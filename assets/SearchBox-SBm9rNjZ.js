import{g as w,j as y,k as O,f as N,t as M,l as L,m as S,_ as I,o as u,c as d,p as z,v as T,d as f,n as _,q as x,F as C,s as k,x as R,y as v,z as F}from"./app-CYuVcYeJ.js";const B=[{path:"/",title:"",pathLocale:"/",contents:[]},{path:"/zh/",title:"",pathLocale:"/",contents:[{header:"å¾®å‰ç«¯",slug:"å¾®å‰ç«¯",content:`å¾®å‰ç«¯çš„æ¦‚å¿µæ˜¯ç”±ThoughtWorksåœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒåœ¨äºå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹è¿è¡Œã€ç‹¬ç«‹éƒ¨ç½²ï¼Œå†å°†è¿™äº›å°å‹åº”ç”¨èåˆä¸ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ï¼Œæˆ–è€…å°†åŸæœ¬è¿è¡Œå·²ä¹…ã€æ²¡æœ‰å…³è”çš„å‡ ä¸ªåº”ç”¨èåˆä¸ºä¸€ä¸ªåº”ç”¨ã€‚å¾®å‰ç«¯æ—¢å¯ä»¥å°†å¤šä¸ªé¡¹ç›®èåˆä¸ºä¸€ï¼Œåˆå¯ä»¥å‡å°‘é¡¹ç›®ä¹‹é—´çš„è€¦åˆï¼Œæå‡é¡¹ç›®æ‰©å±•æ€§ï¼Œç›¸æ¯”ä¸€æ•´å—çš„å‰ç«¯ä»“åº“ï¼Œå¾®å‰ç«¯æ¶æ„ä¸‹çš„å‰ç«¯ä»“åº“å€¾å‘äºæ›´å°æ›´çµæ´»ã€‚
å®ƒä¸»è¦è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š 1ã€éšç€é¡¹ç›®è¿­ä»£åº”ç”¨è¶Šæ¥è¶Šåºå¤§ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚
2ã€è·¨å›¢é˜Ÿæˆ–è·¨éƒ¨é—¨åä½œå¼€å‘é¡¹ç›®å¯¼è‡´æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚`},{header:"å…³äºmicro-app",slug:"å…³äºmicro-app",content:`åœ¨micro-appä¹‹å‰ï¼Œä¸šå†…å·²ç»æœ‰ä¸€äº›å¼€æºçš„å¾®å‰ç«¯æ¡†æ¶ï¼Œæ¯”è¾ƒæµè¡Œçš„æœ‰2ä¸ªï¼šsingle-spaå’Œqiankunã€‚
single-spaæ˜¯é€šè¿‡ç›‘å¬ url change äº‹ä»¶ï¼Œåœ¨è·¯ç”±å˜åŒ–æ—¶åŒ¹é…åˆ°æ¸²æŸ“çš„å­åº”ç”¨å¹¶è¿›è¡Œæ¸²æŸ“ï¼Œè¿™ä¸ªæ€è·¯ä¹Ÿæ˜¯ç›®å‰å®ç°å¾®å‰ç«¯çš„ä¸»æµæ–¹å¼ã€‚åŒæ—¶single-spaè¦æ±‚å­åº”ç”¨ä¿®æ”¹æ¸²æŸ“é€»è¾‘å¹¶æš´éœ²å‡ºä¸‰ä¸ªæ–¹æ³•ï¼šbootstrapã€mountã€unmountï¼Œåˆ†åˆ«å¯¹åº”åˆå§‹åŒ–ã€æ¸²æŸ“å’Œå¸è½½ï¼Œè¿™ä¹Ÿå¯¼è‡´å­åº”ç”¨éœ€è¦å¯¹å…¥å£æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚å› ä¸ºqiankunæ˜¯åŸºäºsingle-spaè¿›è¡Œå°è£…ï¼Œæ‰€ä»¥è¿™äº›ç‰¹ç‚¹ä¹Ÿè¢«qiankunç»§æ‰¿ä¸‹æ¥ï¼Œå¹¶ä¸”éœ€è¦å¯¹webpacké…ç½®è¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚
micro-appå¹¶æ²¡æœ‰æ²¿è¢­single-spaçš„æ€è·¯ï¼Œè€Œæ˜¯å€Ÿé‰´äº†WebComponentçš„æ€æƒ³ï¼Œé€šè¿‡CustomElementç»“åˆè‡ªå®šä¹‰çš„ShadowDomï¼Œå°†å¾®å‰ç«¯å°è£…æˆä¸€ä¸ªç±»WebComponentç»„ä»¶ï¼Œä»è€Œå®ç°å¾®å‰ç«¯çš„ç»„ä»¶åŒ–æ¸²æŸ“ã€‚å¹¶ä¸”ç”±äºè‡ªå®šä¹‰ShadowDomçš„éš”ç¦»ç‰¹æ€§ï¼Œmicro-appä¸éœ€è¦åƒsingle-spaå’Œqiankunä¸€æ ·è¦æ±‚å­åº”ç”¨ä¿®æ”¹æ¸²æŸ“é€»è¾‘å¹¶æš´éœ²å‡ºæ–¹æ³•ï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹webpacké…ç½®ï¼Œæ˜¯ç›®å‰å¸‚é¢ä¸Šæ¥å…¥å¾®å‰ç«¯æˆæœ¬æœ€ä½çš„æ–¹æ¡ˆã€‚`},{header:"æ¦‚å¿µå›¾",slug:"æ¦‚å¿µå›¾",content:""},{header:"micro-appçš„ä¼˜åŠ¿",slug:"micro-appçš„ä¼˜åŠ¿",content:""},{header:"1ã€ä½¿ç”¨ç®€å•",slug:"_1ã€ä½¿ç”¨ç®€å•",content:"æˆ‘ä»¬å°†æ‰€æœ‰åŠŸèƒ½éƒ½å°è£…åˆ°ä¸€ä¸ªç±»WebComponentç»„ä»¶ä¸­ï¼Œä»è€Œå®ç°åœ¨åŸºåº§åº”ç”¨ä¸­åµŒå…¥ä¸€è¡Œä»£ç å³å¯æ¸²æŸ“ä¸€ä¸ªå¾®å‰ç«¯åº”ç”¨ã€‚"},{header:"2ã€åŠŸèƒ½å¼ºå¤§",slug:"_2ã€åŠŸèƒ½å¼ºå¤§",content:"micro-appæä¾›äº†jsæ²™ç®±ã€æ ·å¼éš”ç¦»ã€å…ƒç´ éš”ç¦»ã€è·¯ç”±éš”ç¦»ã€é¢„åŠ è½½ã€æ•°æ®é€šä¿¡ç­‰ä¸€ç³»åˆ—å®Œå–„çš„åŠŸèƒ½ã€‚"},{header:"3ã€å…¼å®¹æ‰€æœ‰æ¡†æ¶",slug:"_3ã€å…¼å®¹æ‰€æœ‰æ¡†æ¶",content:"ä¸ºäº†ä¿è¯å„ä¸ªä¸šåŠ¡ä¹‹é—´ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹éƒ¨ç½²çš„èƒ½åŠ›ï¼Œmicro-appåšäº†è¯¸å¤šå…¼å®¹ï¼Œåœ¨ä»»ä½•å‰ç«¯æ¡†æ¶ä¸­éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œã€‚"}]},{path:"/zh/advanced.html",title:"é«˜çº§åŠŸèƒ½",pathLocale:"/",contents:[{header:"é«˜çº§åŠŸèƒ½",slug:"é«˜çº§åŠŸèƒ½",content:""},{header:"1ã€è‡ªå®šä¹‰fetch",slug:"_1ã€è‡ªå®šä¹‰fetch",content:`é€šè¿‡è‡ªå®šä¹‰fetchæ›¿æ¢æ¡†æ¶è‡ªå¸¦çš„fetchï¼Œå¯ä»¥ä¿®æ”¹fetché…ç½®(æ·»åŠ cookieæˆ–headerä¿¡æ¯ç­‰ç­‰)ï¼Œæˆ–æ‹¦æˆªHTMLã€JSã€CSSç­‰é™æ€èµ„æºã€‚
è‡ªå®šä¹‰çš„fetchå¿…é¡»æ˜¯ä¸€ä¸ªè¿”å›stringç±»å‹çš„Promiseã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ /** * è‡ªå®šä¹‰fetch * @param {string} url é™æ€èµ„æºåœ°å€ * @param {object} options fetchè¯·æ±‚é…ç½®é¡¹ * @param {string|null} appName åº”ç”¨åç§° * @returns Promise<string> */ fetch (url, options, appName) { if (url === 'http://localhost:3001/error.js') { // åˆ é™¤ http://localhost:3001/error.js çš„å†…å®¹ return Promise.resolve('') } const config = { // fetch é»˜è®¤ä¸å¸¦cookieï¼Œå¦‚æœéœ€è¦æ·»åŠ cookieéœ€è¦é…ç½®credentials credentials: 'include', // è¯·æ±‚æ—¶å¸¦ä¸Šcookie } return window.fetch(url, Object.assign(options, config)).then((res) => { return res.text() }) }
})
Note å¦‚æœè·¨åŸŸè¯·æ±‚å¸¦cookieï¼Œé‚£ä¹ˆAccess-Control-Allow-Originä¸èƒ½è®¾ç½®ä¸º*ï¼Œå¿…é¡»æŒ‡å®šåŸŸåï¼ŒåŒæ—¶è®¾ç½®Access-Control-Allow-Credentials: true`}]},{path:"/zh/api.html",title:"",pathLocale:"/",contents:[{header:"start",slug:"start",content:"æè¿°ï¼š micro-appæ³¨å†Œå‡½æ•°ï¼Œå…¨å±€æ‰§è¡Œä¸€æ¬¡\nä»‹ç»ï¼š\nstart (options?: { tagName?: string, // è®¾ç½®æ ‡ç­¾åç§°ï¼Œé»˜è®¤ä¸ºmicro-app iframe?: boolean, // å…¨å±€å¼€å¯iframeæ²™ç®±ï¼Œé»˜è®¤ä¸ºfalse inline?: boolean, // å…¨å±€å¼€å¯å†…è”scriptæ¨¡å¼è¿è¡Œjsï¼Œé»˜è®¤ä¸ºfalse destroy?: boolean, // å…¨å±€å¼€å¯destroyæ¨¡å¼ï¼Œå¸è½½æ—¶å¼ºåˆ¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œé»˜è®¤ä¸ºfalse // shadowDOM?: boolean, // å…¨å±€å¼€å¯shadowDOMæ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalse ssr?: boolean, // å…¨å±€å¼€å¯ssræ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalse 'disable-scopecss'?: boolean, // å…¨å±€ç¦ç”¨æ ·å¼éš”ç¦»ï¼Œé»˜è®¤ä¸ºfalse 'disable-sandbox'?: boolean, // å…¨å±€ç¦ç”¨æ²™ç®±ï¼Œé»˜è®¤ä¸ºfalse 'keep-alive'?: boolean, // å…¨å±€å¼€å¯ä¿æ´»æ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalse 'disable-memory-router'?: boolean, // å…¨å±€å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œé»˜è®¤å€¼false 'keep-router-state'?: boolean, // å­åº”ç”¨åœ¨å¸è½½æ—¶ä¿ç•™è·¯ç”±çŠ¶æ€ï¼Œé»˜è®¤å€¼false 'disable-patch-request'?: boolean, // å…³é—­å­åº”ç”¨è¯·æ±‚çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œé»˜è®¤å€¼false 'router-mode'?: string, // è®¾ç½®è·¯ç”±æ¨¡å¼ï¼Œå…±å››ç§ï¼šsearchã€nativeã€native-scopeã€pureï¼Œé»˜è®¤ä¸ºsearch iframeSrc?: string, // è®¾ç½®iframeæ²™ç®±ä¸­iframeçš„srcåœ°å€ï¼Œé»˜è®¤ä¸ºå­åº”ç”¨æ‰€åœ¨é¡µé¢åœ°å€ // å…¨å±€ç”Ÿå‘½å‘¨æœŸ lifeCycles?: { created?(e?: CustomEvent): void beforemount?(e?: CustomEvent): void mounted?(e?: CustomEvent): void unmount?(e?: CustomEvent): void error?(e?: CustomEvent): void }, // é¢„åŠ è½½ï¼Œæ”¯æŒæ•°ç»„æˆ–å‡½æ•° preFetchApps?: Array<{ name: string, url: string, disableScopecss?: boolean, disableSandbox?: boolean, // shadowDOM?: boolean }> | (() => Array<{ name: string, url: string, disableScopecss?: boolean, disableSandbox?: boolean, // shadowDOM?: boolean }>), // æ’ä»¶ç³»ç»Ÿï¼Œç”¨äºå¤„ç†å­åº”ç”¨çš„jsæ–‡ä»¶ plugins?: { // å…¨å±€æ’ä»¶ï¼Œä½œç”¨äºæ‰€æœ‰å­åº”ç”¨çš„jsæ–‡ä»¶ global?: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°ä¸»åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¯é€‰ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => string, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => string }> // å­åº”ç”¨æ’ä»¶ modules?: { // appNameä¸ºåº”ç”¨çš„åç§°ï¼Œè¿™äº›æ’ä»¶åªä¼šä½œç”¨äºæŒ‡å®šçš„åº”ç”¨ [name: string]: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°ä¸»åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¿…å¡«ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å›codeå€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => string, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => string }> } }, // é‡å®šä¹‰fetchæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºæ‹¦æˆªèµ„æºè¯·æ±‚æ“ä½œ fetch?: (url: string, options: Record<string, any>, appName: string | null) => Promise<string> // è®¾ç½®å…¨å±€é™æ€èµ„æº globalAssets?: { js?: string[], // jsåœ°å€ css?: string[], // cssåœ°å€ }, // æŒ‡å®šéƒ¨åˆ†ç‰¹æ®Šçš„åŠ¨æ€åŠ è½½çš„å¾®åº”ç”¨èµ„æºï¼ˆcss/js) ä¸è¢« micro-app åŠ«æŒå¤„ç† excludeAssetFilter?: (assetUrl: string) => boolean // åŸºåº§å¯¹å­åº”ç”¨ document çš„ä¸€äº›å±æ€§è¿›è¡Œè‡ªå®šä¹‰ä»£ç†æ‰©å±• customProxyDocumentProps?: Map<string | number | symbol, (value: unknown) => void>\n})\nä½¿ç”¨æ–¹å¼ï¼š\n// index.js\nimport microApp from '@micro-zoe/micro-app' microApp.start()"},{header:"preFetch",slug:"prefetch",content:`æè¿°ï¼š é¢„åŠ è½½ï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´ï¼Œä¾ç…§å¼€å‘è€…ä¼ å…¥çš„é¡ºåºï¼Œä¾æ¬¡åŠ è½½æ¯ä¸ªåº”ç”¨çš„é™æ€èµ„æº
ä»‹ç»ï¼š
preFetch([ { name: string, url: string, disableScopecss?: boolean, disableSandbox?: boolean, },
])
ä½¿ç”¨æ–¹å¼ï¼š
import { preFetch } from '@micro-zoe/micro-app' // æ–¹å¼ä¸€
preFetch([ { name: 'my-app1', url: 'xxx' }, { name: 'my-app2', url: 'xxx' },
]) // æ–¹å¼äºŒ
preFetch(() => [ { name: 'my-app1', url: 'xxx' }, { name: 'my-app2', url: 'xxx' },
])`},{header:"getActiveApps",slug:"getactiveapps",content:`æè¿°ï¼š è·å–æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨ï¼Œä¸åŒ…å«å·²å¸è½½å’Œé¢„åŠ è½½çš„åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.5.2åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
/** * getActiveAppsæ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š * @param excludeHiddenApp æ˜¯å¦è¿‡æ»¤å¤„äºéšè—çŠ¶æ€çš„keep-aliveåº”ç”¨ï¼Œé»˜è®¤false * @param excludePreRender æ˜¯å¦è¿‡æ»¤é¢„æ¸²æŸ“çš„åº”ç”¨ï¼Œé»˜è®¤false */
function getActiveApps({ excludeHiddenApp?: boolean, excludePreRender?: boolean,
}): string[]
ä½¿ç”¨æ–¹å¼ï¼š
import { getActiveApps } from '@micro-zoe/micro-app' // è·å–æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åº”ç”¨çš„åç§°
getActiveApps() // [å­åº”ç”¨1name, å­åº”ç”¨2name, ...] // è·å–æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åº”ç”¨çš„åç§°ï¼Œä½†ä¸åŒ…æ‹¬å·²ç»å¤„äºéšè—çŠ¶æ€çš„keep-aliveåº”ç”¨
getActiveApps({ excludeHiddenApp: true }) // è·å–æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åº”ç”¨çš„åç§°ï¼Œä½†ä¸åŒ…æ‹¬é¢„æ¸²æŸ“åº”ç”¨
getActiveApps({ excludePreRender: true })`},{header:"getAllApps",slug:"getallapps",content:`æè¿°ï¼š è·å–æ‰€æœ‰å­åº”ç”¨ï¼ŒåŒ…å«å·²å¸è½½å’Œé¢„åŠ è½½çš„åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.5.2åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
function getAllApps(): string[]
ä½¿ç”¨æ–¹å¼ï¼š
import { getAllApps } from '@micro-zoe/micro-app' getAllApps() // [å­åº”ç”¨name, å­åº”ç”¨name, ...]`},{header:"version",slug:"version",content:`æè¿°ï¼š æŸ¥çœ‹ç‰ˆæœ¬å·
æ–¹å¼1ï¼š
import { version } from '@micro-zoe/micro-app'
æ–¹å¼2ï¼š é€šè¿‡micro-appå…ƒç´ ä¸Šçš„versionå±æ€§æŸ¥çœ‹
document.querySelector('micro-app').version`},{header:"pureCreateElement",slug:"purecreateelement",content:`æè¿°ï¼š åˆ›å»ºæ— ç»‘å®šçš„çº¯å‡€å…ƒç´ 
ä½¿ç”¨æ–¹å¼ï¼š
import { pureCreateElement } from '@micro-zoe/micro-app' const pureDiv = pureCreateElement('div') document.body.appendChild(pureDiv)`},{header:"removeDomScope",slug:"removedomscope",content:`æè¿°ï¼š è§£é™¤å…ƒç´ ç»‘å®šï¼Œé€šå¸¸ç”¨äºå—å­åº”ç”¨å…ƒç´ ç»‘å®šå½±å“ï¼Œå¯¼è‡´ä¸»åº”ç”¨å…ƒç´ é”™è¯¯ç»‘å®šåˆ°å­åº”ç”¨çš„æƒ…å†µ
ä»‹ç»ï¼š
/** * @param force è§£é™¤å…ƒç´ ç»‘å®šï¼Œå¹¶ä¸”ä¸€å®šæ—¶é—´å†…(ä¸€ä¸ªå¾®ä»»åŠ¡Promiseæ—¶é—´)é˜»æ­¢å†æ¬¡ç»‘å®šã€‚ */
function removeDomScope(force?: boolean): void
ä½¿ç”¨æ–¹å¼ï¼š
import { removeDomScope } from '@micro-zoe/micro-app' // è§£é™¤å…ƒç´ ç»‘å®š
removeDomScope() // è§£é™¤å…ƒç´ ç»‘å®šï¼Œå¹¶ä¸”ä¸€å®šæ—¶é—´å†…é˜»æ­¢å†æ¬¡ç»‘å®š
removeDomScope(true)`},{header:"unmountApp",slug:"unmountapp",content:`æè¿°ï¼š æ‰‹åŠ¨å¸è½½åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.6.1åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
// unmountApp å‚æ•°é…ç½®
interface unmountAppParams { /** * destroy: æ˜¯å¦å¼ºåˆ¶å¸è½½åº”ç”¨å¹¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œé»˜è®¤å€¼ï¼šfalse * ä¼˜å…ˆçº§: é«˜äº clearAliveState * å¯¹äºå·²ç»å¸è½½çš„åº”ç”¨: å½“å­åº”ç”¨å·²ç»å¸è½½æˆ–keep-aliveåº”ç”¨å·²ç»æ¨å…¥åå°ï¼Œåˆ™æ¸…é™¤åº”ç”¨çŠ¶æ€åŠç¼“å­˜èµ„æº * å¯¹äºæ­£åœ¨è¿è¡Œçš„åº”ç”¨: å½“å­åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œåˆ™å¸è½½åº”ç”¨å¹¶åˆ é™¤çŠ¶æ€åŠç¼“å­˜èµ„æº */ destroy?: boolean /** * clearAliveState: æ˜¯å¦æ¸…ç©ºåº”ç”¨çš„ç¼“å­˜çŠ¶æ€ï¼Œé»˜è®¤å€¼ï¼šfalse * è§£é‡Š: å¦‚æœå­åº”ç”¨æ˜¯keep-aliveï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æºï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveï¼Œåˆ™æ‰§è¡Œæ­£å¸¸å¸è½½æµç¨‹ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº * è¡¥å……: æ— è®ºkeep-aliveåº”ç”¨æ­£åœ¨è¿è¡Œè¿˜æ˜¯å·²ç»æ¨å…¥åå°ï¼Œéƒ½å°†æ‰§è¡Œå¸è½½æ“ä½œï¼Œæ¸…ç©ºåº”ç”¨ç¼“å­˜çŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº */ clearAliveState?: boolean
} function unmountApp(appName: string, options?: unmountAppParams): Promise<boolean>
ä½¿ç”¨æ–¹å¼ï¼š
// æ­£å¸¸æµç¨‹
unmountApp(å­åº”ç”¨åç§°).then(() => console.log('å¸è½½æˆåŠŸ')) // å¸è½½åº”ç”¨å¹¶æ¸…ç©ºç¼“å­˜èµ„æº
unmountApp(å­åº”ç”¨åç§°, { destroy: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœå­åº”ç”¨æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™æ­£å¸¸å¸è½½
unmountApp(å­åº”ç”¨åç§°, { clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœdestroyå’ŒclearAliveStateåŒæ—¶ä¸ºtrueï¼Œåˆ™clearAliveStateå°†å¤±æ•ˆ
unmountApp(å­åº”ç”¨åç§°, { destroy: true, clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ'))`},{header:"unmountAllApps",slug:"unmountallapps",content:`æè¿°ï¼š æ‰‹åŠ¨å¸è½½æ‰€æœ‰åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.6.1åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
// unmountAllApps å‚æ•°é…ç½®
interface unmountAppParams { /** * destroy: æ˜¯å¦å¼ºåˆ¶å¸è½½åº”ç”¨å¹¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œé»˜è®¤å€¼ï¼šfalse * ä¼˜å…ˆçº§: é«˜äº clearAliveState * å¯¹äºå·²ç»å¸è½½çš„åº”ç”¨: å½“å­åº”ç”¨å·²ç»å¸è½½æˆ–keep-aliveåº”ç”¨å·²ç»æ¨å…¥åå°ï¼Œåˆ™æ¸…é™¤åº”ç”¨çŠ¶æ€åŠç¼“å­˜èµ„æº * å¯¹äºæ­£åœ¨è¿è¡Œçš„åº”ç”¨: å½“å­åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œåˆ™å¸è½½åº”ç”¨å¹¶åˆ é™¤çŠ¶æ€åŠç¼“å­˜èµ„æº */ destroy?: boolean /** * clearAliveState: æ˜¯å¦æ¸…ç©ºåº”ç”¨çš„ç¼“å­˜çŠ¶æ€ï¼Œé»˜è®¤å€¼ï¼šfalse * è§£é‡Š: å¦‚æœå­åº”ç”¨æ˜¯keep-aliveï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æºï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveï¼Œåˆ™æ‰§è¡Œæ­£å¸¸å¸è½½æµç¨‹ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº * è¡¥å……: æ— è®ºkeep-aliveåº”ç”¨æ­£åœ¨è¿è¡Œè¿˜æ˜¯å·²ç»æ¨å…¥åå°ï¼Œéƒ½å°†æ‰§è¡Œå¸è½½æ“ä½œï¼Œæ¸…ç©ºåº”ç”¨ç¼“å­˜çŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº */ clearAliveState?: boolean
} function unmountAllApps(options?: unmountAppParams): Promise<boolean>
ä½¿ç”¨æ–¹å¼ï¼š
// æ­£å¸¸æµç¨‹
unmountAllApps().then(() => console.log('å¸è½½æˆåŠŸ')) // å¸è½½æ‰€æœ‰åº”ç”¨å¹¶æ¸…ç©ºç¼“å­˜èµ„æº
unmountAllApps({ destroy: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœå­åº”ç”¨æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™æ­£å¸¸å¸è½½
unmountAllApps({ clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœdestroyå’ŒclearAliveStateåŒæ—¶ä¸ºtrueï¼Œåˆ™clearAliveStateå°†å¤±æ•ˆ
unmountAllApps({ destroy: true, clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ'))`},{header:"reload",slug:"reload",content:`æè¿°ï¼š é‡æ–°æ¸²æŸ“å­åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 1.0.0åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
/** * @param appName åº”ç”¨åç§°ï¼Œå¿…ä¼  * @param destroy é‡æ–°æ¸²æŸ“æ—¶æ˜¯å¦å½»åº•åˆ é™¤ç¼“å­˜å€¼ï¼Œå¯é€‰ */
function reload(appName: string, destroy?: boolean): Promise<boolean>
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // æ¡ˆä¾‹ä¸€ï¼šé‡æ–°æ¸²æŸ“å­åº”ç”¨my-app
microApp.reload('my-app').then((result) => { if (result) { console.log('é‡æ–°æ¸²æŸ“æˆåŠŸ') } else { console.log('é‡æ–°æ¸²æŸ“å¤±è´¥') }
}) // æ¡ˆä¾‹äºŒï¼šé‡æ–°æ¸²æŸ“å­åº”ç”¨my-appï¼Œå¹¶å½»åº•åˆ é™¤ç¼“å­˜å€¼
microApp.reload('my-app', true).then((result) => { if (result) { console.log('é‡æ–°æ¸²æŸ“æˆåŠŸ') } else { console.log('é‡æ–°æ¸²æŸ“å¤±è´¥') }
})`},{header:"renderApp",slug:"renderapp",content:`æè¿°ï¼š æ‰‹åŠ¨æ¸²æŸ“å­åº”ç”¨
ä»‹ç»ï¼š
interface RenderAppOptions { name: string, // åº”ç”¨åç§°ï¼Œå¿…ä¼  url: string, // åº”ç”¨åœ°å€ï¼Œå¿…ä¼  container: string | Element, // åº”ç”¨å®¹å™¨æˆ–é€‰æ‹©å™¨ï¼Œå¿…ä¼  iframe?: boolean, // æ˜¯å¦åˆ‡æ¢ä¸ºiframeæ²™ç®±ï¼Œå¯é€‰ inline?: boolean, // å¼€å¯å†…è”æ¨¡å¼è¿è¡Œjsï¼Œå¯é€‰ 'disable-scopecss'?: boolean, // å…³é—­æ ·å¼éš”ç¦»ï¼Œå¯é€‰ 'disable-sandbox'?: boolean, // å…³é—­æ²™ç®±ï¼Œå¯é€‰ 'disable-memory-router'?: boolean, // å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œå¯é€‰ 'default-page'?: string, // æŒ‡å®šé»˜è®¤æ¸²æŸ“çš„é¡µé¢ï¼Œå¯é€‰ 'keep-router-state'?: boolean, // ä¿ç•™è·¯ç”±çŠ¶æ€ï¼Œå¯é€‰ 'disable-patch-request'?: boolean, // å…³é—­å­åº”ç”¨è¯·æ±‚çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œå¯é€‰ 'keep-alive'?: boolean, // å¼€å¯keep-aliveæ¨¡å¼ï¼Œå¯é€‰ destroy?: boolean, // å¸è½½æ—¶å¼ºåˆ¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œå¯é€‰ fiber?: boolean, // å¼€å¯fiberæ¨¡å¼ï¼Œå¯é€‰ baseroute?: string, // è®¾ç½®å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå¯é€‰ ssr?: boolean, // å¼€å¯ssræ¨¡å¼ï¼Œå¯é€‰ // shadowDOM?: boolean, // å¼€å¯shadowDOMï¼Œå¯é€‰ data?: Object, // ä¼ é€’ç»™å­åº”ç”¨çš„æ•°æ®ï¼Œå¯é€‰ onDataChange?: Function, // è·å–å­åº”ç”¨å‘é€æ•°æ®çš„ç›‘å¬å‡½æ•°ï¼Œå¯é€‰ // æ³¨å†Œå­åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ lifeCycles?: { created(e: CustomEvent): void, // åŠ è½½èµ„æºå‰è§¦å‘ beforemount(e: CustomEvent): void, // åŠ è½½èµ„æºå®Œæˆåï¼Œå¼€å§‹æ¸²æŸ“ä¹‹å‰è§¦å‘ mounted(e: CustomEvent): void, // å­åº”ç”¨æ¸²æŸ“ç»“æŸåè§¦å‘ unmount(e: CustomEvent): void, // å­åº”ç”¨å¸è½½æ—¶è§¦å‘ error(e: CustomEvent): void, // å­åº”ç”¨æ¸²æŸ“å‡ºé”™æ—¶è§¦å‘ beforeshow(e: CustomEvent): void, // å­åº”ç”¨æ¨å…¥å‰å°ä¹‹å‰è§¦å‘ï¼ˆkeep-aliveæ¨¡å¼ç‰¹æœ‰ï¼‰ aftershow(e: CustomEvent): void, // å­åº”ç”¨æ¨å…¥å‰å°ä¹‹åè§¦å‘ï¼ˆkeep-aliveæ¨¡å¼ç‰¹æœ‰ï¼‰ afterhidden(e: CustomEvent): void, // å­åº”ç”¨æ¨å…¥åå°æ—¶è§¦å‘ï¼ˆkeep-aliveæ¨¡å¼ç‰¹æœ‰ï¼‰ },
} /** * @param options RenderAppOptions é…ç½®é¡¹ */
function renderApp(options: RenderAppOptions): Promise<boolean>
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // æ¡ˆä¾‹ä¸€
microApp.renderApp({ name: 'my-app', url: 'http://localhost:3000', container: '#container',
}).then((result) => { if (result) { console.log('æ¸²æŸ“æˆåŠŸ') } else { console.log('æ¸²æŸ“å¤±è´¥') }
}) // æ¡ˆä¾‹äºŒ
microApp.renderApp({ name: 'my-app', url: 'http://localhost:3000', container: '#container', inline: true, data: { key: 'åˆå§‹åŒ–æ•°æ®' }, lifeCycles: { mounted () { console.log('å­åº”ç”¨å·²ç»æ¸²æŸ“') }, unmount () { console.log('å­åº”ç”¨å·²ç»å¸è½½') }, }
})`},{header:"document.microAppElement",slug:"document-microappelement",content:`æè¿°ï¼š è·å–å­åº”ç”¨æ‰€åœ¨çš„micro-appå…ƒç´ ã€‚
é™åˆ¶ï¼š åªèƒ½åœ¨å­åº”ç”¨å†…éƒ¨ä½¿ç”¨ï¼ŒåŸºåº§ä¸­å¯ä»¥ä½¿ç”¨document.querySelectorè·å–micro-appå…ƒç´ 
ä½¿ç”¨æ–¹å¼ï¼š
document.microAppElement.appendChild(...)`},{header:"setData",slug:"setdata",content:`æè¿°ï¼š å‘æŒ‡å®šçš„å­åº”ç”¨å‘é€æ•°æ®
ä»‹ç»ï¼š
setData(appName: String, data: Object)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // å‘é€æ•°æ®ç»™å­åº”ç”¨ my-appï¼ŒsetDataç¬¬äºŒä¸ªå‚æ•°åªæ¥å—å¯¹è±¡ç±»å‹
microApp.setData('my-app', {type: 'æ–°çš„æ•°æ®'})`},{header:"getData",slug:"getdata",content:`æè¿°ï¼š è·å–æŒ‡å®šçš„å­åº”ç”¨dataæ•°æ®
ä»‹ç»ï¼š
getData(appName: String): Object
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' const childData = microApp.getData('my-app') // è¿”å›my-appå­åº”ç”¨çš„dataæ•°æ®`},{header:"addDataListener",slug:"adddatalistener",content:`æè¿°ï¼š ç›‘å¬æŒ‡å®šå­åº”ç”¨çš„æ•°æ®å˜åŒ–
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * appName: åº”ç”¨åç§° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addDataListener(appName: string, dataListener: Function, autoTrigger?: boolean)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
} microApp.addDataListener('my-app', dataListener)`},{header:"removeDataListener",slug:"removedatalistener",content:`æè¿°ï¼š è§£é™¤ä¸»åº”ç”¨çš„æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
} // è§£ç»‘ç›‘å¬my-appå­åº”ç”¨çš„æ•°æ®ç›‘å¬å‡½æ•°
microApp.removeDataListener('my-app', dataListener)`},{header:"clearDataListener",slug:"cleardatalistener",content:`æè¿°ï¼š æ¸…ç©ºä¸»åº”ç”¨çš„æ‰€æœ‰æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // æ¸…ç©ºæ‰€æœ‰ç›‘å¬appNameå­åº”ç”¨çš„æ•°æ®ç›‘å¬å‡½æ•°
microApp.clearDataListener('my-app')`},{header:"getGlobalData",slug:"getglobaldata",content:`æè¿°ï¼š è·å–å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // ç›´æ¥è·å–æ•°æ®
const globalData = microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ®`},{header:"addGlobalDataListener",slug:"addglobaldatalistener",content:`æè¿°ï¼š ç»‘å®šæ•°æ®ç›‘å¬å‡½æ•°
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addGlobalDataListener(dataListener: Function, autoTrigger?: boolean)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} microApp.addGlobalDataListener(dataListener)`},{header:"removeGlobalDataListener",slug:"removeglobaldatalistener",content:`æè¿°ï¼š è§£ç»‘å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} microApp.removeGlobalDataListener(dataListener)`},{header:"clearGlobalDataListener",slug:"clearglobaldatalistener",content:`æè¿°ï¼š æ¸…ç©ºä¸»åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' microApp.clearGlobalDataListener()`},{header:"setGlobalData",slug:"setglobaldata",content:`æè¿°ï¼š å‘é€å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'})`},{header:"pureCreateElement",slug:"purecreateelement-1",content:`æè¿°ï¼š åˆ›å»ºæ— ç»‘å®šçš„çº¯å‡€å…ƒç´ ï¼Œè¯¥å…ƒç´ å¯ä»¥é€ƒç¦»å…ƒç´ éš”ç¦»çš„è¾¹ç•Œï¼Œä¸å—å­åº”ç”¨æ²™ç®±çš„æ§åˆ¶
ç‰ˆæœ¬é™åˆ¶ï¼š 0.8.2åŠä»¥ä¸Šç‰ˆæœ¬
ä½¿ç”¨æ–¹å¼ï¼š
const pureDiv = window.microApp.pureCreateElement('div') document.body.appendChild(pureDiv)`},{header:"removeDomScope",slug:"removedomscope-1",content:`æè¿°ï¼š è§£é™¤å…ƒç´ ç»‘å®šï¼Œé€šå¸¸ç”¨äºå—å­åº”ç”¨å…ƒç´ ç»‘å®šå½±å“ï¼Œå¯¼è‡´ä¸»åº”ç”¨å…ƒç´ é”™è¯¯ç»‘å®šåˆ°å­åº”ç”¨çš„æƒ…å†µ
ç‰ˆæœ¬é™åˆ¶ï¼š 0.8.2åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
/** * @param force è§£é™¤å…ƒç´ ç»‘å®šï¼Œå¹¶ä¸”ä¸€å®šæ—¶é—´å†…(ä¸€ä¸ªå¾®ä»»åŠ¡Promiseæ—¶é—´)é˜»æ­¢å†æ¬¡ç»‘å®šã€‚ */
function removeDomScope(force?: boolean): void
ä½¿ç”¨æ–¹å¼ï¼š
// è§£é™¤å…ƒç´ ç»‘å®š
window.microApp.removeDomScope() // è§£é™¤å…ƒç´ ç»‘å®šï¼Œå¹¶ä¸”ä¸€å®šæ—¶é—´å†…é˜»æ­¢å†æ¬¡ç»‘å®š
window.microApp.removeDomScope(true)`},{header:"rawWindow",slug:"rawwindow",content:`æè¿°ï¼š è·å–çœŸå®çš„window
ä½¿ç”¨æ–¹å¼ï¼š
window.rawWindow`},{header:"rawDocument",slug:"rawdocument",content:`æè¿°ï¼š è·å–çœŸå®çš„document
ä½¿ç”¨æ–¹å¼ï¼š
window.rawDocument`},{header:"getData",slug:"getdata-1",content:`æè¿°ï¼š è·å–ä¸»åº”ç”¨ä¸‹å‘çš„dataæ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
const data = window.microApp.getData() // è¿”å›ä¸»åº”ç”¨ä¸‹å‘çš„dataæ•°æ®`},{header:"addDataListener",slug:"adddatalistener-1",content:`æè¿°ï¼š ç»‘å®šæ•°æ®ç›‘å¬å‡½æ•°
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•°ï¼Œç›‘å¬å‡½æ•°åªæœ‰åœ¨æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse * !!!é‡è¦è¯´æ˜: å› ä¸ºå­åº”ç”¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„ï¼Œè€Œä¸»åº”ç”¨å‘é€æ•°æ®æ˜¯åŒæ­¥çš„ï¼Œ * å¦‚æœåœ¨å­åº”ç”¨æ¸²æŸ“ç»“æŸå‰ä¸»åº”ç”¨å‘é€æ•°æ®ï¼Œåˆ™åœ¨ç»‘å®šç›‘å¬å‡½æ•°å‰æ•°æ®å·²ç»å‘é€ï¼Œåœ¨åˆå§‹åŒ–åä¸ä¼šè§¦å‘ç»‘å®šå‡½æ•°ï¼Œ * ä½†è¿™ä¸ªæ•°æ®ä¼šæ”¾å…¥ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶å¯ä»¥è®¾ç½®autoTriggerä¸ºtrueä¸»åŠ¨è§¦å‘ä¸€æ¬¡ç›‘å¬å‡½æ•°æ¥è·å–æ•°æ®ã€‚ */
window.microApp.addDataListener(dataListener: Function, autoTrigger?: boolean)
ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®', data)
} window.microApp.addDataListener(dataListener)`},{header:"removeDataListener",slug:"removedatalistener-1",content:`æè¿°ï¼š è§£ç»‘æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®', data)
} window.microApp.removeDataListener(dataListener)`},{header:"clearDataListener",slug:"cleardatalistener-1",content:`æè¿°ï¼š æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰æ•°æ®ç›‘å¬å‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
ä½¿ç”¨æ–¹å¼ï¼š
window.microApp.clearDataListener()`},{header:"dispatch",slug:"dispatch",content:`æè¿°ï¼š å‘ä¸»åº”ç”¨å‘é€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
// dispatchåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})`},{header:"getGlobalData",slug:"getglobaldata-1",content:`æè¿°ï¼š è·å–å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
const globalData = window.microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ®`},{header:"addGlobalDataListener",slug:"addglobaldatalistener-1",content:`æè¿°ï¼š ç»‘å®šæ•°æ®ç›‘å¬å‡½æ•°
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.microApp.addGlobalDataListener(dataListener: Function, autoTrigger?: boolean) ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} window.microApp.addGlobalDataListener(dataListener)`},{header:"removeGlobalDataListener",slug:"removeglobaldatalistener-1",content:`æè¿°ï¼š è§£ç»‘å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} window.microApp.removeGlobalDataListener(dataListener)`},{header:"clearGlobalDataListener",slug:"clearglobaldatalistener-1",content:`æè¿°ï¼š æ¸…ç©ºå½“å‰å­åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
window.microApp.clearGlobalDataListener()`},{header:"setGlobalData",slug:"setglobaldata-1",content:`æè¿°ï¼š å‘é€å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
// setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'})`}]},{path:"/zh/browser-router.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:"nativeæ¨¡å¼ä¸‹å­åº”ç”¨å®Œå…¨åŸºäºæµè§ˆå™¨è·¯ç”±ç³»ç»Ÿè¿›è¡Œæ¸²æŸ“ï¼Œæ­¤æ—¶éœ€è¦æ›´åŠ å¤æ‚çš„è·¯ç”±é…ç½®ï¼Œå¯¹ä¸»åº”ç”¨å’Œå­åº”ç”¨çš„è·¯ç”±éƒ½è¦è¿›è¡Œä¸€äº›æ”¹é€ ã€‚"},{header:"è·¯ç”±ç±»å‹çº¦æŸ",slug:"è·¯ç”±ç±»å‹çº¦æŸ",content:`nativeæ¨¡å¼ä¸‹ä¸»ã€å­åº”ç”¨éœ€è¦éµå¾ªä»¥ä¸‹çº¦æŸï¼š 1ã€ä¸»åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œå­åº”ç”¨ä¹Ÿå¿…é¡»æ˜¯hashè·¯ç”±
2ã€ä¸»åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥æ˜¯hashæˆ–historyè·¯ç”±`},{header:"åŸºç¡€è·¯ç”±",slug:"åŸºç¡€è·¯ç”±",content:`ä½œç”¨ï¼š
é€šå¸¸ä¸»åº”ç”¨å’Œå­åº”ç”¨å„æœ‰ä¸€å¥—è·¯ç”±ç³»ç»Ÿï¼Œä¸ºäº†é˜²æ­¢å†²çªï¼Œä¸»åº”ç”¨éœ€è¦åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨ï¼Œç§°ä¹‹ä¸ºåŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥åœ¨è¿™ä¸ªè·¯ç”±ä¸‹æ¸²æŸ“ï¼Œä½†ä¸èƒ½è¶…å‡ºè¿™ä¸ªè·¯ç”±çš„èŒƒå›´ï¼Œè¿™å°±æ˜¯åŸºç¡€è·¯ç”±çš„ä½œç”¨ã€‚
ä½¿ç”¨æ–¹å¼
ä¸»åº”ç”¨ä¸­é€šè¿‡è®¾ç½® <micro-app>çš„baserouteå±æ€§ä¸‹å‘ï¼Œå­åº”ç”¨é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–æ­¤å€¼å¹¶è®¾ç½®åŸºç¡€è·¯ç”±ã€‚
æ³¨æ„ç‚¹ï¼š 1ã€å¦‚æœä¸»åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œä¸éœ€è¦è®¾ç½®åŸºç¡€è·¯ç”±baseroute
2ã€å¦‚æœå­åº”ç”¨åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œæ²¡æœ‰ä½¿ç”¨react-routerï¼Œvue-routerä¹‹ç±»ï¼Œä¹Ÿä¸éœ€è¦è®¾ç½®åŸºç¡€è·¯ç”±baseroute
3ã€vue-routeråœ¨hashæ¨¡å¼ä¸‹æ— æ³•é€šè¿‡baseè®¾ç½®åŸºç¡€è·¯ç”±ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªç©ºçš„è·¯ç”±é¡µé¢ï¼Œå°†å…¶å®ƒè·¯ç”±ä½œä¸ºå®ƒçš„childrenï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹ï¼š import RootApp from './root-app.vue' const routes = [ { path: window.__MICRO_APP_BASE_ROUTE__ || '/', component: RootApp, children: [ // å…¶ä»–çš„è·¯ç”±éƒ½å†™åˆ°è¿™é‡Œ ], },
]
root-app.vueå†…å®¹å¦‚ä¸‹ï¼š
<template> <router-view />
</template>
ç¤ºä¾‹ // router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom'
import ChildPage from './child-page' export default function AppRoute () { return ( <BrowserRouter> <Switch> // éä¸¥æ ¼åŒ¹é…ï¼Œ/child/* éƒ½æŒ‡å‘ChildPageç»„ä»¶ // /child å°±æ˜¯åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±baseroute <Route path='/child'> <ChildPage /> </Route> </Switch> </BrowserRouter> )
} // child-page.js
export function ChildPage () { return ( <div> <h1>å­åº”ç”¨</h1> <micro-app name='child-app' url='http://localhost:3000/' baseroute='/child'></micro-app> </div> )
} import { BrowserRouter, Switch, Route } from 'react-router-dom' export default function AppRoute () { return ( // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–ä¸»åº”ç”¨ä¸‹å‘çš„baserouteï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™æ­¤å€¼é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² <BrowserRouter basename={window.__MICRO_APP_BASE_ROUTE__ || '/'}> ... </BrowserRouter> )
} // router.js
import Vue from 'vue'
import VueRouter from 'vue-router'
import ChildPage from './child-page.vue' Vue.use(VueRouter) const routes = [ { // /child/* éƒ½æŒ‡å‘ChildPageç»„ä»¶ path: '/child/*', // vue-router@4.x pathçš„å†™æ³•ä¸ºï¼š'/child/:page*' name: 'child', component: ChildPage, },
] export default routes // child-page.vue
<template> <div> <h1>å­åº”ç”¨</h1> <micro-app name='child-app' url='http://localhost:3000/' baseroute='/child'></micro-app> </div>
</template> import Vue from 'vue'
import VueRouter from 'vue-router'
import routes from './router' const router = new VueRouter({ // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–ä¸»åº”ç”¨ä¸‹å‘çš„baserouteï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™æ­¤å€¼é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² base: window.__MICRO_APP_BASE_ROUTE__ || '/', routes,
}) let app = new Vue({ router, render: h => h(App),
}).$mount('#app') æç¤º
vue-router@4.xè®¾ç½®baseçš„æ–¹å¼è¯·æŸ¥çœ‹ https://next.router.vuejs.org/`},{header:"å…³äºnativeæ¨¡å¼çš„åŸç†è§£æ",slug:"å…³äºnativeæ¨¡å¼çš„åŸç†è§£æ",content:`å­åº”ç”¨ä¸ä¼šæ ¹æ®micro-appçš„urlå±æ€§æ¸²æŸ“å¯¹åº”çš„é¡µé¢ï¼Œè€Œæ˜¯æ ¹æ®æµè§ˆå™¨åœ°å€æ¸²æŸ“å¯¹åº”çš„é¡µé¢ã€‚
ä¸¾ä¸ªæ —å­ ğŸŒ° :
æµè§ˆå™¨åœ°å€ä¸ºï¼šhttp://localhost:3000/page1/ï¼Œæ­¤æ—¶è·¯ç”±åœ°å€ä¸ºpage1ã€‚
ä¸»åº”ç”¨ä¼šåŒ¹é…page1å¹¶æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œå­åº”ç”¨ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæµè§ˆå™¨åœ°å€ä¼šåŒæ—¶å½±å“åˆ°ä¸»åº”ç”¨å’Œå­åº”ç”¨ï¼Œå› ä¸ºæ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€å¥—è‡ªå·±çš„è·¯ç”±ç³»ç»Ÿï¼Œå®ƒä»¬æ˜¯å¯ä»¥å…±å­˜çš„ï¼Œä¸ä¼šå†²çªã€‚
æ­¤æ—¶æˆ‘ä»¬è¦æ¸²æŸ“å­åº”ç”¨http://www.xxx.com/çš„page1é¡µé¢ï¼Œé‚£ä¹ˆmicro-appçš„urlå±æ€§å¡«å†™çš„æ˜¯http://www.xxx.com/ï¼Œè€Œä¸æ˜¯http://www.xxx.com/page1/ã€‚
<micro-app url='http://www.xxx.com/'></micro-app>
å­åº”ç”¨åŠ è½½å®Œæˆåä¼šæ ¹æ®æµè§ˆå™¨çš„åœ°å€page1åŒ¹é…å¹¶æ¸²æŸ“å¯¹åº”çš„é¡µé¢ã€‚
åŒç†ï¼Œé¡µé¢å‚æ•°å’Œhashä¹Ÿæ˜¯ä»¥æµè§ˆå™¨ä¸ºå‡†ã€‚
æ —å­2 ğŸŒ° :
åœºæ™¯ï¼šå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œæˆ‘ä»¬è¦æ¸²æŸ“å­åº”ç”¨çš„page1é¡µé¢
æ­¤æ—¶åœ¨micro-appçš„urlå±æ€§ä¸Šè®¾ç½®hashå€¼æ˜¯æ— æ•ˆçš„ï¼Œ#/page1åº”è¯¥æ·»åŠ åˆ°æµè§ˆå™¨åœ°å€ä¸Šã€‚
<!-- âŒ è¿™é‡Œçš„#/page1æ˜¯æ— æ•ˆçš„ï¼Œåº”è¯¥æ·»åŠ åˆ°æµè§ˆå™¨åœ°å€ä¸Š -->
<micro-app url='http://www.xxx.com/#/page1'></micro-app> <!-- âœ”ï¸ è¿™ä¸ªurlæ‰æ˜¯æ­£ç¡®çš„ -->
<micro-app url='http://www.xxx.com/'></micro-app>
æ —å­3 ğŸŒ° :
åœºæ™¯ï¼šä¸»åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œæˆ‘ä»¬è¦è·³è½¬ä¸»åº”ç”¨çš„my-appé¡µé¢ï¼Œé¡µé¢ä¸­åµŒå…¥å­åº”ç”¨ï¼Œæˆ‘ä»¬è¦å±•ç°å­åº”ç”¨çš„page1é¡µé¢ã€‚
é‚£ä¹ˆæµè§ˆå™¨åœ°å€åº”è¯¥ä¸ºï¼šåŸŸå/my-page#/page1ï¼Œæˆ‘ä»¬åœ¨ä¸»åº”ç”¨ä¸­è·³è½¬my-appé¡µé¢çš„å‚æ•°ä¸ºï¼šrouter.push('/my-page#/page1')
æ­¤æ—¶æµç¨‹ä¸ºï¼šä¸»åº”ç”¨åŒ¹é…åˆ°/my-pageè·¯å¾„å¹¶æ¸²æŸ“my-appé¡µé¢ï¼Œå› ä¸ºmy-appé¡µé¢ä¸­åµŒå…¥äº†å­åº”ç”¨ï¼Œæ­¤æ—¶å­åº”ç”¨å¼€å§‹åŠ è½½å¹¶æ¸²æŸ“ï¼Œå­åº”ç”¨åœ¨æ¸²æŸ“æ—¶ä¼šåŒ¹é…åˆ°#/page1å¹¶æ¸²æŸ“page1é¡µé¢ã€‚
micro-appé…ç½®å¦‚ä¸‹ï¼š
<!-- æ­¤æ—¶ä¸éœ€è¦è®¾ç½®baseroute -->
<micro-app url='http://www.xxx.com/index.html'></micro-app>
æ —å­4 ğŸŒ° :
åœºæ™¯ï¼šä¸»åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨ä¹Ÿæ˜¯historyè·¯ç”±ï¼Œæˆ‘ä»¬è¦è·³è½¬ä¸»åº”ç”¨çš„my-appé¡µé¢ï¼Œmy-appé¡µé¢ä¸­åµŒå…¥å­åº”ç”¨ï¼Œæˆ‘ä»¬è¦å±•ç°å­åº”ç”¨çš„page1é¡µé¢ã€‚
é‚£ä¹ˆæµè§ˆå™¨åœ°å€åº”è¯¥ä¸ºï¼šåŸŸå/my-page/page1ï¼Œæˆ‘ä»¬åœ¨ä¸»åº”ç”¨ä¸­è·³è½¬çš„å‚æ•°ä¸ºï¼šrouter.push('/my-page/page1')
æ­¤æ—¶æµç¨‹ä¸ºï¼šä¸»åº”ç”¨åŒ¹é…åˆ°/my-pageè·¯å¾„å¹¶æ¸²æŸ“my-appé¡µé¢ï¼Œå› ä¸ºmy-appé¡µé¢ä¸­åµŒå…¥äº†å­åº”ç”¨ï¼Œæ­¤æ—¶å­åº”ç”¨å¼€å§‹åŠ è½½å¹¶æ¸²æŸ“ï¼Œå­åº”ç”¨åœ¨æ¸²æŸ“æ—¶ä¼šåŒ¹é…åˆ°/my-page/page1å¹¶æ¸²æŸ“page1é¡µé¢ã€‚
micro-appé…ç½®å¦‚ä¸‹ï¼š
<!-- å­åº”ç”¨é€šè¿‡baserouteè®¾ç½®åŸºç¡€è·¯ç”±/my-page -->
<micro-app url='http://www.xxx.com/index.html' baseroute='/my-page'></micro-app>
æç¤º
å¦‚æœä½ çœ‹åˆ°è¿™é‡Œè¿˜æ˜¯æ— æ³•æ­£ç¡®è®¾ç½®è·¯ç”±ï¼Œä¸å¦¨è¯•è¯•å…¶å®ƒè·¯ç”±æ¨¡å¼`}]},{path:"/zh/changelog.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:"micro-app éµå¾ª Semantic Versioning 2.0.0 è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒã€‚"},{header:"å‘å¸ƒå‘¨æœŸ",slug:"å‘å¸ƒå‘¨æœŸ",content:`ä¸»ç‰ˆæœ¬å·ï¼šå«æœ‰ç ´åæ€§æ›´æ–°å’Œæ–°ç‰¹æ€§ï¼Œä¸åœ¨å‘å¸ƒå‘¨æœŸå†…ã€‚
æ¬¡ç‰ˆæœ¬å·ï¼šæ¯æœˆå‘å¸ƒä¸€ä¸ªå¸¦æœ‰æ–°ç‰¹æ€§çš„å‘ä¸‹å…¼å®¹çš„ç‰ˆæœ¬ã€‚
ä¿®è®¢ç‰ˆæœ¬å·ï¼šæ¯å‘¨æœ«ä¼šè¿›è¡Œæ—¥å¸¸ bugfix æ›´æ–°ã€‚ï¼ˆå¦‚æœæœ‰ç´§æ€¥çš„ bugfixï¼Œåˆ™ä»»ä½•æ—¶å€™éƒ½å¯å‘å¸ƒï¼‰`},{header:"1.0.0-rc.4",slug:"_1-0-0-rc-4",content:`2024-1-31 New ğŸ†• æ–°å¢å…¨å±€é…ç½®iframeSrcï¼Œç”¨äºåŠ¨æ€è®¾ç½®iframeæ²™ç®±çš„srcåœ°å€ã€‚
ğŸ†• æ–°å¢micro-appå…ƒç´ å…¬æœ‰å˜é‡publicPathã€baseRouteï¼Œç”¨äºæ”¯æŒchromeæ’ä»¶ï¼ŒPR 1052 by raoenhuiã€‚
ğŸ†• æ–°å¢äº†åœ¨iframeæ²™ç®±ä¸‹å¯¹Document.prototype.createElementNSã€Document.prototype.createDocumentFragmentçš„æ‹¦æˆªå’Œå¤„ç†ã€‚
ğŸ†• æ–°å¢äº†removeDomScopeæ–¹æ³•çš„é…ç½®é¡¹forceï¼Œç”¨äºåœ¨ä¸€å®šæ—¶é—´å†…è§£é™¤å…ƒç´ ç»‘å®šï¼Œissue 995ã€‚
ğŸ†• æ–°å¢äº†withæ²™ç®±å¯¹äºDocument.prototype.createElementNSçš„ç›´æ¥å¤„ç†ï¼Œè§„é¿å¯èƒ½å­˜åœ¨çš„å…ƒç´ æ³„æ¼é£é™©ã€‚ Bug Fix ğŸ ä¿®å¤äº†çˆ¶åº”ç”¨éæ ¹ç›®å½•ä¸‹å¾®åº”ç”¨æ— æ³•æ­£å¸¸æ¸²æŸ“çš„é—®é¢˜ï¼ŒPR 1037 by xuhongboã€‚
ğŸ ä¿®å¤äº†iframeæ²™ç®±ä¸‹antd Dropdownã€Tooltipç­‰ç»„ä»¶æ¸²æŸ“å¼‚å¸¸çš„é—®é¢˜ï¼ŒPR 1015 by keubyã€‚
ğŸ ä¿®å¤äº†micro-app urlå±æ€§ä¸ºç›¸å¯¹åœ°å€æ—¶æ²¡æœ‰è‡ªåŠ¨è¡¥å…¨å¯¼è‡´å­åº”ç”¨æ¸²æŸ“å¤±è´¥çš„é—®é¢˜ï¼ŒPR 1056ã€‚
ğŸ ä¿®å¤äº†EventTargetåœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸­çš„å…¼å®¹æ€§é—®é¢˜ï¼Œissue 1064ï¼Œissue 1065ã€‚
ğŸ ä¿®å¤äº†withæ²™ç®±åœ¨éƒ¨åˆ†åœºæ™¯ä¸‹å¼ºéš”ç¦»å˜é‡scopePropertiesé€šè¿‡key in windowåˆ¤æ–­å¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†withæ²™ç®±åœ¨é»˜è®¤æ¨¡å¼ä¸‹ç”¨æˆ·è‡ªå®šä¹‰çš„å¼ºéš”ç¦»å˜é‡scopePropertiesåœ¨å¸è½½æ—¶æ— æ³•æ¸…ç©ºçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†withæ²™ç®±å­åº”ç”¨çš„window.onpopstateå…œåº•åˆ°ä¸»åº”ç”¨å¯¼è‡´å¤šæ¬¡æ‰§è¡Œçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†cracoå­åº”ç”¨styleå…ƒç´ æ’å…¥é¡ºåºé”™è¯¯å¯¼è‡´æ ·å¼ä¼˜å…ˆçº§æ··ä¹±çš„é—®é¢˜ï¼Œissue 1071ã€‚
ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†åœºæ™¯ä¸‹å­åº”ç”¨é‡å†™Array.prototype.includeså¯¼è‡´æ­»å¾ªç¯çš„é—®é¢˜ï¼ŒPR 1067 by tinyminsã€‚
ğŸ ä¿®å¤äº†åœ¨å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿæ—¶å­åº”ç”¨åŸŸåä¸æµè§ˆå™¨åŸŸåä¸ä¸€è‡´çš„é—®é¢˜ã€‚ Update ğŸš€ è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿå‡çº§ï¼Œæ–°å¢searchã€nativeã€native-scopeã€pureæ¨¡å¼ï¼Œç”¨äºé€‚é…æ›´å¤šä½¿ç”¨åœºæ™¯ã€‚
ğŸš€ ä¼˜åŒ–äº†å¯¹äºiframeæ²™ç®±Node.parentNodeçš„å¤„ç†æ–¹å¼ã€‚
ğŸš€ ä¼˜åŒ–äº†iframeæ²™ç®±å¯¹äºæ’ä»¶ç³»ç»ŸescapePropertiesçš„æ”¯æŒã€‚
ğŸš€ æ›´æ–°äº†æ¡ˆä¾‹ã€‚`},{header:"1.0.0-rc.3",slug:"_1-0-0-rc-3",content:`2023-12-18 New ğŸ†• æ–°å¢componentModeç»„ä»¶æ¨¡å¼ï¼Œmicro-appæ”¯æŒå•ç‹¬è¿è¡Œjsæ–‡ä»¶944ã€‚
ğŸ†• æ–°å¢æ–¹æ³•getAppStateï¼Œç”¨äºåœ¨åŸºåº§ä¸­è·å–å­åº”ç”¨çš„çŠ¶æ€ã€‚
ğŸ†• æ–°å¢è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿpush, replaceæ–¹æ³•å¯¹Promiseçš„æ”¯æŒã€‚
ğŸ†• æ–°å¢å¯¹äºCSSå¾ªç¯åµŒå¥—çš„æ”¯æŒ956ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨écustomè·¯ç”±æ¨¡å¼ä¸‹è®¾ç½®baserouteå¯¼è‡´å­åº”ç”¨æ¸²æŸ“å¤±è´¥çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†isObjectæ–¹æ³•ä¸­å‚æ•°ä¸ºnullå¯¼è‡´é”™è¯¯çš„é—®é¢˜998ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨onerroräº‹ä»¶æ— æ³•è§¦å‘çš„é—®é¢˜992ã€‚
ğŸ ä¿®å¤äº†iframeæ²™ç®±ä¸‹å­åº”ç”¨Node.ownerDocumentæŒ‡å‘é”™è¯¯çš„é—®é¢˜988ã€‚
ğŸ ä¿®å¤äº†withæ²™ç®±ä¸‹åˆ¤æ–­MicroDocumentå®ä¾‹æ—¶ç›®æ ‡ä¸ºnullå¯¼è‡´æŠ¥é”™çš„é—®é¢˜986ã€‚
ğŸ ä¿®å¤äº†iframeæ²™ç®±ä¸‹é€šè¿‡document.head.querySelector(...)æŸ¥è¯¢å…ƒç´ å¼‚å¸¸çš„é—®é¢˜984ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨htmlè‡ªå¸¦å…ƒç´ parentNodeæŒ‡å‘å¼‚å¸¸çš„é—®é¢˜ã€‚ Update ğŸš€ æ›´æ–°withæ²™ç®±è¿è¡Œé€»è¾‘ï¼Œå¼‚æ­¥æ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œç¡®ä¿ä¸åŒæ²™ç®±ä¹‹é—´é€»è¾‘ä¸€è‡´ã€‚
ğŸš€ ä¼˜åŒ–äº†utilsæ–¹æ³•ä¸­å…ƒç´ åˆ¤æ–­çš„æ–¹å¼998ã€‚
ğŸš€ æ›´æ–°äº†æ¡ˆä¾‹ã€‚`},{header:"1.0.0-rc.2",slug:"_1-0-0-rc-2",content:`2023-10-30 New ğŸ†• æ–°å¢äº†å­åº”ç”¨å…¨å±€å˜é‡__MICRO_APP_STATE__ï¼Œç”¨äºæ ‡è®°å½“å‰åº”ç”¨çš„çŠ¶æ€ã€‚
ğŸ†• æ–°å¢äº†å­åº”ç”¨documentå˜é‡__MICRO_APP_NAME__ï¼Œç”¨äºæ ‡è®°documentæ‰€å±åº”ç”¨ã€‚
ğŸ†• é‡å†™äº†åŸå‹æ–¹æ³•Node.prototype.parentNodeï¼Œç”¨äºå¤„ç†ç‰¹æ®Šå…ƒç´ parentNodeçš„æŒ‡å‘é—®é¢˜ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨iframeæ²™ç®±ä¸‹å¾ªç¯åµŒå¥—çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨iframeæ²™ç®±ä¸‹å¼€å¯inlineæ¨¡å¼å¯¼è‡´é€šè¿‡getElementsByTagNameè·å–scriptå…ƒç´ å¤±è´¥çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†å†…å­˜å ç”¨ï¼Œåœ¨iframeæ²™ç®±æ¨¡å¼ä¸‹é»˜è®¤å¼€å¯inlineæ¨¡å¼ã€‚
ğŸš€ æ›´æ–°äº†å®˜ç½‘æ–‡æ¡£ã€‚`},{header:"1.0.0-rc.1",slug:"_1-0-0-rc-1",content:`2023-10-16 New ğŸ†• æ–°å¢äº†Chromeæµè§ˆå™¨æ’ä»¶Micro-App-DevToolsï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ Update ğŸš€ å®Œå–„å•å…ƒæµ‹è¯•åŠŸèƒ½ã€‚
ğŸš€ æ›´æ–°äº†å®˜ç½‘æ–‡æ¡£ã€‚`},{header:"1.0.0-rc.0",slug:"_1-0-0-rc-0",content:`2023-09-22 New ğŸ†• æ–°å¢äº†å­åº”ç”¨å…¨å±€å˜é‡__MICRO_APP_SANDBOX_TYPE__ï¼Œç”¨äºæ ‡è®°å½“å‰åº”ç”¨çš„æ²™ç®±ç±»å‹ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨å…³é—­æ²™ç®±åå‘é€ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œå¤šæ¬¡æ‰§è¡ŒmicroApp.startæ–¹æ³•å¯¼è‡´çš„æ­»å¾ªç¯é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†afterhiddenè¿‡æ—©è§¦å‘å¯¼è‡´çš„containerä¸ºç©ºçš„é—®é¢˜ã€‚ Update ğŸš€ å®Œå–„å•å…ƒæµ‹è¯•åŠŸèƒ½ã€‚
ğŸš€ æ›´æ–°äº†å®˜ç½‘æ–‡æ¡£ã€‚
ğŸš€ å‘å¸ƒ1.0æ­£å¼ç‰ˆã€‚`},{header:"1.0.0-beta.7",slug:"_1-0-0-beta-7",content:`2023-09-20 New ğŸ†• æ–°å¢äº†å­åº”ç”¨å†…éƒ¨çŠ¶æ€before_mountï¼Œç”¨äºæ ‡è®°å­åº”ç”¨åœ¨èµ„æºåŠ è½½åå’Œæ‰§è¡Œjså‰çš„ä¸­é—´çŠ¶æ€ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨iframeæ²™ç®±æ¨¡å¼ä¸‹ï¼Œå­åº”ç”¨ä½¿ç”¨monaco-editoræ—¶ä»£ç è¾“å…¥æ¡†å…‰æ ‡å¤±æ•ˆçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨window.mountä¸ºPromiseæ—¶æŠ›å‡ºçš„é”™è¯¯æ— æ³•æ•è·çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨iframeæ²™ç®±æ¨¡å¼ä¸‹ï¼Œå­åº”ç”¨åŠ è½½å®Œæˆä¹‹å‰è¿›è¡Œå¯¼èˆªå¯¼è‡´æŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨withæ²™ç®±æ¨¡å¼ä¸‹ï¼Œå¼‚æ­¥åˆ›å»ºè·¯ç”±ç³»ç»Ÿå¯¼è‡´éƒ¨åˆ†åœºæ™¯ä¸‹locationæœªå®šä¹‰çš„é—®é¢˜ï¼Œissue #908ã€‚
ğŸ ä¿®å¤äº†åœ¨micro-appå­åº”ç”¨å¼€å§‹æ¸²æŸ“åˆ°æ¸²æŸ“å®Œæˆä¹‹å‰é€šè¿‡è·¯ç”±APIæ— æ³•æ§åˆ¶è·³è½¬çš„é—®é¢˜ã€‚ Update ğŸš€ å®Œå–„å•å…ƒæµ‹è¯•åŠŸèƒ½ã€‚
ğŸš€ æ›´æ–°äº†å®˜ç½‘æ–‡æ¡£ã€‚`},{header:"1.0.0-beta.6",slug:"_1-0-0-beta-6",content:`2023-09-14 New ğŸ†• æ–°å¢äº†è™šæ‹Ÿè·¯ç”±å¤šç§æ¨¡å¼åŠŸèƒ½ï¼Œæ–°å¢äº†ä¸‰ç§è·¯ç”±æ¨¡å¼ï¼šsearchã€historyã€customã€‚
ğŸ†• æ–°å¢äº†åœ¨é¢„æ¸²æŸ“æ—¶å¯ä»¥é€‰æ‹©ä¸åŒè·¯ç”±æ¨¡å¼è¿›è¡Œæ¸²æŸ“çš„åŠŸèƒ½ã€‚
ğŸ†• æ–°å¢äº†å…¨å±€å˜é‡document.microAppElementï¼Œç”¨äºè·å–å­åº”ç”¨æ‰€åœ¨çš„micro-appå…ƒç´ ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨withæ²™ç®±ä¸‹å­åº”ç”¨ä½¿ç”¨vuedraggableæŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨iframeæ²™ç®±ä¸‹å­åº”ç”¨å®šä¹‰onpopstateã€onhashchangeä¼šè¦†ç›–ä¸»åº”ç”¨æ–¹æ³•çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†window.addEventListenerç»‘å®šéwindowå¯¹è±¡æ—¶è¡¨ç°å¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†document.addEventListenerç»‘å®šédocumentå¯¹è±¡æ—¶è¡¨ç°å¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨å­åº”ç”¨åˆå§‹åŒ–åicon linkä¸¢å¤±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†é€šè¿‡rawDocumentã€rawWindowæ“ä½œå…ƒç´ æ—¶ï¼Œå…ƒç´ ä½œç”¨åŸŸç»‘å®šå¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†é€šè¿‡document.querySelector(":root")æ— æ³•è·å–æ ¹å…ƒç´ çš„é—®é¢˜ã€‚ Update ğŸš€ åˆ é™¤äº†é…ç½®é¡¹disable-memory-routerï¼Œè™šæ‹Ÿè·¯ç”±ä¸å†æ”¯æŒå…³é—­åŠŸèƒ½ã€‚
ğŸš€ ä¼˜åŒ–äº†withæ²™ç®±ä¸­ç‰¹æ®Šäº‹ä»¶çš„å¤„ç†æ–¹å¼ï¼Œonpopstateã€onhashchangeç­‰æ–¹æ³•ä¸å†ç»‘å®šåˆ°åŸç”Ÿwindowã€‚
ğŸš€ ä¼˜åŒ–äº†æ²™ç®±çš„æ¶æ„è®¾è®¡åŠä»£ç ã€‚
ğŸš€ å®Œæˆäº†éƒ¨åˆ†1.0ç‰ˆæœ¬å•å…ƒæµ‹è¯•çš„åŠŸèƒ½ã€‚
ğŸš€ æ›´æ–°äº†å®˜ç½‘æ–‡æ¡£ã€‚`},{header:"1.0.0-beta.5",slug:"_1-0-0-beta-5",content:`2023-05-23 Bug Fix ğŸ ä¿®å¤äº†ç¯å¢ƒå˜é‡__MICRO_APP_BASE_APPLICATION__ä¸ºundefinedçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†vite+reactå­åº”ç”¨æ¥å…¥å¤±è´¥çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†é€šè¿‡ä¿®æ”¹nameå’Œurlæ¸²æŸ“keep-aliveåº”ç”¨å¤±è´¥çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†éƒ¨åˆ†å¼€å‘æ¡ˆä¾‹ã€‚`},{header:"1.0.0-beta.4",slug:"_1-0-0-beta-4",content:`2023-04-27 New ğŸ†• æ–°å¢äº†åœ¨iframeæ²™ç®±ä¸‹æ”¯æŒå…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿçš„åŠŸèƒ½ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨å­åº”ç”¨è¿˜æœªæ¸²æŸ“æ—¶é€šè¿‡è™šæ‹Ÿè·¯ç”±æ§åˆ¶å­åº”ç”¨è·³è½¬å¯¼è‡´æµè§ˆå™¨URLåœ°å€ä¿®æ”¹çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨keep-aliveåº”ç”¨éšè—åé€šè¿‡è™šæ‹Ÿè·¯ç”±æ§åˆ¶å­åº”ç”¨è·³è½¬å¯¼è‡´æµè§ˆå™¨URLåœ°å€ä¿®æ”¹çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†éƒ¨åˆ†å¼€å‘æ¡ˆä¾‹ã€‚`},{header:"1.0.0-beta.3",slug:"_1-0-0-beta-3",content:`2023-04-13 Bug Fix ğŸ ä¿®å¤äº†åœ¨éå†…è”æ¨¡å¼ä¸‹é€šè¿‡insertAdjacentElementæ’å…¥scriptå¯¼è‡´æŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨å…³é—­æ²™ç®±æ—¶module scriptè¿œç¨‹èµ„æºè¢«é‡å¤åŠ è½½çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨åŠ è½½èµ„æºè¿‡ç¨‹ä¸­å¸è½½keep-aliveåº”ç”¨å¯¼è‡´åº”ç”¨äºŒæ¬¡æ¸²æŸ“å¤±è´¥çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨umdæ¨¡å¼ä¸‹å¸è½½preRender appã€hidden keep-alive appåº”ç”¨å¯¼è‡´äº‹ä»¶è¦†ç›–çš„é—®é¢˜ã€‚`},{header:"1.0.0-beta.2",slug:"_1-0-0-beta-2",content:`2023-04-06 New ğŸ†• æ–°å¢äº†å¯¹insertAdjacentElementå…ƒç´ æ–¹æ³•çš„å¤„ç†ã€‚
ğŸ†• æ–°å¢äº†åœ¨iframeæ²™ç®±ä¸‹å¯¹appendã€prependå…ƒç´ æ–¹æ³•çš„å¤„ç†ã€‚ Bug Fix ğŸ ä¿®å¤äº†å¼‚æ­¥å¸è½½å­åº”ç”¨æ—¶Element.prototype.setAttributeæ–¹æ³•å¯èƒ½è¢«é‡ç½®çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨å¤šå±‚åµŒå¥—æ—¶å¼‚æ­¥å¸è½½å­åº”ç”¨å¯¼è‡´åº”ç”¨ç»‘å®šä½œç”¨åŸŸå¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨iframeæ²™ç®±ä¸‹æ— æ³•è®¾ç½®document.titleçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨å¼€å‘ç¯å¢ƒä¸‹vite4æ ·å¼éš”ç¦»å¤±æ•ˆçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨withæ²™ç®±ä¸‹å¾ªç¯åµŒå¥—å­åº”ç”¨æ— æ³•è®¾ç½®document.onclickçš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†withæ²™ç®±Documentäº‹ä»¶ç³»ç»Ÿçš„æ¶æ„è®¾è®¡ï¼Œå¢åŠ å…¼å®¹æ€§ã€‚
ğŸš€ ä¼˜åŒ–äº†iframeæ²™ç®±Documentã€ElementåŸå‹æ–¹æ³•ã€‚
ğŸš€ ä¼˜åŒ–äº†iframeæ²™ç®±è·¯ç”±ç›¸å…³ä»£ç ã€‚
ğŸš€ æ›´æ–°äº†vite4çš„å¼€å‘æ¡ˆä¾‹ã€‚`},{header:"1.0.0-beta.1",slug:"_1-0-0-beta-1",content:`2023-03-23 Bug Fix ğŸ ä¿®å¤äº†ä¸»åº”ç”¨å’Œå­åº”ç”¨ä¿®æ”¹domainå¯¼è‡´çš„iframeè·¨åŸŸé—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å…³é—­æ²™ç®±å¯¼è‡´onmountæ–¹æ³•æŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†withæ²™ç®±ç¯å¢ƒä¸‹reactçš„æŠ½å±‰ç»„ä»¶æ— æ³•æ¸²æŸ“çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†withæ²™ç®±ç¯å¢ƒä¸‹é‡å†™ownerDocumentå¯¼è‡´çš„reactäº‹ä»¶é‡å¤è§¦å‘çš„é—®é¢˜ã€‚ Update ğŸš€ æ›´æ–°äº†å¼€å‘ç¯å¢ƒçš„æ¡ˆä¾‹ã€‚`},{header:"1.0.0-beta.0",slug:"_1-0-0-beta-0",content:`2023-03-17 New ğŸ†• æ–°å¢äº†iframeæ²™ç®±åŠŸèƒ½ï¼Œå…¼å®¹viteç­‰å¼€å‘ç¯å¢ƒã€‚
ğŸ†• æ–°å¢äº†è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿçš„iframeæ²™ç®±æ¨¡å¼ã€‚
ğŸ†• æ–°å¢äº†videoã€audioã€sourceã€embedç­‰èµ„æºæ ‡ç­¾çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚ Bug Fix ğŸ ä¿®å¤äº†é€šè¿‡unmountAppæ–¹æ³•å¸è½½é¢„æ¸²æŸ“åº”ç”¨æŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†ä¸»åŠ¨å¸è½½keep-aliveã€é¢„æ¸²æŸ“åº”ç”¨æ—¶å…¨å±€äº‹ä»¶ç¼“å­˜é”™è¯¯çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†htmlé™æ€å…ƒç´ æ— æ³•æ ‡è®°å’Œå¤„ç†çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†æ ¹å…ƒç´ ä¸‹parentNodeè¡¨ç°å¼‚å¸¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸æ”¯æŒString.prototype.replaceAllçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å¿½ç•¥çš„è„šæœ¬å†…è·å– currentScript å‡ºé”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†æ•°æ®é€šä¿¡åœ¨éƒ¨åˆ†åœºæ™¯ä¸‹å¿«ç…§å¤‡ä»½æ•°æ®ç›‘å¬å‡½æ•°æŠ¥é”™çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†èµ„æºç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§æ²™ç®±ä¹‹é—´åŠ¨æ€åˆ‡æ¢ï¼Œæå‡èµ„æºå¤ç”¨æ•ˆç‡ã€‚
ğŸš€ ç§»é™¤äº†esmoduleé…ç½®ï¼Œiframeæ²™ç®±ç¯å¢ƒä¸‹é»˜è®¤å¼€å¯ã€‚
ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½ã€é¢„æ¸²æŸ“ç›¸å…³åŠŸèƒ½ï¼Œå¢åŠ ç”¨æˆ·ä½“éªŒã€‚
ğŸš€ ä¼˜åŒ–äº†umdæ¨¡å¼ä¸‹å¯¹å­åº”ç”¨å®šæ—¶å™¨çš„å¤„ç†é€»è¾‘ã€‚`},{header:"1.0.0-alpha.10",slug:"_1-0-0-alpha-10",content:`2022-10-11 Bug Fix ğŸ ä¿®å¤äº†innerHTMLåˆ›å»ºçš„å…ƒç´ æ— æ³•è¢«æ‹¦æˆªçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å¾ªç¯åµŒå¥—ä¸‹ï¼Œæ ¹å…ƒç´ çš„parentNodeè¢«å¤šæ¬¡é‡å†™å¯¼è‡´parentNodeæŒ‡å‘é”™è¯¯çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†ç›¸å…³æ¡ˆä¾‹ã€‚`},{header:"1.0.0-alpha.9",slug:"_1-0-0-alpha-9",content:`2022-09-09 Bug Fix ğŸ ä¿®å¤äº†angularæ¡†æ¶ä¸‹ï¼Œmicro-appè®¾ç½®åŠ¨æ€urlå¯¼è‡´åº”ç”¨å¤šæ¬¡æ¸²æŸ“çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨titleã€metaå…ƒç´ ä¸¢å¤±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†éƒ¨åˆ†åœºæ™¯ä¸‹scopePropertieså¯ä»¥é€ƒé€¸çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿæ—¶keep-aliveåº”ç”¨ä¾ç„¶å¯ä»¥è§¦å‘è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿçš„é—®é¢˜ã€‚ Update ğŸš€ å¢åŠ å¯¹documentçš„ç¼“å­˜ï¼Œä¼˜åŒ–æ²™ç®±æ€§èƒ½ã€‚
ğŸš€ æ›´æ–°äº†titleå…ƒç´ çš„å¤„ç†é€»è¾‘ï¼Œå­åº”ç”¨çš„titleå…ƒç´ å…œåº•åˆ°ä¸»åº”ç”¨ï¼Œç¡®ä¿titleå…¨å±€å”¯ä¸€ã€‚`},{header:"1.0.0-alpha.8",slug:"_1-0-0-alpha-8",content:`2022-09-02 New ğŸ†• æ–°å¢äº†é¢„æ¸²æŸ“çš„åŠŸèƒ½ï¼Œæå‡é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦ã€‚
ğŸ†• æ–°å¢äº†rollupä¸­__DEV__é…ç½®ï¼Œä¼˜åŒ–å¼€å‘ä½“éªŒã€‚
ğŸ†• æ›´æ–°äº†getActiveAppsæ–¹æ³•ï¼Œå¢åŠ å‚æ•°excludePreRenderã€‚
ğŸ†• æ›´æ–°äº†attachAllToURLæ–¹æ³•ï¼Œå¢åŠ å‚æ•°includePreRenderã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œå­åº”ç”¨å¸è½½ååˆ é™¤å…ƒç´ å¯¼è‡´removeChildæ–¹æ³•è¢«å¾ªç¯è°ƒç”¨çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†UMDæ¨¡å¼ä¸‹ï¼ŒäºŒæ¬¡æ¸²æŸ“æ—¶documentå…¨å±€äº‹ä»¶æ— æ³•è‡ªåŠ¨å¸è½½çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†keep-aliveæ¨¡å¼ä¸‹ï¼Œå­åº”ç”¨éšè—åå…¨å±€äº‹ä»¶æ— æ³•è‡ªåŠ¨å¸è½½å¯¼è‡´å…ƒç´ ä½œç”¨åŸŸå¼‚å¸¸ç»‘å®šçš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†æ•°æ®é€šè®¯ç³»ç»Ÿï¼Œå¢åŠ å›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚
ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½é€»è¾‘ï¼Œå‡å°å¯¹ä¸»åº”ç”¨æ€§èƒ½çš„å½±å“ã€‚`},{header:"1.0.0-alpha.7",slug:"_1-0-0-alpha-7",content:`2022-08-26 New ğŸ†• æ–°å¢äº†reloadæ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨é‡æ–°åŠ è½½å­åº”ç”¨ã€‚
ğŸ†• æ–°å¢äº†renderAppæ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨æ¸²æŸ“å­åº”ç”¨ã€‚
ğŸ†• æ–°å¢äº†å­åº”ç”¨å…¨å±€äº‹ä»¶onmountã€onunmountï¼Œç”¨äºç›‘å¬å­åº”ç”¨çš„æ¸²æŸ“ä¸å¸è½½ã€‚
ğŸ†• æ–°å¢äº†clear-dataé…ç½®ï¼Œç”¨äºåœ¨å¸è½½æ—¶æ¸…ç©ºæ•°æ®é€šè®¯ä¸­çš„ç¼“å­˜æ•°æ®ã€‚ Bug Fix ğŸ ä¿®å¤äº†ElementUIä¸‹æ‹‰é€‰æ¡†åœ¨å±€éƒ¨åˆ·æ–°æ—¶é€‰æ‹©æ¡†æ— æ³•æ¶ˆå¤±çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†destroyçš„é€»è¾‘ï¼Œå¸è½½æ—¶ä¸»åŠ¨æ¸…ç©ºæ•°æ®é€šè®¯ä¸­çš„ç¼“å­˜æ•°æ®ã€‚
ğŸš€ ä¼˜åŒ–äº†æ•°æ®é€šä¿¡ç³»ç»Ÿï¼Œåˆå¹¶æ–°æ—§å€¼ï¼Œå¢åŠ å¼ºåˆ¶æ›´æ–°APIå’Œé˜²æŠ–å¤„ç†ã€‚`},{header:"1.0.0-alpha.6",slug:"_1-0-0-alpha-6",content:`2022-08-19 New ğŸ†• é‡æ„äº†èµ„æºç®¡ç†ç³»ç»Ÿï¼Œæå‡èµ„æºå¤ç”¨ç‡ã€‚
ğŸ†• æ–°å¢äº†excludeAssetFilteré…ç½®ï¼Œç”¨äºæŒ‡å®šéƒ¨åˆ†ç‰¹æ®Šçš„åŠ¨æ€åŠ è½½çš„å¾®åº”ç”¨èµ„æºï¼ˆcss/js) ä¸è¢« micro-app åŠ«æŒå¤„ç†ã€‚
ğŸ†• æ–°å¢äº†fiberé…ç½®ï¼Œæ”¯æŒå­åº”ç”¨ä»¥fiberæ¨¡å¼è¿è¡Œï¼Œå¢åŠ ä¸»åº”ç”¨çš„å“åº”é€Ÿåº¦ã€‚ Bug Fix ğŸ ä¿®å¤äº†sourceMapåœ°å€ä¸¢å¤±ï¼Œå¯¼è‡´è°ƒè¯•å›°éš¾çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†document.defaultViewå¯ä»¥è·å–çœŸå®windowçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†document.currentScriptä¸¢å¤±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åŠ¨æ€scriptæ ‡ç­¾äºŒæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œé¡ºåºé”™è¯¯çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†angular13ã€14åŠvue-cli5 buildååº”ç”¨æ²™ç®±å¤±æ•ˆçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å…¨å±€è·¯ç”±å®ˆå«å‚æ•°ä¸æ–‡æ¡£ä¸ä¸€è‡´çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†micro-appåœ¨vue keep-aliveç¯å¢ƒä¸‹é¢‘ç¹æ¸²æŸ“çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½é€»è¾‘ï¼Œæå‡é¢„åŠ è½½å­åº”ç”¨çš„æ¸²æŸ“é€Ÿåº¦ã€‚
ğŸš€ ä¼˜åŒ–äº†sandboxã€create_appç›¸å…³ä»£ç ã€‚`},{header:"1.0.0-alpha.5",slug:"_1-0-0-alpha-5",content:"2022-08-01 New ğŸ†• æ–°å¢å­åº”ç”¨å…¨å±€é’©å­å‡½æ•°mount, unmountï¼Œç®€åŒ–æ¥å…¥æ­¥éª¤ã€‚ Update ğŸš€ æ›´æ–°äº†1.0ç‰ˆæœ¬æ–‡æ¡£"},{header:"1.0.0-alpha.4",slug:"_1-0-0-alpha-4",content:`2022-07-28 New ğŸ†• æ–°å¢äº†é…ç½®disable-patch-requestï¼Œç”¨äºé˜»æ­¢MicroAppå¯¹å­åº”ç”¨fetchã€XMLHttpRequestç­‰è¯·æ±‚æ–¹æ³•çš„é‡å†™ã€‚ Bug Fix ğŸ ä¿®å¤äº†è®¾ç½®document.title, history.scrollRestorationæ—¶æŠ¥Illegal invocationé”™è¯¯çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨umdæ¨¡å¼éƒ¨åˆ†åœºæ™¯ä¸‹äºŒæ¬¡æ¸²æŸ“æ—¶å…¨å±€å˜é‡å’Œå…¨å±€äº‹ä»¶ä¸¢å¤±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†é«˜å¾·åœ°å›¾äºŒæ¬¡æ¸²æŸ“æ—¶åœ°å›¾æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†element-plusæŒ‰éœ€åŠ è½½æ—¶ï¼Œç‚¹å‡»ElSelectç»„ä»¶ç©ºç™½åŒºåŸŸæ— æ³•æ”¶èµ·çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹æ¯æ¬¡æ¸²æŸ“æ—¶fetchã€XMLHttpRequestç­‰APIè¢«é‡å†™çš„é—®é¢˜ã€‚ Update ğŸš€ æ›´æ–°äº†umdæ¨¡å¼ä¸‹å…¨å±€äº‹ä»¶å’Œå…¨å±€å˜é‡çš„å¤„ç†é€»è¾‘ï¼Œä¸å†ä¸»åŠ¨å¸è½½å…¨å±€äº‹ä»¶å’Œåˆ é™¤å…¨å±€å˜é‡ã€‚
ğŸš€ æ›´æ–°äº†1.0ç‰ˆæœ¬æ–‡æ¡£`},{header:"1.0.0-alpha.3",slug:"_1-0-0-alpha-3",content:`2022-07-21 New ğŸ†• é‡å†™äº†ä¸»åº”ç”¨çš„pushStateã€replaceStateæ–¹æ³•ï¼Œè‡ªåŠ¨å°†å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ã€‚
ğŸ†• é‡å†™äº†å­åº”ç”¨çš„Documentå¯¹è±¡ï¼Œæ¯ä¸ªå­åº”ç”¨æ‹¥æœ‰å•ç‹¬çš„Documentå®ä¾‹ã€‚ Bug Fix ğŸ ä¿®å¤äº†DocumentåŸå‹æ–¹æ³•ç»‘å®šåˆ°ProxyDocumentæ—¶æŠ¥é”™çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†è·¯ç”±ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚
ğŸš€ æ›´æ–°äº†æ¡ˆä¾‹ï¼Œå¢åŠ é€‚é…åœºæ™¯`},{header:"1.0.0-alpha.2",slug:"_1-0-0-alpha-2",content:`2022-07-15 New ğŸ†• æ–°å¢äº†attachToURLã€attachAllToURLæ–¹æ³•ï¼Œç”¨äºå°†å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ã€‚
ğŸ†• æ–°å¢äº†setBaseRouterã€getBaseRouteræ–¹æ³•ï¼Œç”¨äºæ³¨å†Œå’Œä½¿ç”¨ä¸»åº”ç”¨è·¯ç”±ã€‚
ğŸ†• æ–°å¢äº†ProxyDocumentï¼Œä¸ºå­åº”ç”¨åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„documentå¯¹è±¡ã€‚ Bug Fix ğŸ ä¿®å¤äº†ant-design-vueçš„å¼¹çª—ç±»ç»„ä»¶åŠå…¶å®ƒç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå­åº”ç”¨å…ƒç´ é€ƒé€¸åˆ°åŸç”Ÿbodyä¸Šçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨æœªè®¾ç½®public_pathæ—¶ï¼Œå­åº”ç”¨çš„èµ„æºåœ°å€è¡¥å…¨å¤±è´¥çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨åœ¨è°ƒç”¨fetchç­‰APIæ—¶ï¼Œå…ƒç´ ç»‘å®šæ²¡æœ‰è§£é™¤çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨@keyframesåç§°å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦æ—¶æ ·å¼éš”ç¦»å¤±è´¥çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†è·¯ç”±ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚
ğŸš€ æ›´æ–°äº†æ¡ˆä¾‹ã€‚`},{header:"1.0.0-alpha.1",slug:"_1-0-0-alpha-1",content:`2022-07-06 New ğŸ†• æ–°å¢äº†proxyRequestï¼Œç”¨äºæ‹¦æˆªfetchã€XMLHttpRequestã€EventSourceè¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ã€‚ Bug Fix ğŸ ä¿®å¤äº†é€šè¿‡create-react-appåˆ›å»ºçš„reactåº”ç”¨çƒ­æ›´æ–°æ—¶æŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨æ‰§è¡ŒpushState/replaceStateæ—¶popStateEventäº‹ä»¶å¼‚å¸¸è§¦å‘çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†èµ„æºåŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚`},{header:"1.0.0-alpha.0",slug:"_1-0-0-alpha-0",content:"2022-06-30 New ğŸ†• æ–°å¢äº†ç‹¬ç«‹çš„è·¯ç”±ç³»ç»Ÿ - MemoryRouterï¼Œå®Œå–„JSæ²™ç®±ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨å¾ªç¯åµŒå¥—æ—¶iconfont.jsåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æŠ¥é”™çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ï¼Œæé«˜å¹¶è¡Œæ¸²æŸ“èƒ½åŠ›ã€‚"},{header:"0.8.10",slug:"_0-8-10",content:"2022-08-19 New ğŸ†• æ–°å¢äº†excludeAssetFilteré…ç½®ï¼Œç”¨äºæŒ‡å®šéƒ¨åˆ†ç‰¹æ®Šçš„åŠ¨æ€åŠ è½½çš„å¾®åº”ç”¨èµ„æºï¼ˆcss/js) ä¸è¢« micro-app åŠ«æŒå¤„ç†ã€‚"},{header:"0.8.9",slug:"_0-8-9",content:"2022-08-15 Bug Fix ğŸ ä¿®å¤äº†åœ¨umdæ¨¡å¼ä¸‹å¼‚å¸¸æ¸…ç©ºå…¨å±€å˜é‡çš„é—®é¢˜ã€‚"},{header:"0.8.8",slug:"_0-8-8",content:"2022-07-15 Bug Fix ğŸ ä¿®å¤systemjsçš„scriptæ ‡ç­¾srcæ²¡æœ‰è‡ªåŠ¨è¡¥å…¨çš„é—®é¢˜"},{header:"0.8.6",slug:"_0-8-6",content:`2022-06-30 New ğŸ†• åœ¨ plugin ä¸­å¢åŠ  excludeChecker å’Œ ignoreChecker ç”¨äºä¸»åº”ç”¨ä¸»åŠ¨å¿½ç•¥å­åº”ç”¨éƒ¨åˆ† script å’Œ linkã€‚
ğŸ†• æ–°å¢äº†processHtmlï¼Œç”¨äºåœ¨æ’ä»¶ä¸­å¤„ç†htmlã€‚ Update ğŸš€ ä¼˜åŒ–äº†èµ„æºåŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚
ğŸš€ ä¼˜åŒ–äº†å•å…ƒæµ‹è¯•ç›¸å…³ä»£ç ã€‚`},{header:"0.8.5",slug:"_0-8-5",content:"2022-02-14 New ğŸ†• æ’ä»¶çš„loaderæ–¹æ³•ä¸­æ–°å¢åŒ…å«scriptä¿¡æ¯çš„infoå‚æ•°ã€‚"},{header:"0.8.4",slug:"_0-8-4",content:"2022-01-25 Bug Fix ğŸ ä¿®å¤äº†åœ¨ç«ç‹æµè§ˆå™¨80åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œæ ·å¼éš”ç¦»æ‰§è¡Œé€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚"},{header:"0.8.3",slug:"_0-8-3",content:"2022-01-20 Bug Fix ğŸ ä¿®å¤äº†åœ¨cssä¸­é€šè¿‡background-imageå¼•å…¥svgæ—¶ï¼Œæ ·å¼éš”ç¦»è§£æå¤±è´¥çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†æ ·å¼éš”ç¦»çš„é€»è¾‘ï¼Œæé«˜å…¼å®¹å’Œæ€§èƒ½ã€‚"},{header:"0.8.2",slug:"_0-8-2",content:`2022-01-14 New ğŸ†• æ–°å¢äº†å­åº”ç”¨pureCreateElementæ–¹æ³•ï¼Œç”¨äºåˆ›å»ºæ— ç»‘å®šçš„çº¯å‡€å…ƒç´ ã€‚
ğŸ†• æ–°å¢äº†å­åº”ç”¨removeDomScopeæ–¹æ³•ï¼Œç”¨äºè§£é™¤å…ƒç´ ç»‘å®šã€‚ Bug Fix ğŸ ä¿®å¤äº†ä¸»åº”ç”¨é€šè¿‡è¿œç¨‹è¿æ¥å¼•å…¥Vueï¼ŒåŠ è½½vueå­åº”ç”¨æŠ¥é”™çš„é—®é¢˜ï¼Œissue #234ã€‚ Update ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ï¼Œå‡å°å¯¹ä¸»åº”ç”¨é¡¹ç›®çš„å½±å“ã€‚`},{header:"0.8.1",slug:"_0-8-1",content:`2022-01-12 Bug Fix ğŸ ä¿®å¤äº†element-pluséƒ¨åˆ†ç»„ä»¶é€ƒç¦»å…ƒç´ éš”ç¦»çš„é—®é¢˜, issue #223ã€‚
ğŸ ä¿®å¤äº†åœ¨ä½¿ç”¨IE6ã€7 CSSHackæ—¶æ ·å¼è§£æå¤±è´¥çš„é—®é¢˜, issue #232ã€‚ Update ğŸš€ ä¼˜åŒ–äº†æ’ä»¶ç›¸å…³ä»£ç å’Œé€»è¾‘, PR #224 by LinFeng1997ã€‚
ğŸš€ ä¼˜åŒ–äº†æ²™ç®±ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚`},{header:"0.8.0",slug:"_0-8-0",content:`2022-01-07 New ğŸ†• æ–°å¢äº†åœ¨æ ·å¼éš”ç¦»ä¸‹çš„åŠ¨æ€å¿½ç•¥è§„åˆ™ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨ä½¿ç”¨csså˜é‡æ—¶å¯¼è‡´æ ·å¼ä¸¢å¤±çš„é—®é¢˜ï¼Œissue #157ã€#121ã€‚
ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†æµè§ˆå™¨(å¦‚ï¼šsafari)ä¸‹ï¼Œcssè¡¨ç°æœ‰å·®å¼‚çš„é—®é¢˜ã€‚ Update ğŸš€ æ ·å¼éš”ç¦»é‡æ„ï¼Œæå‡æ€§èƒ½å’Œå…¼å®¹æ€§ã€‚`},{header:"0.7.1",slug:"_0-7-1",content:`2021-12-31 Bug Fix ğŸ ä¿®å¤äº†linkæ ‡ç­¾åœ¨éheadæ—¶æ ·å¼ä¸¢å¤±çš„é—®é¢˜
ğŸ ä¿®å¤äº†é”™è¯¯è¡¥å…¨svgåœ°å€çš„é—®é¢˜ï¼ŒPR #207 by ickskyã€‚
ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†æµè§ˆå™¨ä¸‹æŠ¥WeakRef is not definedé”™è¯¯çš„é—®é¢˜ã€‚`},{header:"0.7.0",slug:"_0-7-0",content:`2021-12-29 New ğŸ†• æ–°å¢Apiï¼Œå¯¹å¤–export MicroAppç±»ã€‚ Update ğŸš€ æ²™ç®±é‡æ„ï¼Œæ€§èƒ½ä¼˜åŒ–ã€‚
ğŸš€ ä¼˜åŒ–äº†execScriptsæ–¹æ³•ï¼Œä¸å†ä½¿ç”¨Promise.allï¼Œé˜²æ­¢å•æ–‡ä»¶åŠ è½½é”™è¯¯å¯¼è‡´åç»­æ–‡ä»¶æ— æ³•æ‰§è¡Œçš„é—®é¢˜ã€‚
ğŸš€ ä¼˜åŒ–äº†getActiveAppsæ–¹æ³•ï¼Œå¢åŠ å¯¹è¿‡æ»¤keep-aliveåº”ç”¨çš„æ”¯æŒã€‚`},{header:"0.6.2",slug:"_0-6-2",content:"2021-12-19 Bug Fix ğŸ ä¿®å¤äº†åœ¨SSRç¯å¢ƒä¸‹ï¼ŒæŠ›å‡ºImage is not definedçš„æŠ¥é”™é—®é¢˜ã€‚"},{header:"0.6.1",slug:"_0-6-1",content:`2021-12-17 New ğŸ†• æ–°å¢äº†unmountApp, unmountAllAppsæ–¹æ³•ï¼Œç”¨äºä¸»åŠ¨å¸è½½åº”ç”¨ã€‚
ğŸ†• æ–°å¢äº†å¯¹disable-sandbox, disable-scopecssé…ç½®çš„æ”¯æŒã€‚ Bug Fix ğŸ ä¿®å¤äº†é€šè¿‡new Image()åˆ›å»ºçš„å…ƒç´ é€ƒç¦»æ²™ç®±çš„é—®é¢˜ï¼Œissue #186ï¼ŒPR #187 by asiainfoliweiã€‚
ğŸ ä¿®å¤äº†é€šè¿‡cloneNodeåˆ›å»ºçš„å…ƒç´ é€ƒç¦»æ²™ç®±çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†å…ƒç´ éš”ç¦»patchåŸå‹é“¾æ–¹æ³•ç›¸å…³ä»£ç ã€‚
ğŸš€ ä¼˜åŒ–äº†kee-aliveå’Œdestoryç›¸å…³çš„å¤„ç†é€»è¾‘ã€‚
ğŸš€ ä¼˜åŒ–äº†unmountç”Ÿå‘½å‘¨æœŸçš„è§¦å‘æ—¶æœºï¼Œç§»åŠ¨åˆ°åº”ç”¨å½»åº•å¸è½½åæ‰§è¡Œã€‚`},{header:"0.6.0",slug:"_0-6-0",content:"2021-12-10 New ğŸ†• æ–°å¢äº†å¯¹keep-aliveæ¨¡å¼çš„æ”¯æŒã€‚"},{header:"0.5.3",slug:"_0-5-3",content:`2021-12-02 New ğŸ†• æ–°å¢äº†å¯¹ssræ¨¡å¼çš„å…¨å±€é…ç½®çš„æ”¯æŒã€‚ Bug Fix ğŸ ä¿®å¤äº†æ²™ç®±ä¸­æ³¨å†Œçš„å…¨å±€å˜é‡çš„æ˜ å°„keyåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æ²¡æœ‰åŠæ—¶åˆ é™¤çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨ä¸æ”¯æŒESModuleçš„é¡¹ç›®ä¸­ï¼Œå¼•å…¥polyfill/jsx-custom-eventæŠ¥é”™çš„é—®é¢˜ã€‚`},{header:"0.5.2",slug:"_0-5-2",content:"2021-11-25 Bug Fix ğŸ ä¿®å¤äº†index.d.tsä¸­getActiveAppsã€getAllAppsç±»å‹å£°æ˜é”™è¯¯çš„é—®é¢˜ã€‚"},{header:"0.5.1",slug:"_0-5-1",content:`2021-11-25 New ğŸ†• æ–°å¢äº†getActiveAppsæ–¹æ³•ï¼Œç”¨äºè·å–æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨ã€‚
ğŸ†• æ–°å¢äº†getAllAppsæ–¹æ³•ï¼Œç”¨äºè·å–æ‰€æœ‰å·²ç»æ³¨å†Œçš„å­åº”ç”¨ã€‚ Bug Fix ğŸ ä¿®å¤äº†linkã€styleå…ƒç´ æ ¼å¼åŒ–åé¡ºåºä¸ä¸€è‡´å¯¼è‡´çš„æ ·å¼ä¸¢å¤±çš„é—®é¢˜ã€‚`},{header:"0.5.0",slug:"_0-5-0",content:`2021-11-19 Bug Fix ğŸ ä¿®å¤äº†nameå¸¦æœ‰ç‰¹æ®Šç¬¦å·æ—¶æ ·å¼å¤±æ•ˆçš„é—®é¢˜ï¼Œåˆ é™¤nameä¸­çš„ç‰¹æ®Šç¬¦å·ã€‚
ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹ï¼Œåº”ç”¨å¸è½½å¹¶é‡æ–°æ¸²æŸ“æ—¶urlå†²çªï¼Œæ—§åº”ç”¨æ²¡æœ‰å¸è½½å¹²å‡€çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨å…³é—­æ ·å¼éš”ç¦»æ—¶ï¼Œæ ·å¼å»¶è¿Ÿç”Ÿæ•ˆå¯¼è‡´é¡µé¢å¸ƒå±€é”™ä¹±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å¤šæ¬¡é‡å¤å‘headä¸­æ’å…¥åŒä¸€ä¸ªstyleå…ƒç´ ï¼Œå¯¼è‡´æ ·å¼å¤±æ•ˆçš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†åº”ç”¨äºŒæ¬¡æ¸²æŸ“æ—¶çš„æ€§èƒ½åŠå†…å­˜ã€‚
ğŸš€ ä¼˜åŒ–äº†æ ·å¼éš”ç¦»é€»è¾‘ï¼Œæ— è®ºæ˜¯å¦å…³é—­æ ·å¼éš”ç¦»ï¼Œå§‹ç»ˆå°†linkå…ƒç´ æå–è½¬æ¢ä¸ºstyleå…ƒç´ ã€‚`},{header:"0.4.3",slug:"_0-4-3",content:`2021-11-05 New ğŸ†• æ–°å¢äº†EventCenterForMicroAppæ–¹æ³•ï¼Œç”¨äºæ²™ç®±å…³é—­æ—¶å®ç°é€šä¿¡åŠŸèƒ½(å¦‚vite) Bug Fix ğŸ ä¿®å¤äº†åœ¨ä¸æ”¯æŒShadowRootçš„æµè§ˆå™¨ä¸­çš„æŠ¥é”™é—®é¢˜ï¼Œissue #134
ğŸ ä¿®å¤äº†å…ƒç´ æŸ¥è¯¢æ—¶å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æŠ¥é”™çš„é—®é¢˜ï¼Œissue #140`},{header:"0.4.2",slug:"_0-4-2",content:`2021-10-29 New ğŸ†• æ–°å¢äº†æ•°æ®é€šä¿¡ä¸­getGlobalDataæ–¹æ³•ï¼Œç”¨äºä¸»åŠ¨è·å–å…¨å±€æ•°æ®
ğŸ†• æ–°å¢äº†å¯¹mount, unmountæ–¹æ³•promiseç±»å‹çš„æ”¯æŒ
ğŸ†• æ–°å¢äº†destroyé…ç½®é¡¹ï¼Œç”¨äºæ›¿æ¢destoryï¼Œä½†ä¾ç„¶ä¿æŒå¯¹ä½ç‰ˆæœ¬çš„å…¼å®¹ï¼Œissue #132 Bug Fix ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹ï¼Œreact16åŠä»¥ä¸‹ç‰ˆæœ¬äºŒæ¬¡æ¸²æŸ“åè·¯ç”±è·³è½¬åˆ·æ–°é¡µé¢çš„é—®é¢˜
ğŸ ä¿®å¤äº†SSRå­åº”ç”¨äºŒæ¬¡æ¸²æŸ“æ—¶urlä¸åŒå¯¼è‡´æ¸²æŸ“å¤±è´¥çš„é—®é¢˜
ğŸ ä¿®å¤äº† react-inlinesvg æ— æ³•æ­£å¸¸æ¸²æŸ“çš„é—®é¢˜ï¼Œissue #56
ğŸ ä¿®å¤äº† safari æµè§ˆå™¨ä¸­ï¼Œåˆ›å»ºmoduleè„šæœ¬é”™è¯¯çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨é€šè¿‡definePropertyé‡å†™document.onclickæ—¶æŠ¥é”™çš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†MicroAppElementã€æ²™ç®±ç­‰ä»£ç 
ğŸš€ ä¼˜åŒ–äº†umdæ¨¡å¼ä¸‹ï¼Œå­åº”ç”¨åˆæ¬¡æ¸²æŸ“çš„é€Ÿåº¦
ğŸš€ ä¼˜åŒ–äº†åŠ¨æ€åˆ›å»ºçš„scriptå…ƒç´ srcæˆ–textContentä¸ºç©ºæ—¶çš„å¤„ç†é€»è¾‘
ğŸš€ ä¼˜åŒ–äº†mountedç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œæ—¶æœº`},{header:"0.4.1",slug:"_0-4-1",content:`2021-10-22 Bug Fix ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹ï¼Œåº”ç”¨äºŒæ¬¡æ¸²æŸ“æ—¶æ ·å¼ä¸¢å¤±çš„é—®é¢˜
ğŸ ä¿®å¤äº†èµ„æºåœ°å€ä¸ºç©ºæ—¶ï¼Œè¡¥å…¨é”™è¯¯çš„é—®é¢˜
ğŸ ä¿®å¤äº†å¯¹iframeå…ƒç´ srcå±æ€§çš„é”™è¯¯å¤„ç†
ğŸ ä¿®å¤äº†mountedç”Ÿå‘½å‘¨æœŸåœ¨å¼‚æ­¥è„šæœ¬ä¸­æ‰§è¡Œæ—¶æœºé”™è¯¯çš„é—®é¢˜
ğŸ ä¿®å¤äº†åœ¨éæ²™ç®±ç¯å¢ƒä¸‹ä½¿ç”¨umdæ¨¡å¼ï¼Œå¼€å¯destoryåï¼Œå¸è½½æ—¶æ³¨å†Œçš„å‡½æ•°æ²¡æœ‰å¸è½½çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨å¸¦æœ‰preloadæ—¶èµ„æºåŠ è½½ä¸¤æ¬¡çš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†åœ¨éinlineæ¨¡å¼ä¸‹ï¼Œmoduleç±»å‹scriptå…ƒç´ çš„æ‰§è¡Œæ–¹å¼
ğŸš€ ä¼˜åŒ–äº†æŠ¥é”™æ—¥å¿—ä¿¡æ¯ï¼Œå¢åŠ åº”ç”¨åç§°`},{header:"0.4.0",slug:"_0-4-0",content:`2021-10-15 New ğŸ†• æ–°å¢äº†ignoreå±æ€§ï¼Œç”¨äºå¿½ç•¥éƒ¨åˆ†éƒ¨åˆ†å…ƒç´ 
ğŸ†• æ–°å¢äº†å…¨å±€å˜é‡ __MICRO_APP_BASE_APPLICATION__ ç”¨äºæ ‡è®°å½“å‰åº”ç”¨ä¸ºä¸»åº”ç”¨ Bug Fix ğŸ ä¿®å¤äº†å¯¹webpack5 & jsonp çš„æ”¯æŒ
ğŸ ä¿®å¤äº†angularä¸‹åŠ¨æ€è®¾ç½®urlå±æ€§å¯¼è‡´åŠ è½½å¤±è´¥çš„é—®é¢˜
ğŸ ä¿®å¤äº†åœ¨viteç¯å¢ƒä¸‹ï¼Œå†…å­˜ä¼˜åŒ–çš„æ”¯æŒ
ğŸ ä¿®å¤äº†script type ä¸ºç‰¹æ®Šæƒ…å†µä¸‹çš„å…œåº•å¤„ç†ï¼Œå¦‚application/json
ğŸ ä¿®å¤äº†å¾ªç¯åµŒå¥—æ—¶æ²¡æœ‰å®Œå…¨å¸è½½åº”ç”¨çš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†å¯¹ssrçš„æ”¯æŒæ–¹å¼
ğŸš€ ä¼˜åŒ–äº†åŠ¨æ€moduleçš„åˆ›å»ºå’Œæ¸²æŸ“
ğŸš€ ä¼˜åŒ–äº†å¯¹dataã€blobç±»å‹æ•°æ®çš„å¤„ç†`},{header:"0.3.3",slug:"_0-3-3",content:`2021-09-13 Bug Fix ğŸ ä¿®å¤äº†dataå±æ€§èµ‹å€¼åæ’å…¥æ–‡æ¡£æ—¶ï¼Œåˆå§‹åŒ–dataå€¼æ— æ³•é€šè¿‡setAttributeæ‹¦æˆªçš„é—®é¢˜
ğŸ ä¿®å¤äº†æ¸²æŸ“ç¼“å­˜micro-appå…ƒç´ æ—¶å¯¼è‡´çš„micro-app-head, micro-app-bodyé‡å¤çš„é—®é¢˜`},{header:"0.3.2",slug:"_0-3-2",content:`2021-09-10 New ğŸ†• æ–°å¢äº†baserouteé…ç½®é¡¹ï¼Œç”¨äºæ›¿æ¢baseurl
ğŸ†• æ–°å¢äº†__MICRO_APP_BASE_ROUTE__å…¨å±€å˜é‡ï¼Œç”¨äºæ›¿æ¢__MICRO_APP_BASE_URL__ Update ğŸš€ åºŸå¼ƒäº†baseurlå’Œ__MICRO_APP_BASE_URL__ï¼Œä½†ä¾ç„¶å…¼å®¹æ—§ç‰ˆ`},{header:"0.3.1",slug:"_0-3-1",content:"2021-09-08 Bug Fix ğŸ ä¿®å¤äº†micro-appå…ƒç´ å…ˆä½¿ç”¨åå®šä¹‰å¯¼è‡´startæ–¹æ³•é…ç½®å¤±æ•ˆçš„é—®é¢˜"},{header:"0.3.0",slug:"_0-3-0",content:`2021-09-07 New ğŸ†• æ–°å¢äº†å¯¹umdæ ¼å¼çš„æ”¯æŒ
ğŸ†• åºŸå¼ƒevalæ–¹æ³•ï¼Œä½¿ç”¨Functionè¿›è¡Œæ›¿æ¢ Bug Fix ğŸ ä¿®å¤äº†å­åº”ç”¨å¸è½½éƒ¨åˆ†å†…å­˜æ— æ³•é‡Šæ”¾çš„é—®é¢˜
ğŸ ä¿®å¤äº†widnow\\document\\timeräº‹ä»¶åœ¨umdæ¨¡å¼ä¸‹å¤šæ¬¡æ¸²æŸ“çš„é—®é¢˜
ğŸ ä¿®å¤äº†asyncå’Œdefer jsæ–‡ä»¶æ²¡æœ‰ç¼“å­˜çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨åŒæ—¶å­˜åœ¨å¤šä¸ªheadã€bodyå…ƒç´ æ—¶ï¼Œå…ƒç´ æ“ä½œå¼‚å¸¸çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†ä¿®æ”¹name&urlå±æ€§åˆ‡æ¢åº”ç”¨çš„æ“ä½œï¼Œéƒ¨åˆ†åœºæ™¯ä¸‹è¢«æ›¿æ¢çš„åº”ç”¨å¯ä»¥è®¡å…¥ç¼“å­˜
ğŸš€ æ›´æ–°äº†å…¨å±€æ•°æ®é€šä¿¡å¸è½½æœºåˆ¶ï¼Œä¸»åº”ç”¨å’Œå­åº”ç”¨åªèƒ½å¸è½½è‡ªèº«çš„å…¨å±€ç›‘å¬å‡½æ•°`},{header:"0.2.5",slug:"_0-2-5",content:`2021-08-23 New ğŸ†• æ–°å¢äº†main-vue3-viteä¸»åº”ç”¨æ¡ˆä¾‹ Bug Fix ğŸ ä¿®å¤äº†åœ¨vue3ä¸­nameè¢«åˆ é™¤å¯¼è‡´çš„æ ·å¼ä¸¢å¤±çš„é—®é¢˜
ğŸ ä¿®å¤äº†æ— æ³•é€‚é….nodeã€.phpã€.netåç¼€æ–‡ä»¶çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨å¸è½½åä¾ç„¶å¯ä»¥é€šè¿‡å‰¯ä½œç”¨å‡½æ•°ç»‘å®šnameä½œç”¨åŸŸçš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†cosoleæ—¥å¿—æ–¹æ³•å’Œä½¿ç”¨æ–¹å¼
ğŸš€ ä¼˜åŒ–äº†viteé€‚é…æ–¹å¼`},{header:"0.2.4",slug:"_0-2-4",content:`2021-08-13 New ğŸ†• æ–°å¢äº†starté…ç½®é¡¹globalAssetsï¼Œç”¨äºè®¾ç½®å…¨å±€å…±äº«èµ„æº Bug Fix ğŸ ä¿®å¤äº†åœ¨å­åº”ç”¨ä¸­è¯·æ±‚htmlå…ƒç´ è¢«æ‹¦æˆªçš„é—®é¢˜
ğŸ ä¿®å¤ä½ç‰ˆæœ¬nodejså¯¹äºrollup.config.jsæ‰§è¡Œé”™è¯¯çš„é—®é¢˜ Update ğŸš€ ä»£ç ä¼˜åŒ–`},{header:"0.2.3",slug:"_0-2-3",content:`2021-08-10 Bug Fix ğŸ ä¿®å¤äº†åˆ‡æ¢è‡³é¢„åŠ è½½appæ—¶æŠ¥app already existsé”™è¯¯
ğŸ ä¿®å¤äº†åœ°å€è¡¥å…¨å¯¹äºaå…ƒç´ çš„é”™è¯¯å¤„ç† Update ğŸš€ æ–‡æ¡£æ›´æ–°
ğŸš€ ä»£ç ä¼˜åŒ–
ğŸš€ æ›´æ–°å•å…ƒæµ‹è¯•`},{header:"0.2.2",slug:"_0-2-2",content:"2021-07-27 Bug Fix ğŸ ä¿®å¤äº†JSX.IntrinsicElementså±æ€§ç”Ÿå‘½ä¸¢å¤±çš„é—®é¢˜ Update ğŸš€ ä»£ç ä¼˜åŒ–"},{header:"0.2.0",slug:"_0-2-0",content:`2021-07-16 Bug Fix ğŸ ä¿®å¤äº†styled-componetsä¸‹æ ·å¼å¤±æ•ˆçš„é—®é¢˜
ğŸ ä¿®å¤äº†æ²™ç®±å…³é—­æ—¶ï¼Œæ’ä»¶ç³»ç»Ÿå¤±æ•ˆçš„é—®é¢˜
ğŸ ä¿®å¤äº†linkåœ°å€æ²¡æœ‰åè®®å‰ç¼€æ—¶è¡¥å…¨ç›¸å¯¹åœ°å€å¤±è´¥çš„é—®é¢˜ Update ğŸš€ æ¡ˆä¾‹åŠæ–‡æ¡£æ›´æ–°`},{header:"0.1.0",slug:"_0-1-0",content:"2021-07-09 ğŸ‰ v0.1.0æ­£å¼ç‰ˆå‘å¸ƒã€‚"}]},{path:"/zh/chat.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:`Gitterç¾¤èŠ
GitHubè®¨è®ºç»„
BUGåé¦ˆ`}]},{path:"/zh/configure.html",title:"é…ç½®é¡¹",pathLocale:"/",contents:[{header:"é…ç½®é¡¹",slug:"é…ç½®é¡¹",content:"é€šè¿‡é…ç½®é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šå¼€å¯æˆ–å…³é—­æŸäº›åŠŸèƒ½ã€‚"},{header:"name",slug:"name",content:`Desc: åº”ç”¨åç§°
Type: string
Default: å¿…ä¼ å‚æ•°
ä½¿ç”¨æ–¹å¼: <micro-app name='xx'></micro-app>
æ³¨æ„äº‹é¡¹: å¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦ç‰¹æ®Šç¬¦å·(ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿é™¤å¤–) æ¯ä¸ªnameéƒ½å¯¹åº”ä¸€ä¸ªåº”ç”¨ï¼Œå½“å¤šä¸ªåº”ç”¨åŒæ—¶æ¸²æŸ“æ—¶ï¼Œnameä¸å¯ä»¥é‡å¤ã€‚
å½“nameçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¸è½½å½“å‰åº”ç”¨å¹¶é‡æ–°æ¸²æŸ“ã€‚`},{header:"url",slug:"url",content:`Desc: åº”ç”¨åœ°å€
Type: string
Default: å¿…ä¼ å‚æ•°
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx'></micro-app> urlå¿…é¡»æŒ‡å‘å­åº”ç”¨çš„index.htmlï¼Œå¦‚ï¼šhttp://localhost:3000/ æˆ– http://localhost:3000/index.html
MicroAppä¼šæ ¹æ®urlåœ°å€è‡ªåŠ¨è¡¥å…¨å­åº”ç”¨çš„é™æ€èµ„æºï¼Œå¦‚jsã€cssã€å›¾ç‰‡ç­‰
å½“urlçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¸è½½å½“å‰åº”ç”¨å¹¶æ ¹æ®æ–°çš„urlå€¼é‡æ–°æ¸²æŸ“ã€‚`},{header:"iframe",slug:"iframe",content:`Desc: å¼€å¯iframeæ²™ç®±
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app iframe></micro-app> MicroAppæœ‰ä¸¤ç§æ²™ç®±æ–¹æ¡ˆï¼šwithæ²™ç®±å’Œiframeæ²™ç®±ã€‚
é»˜è®¤å¼€å¯withæ²™ç®±ï¼Œå¦‚æœwithæ²™ç®±æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å°è¯•åˆ‡æ¢åˆ°iframeæ²™ç®±ï¼Œæ¯”å¦‚viteã€‚`},{header:"inline",slug:"inline",content:`Desc: ä½¿ç”¨å†…è”script
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' inline></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨çš„jsä¼šè¢«æå–å¹¶åœ¨åå°è¿è¡Œï¼Œè¿™ä¼šå¯¼è‡´è°ƒè¯•å›°éš¾ã€‚
å¼€å¯inlineåï¼Œè¢«æå–çš„jsä¼šä½œä¸ºscriptæ ‡ç­¾æ’å…¥åº”ç”¨ä¸­è¿è¡Œï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­æ›´æ–¹ä¾¿è°ƒè¯•ã€‚
Note
å¼€å¯inlineåä¼šç¨å¾®æŸè€—æ€§èƒ½ï¼Œå»ºè®®åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ã€‚`},{header:"destroy",slug:"destroy",content:`Desc: å¸è½½æ—¶å¼ºåˆ¶åˆ é™¤ç¼“å­˜èµ„æº
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' destroy></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨è¢«å¸è½½åä¸ä¼šåˆ é™¤ç¼“å­˜çš„é™æ€èµ„æºå’Œæ•°æ®ï¼Œä»¥ä¾¿åœ¨é‡æ–°æ¸²æŸ“æ—¶è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚
å¼€å¯destroyï¼Œå­åº”ç”¨åœ¨å¸è½½åä¼šæ¸…ç©ºç¼“å­˜èµ„æºå’Œæ•°æ®ï¼Œå½“é‡æ–°æ¸²æŸ“æ—¶å°†å’Œåˆæ¬¡æ¸²æŸ“çš„è¡Œä¸ºä¿æŒä¸€è‡´ã€‚`},{header:"clear-data",slug:"clear-data",content:`Desc: å¸è½½æ—¶æ¸…ç©ºæ•°æ®é€šè®¯ä¸­çš„ç¼“å­˜æ•°æ®
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' clear-data></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨è¢«å¸è½½åæ•°æ®é€šè®¯ä¸­çš„ç¼“å­˜æ•°æ®ä¼šè¢«ä¿ç•™ï¼Œå¦‚æœä½ å¸Œæœ›æ¸…ç©ºè¿™äº›æ•°æ®ï¼Œè®¾ç½®clear-dataå³å¯ã€‚
å­åº”ç”¨å¸è½½æ—¶ä¼šåŒæ—¶æ¸…ç©ºä¸»åº”ç”¨å‘é€ç»™å½“å‰å­åº”ç”¨ï¼Œå’Œå½“å‰å­åº”ç”¨å‘é€ç»™ä¸»åº”ç”¨çš„æ•°æ®ã€‚
destroyä¹Ÿæœ‰åŒæ ·çš„æ•ˆæœã€‚`},{header:"disable-scopecss",slug:"disable-scopecss",content:`Desc: å…³é—­æ ·å¼éš”ç¦»
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' disable-scopecss></micro-app> å…³é—­æ ·å¼éš”ç¦»å¯ä»¥æå‡é¡µé¢æ¸²æŸ“é€Ÿåº¦ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿å„åº”ç”¨ä¹‹é—´æ ·å¼ä¸ä¼šç›¸äº’æ±¡æŸ“ã€‚`},{header:"disable-sandbox",slug:"disable-sandbox",content:`Desc: å…³é—­jsæ²™ç®±
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' disable-sandbox></micro-app> å…³é—­æ²™ç®±å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›ä¸å¯é¢„æ–™çš„é—®é¢˜ï¼Œé€šå¸¸æƒ…å†µä¸å»ºè®®è¿™æ ·åšã€‚
Note
å…³é—­æ²™ç®±åä»¥ä¸‹åŠŸèƒ½å°†å¤±æ•ˆ: æ ·å¼éš”ç¦»
å…ƒç´ éš”ç¦»
è·¯ç”±éš”ç¦»
__MICRO_APP_ENVIRONMENT__ã€__MICRO_APP_PUBLIC_PATH__ç­‰å…¨å±€å˜é‡
baseroute`},{header:"ssr",slug:"ssr",content:`Desc: å¼€å¯ssræ¨¡å¼
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' ssr></micro-app>
ç‰ˆæœ¬è¦æ±‚: 0.5.3åŠä»¥ä¸Šç‰ˆæœ¬ å½“å­åº”ç”¨æ˜¯ssråº”ç”¨æ—¶ï¼Œéœ€è¦è®¾ç½®ssrå±æ€§ï¼Œæ­¤æ—¶micro-appä¼šæ ¹æ®ssræ¨¡å¼åŠ è½½å­åº”ç”¨ã€‚`},{header:"keep-alive",slug:"keep-alive",content:`Desc: å¼€å¯keep-aliveæ¨¡å¼
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' keep-alive></micro-app>
ç‰ˆæœ¬è¦æ±‚: 0.6.0åŠä»¥ä¸Šç‰ˆæœ¬ å¼€å¯keep-aliveåï¼Œåº”ç”¨å¸è½½æ—¶ä¼šè¿›å…¥ç¼“å­˜ï¼Œè€Œä¸æ˜¯é”€æ¯å®ƒä»¬ï¼Œä»¥ä¾¿ä¿ç•™åº”ç”¨çš„çŠ¶æ€å’Œæå‡é‡å¤æ¸²æŸ“çš„æ€§èƒ½ã€‚
keep-aliveçš„ä¼˜å…ˆçº§å°äºdestroyï¼Œå½“ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œkeep-aliveå°†å¤±æ•ˆã€‚`},{header:"default-page",slug:"default-page",content:`Desc: æŒ‡å®šé»˜è®¤æ¸²æŸ“çš„é¡µé¢
Type: string
Default: ''
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' default-page='é¡µé¢åœ°å€'></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨æ¸²æŸ“åä¼šå±•ç¤ºé¦–é¡µï¼Œè®¾ç½®default-pageå¯ä»¥æŒ‡å®šå­åº”ç”¨æ¸²æŸ“çš„é¡µé¢ã€‚`},{header:"router-mode",slug:"router-mode",content:`Desc: è·¯ç”±æ¨¡å¼
Type: string
Default: search
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' router-mode='search/native/native-scope/pure'></micro-app> è·¯ç”±åˆ†ä¸ºå››ç§æ¨¡å¼ï¼šsearchã€nativeã€native-scopeã€pureï¼Œæ¯ç§æ¨¡å¼å¯¹åº”ä¸åŒçš„åŠŸèƒ½ï¼Œä»¥æ»¡è¶³å°½å¯èƒ½å¤šçš„é¡¹ç›®éœ€æ±‚ï¼Œè¯¦æƒ…å‚è€ƒè™šæ‹Ÿè·¯ç”±ç³»ç»Ÿã€‚`},{header:"baseroute",slug:"baseroute",content:`Desc: è®¾ç½®å­åº”ç”¨çš„åŸºç¡€è·¯ç”±
Type: string
Default: ''
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' baseroute='/my-page/'></micro-app> åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œå­åº”ç”¨å¯ä»¥ä»window.__MICRO_APP_BASE_ROUTE__ä¸Šè·å–baserouteçš„å€¼ï¼Œç”¨äºè®¾ç½®åŸºç¡€è·¯ç”±ã€‚
åªæœ‰è·¯ç”±æ¨¡å¼æ˜¯nativeæˆ–native-scopeæˆ‘ä»¬æ‰éœ€è¦è®¾ç½®baserouteï¼Œè¯¦æƒ…å‚è€ƒè™šæ‹Ÿè·¯ç”±ç³»ç»Ÿã€‚`},{header:"keep-router-state",slug:"keep-router-state",content:`Desc: ä¿ç•™è·¯ç”±çŠ¶æ€
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' keep-router-state></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨å¸è½½åé‡æ–°æ¸²æŸ“ï¼Œå°†å’Œé¦–æ¬¡åŠ è½½ä¸€æ ·æ¸²æŸ“å­åº”ç”¨çš„é¡µé¢ã€‚
è®¾ç½®keep-router-stateå¯ä»¥ä¿ç•™å­åº”ç”¨è·¯ç”±çŠ¶æ€ï¼Œåœ¨å¸è½½åé‡æ–°æ¸²æŸ“æ—¶å°†æ¢å¤å¸è½½å‰çš„é¡µé¢ï¼ˆé¡µé¢ä¸­çš„çŠ¶æ€ä¸ä¿ç•™ï¼‰ã€‚
æ³¨æ„ï¼š å¦‚æœå…³é—­äº†è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œkeep-router-stateä¹Ÿå°†å¤±æ•ˆã€‚
å½“è®¾ç½®äº†default-pageæ—¶keep-router-stateå°†å¤±æ•ˆï¼Œå› ä¸ºå®ƒçš„ä¼˜å…ˆçº§å°äºdefault-page`},{header:"disable-memory-router",slug:"disable-memory-router",content:`Desc: å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' disable-memory-router></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨å°†è¿è¡Œåœ¨è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿä¸­ï¼Œå’Œä¸»åº”ç”¨çš„è·¯ç”±ç³»ç»Ÿè¿›è¡Œéš”ç¦»ï¼Œé¿å…ç›¸äº’å½±å“ã€‚
å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯ä¼šä½œä¸ºqueryå‚æ•°åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Šï¼Œå¦‚ä¸‹ï¼š è®¾ç½®disable-memory-routeråï¼Œå­åº”ç”¨å°†åŸºäºæµè§ˆå™¨çš„è·¯ç”±ç³»ç»Ÿè¿›è¡Œæ¸²æŸ“ï¼Œæ‹¥æœ‰æ›´åŠ ç®€æ´ä¼˜é›…çš„çš„æµè§ˆå™¨åœ°å€ï¼Œè¯¦æƒ…å‚è€ƒè™šæ‹Ÿè·¯ç”±ç³»ç»Ÿã€‚`},{header:"disable-patch-request",slug:"disable-patch-request",content:`Desc: å…³é—­å­åº”ç”¨è¯·æ±‚çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' disable-patch-request></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼ŒMicroAppå¯¹å­åº”ç”¨çš„fetchã€XMLHttpRequestã€EventSourceè¿›è¡Œé‡å†™ï¼Œå½“è¯·æ±‚ç›¸å¯¹åœ°å€æ—¶ä¼šä½¿ç”¨å­åº”ç”¨åŸŸåè‡ªåŠ¨è¡¥å…¨
å¦‚ï¼šfetch('/api/data') è¡¥å…¨ä¸º fetch(å­åº”ç”¨åŸŸå + '/api/data')
å¦‚æœä¸éœ€è¦è¿™æ ·çš„è¡¥å…¨ï¼Œå¯ä»¥é…ç½®disable-patch-requestè¿›è¡Œå…³é—­ï¼Œæ­¤æ—¶ç›¸å¯¹åœ°å€ä¼šå…œåº•åˆ°ä¸»åº”ç”¨åŸŸåã€‚
å¦‚ï¼šfetch('/api/data') å…œåº•ä¸º fetch(ä¸»åº”ç”¨åŸŸå + '/api/data')`},{header:"fiber",slug:"fiber",content:`Desc: å¼€å¯fiberæ¨¡å¼
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' fiber></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨jsæ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œè¿™ä¼šé˜»å¡ä¸»åº”ç”¨çš„æ¸²æŸ“çº¿ç¨‹ï¼Œå½“å¼€å¯fiberåï¼Œmicro-appä¼šé™ä½å­åº”ç”¨çš„ä¼˜å…ˆçº§ï¼Œé€šè¿‡å¼‚æ­¥æ‰§è¡Œå­åº”ç”¨çš„jsæ–‡ä»¶ï¼Œä»¥å‡å°å¯¹ä¸»åº”ç”¨çš„å½±å“ï¼Œå¿«é€Ÿå“åº”ç”¨æˆ·æ“ä½œã€‚
Note
å¼€å¯fiberåä¼šé™ä½å­åº”ç”¨çš„æ¸²æŸ“é€Ÿåº¦ã€‚`},{header:"å…¨å±€é…ç½®",slug:"å…¨å±€é…ç½®",content:`å…¨å±€é…ç½®ä¼šå½±å“æ¯ä¸€ä¸ªå­åº”ç”¨ï¼Œè¯·å°å¿ƒä½¿ç”¨ï¼
ä½¿ç”¨æ–¹å¼
import microApp from '@micro-zoe/micro-app' microApp.start({ iframe: true, // å…¨å±€å¼€å¯iframeæ²™ç®±ï¼Œé»˜è®¤ä¸ºfalse inline: true, // å…¨å±€å¼€å¯å†…è”scriptæ¨¡å¼è¿è¡Œjsï¼Œé»˜è®¤ä¸ºfalse destroy: true, // å…¨å±€å¼€å¯destroyæ¨¡å¼ï¼Œå¸è½½æ—¶å¼ºåˆ¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œé»˜è®¤ä¸ºfalse ssr: true, // å…¨å±€å¼€å¯ssræ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalse 'disable-scopecss': true, // å…¨å±€ç¦ç”¨æ ·å¼éš”ç¦»ï¼Œé»˜è®¤ä¸ºfalse 'disable-sandbox': true, // å…¨å±€ç¦ç”¨æ²™ç®±ï¼Œé»˜è®¤ä¸ºfalse 'keep-alive': true, // å…¨å±€å¼€å¯ä¿æ´»æ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalse 'disable-memory-router': true, // å…¨å±€å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œé»˜è®¤å€¼false 'keep-router-state': true, // å­åº”ç”¨åœ¨å¸è½½æ—¶ä¿ç•™è·¯ç”±çŠ¶æ€ï¼Œé»˜è®¤å€¼false 'disable-patch-request': true, // å…³é—­å­åº”ç”¨è¯·æ±‚çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œé»˜è®¤å€¼false iframeSrc: location.origin, // è®¾ç½®iframeæ²™ç®±ä¸­iframeçš„srcåœ°å€ï¼Œé»˜è®¤ä¸ºå­åº”ç”¨æ‰€åœ¨é¡µé¢åœ°å€
})
å¦‚æœå¸Œæœ›åœ¨æŸä¸ªåº”ç”¨ä¸­ä¸ä½¿ç”¨å…¨å±€é…ç½®ï¼Œå¯ä»¥å•ç‹¬é…ç½®å…³é—­ï¼š
<micro-app name='xx' url='xx' iframe='false' inline='false' destroy='false' ssr='false' disable-scopecss='false' disable-sandbox='false' keep-alive='false' disable-memory-router='false' keep-router-state='false' disable-patch-request='false'
></micro-app>`},{header:"å…¶å®ƒé…ç½®",slug:"å…¶å®ƒé…ç½®",content:""},{header:"global",slug:"global",content:`å½“å¤šä¸ªå­åº”ç”¨ä½¿ç”¨ç›¸åŒçš„jsæˆ–cssèµ„æºï¼Œåœ¨linkã€scriptè®¾ç½®globalå±æ€§ä¼šå°†æ–‡ä»¶æå–ä¸ºå…¬å…±æ–‡ä»¶ï¼Œå…±äº«ç»™å…¶å®ƒåº”ç”¨ã€‚
è®¾ç½®globalå±æ€§åæ–‡ä»¶ç¬¬ä¸€æ¬¡åŠ è½½ä¼šæ”¾å…¥å…¬å…±ç¼“å­˜ï¼Œå…¶å®ƒå­åº”ç”¨åŠ è½½ç›¸åŒçš„èµ„æºæ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å†…å®¹ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" global>
<script src="xx.js" global><\/script>`},{header:"globalAssets",slug:"globalassets",content:`globalAssetsç”¨äºè®¾ç½®å…¨å±€å…±äº«èµ„æºï¼Œå®ƒå’Œé¢„åŠ è½½çš„æ€è·¯ç›¸åŒï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½èµ„æºå¹¶æ”¾å…¥ç¼“å­˜ï¼Œæé«˜æ¸²æŸ“æ•ˆç‡ã€‚
å½“å­åº”ç”¨åŠ è½½ç›¸åŒåœ°å€çš„jsæˆ–cssèµ„æºæ—¶ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­æå–æ•°æ®ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start({ globalAssets: { js: ['jsåœ°å€1', 'jsåœ°å€2', ...], // jsåœ°å€ css: ['cssåœ°å€1', 'cssåœ°å€2', ...], // cssåœ°å€ }
})`},{header:"exclude(è¿‡æ»¤å…ƒç´ )",slug:"exclude-è¿‡æ»¤å…ƒç´ ",content:`å½“å­åº”ç”¨ä¸éœ€è¦åŠ è½½æŸä¸ªjsæˆ–cssï¼Œå¯ä»¥é€šè¿‡åœ¨linkã€scriptã€styleè®¾ç½®excludeå±æ€§ï¼Œå½“micro-appé‡åˆ°å¸¦æœ‰excludeå±æ€§çš„å…ƒç´ ä¼šè¿›è¡Œåˆ é™¤ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" exclude>
<script src="xx.js" exclude><\/script>
<style exclude></style>`},{header:"ignore(å¿½ç•¥å…ƒç´ )",slug:"ignore-å¿½ç•¥å…ƒç´ ",content:`å½“linkã€scriptã€styleå…ƒç´ å…·æœ‰ignoreå±æ€§ï¼Œmicro-appä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ã€‚
ä½¿ç”¨åœºæ™¯ä¾‹å¦‚ï¼šjsonp
jsonpä¼šåˆ›å»ºä¸€ä¸ªscriptå…ƒç´ åŠ è½½æ•°æ®ï¼Œæ­£å¸¸æƒ…å†µscriptä¼šè¢«æ‹¦æˆªå¯¼è‡´jsonpè¯·æ±‚å¤±è´¥ï¼Œæ­¤æ—¶å¯ä»¥ç»™scriptå…ƒç´ æ·»åŠ ignoreå±æ€§ï¼Œè·³è¿‡æ‹¦æˆªã€‚
// ä¿®æ”¹jsonpæ–¹æ³•ï¼Œåœ¨åˆ›å»ºscriptå…ƒç´ åæ·»åŠ ignoreå±æ€§
const script = document.createElement('script')
script.setAttribute('ignore', 'true')`}]},{path:"/zh/data.html",title:"æ•°æ®é€šä¿¡",pathLocale:"/",contents:[{header:"æ•°æ®é€šä¿¡",slug:"æ•°æ®é€šä¿¡",content:`micro-appæä¾›äº†ä¸€å¥—çµæ´»çš„æ•°æ®é€šä¿¡æœºåˆ¶ï¼Œæ–¹ä¾¿ä¸»åº”ç”¨å’Œå­åº”ç”¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚
ä¸»åº”ç”¨å’Œå­åº”ç”¨ä¹‹é—´çš„é€šä¿¡æ˜¯ç»‘å®šçš„ï¼Œä¸»åº”ç”¨åªèƒ½å‘æŒ‡å®šçš„å­åº”ç”¨å‘é€æ•°æ®ï¼Œå­åº”ç”¨åªèƒ½å‘ä¸»åº”ç”¨å‘é€æ•°æ®ï¼Œè¿™ç§æ–¹å¼å¯ä»¥æœ‰æ•ˆçš„é¿å…æ•°æ®æ±¡æŸ“ï¼Œé˜²æ­¢å¤šä¸ªå­åº”ç”¨ä¹‹é—´ç›¸äº’å½±å“ã€‚
åŒæ—¶æˆ‘ä»¬ä¹Ÿæä¾›äº†å…¨å±€é€šä¿¡ï¼Œæ–¹ä¾¿è·¨åº”ç”¨ä¹‹é—´çš„æ•°æ®é€šä¿¡ã€‚`},{header:"ä¸€ã€å­åº”ç”¨è·å–æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®",slug:"ä¸€ã€å­åº”ç”¨è·å–æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®",content:"æœ‰ä¸¤ç§æ–¹å¼è·å–æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®ï¼š"},{header:"æ–¹å¼1ï¼šç›´æ¥è·å–æ•°æ®",slug:"æ–¹å¼1-ç›´æ¥è·å–æ•°æ®",content:"const data = window.microApp.getData() // è¿”å›ä¸»åº”ç”¨ä¸‹å‘çš„dataæ•°æ®"},{header:"æ–¹å¼2ï¼šç»‘å®šç›‘å¬å‡½æ•°",slug:"æ–¹å¼2-ç»‘å®šç›‘å¬å‡½æ•°",content:`/** * ç»‘å®šç›‘å¬å‡½æ•°ï¼Œç›‘å¬å‡½æ•°åªæœ‰åœ¨æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse * !!!é‡è¦è¯´æ˜: å› ä¸ºå­åº”ç”¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„ï¼Œè€Œä¸»åº”ç”¨å‘é€æ•°æ®æ˜¯åŒæ­¥çš„ï¼Œ * å¦‚æœåœ¨å­åº”ç”¨æ¸²æŸ“ç»“æŸå‰ä¸»åº”ç”¨å‘é€æ•°æ®ï¼Œåˆ™åœ¨ç»‘å®šç›‘å¬å‡½æ•°å‰æ•°æ®å·²ç»å‘é€ï¼Œåœ¨åˆå§‹åŒ–åä¸ä¼šè§¦å‘ç»‘å®šå‡½æ•°ï¼Œ * ä½†è¿™ä¸ªæ•°æ®ä¼šæ”¾å…¥ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶å¯ä»¥è®¾ç½®autoTriggerä¸ºtrueä¸»åŠ¨è§¦å‘ä¸€æ¬¡ç›‘å¬å‡½æ•°æ¥è·å–æ•°æ®ã€‚ */
window.microApp.addDataListener(dataListener: (data: Object) => any, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
window.microApp.removeDataListener(dataListener: (data: Object) => any) // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
window.microApp.clearDataListener()
ä½¿ç”¨æ–¹å¼ï¼š
// ç›‘å¬å‡½æ•°
function dataListener (data) { console.log('æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®', data)
} // ç›‘å¬æ•°æ®å˜åŒ–
window.microApp.addDataListener(dataListener) // ç›‘å¬æ•°æ®å˜åŒ–ï¼Œåˆå§‹åŒ–æ—¶å¦‚æœæœ‰æ•°æ®åˆ™ä¸»åŠ¨è§¦å‘ä¸€æ¬¡
window.microApp.addDataListener(dataListener, true) // è§£ç»‘ç›‘å¬å‡½æ•°
window.microApp.removeDataListener(dataListener) // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
window.microApp.clearDataListener()`},{header:"äºŒã€å­åº”ç”¨å‘ä¸»åº”ç”¨å‘é€æ•°æ®",slug:"äºŒã€å­åº”ç”¨å‘ä¸»åº”ç”¨å‘é€æ•°æ®",content:`// dispatchåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.dispatch({type: 'å­åº”ç”¨å‘é€ç»™ä¸»åº”ç”¨çš„æ•°æ®'})
dispatchåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå®ƒå‘é€çš„æ•°æ®éƒ½ä¼šè¢«ç¼“å­˜ä¸‹æ¥ã€‚
micro-appä¼šéå†æ–°æ—§å€¼ä¸­çš„æ¯ä¸ªkeyåˆ¤æ–­å€¼æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¦‚æœæ‰€æœ‰æ•°æ®éƒ½ç›¸åŒåˆ™ä¸ä¼šå‘é€ï¼ˆæ³¨æ„ï¼šåªä¼šéå†ç¬¬ä¸€å±‚keyï¼‰ï¼Œå¦‚æœæ•°æ®æœ‰å˜åŒ–åˆ™å°†æ–°æ—§å€¼è¿›è¡Œåˆå¹¶åå‘é€ã€‚
ä¾‹å¦‚ï¼š
// ç¬¬ä¸€æ¬¡å‘é€æ•°æ®ï¼Œè®°å…¥ç¼“å­˜å€¼ {name: 'jack'}ï¼Œç„¶åå‘é€ window.microApp.dispatch({name: 'jack'})
// ç¬¬äºŒæ¬¡å‘é€æ•°æ®ï¼Œå°†æ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œè®°å…¥ç¼“å­˜å€¼ï¼Œç„¶åå‘é€ window.microApp.dispatch({age: 20})
// ç¬¬ä¸‰æ¬¡å‘é€æ•°æ®ï¼Œæ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œä¸ç¼“å­˜å€¼ç›¸åŒï¼Œä¸å†å‘é€
window.microApp.dispatch({age: 20})`},{header:"dispatchæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå¤šä¸ªdispatchä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºä¸€æ¬¡æ‰§è¡Œ",slug:"dispatchæ˜¯å¼‚æ­¥æ‰§è¡Œçš„-å¤šä¸ªdispatchä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºä¸€æ¬¡æ‰§è¡Œ",content:`ä¾‹å¦‚ï¼š
window.microApp.dispatch({name: 'jack'})
window.microApp.dispatch({age: 20}) // ä¸Šé¢çš„æ•°æ®ä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºå¯¹è±¡{name: 'jack', age: 20}ä¸€æ¬¡æ€§å‘é€ç»™ä¸»åº”ç”¨`},{header:"dispatchç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå®ƒä¼šåœ¨æ•°æ®å‘é€ç»“æŸåæ‰§è¡Œ",slug:"dispatchç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°-å®ƒä¼šåœ¨æ•°æ®å‘é€ç»“æŸåæ‰§è¡Œ",content:`ä¾‹å¦‚ï¼š
window.microApp.dispatch({city: 'HK'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
})`},{header:"å½“æ•°æ®ç›‘å¬å‡½æ•°æœ‰è¿”å›å€¼æ—¶ï¼Œä¼šä½œä¸ºdispatchå›è°ƒå‡½æ•°çš„å…¥å‚",slug:"å½“æ•°æ®ç›‘å¬å‡½æ•°æœ‰è¿”å›å€¼æ—¶-ä¼šä½œä¸ºdispatchå›è°ƒå‡½æ•°çš„å…¥å‚",content:`ä¾‹å¦‚ï¼š
ä¸»åº”ç”¨ï¼š
import microApp from '@micro-zoe/micro-app' microApp.addDataListener('my-app', (data) => { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data) return 'è¿”å›å€¼1'
}) microApp.addDataListener('my-app', (data) => { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data) return 'è¿”å›å€¼2'
})
å­åº”ç”¨ï¼š
// è¿”å›å€¼ä¼šæ”¾å…¥æ•°ç»„ä¸­ä¼ é€’ç»™dispatchçš„å›è°ƒå‡½æ•°
window.microApp.dispatch({city: 'HK'}, (res: any[]) => { console.log(res) // ['è¿”å›å€¼1', 'è¿”å›å€¼2']
})`},{header:"forceDispatchï¼šå¼ºåˆ¶å‘é€",slug:"forcedispatch-å¼ºåˆ¶å‘é€",content:`forceDispatchæ–¹æ³•æ‹¥æœ‰å’Œdispatchä¸€æ ·çš„å‚æ•°å’Œè¡Œä¸ºï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯forceDispatchä¼šå¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºæ•°æ®æ˜¯å¦å˜åŒ–ã€‚
ä¾‹å¦‚ï¼š
// å¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ name: 'jack' çš„å€¼
window.microApp.forceDispatch({name: 'jack'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
})`},{header:"ä¸‰ã€ä¸»åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®",slug:"ä¸‰ã€ä¸»åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®",content:"ä¸»åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼š"},{header:"æ–¹å¼1: é€šè¿‡dataå±æ€§å‘é€æ•°æ®",slug:"æ–¹å¼1-é€šè¿‡dataå±æ€§å‘é€æ•°æ®",content:`åœ¨Reactä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>å…ƒç´ æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfill(æ³¨é‡Šä¹Ÿè¦å¤åˆ¶)ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='my-app' url='xx' data={this.state.dataForChild} // dataåªæ¥å—å¯¹è±¡ç±»å‹ï¼Œé‡‡ç”¨ä¸¥æ ¼å¯¹æ¯”(===)ï¼Œå½“ä¼ å…¥æ–°çš„dataå¯¹è±¡æ—¶ä¼šé‡æ–°å‘é€
/> vueä¸­å’Œç»‘å®šæ™®é€šå±æ€§æ–¹å¼ä¸€è‡´ã€‚
<template> <micro-app name='my-app' url='xx' :data='dataForChild' // dataåªæ¥å—å¯¹è±¡ç±»å‹ï¼Œæ•°æ®å˜åŒ–æ—¶ä¼šé‡æ–°å‘é€ />
</template> <script>
export default { data () { return { dataForChild: {type: 'å‘é€ç»™å­åº”ç”¨çš„æ•°æ®'} } }
}
<\/script>`},{header:"æ–¹å¼2: æ‰‹åŠ¨å‘é€æ•°æ®",slug:"æ–¹å¼2-æ‰‹åŠ¨å‘é€æ•°æ®",content:`æ‰‹åŠ¨å‘é€æ•°æ®éœ€è¦é€šè¿‡nameæŒ‡å®šæ¥å—æ•°æ®çš„å­åº”ç”¨ï¼Œæ­¤å€¼å’Œ<micro-app>å…ƒç´ ä¸­çš„nameä¸€è‡´ã€‚
import microApp from '@micro-zoe/micro-app' // å‘é€æ•°æ®ç»™å­åº”ç”¨ my-appï¼ŒsetDataç¬¬äºŒä¸ªå‚æ•°åªæ¥å—å¯¹è±¡ç±»å‹
microApp.setData('my-app', {type: 'æ–°çš„æ•°æ®'})
setDataç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­åº”ç”¨åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¼ é€’çš„æ•°æ®ï¼Œå®ƒå‘é€çš„æ•°æ®éƒ½ä¼šè¢«ç¼“å­˜ä¸‹æ¥ã€‚
micro-appä¼šéå†æ–°æ—§å€¼ä¸­çš„æ¯ä¸ªkeyåˆ¤æ–­å€¼æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¦‚æœæ‰€æœ‰æ•°æ®éƒ½ç›¸åŒåˆ™ä¸ä¼šå‘é€ï¼ˆæ³¨æ„ï¼šåªä¼šéå†ç¬¬ä¸€å±‚keyï¼‰ï¼Œå¦‚æœæ•°æ®æœ‰å˜åŒ–åˆ™å°†æ–°æ—§å€¼è¿›è¡Œåˆå¹¶åå‘é€ã€‚
ä¾‹å¦‚ï¼š
// ç¬¬ä¸€æ¬¡å‘é€æ•°æ®ï¼Œè®°å…¥ç¼“å­˜å€¼ {name: 'jack'}ï¼Œç„¶åå‘é€ microApp.setData('my-app', {name: 'jack'})
// ç¬¬äºŒæ¬¡å‘é€æ•°æ®ï¼Œå°†æ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œè®°å…¥ç¼“å­˜å€¼ï¼Œç„¶åå‘é€ microApp.setData('my-app', {age: 20})
// ç¬¬ä¸‰æ¬¡å‘é€æ•°æ®ï¼Œæ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œä¸ç¼“å­˜å€¼ç›¸åŒï¼Œä¸å†å‘é€
microApp.setData('my-app', {age: 20})`},{header:"setDataæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå¤šä¸ªsetDataä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºä¸€æ¬¡æ‰§è¡Œ",slug:"setdataæ˜¯å¼‚æ­¥æ‰§è¡Œçš„-å¤šä¸ªsetdataä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºä¸€æ¬¡æ‰§è¡Œ",content:`ä¾‹å¦‚ï¼š
microApp.setData('my-app', {name: 'jack'})
microApp.setData('my-app', {age: 20}) // ä¸Šé¢çš„æ•°æ®ä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºå¯¹è±¡{name: 'jack', age: 20}ä¸€æ¬¡æ€§å‘é€ç»™å­åº”ç”¨my-app`},{header:"setDataç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå®ƒä¼šåœ¨æ•°æ®å‘é€ç»“æŸåæ‰§è¡Œ",slug:"setdataç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°-å®ƒä¼šåœ¨æ•°æ®å‘é€ç»“æŸåæ‰§è¡Œ",content:`ä¾‹å¦‚ï¼š
microApp.setData('my-app', {city: 'HK'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
})`},{header:"å½“æ•°æ®ç›‘å¬å‡½æ•°æœ‰è¿”å›å€¼æ—¶ï¼Œä¼šä½œä¸ºsetDataå›è°ƒå‡½æ•°çš„å…¥å‚",slug:"å½“æ•°æ®ç›‘å¬å‡½æ•°æœ‰è¿”å›å€¼æ—¶-ä¼šä½œä¸ºsetdataå›è°ƒå‡½æ•°çš„å…¥å‚",content:`ä¾‹å¦‚ï¼š
å­åº”ç”¨ï¼š
window.microApp.addDataListener((data) => { console.log('æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®', data) return 'è¿”å›å€¼1'
}) window.microApp.addDataListener((data) => { console.log('æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®', data) return 'è¿”å›å€¼2'
})
ä¸»åº”ç”¨ï¼š
// è¿”å›å€¼ä¼šæ”¾å…¥æ•°ç»„ä¸­ä¼ é€’ç»™setDataçš„å›è°ƒå‡½æ•°
microApp.setData('my-app', {city: 'HK'}, (res: any[]) => { console.log(res) // ['è¿”å›å€¼1', 'è¿”å›å€¼2']
})`},{header:"forceSetDataï¼šå¼ºåˆ¶å‘é€",slug:"forcesetdata-å¼ºåˆ¶å‘é€",content:`forceSetDataæ–¹æ³•æ‹¥æœ‰å’ŒsetDataä¸€æ ·çš„å‚æ•°å’Œè¡Œä¸ºï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯forceSetDataä¼šå¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºæ•°æ®æ˜¯å¦å˜åŒ–ã€‚
ä¾‹å¦‚ï¼š
// å¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ name: 'jack' çš„å€¼
microApp.forceSetData('my-app', {name: 'jack'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
})`},{header:"å››ã€ä¸»åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®",slug:"å››ã€ä¸»åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®",content:"ä¸»åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®æœ‰ä¸‰ç§æ–¹å¼ï¼š"},{header:"æ–¹å¼1ï¼šç›´æ¥è·å–æ•°æ®",slug:"æ–¹å¼1-ç›´æ¥è·å–æ•°æ®-1",content:"import microApp from '@micro-zoe/micro-app' const childData = microApp.getData(appName) // è¿”å›å­åº”ç”¨çš„dataæ•°æ®"},{header:"æ–¹å¼2: ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ (datachange)",slug:"æ–¹å¼2-ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶-datachange",content:`åœ¨Reactä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>å…ƒç´ æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfill(æ³¨é‡Šä¹Ÿè¦å¤åˆ¶)ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='my-app' url='xx' // æ•°æ®åœ¨event.detail.dataå­—æ®µä¸­ï¼Œå­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange onDataChange={(e) => console.log('æ¥è‡ªå­åº”ç”¨çš„æ•°æ®ï¼š', e.detail.data)}
/> vueä¸­ç›‘å¬æ–¹å¼å’Œæ™®é€šäº‹ä»¶ä¸€è‡´ã€‚
<template> <micro-app name='my-app' url='xx' // æ•°æ®åœ¨äº‹ä»¶å¯¹è±¡çš„detail.dataå­—æ®µä¸­ï¼Œå­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange @datachange='handleDataChange' />
</template> <script>
export default { methods: { handleDataChange (e) { console.log('æ¥è‡ªå­åº”ç”¨çš„æ•°æ®ï¼š', e.detail.data) } }
}
<\/script> æ³¨æ„ï¼šdatachangeç»‘å®šå‡½æ•°çš„è¿”å›å€¼ä¸ä¼šä½œä¸ºå­åº”ç”¨dispatchå›è°ƒå‡½æ•°çš„å…¥å‚ï¼Œå®ƒçš„è¿”å›å€¼æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚`},{header:"æ–¹å¼3: ç»‘å®šç›‘å¬å‡½æ•°",slug:"æ–¹å¼3-ç»‘å®šç›‘å¬å‡½æ•°",content:`ç»‘å®šç›‘å¬å‡½æ•°éœ€è¦é€šè¿‡nameæŒ‡å®šå­åº”ç”¨ï¼Œæ­¤å€¼å’Œ<micro-app>å…ƒç´ ä¸­çš„nameä¸€è‡´ã€‚
import microApp from '@micro-zoe/micro-app' /** * ç»‘å®šç›‘å¬å‡½æ•° * appName: åº”ç”¨åç§° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addDataListener(appName: string, dataListener: (data: Object) => any, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬æŒ‡å®šå­åº”ç”¨çš„å‡½æ•°
microApp.removeDataListener(appName: string, dataListener: (data: Object) => any) // æ¸…ç©ºæ‰€æœ‰ç›‘å¬æŒ‡å®šå­åº”ç”¨çš„å‡½æ•°
microApp.clearDataListener(appName: string)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // ç›‘å¬å‡½æ•°
function dataListener (data) { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
} // ç›‘å¬æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®
microApp.addDataListener('my-app', dataListener) // è§£ç»‘ç›‘å¬my-appå­åº”ç”¨çš„å‡½æ•°
microApp.removeDataListener('my-app', dataListener) // æ¸…ç©ºæ‰€æœ‰ç›‘å¬my-appå­åº”ç”¨çš„å‡½æ•°
microApp.clearDataListener('my-app')`},{header:"äº”ã€æ¸…ç©ºæ•°æ®",slug:"äº”ã€æ¸…ç©ºæ•°æ®",content:"ç”±äºé€šä¿¡çš„æ•°æ®ä¼šè¢«ç¼“å­˜ï¼Œå³ä¾¿å­åº”ç”¨è¢«å¸è½½ä¹Ÿä¸ä¼šæ¸…ç©ºï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å›°æ‰°ï¼Œæ­¤æ—¶å¯ä»¥ä¸»åŠ¨æ¸…ç©ºç¼“å­˜æ•°æ®æ¥è§£å†³ã€‚"},{header:"æ–¹å¼ä¸€ï¼šé…ç½®é¡¹ - clear-data",slug:"æ–¹å¼ä¸€-é…ç½®é¡¹-clear-data",content:`ä½¿ç”¨æ–¹å¼: <micro-app clear-data></micro-app> å½“è®¾ç½®äº†clear-dataï¼Œå­åº”ç”¨å¸è½½æ—¶ä¼šåŒæ—¶æ¸…ç©ºä¸»åº”ç”¨å‘é€ç»™å½“å‰å­åº”ç”¨ï¼Œå’Œå½“å‰å­åº”ç”¨å‘é€ç»™ä¸»åº”ç”¨çš„æ•°æ®ã€‚
destroyä¹Ÿæœ‰åŒæ ·çš„æ•ˆæœã€‚`},{header:"æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ¸…ç©º - clearData",slug:"æ–¹å¼äºŒ-æ‰‹åŠ¨æ¸…ç©º-cleardata",content:`import microApp from '@micro-zoe/micro-app' // æ¸…ç©ºä¸»åº”ç”¨å‘é€ç»™å­åº”ç”¨ my-app çš„æ•°æ®
microApp.clearData('my-app')`},{header:"æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨æ¸…ç©º - clearData",slug:"æ–¹å¼ä¸€-æ‰‹åŠ¨æ¸…ç©º-cleardata",content:`// æ¸…ç©ºå½“å‰å­åº”ç”¨å‘é€ç»™ä¸»åº”ç”¨çš„æ•°æ®
window.microApp.clearData()`},{header:"å…¨å±€æ•°æ®é€šä¿¡",slug:"å…¨å±€æ•°æ®é€šä¿¡",content:"å…¨å±€æ•°æ®é€šä¿¡ä¼šå‘ä¸»åº”ç”¨å’Œæ‰€æœ‰å­åº”ç”¨å‘é€æ•°æ®ï¼Œåœ¨è·¨åº”ç”¨é€šä¿¡çš„åœºæ™¯ä¸­é€‚ç”¨ã€‚"},{header:"å‘é€å…¨å±€æ•°æ®",slug:"å‘é€å…¨å±€æ•°æ®",content:`import microApp from '@micro-zoe/micro-app' // setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'}) // setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'}) setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå®ƒå‘é€çš„æ•°æ®éƒ½ä¼šè¢«ç¼“å­˜ä¸‹æ¥ã€‚
micro-appä¼šéå†æ–°æ—§å€¼ä¸­çš„æ¯ä¸ªkeyåˆ¤æ–­å€¼æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¦‚æœæ‰€æœ‰æ•°æ®éƒ½ç›¸åŒåˆ™ä¸ä¼šå‘é€ï¼ˆæ³¨æ„ï¼šåªä¼šéå†ç¬¬ä¸€å±‚keyï¼‰ï¼Œå¦‚æœæ•°æ®æœ‰å˜åŒ–åˆ™å°†æ–°æ—§å€¼è¿›è¡Œåˆå¹¶åå‘é€ã€‚
ä¾‹å¦‚ï¼š // ç¬¬ä¸€æ¬¡å‘é€æ•°æ®ï¼Œè®°å…¥ç¼“å­˜å€¼ {name: 'jack'}ï¼Œç„¶åå‘é€ microApp.setGlobalData({name: 'jack'})
// ç¬¬äºŒæ¬¡å‘é€æ•°æ®ï¼Œå°†æ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œè®°å…¥ç¼“å­˜å€¼ï¼Œç„¶åå‘é€ microApp.setGlobalData({age: 20})
// ç¬¬ä¸‰æ¬¡å‘é€æ•°æ®ï¼Œæ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œä¸ç¼“å­˜å€¼ç›¸åŒï¼Œä¸å†å‘é€
microApp.setGlobalData({age: 20}) // ç¬¬ä¸€æ¬¡å‘é€æ•°æ®ï¼Œè®°å…¥ç¼“å­˜å€¼ {name: 'jack'}ï¼Œç„¶åå‘é€ window.microApp.setGlobalData({name: 'jack'})
// ç¬¬äºŒæ¬¡å‘é€æ•°æ®ï¼Œå°†æ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œè®°å…¥ç¼“å­˜å€¼ï¼Œç„¶åå‘é€ window.microApp.setGlobalData({age: 20})
// ç¬¬ä¸‰æ¬¡å‘é€æ•°æ®ï¼Œæ–°æ—§å€¼åˆå¹¶ä¸º {name: 'jack', age: 20}ï¼Œä¸ç¼“å­˜å€¼ç›¸åŒï¼Œä¸å†å‘é€
window.microApp.setGlobalData({age: 20})`},{header:"setGlobalDataæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå¤šä¸ªsetGlobalDataä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºä¸€æ¬¡æ‰§è¡Œ",slug:"setglobaldataæ˜¯å¼‚æ­¥æ‰§è¡Œçš„-å¤šä¸ªsetglobaldataä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºä¸€æ¬¡æ‰§è¡Œ",content:`ä¾‹å¦‚ï¼š microApp.setGlobalData({name: 'jack'})
microApp.setGlobalData({age: 20}) // ä¸Šé¢çš„æ•°æ®ä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºå¯¹è±¡{name: 'jack', age: 20}ä¸€æ¬¡æ€§å‘é€ç»™ä¸»åº”ç”¨ window.microApp.setGlobalData({name: 'jack'})
window.microApp.setGlobalData({age: 20}) // ä¸Šé¢çš„æ•°æ®ä¼šåœ¨ä¸‹ä¸€å¸§åˆå¹¶ä¸ºå¯¹è±¡{name: 'jack', age: 20}ä¸€æ¬¡æ€§å‘é€ç»™ä¸»åº”ç”¨`},{header:"setGlobalDataç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå®ƒä¼šåœ¨æ•°æ®å‘é€ç»“æŸåæ‰§è¡Œ",slug:"setglobaldataç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°-å®ƒä¼šåœ¨æ•°æ®å‘é€ç»“æŸåæ‰§è¡Œ",content:`ä¾‹å¦‚ï¼š microApp.setGlobalData({city: 'HK'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
}) window.microApp.setGlobalData({city: 'HK'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
})`},{header:"å½“å…¨å±€æ•°æ®çš„ç›‘å¬å‡½æ•°æœ‰è¿”å›å€¼æ—¶ï¼Œä¼šä½œä¸ºsetGlobalDataå›è°ƒå‡½æ•°çš„å…¥å‚",slug:"å½“å…¨å±€æ•°æ®çš„ç›‘å¬å‡½æ•°æœ‰è¿”å›å€¼æ—¶-ä¼šä½œä¸ºsetglobaldataå›è°ƒå‡½æ•°çš„å…¥å‚",content:`ä¾‹å¦‚ï¼š microApp.addGlobalDataListener((data) => { console.log('å…¨å±€æ•°æ®', data) return 'è¿”å›å€¼1'
}) microApp.addGlobalDataListener((data) => { console.log('å…¨å±€æ•°æ®', data) return 'è¿”å›å€¼2'
})
// è¿”å›å€¼ä¼šæ”¾å…¥æ•°ç»„ä¸­ä¼ é€’ç»™setGlobalDataçš„å›è°ƒå‡½æ•°
microApp.setGlobalData({city: 'HK'}, (res: any[]) => { console.log(res) // ['è¿”å›å€¼1', 'è¿”å›å€¼2']
}) window.microApp.addGlobalDataListener((data) => { console.log('å…¨å±€æ•°æ®', data) return 'è¿”å›å€¼1'
}) window.microApp.addGlobalDataListener((data) => { console.log('å…¨å±€æ•°æ®', data) return 'è¿”å›å€¼2'
})
// è¿”å›å€¼ä¼šæ”¾å…¥æ•°ç»„ä¸­ä¼ é€’ç»™setGlobalDataçš„å›è°ƒå‡½æ•°
window.microApp.setGlobalData({city: 'HK'}, (res: any[]) => { console.log(res) // ['è¿”å›å€¼1', 'è¿”å›å€¼2']
})`},{header:"forceSetGlobalDataï¼šå¼ºåˆ¶å‘é€",slug:"forcesetglobaldata-å¼ºåˆ¶å‘é€",content:`forceSetGlobalDataæ–¹æ³•æ‹¥æœ‰å’ŒsetGlobalDataä¸€æ ·çš„å‚æ•°å’Œè¡Œä¸ºï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯forceSetGlobalDataä¼šå¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºæ•°æ®æ˜¯å¦å˜åŒ–ã€‚
ä¾‹å¦‚ï¼š // å¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ name: 'jack' çš„å€¼
microApp.forceSetGlobalData({name: 'jack'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
}) // å¼ºåˆ¶å‘é€æ•°æ®ï¼Œæ— è®ºç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ name: 'jack' çš„å€¼
window.microApp.forceSetGlobalData({name: 'jack'}, () => { console.log('æ•°æ®å·²ç»å‘é€å®Œæˆ')
})`},{header:"è·å–å…¨å±€æ•°æ®",slug:"è·å–å…¨å±€æ•°æ®",content:`import microApp from '@micro-zoe/micro-app' // ç›´æ¥è·å–æ•°æ®
const globalData = microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ® function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addGlobalDataListener(dataListener: (data: Object) => any, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
microApp.removeGlobalDataListener(dataListener: (data: Object) => any) // æ¸…ç©ºä¸»åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
microApp.clearGlobalDataListener() // ç›´æ¥è·å–æ•°æ®
const globalData = window.microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ® function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.microApp.addGlobalDataListener(dataListener: (data: Object) => any, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
window.microApp.removeGlobalDataListener(dataListener: (data: Object) => any) // æ¸…ç©ºå½“å‰å­åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
window.microApp.clearGlobalDataListener()`},{header:"æ¸…ç©ºå…¨å±€æ•°æ®",slug:"æ¸…ç©ºå…¨å±€æ•°æ®",content:`import microApp from '@micro-zoe/micro-app' // æ¸…ç©ºå…¨å±€æ•°æ®
microApp.clearGlobalData() // æ¸…ç©ºå…¨å±€æ•°æ®
window.microApp.clearGlobalData()`},{header:"å…³é—­æ²™ç®±åçš„é€šä¿¡æ–¹å¼",slug:"å…³é—­æ²™ç®±åçš„é€šä¿¡æ–¹å¼",content:`æ²™ç®±å…³é—­åï¼Œå­åº”ç”¨é»˜è®¤çš„é€šä¿¡åŠŸèƒ½å¤±æ•ˆï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡æ‰‹åŠ¨æ³¨å†Œé€šä¿¡å¯¹è±¡å®ç°ä¸€è‡´çš„åŠŸèƒ½ã€‚
æ³¨å†Œæ–¹å¼ï¼šåœ¨ä¸»åº”ç”¨ä¸­ä¸ºå­åº”ç”¨åˆå§‹åŒ–é€šä¿¡å¯¹è±¡
import { EventCenterForMicroApp } from '@micro-zoe/micro-app' // æ³¨æ„ï¼šæ¯ä¸ªå­åº”ç”¨æ ¹æ®appNameå•ç‹¬åˆ†é…ä¸€ä¸ªé€šä¿¡å¯¹è±¡
window.eventCenterForAppxx = new EventCenterForMicroApp(appName)
å­åº”ç”¨å°±å¯ä»¥é€šè¿‡æ³¨å†Œçš„eventCenterForAppxxå¯¹è±¡è¿›è¡Œé€šä¿¡ï¼Œå…¶apiå’Œwindow.microAppä¸€è‡´ï¼Œä¸»åº”ç”¨é€šä¿¡æ–¹å¼æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚
å­åº”ç”¨é€šä¿¡æ–¹å¼ï¼š
// ç›´æ¥è·å–æ•°æ®
const data = window.eventCenterForAppxx.getData() // è¿”å›dataæ•°æ® function dataListener (data) { console.log('æ¥è‡ªä¸»åº”ç”¨çš„æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.eventCenterForAppxx.addDataListener(dataListener: (data: Object) => any, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
window.eventCenterForAppxx.removeDataListener(dataListener: (data: Object) => any) // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
window.eventCenterForAppxx.clearDataListener() // å­åº”ç”¨å‘ä¸»åº”ç”¨å‘é€æ•°æ®ï¼Œåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.eventCenterForAppxx.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})`}]},{path:"/zh/deploy.html",title:"",pathLocale:"/",contents:[{header:"å‰è¨€",slug:"å‰è¨€",content:`æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ä¿æŒå¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒè·¯å¾„(å³webpackçš„publicPath)çš„ä¸€è‡´æ€§ï¼Œä»¥é¿å…åœ¨éƒ¨ç½²åå‡ºç°é—®é¢˜ï¼Œæ— è®ºæ˜¯ä¸»åº”ç”¨è¿˜æ˜¯å­åº”ç”¨ã€‚
æ¯”å¦‚ä¸€ä¸ªåº”ç”¨ï¼Œåœ¨éƒ¨ç½²æ—¶ä½œä¸ºæ–‡ä»¶å¤¹ my-app æ”¾å…¥æœåŠ¡å™¨æ ¹ç›®å½•ï¼Œé‚£ä¹ˆé…ç½®å¦‚ä¸‹ï¼š // webpack.config.js
module.exports = { output: { path: 'my-app', publicPath: process.env.NODE_ENV === 'production' ? '/my-app/' : '', // bad âŒ publicPath: '/my-app/', // good ğŸ‘ }
} // vue.config.js
module.exports = { outputDir: 'my-app', publicPath: process.env.NODE_ENV === 'production' ? '/my-app/' : '', // bad âŒ publicPath: '/my-app/', // good ğŸ‘
}`},{header:"ç¤ºä¾‹",slug:"ç¤ºä¾‹",content:`æ­£å¸¸æ¥è¯´åªè¦å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒèµ„æºè·¯å¾„ä¸€è‡´ï¼Œå¹¶åœ¨éƒ¨ç½²åè®¾ç½®å¥½nginxçš„è·¨åŸŸå³å¯ï¼Œåœ¨å¼€å‘ç¯å¢ƒæ­£å¸¸è¿è¡Œçš„é¡¹ç›®ï¼Œéƒ¨ç½²åˆ°æœåŠ¡å™¨åï¼Œç†è®ºä¸Šä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œã€‚
ä½†åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ä¼šå‡ºç°åœ°å€404ã€èµ„æºä¸¢å¤±ç­‰é—®é¢˜ï¼Œè¿™é€šå¸¸æ˜¯å› ä¸ºæœåŠ¡å™¨é…ç½®é”™è¯¯æˆ–è€…micro-appå…ƒç´ urlå±æ€§åœ°å€é”™è¯¯å¯¼è‡´ã€‚
æˆ‘ä»¬ä»¥micro-app-demoä¸ºä¾‹ä»‹ç»éƒ¨ç½²ç›¸å…³å†…å®¹ï¼Œä»¥ä¾›å¤§å®¶å‚è€ƒï¼Œå› ä¸ºmicro-app-demoè¦†ç›–äº†historyè·¯ç”±ã€hashè·¯ç”±ã€ssrã€æ ¹è·¯å¾„ã€äºŒçº§è·¯å¾„ç­‰å¤§éƒ¨åˆ†åœºæ™¯ï¼Œæ˜¯ä¸€ä¸ªå…¸å‹çš„æ¡ˆä¾‹ã€‚`},{header:"ä»£ç ä»“åº“ç›®å½•ç»“æ„ï¼š",slug:"ä»£ç ä»“åº“ç›®å½•ç»“æ„",content:`.
â”œâ”€â”€ child_apps
â”‚ â”œâ”€â”€ angular11 // å­åº”ç”¨ angular11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nextjs11 // å­åº”ç”¨ nextjs11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nuxtjs2 // å­åº”ç”¨ nuxtjs2 (historyè·¯ç”±) â”‚ â”œâ”€â”€ react16 // å­åº”ç”¨ react16 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ react17 // å­åº”ç”¨ react17 (hashè·¯ç”±)
â”‚ â”œâ”€â”€ sidebar // å­åº”ç”¨ sidebarï¼Œå…¬å…±ä¾§è¾¹æ 
â”‚ â”œâ”€â”€ vite-vue3 // å­åº”ç”¨ vite (hashè·¯ç”±)
â”‚ â”œâ”€â”€ vue2 // å­åº”ç”¨ vue2 (historyè·¯ç”±)
â”‚ â””â”€â”€ vue3 // å­åº”ç”¨ vue3 (historyè·¯ç”±)
â”œâ”€â”€ main_apps
â”‚ â”œâ”€â”€ angular11 // ä¸»åº”ç”¨ angular11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nextjs11 // ä¸»åº”ç”¨ nextjs11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nuxtjs2 // ä¸»åº”ç”¨ nuxtjs2 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ react16 // ä¸»åº”ç”¨ react16 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ react17 // ä¸»åº”ç”¨ react17 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ vite-vue3 // ä¸»åº”ç”¨ vite (historyè·¯ç”±)
â”‚ â”œâ”€â”€ vue2 // ä¸»åº”ç”¨ vue2 (historyè·¯ç”±)
â”‚ â””â”€â”€ vue3 // ä¸»åº”ç”¨ vue3 (historyè·¯ç”±)
â”œâ”€â”€ package.json
â””â”€â”€ yarn.lock`},{header:"éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„ç›®å½•ç»“æ„ï¼š",slug:"éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„ç›®å½•ç»“æ„",content:`root(æœåŠ¡å™¨æ ¹ç›®å½•)
â”œâ”€â”€ child
â”‚ â”œâ”€â”€ angular11 // å­åº”ç”¨ angular11
â”‚ â”œâ”€â”€ react16 // å­åº”ç”¨ react16
â”‚ â”œâ”€â”€ react17 // å­åº”ç”¨ react17
â”‚ â”œâ”€â”€ sidebar // å­åº”ç”¨ sidebar
â”‚ â”œâ”€â”€ vite // å­åº”ç”¨ vite
â”‚ â”œâ”€â”€ vue2 // å­åº”ç”¨ vue2
â”‚ â”œâ”€â”€ vue3 // å­åº”ç”¨ vue3
â”‚ â”œâ”€â”€ nextjs11 // å­åº”ç”¨ nextjs11ï¼Œä¸ºæ¯ä¸ªä¸»åº”ç”¨å•ç‹¬æ‰“åŒ…ï¼Œç«¯å£å·ï¼š5001~5009
â”‚ â””â”€â”€ nuxtjs2 // å­åº”ç”¨ nuxtjs2ï¼Œä¸ºæ¯ä¸ªä¸»åº”ç”¨å•ç‹¬æ‰“åŒ…ï¼Œç«¯å£å·ï¼š6001~6009
â”‚ â”œâ”€â”€ main-angular11 // ä¸»åº”ç”¨ angular11
â”œâ”€â”€ main-react16 // ä¸»åº”ç”¨ react16
â”œâ”€â”€ main-react17 // ä¸»åº”ç”¨ react17
â”œâ”€â”€ main-vite // ä¸»åº”ç”¨ vite
â”œâ”€â”€ main-vue2 // ä¸»åº”ç”¨ vue2
â”œâ”€â”€ main-vue3 // ä¸»åº”ç”¨ vue3
â”œâ”€â”€ main-nextjs11 // ä¸»åº”ç”¨ nextjs11ï¼Œç›‘å¬ç«¯å£å·ï¼š5000
â”œâ”€â”€ main-nuxtjs2 // ä¸»åº”ç”¨ nuxtjs2ï¼Œç›‘å¬ç«¯å£å·ï¼š7000`},{header:"nginxé…ç½®å¦‚ä¸‹ï¼š",slug:"nginxé…ç½®å¦‚ä¸‹",content:`ä»¥ä¸‹é…ç½®ä»…ä¾›å‚è€ƒï¼Œå…·ä½“é¡¹ç›®æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ã€‚
# micro-zoe.com ç›¸å…³é…ç½®
server { listen 80; server_name www.micro-zoe.com micro-zoe.com; location / { root /root/mygit/micro-zoe; index index.php index.html index.htm; # add_header Cache-Control; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } } # ä¸»åº”ç”¨main-angular11 location /main-angular11 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-angular11/index.html; } # ä¸»åº”ç”¨main-react16 location /main-react16 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-react16/index.html; } # ä¸»åº”ç”¨main-react17 location /main-react17 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-react17/index.html; } # ä¸»åº”ç”¨main-vite location /main-vite { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-vite/index.html; } # ä¸»åº”ç”¨main-vue2 location /main-vue2 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-vue2/index.html; } # ä¸»åº”ç”¨main-vue3 location /main-vue3 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-vue3/index.html; } # å­åº”ç”¨child-angular11 location /child/angular11 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/angular11/index.html; } # å­åº”ç”¨child-react16 location /child/react16 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/react16/index.html; } # å­åº”ç”¨child-react17 location /child/react17 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/react17/index.html; } # å­åº”ç”¨child-sidebar location /child/sidebar { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/sidebar/index.html; } # å­åº”ç”¨child-vite location /child/vite { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/vite/index.html; } # å­åº”ç”¨child-vue2 location /child/vue2 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/vue2/index.html; } # å­åº”ç”¨child-vue3 location /child/vue3 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/vue3/index.html; } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }
} # ä¸»åº”ç”¨nextjs11éƒ¨ç½²åç›‘å¬5000ç«¯å£ï¼Œè®¾ç½®ä»£ç†æŒ‡å‘5000ç«¯å£ï¼Œåˆ™å¯ä»¥é€šè¿‡ nextjs11.micro-zoe.com è®¿é—®ä¸»åº”ç”¨
server { listen 80; server_name nextjs11.micro-zoe.com; root html; index index.html index.htm; location / { proxy_pass http://127.0.0.1:5000; proxy_set_header Host $host:80; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # add_header Cache-Control; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }
} # ä¸»åº”ç”¨nuxtjs2éƒ¨ç½²åç›‘å¬7000ç«¯å£ï¼Œè®¾ç½®ä»£ç†æŒ‡å‘7000ç«¯å£ï¼Œåˆ™å¯ä»¥é€šè¿‡ nuxtjs2.micro-zoe.com è®¿é—®ä¸»åº”ç”¨
server { listen 80; server_name nuxtjs2.micro-zoe.com; root html; index index.html index.htm; location / { proxy_pass http://127.0.0.1:7000; proxy_set_header Host $host:80; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # add_header Cache-Control; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }
}`},{header:"çº¿ä¸Šæ•ˆæœå¦‚ä¸‹ï¼š",slug:"çº¿ä¸Šæ•ˆæœå¦‚ä¸‹",content:`main-vue2ï¼šhttp://www.micro-zoe.com/main-vue2/
main-nextjs11ï¼šhttp://nextjs11.micro-zoe.com/
main-nuxtjs2ï¼šhttp://nuxtjs2.micro-zoe.com/`}]},{path:"/zh/dom-scope.html",title:"å…ƒç´ éš”ç¦»",pathLocale:"/",contents:[{header:"å…ƒç´ éš”ç¦»",slug:"å…ƒç´ éš”ç¦»",content:`å…ƒç´ éš”ç¦»çš„æ¦‚å¿µæ¥è‡ªShadowDomï¼Œå³ShadowDomä¸­çš„å…ƒç´ å¯ä»¥å’Œå¤–éƒ¨çš„å…ƒç´ é‡å¤ä½†ä¸ä¼šå†²çªï¼Œmicro-appæ¨¡æ‹Ÿå®ç°äº†ç±»ä¼¼ShadowDomçš„åŠŸèƒ½ï¼Œå…ƒç´ ä¸ä¼šé€ƒç¦»<micro-app>å…ƒç´ è¾¹ç•Œï¼Œå­åº”ç”¨åªèƒ½å¯¹è‡ªèº«çš„å…ƒç´ è¿›è¡Œå¢ã€åˆ ã€æ”¹ã€æŸ¥çš„æ“ä½œã€‚
ä¸¾ä¸ªæ —å­ğŸŒ° :
ä¸»åº”ç”¨å’Œå­åº”ç”¨éƒ½æœ‰ä¸€ä¸ªå…ƒç´ <div id='root'></div>ï¼Œæ­¤æ—¶å­åº”ç”¨é€šè¿‡document.querySelector('#root')è·å–åˆ°çš„æ˜¯è‡ªå·±å†…éƒ¨çš„#rootå…ƒç´ ï¼Œè€Œä¸æ˜¯ä¸»åº”ç”¨çš„ã€‚
ä¸»åº”ç”¨å¯ä»¥è·å–å­åº”ç”¨çš„å…ƒç´ å—ï¼Ÿ
å¯ä»¥çš„ï¼
è¿™ä¸€ç‚¹å’ŒShadowDomä¸åŒï¼Œåœ¨å¾®å‰ç«¯ä¸‹ä¸»åº”ç”¨æ‹¥æœ‰ç»Ÿç­¹å…¨å±€çš„ä½œç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰å¯¹ä¸»åº”ç”¨æ“ä½œå­åº”ç”¨å…ƒç´ çš„è¡Œä¸ºè¿›è¡Œé™åˆ¶ã€‚`},{header:"è§£é™¤å…ƒç´ ç»‘å®š",slug:"è§£é™¤å…ƒç´ ç»‘å®š",content:`é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å­åº”ç”¨æ“ä½œå…ƒç´ æ—¶ä¼šç»‘å®šå…ƒç´ ä½œç”¨åŸŸï¼Œè€Œè§£ç»‘è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ“ä½œå…ƒç´ å¼‚å¸¸ï¼Œæ­¤æ—¶æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
æ–¹å¼ä¸€ï¼šæ‰§è¡ŒremoveDomScope
removeDomScopeæ–¹æ³•å¯ä»¥è§£é™¤å…ƒç´ ç»‘å®šï¼Œé€šå¸¸ç”¨äºå—å­åº”ç”¨å…ƒç´ ç»‘å®šå½±å“ï¼Œå¯¼è‡´ä¸»åº”ç”¨å…ƒç´ é”™è¯¯ç»‘å®šåˆ°å­åº”ç”¨çš„æƒ…å†µã€‚
å…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š import { removeDomScope } from '@micro-zoe/micro-app' // è§£é™¤å…ƒç´ ç»‘å®šï¼Œå¹¶ä¸”ä¸€å®šæ—¶é—´å†…(ä¸€ä¸ªå¾®ä»»åŠ¡Promiseæ—¶é—´)é˜»æ­¢å†æ¬¡ç»‘å®š
removeDomScope(true) const div = window.document.createElement('div')
// æ’å…¥åˆ°ä¸»åº”ç”¨bodyä¸­
document.body.appendChild(div) // è§£é™¤å…ƒç´ ç»‘å®šï¼Œå¹¶ä¸”ä¸€å®šæ—¶é—´å†…(ä¸€ä¸ªå¾®ä»»åŠ¡Promiseæ—¶é—´)é˜»æ­¢å†æ¬¡ç»‘å®š
window.microApp.removeDomScope(true) const div = window.rawDocument.createElement('div')
// æ’å…¥åˆ°ä¸»åº”ç”¨bodyä¸­
document.body.appendChild(div) æ–¹å¼äºŒï¼šä½¿ç”¨setTimeout // ç­‰å¾…è§£ç»‘ç»“æŸåæ“ä½œå…ƒç´ 
setTimeout(() => { const div = window.document.createElement('div') // æ’å…¥åˆ°ä¸»åº”ç”¨bodyä¸­ document.body.appendChild(div) }, 0) // è®°å½•ä¸»åº”ç”¨document
const rawDocument = window.rawDocument // ç­‰å¾…è§£ç»‘ç»“æŸåæ“ä½œå…ƒç´ 
setTimeout(() => { const div = rawDocument.createElement('div') // æ’å…¥åˆ°ä¸»åº”ç”¨bodyä¸­ rawDocument.body.appendChild(div) }, 0)`}]},{path:"/zh/env.html",title:"ç¯å¢ƒå˜é‡",pathLocale:"/",contents:[{header:"ç¯å¢ƒå˜é‡",slug:"ç¯å¢ƒå˜é‡",content:""},{header:"__MICRO_APP_ENVIRONMENT__",slug:"micro-app-environment",content:`æè¿°ï¼šåˆ¤æ–­åº”ç”¨æ˜¯å¦åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­
åœ¨å­åº”ç”¨ä¸­é€šè¿‡ window.__MICRO_APP_ENVIRONMENT__ åˆ¤æ–­æ˜¯å¦åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­ã€‚
if (window.__MICRO_APP_ENVIRONMENT__) { console.log('æˆ‘åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­')
}`},{header:"__MICRO_APP_NAME__",slug:"micro-app-name",content:`æè¿°ï¼šåº”ç”¨åç§°
åœ¨å­åº”ç”¨ä¸­é€šè¿‡ window.__MICRO_APP_NAME__ è·å–åº”ç”¨çš„nameå€¼ï¼Œå³<micro-app>æ ‡ç­¾çš„nameå€¼ã€‚`},{header:"__MICRO_APP_PUBLIC_PATH__",slug:"micro-app-public-path",content:`æè¿°ï¼šå­åº”ç”¨çš„é™æ€èµ„æºå‰ç¼€
ç”¨äºè®¾ç½®webpackåŠ¨æ€public-pathï¼Œå°†å­åº”ç”¨çš„é™æ€èµ„æºè¡¥å…¨ä¸º http å¼€å¤´çš„ç»å¯¹åœ°å€ã€‚
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
if (window.__MICRO_APP_ENVIRONMENT__) { __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨çš„å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
import './public-path'`},{header:"__MICRO_APP_BASE_ROUTE__",slug:"micro-app-base-route",content:`æè¿°ï¼šå­åº”ç”¨çš„åŸºç¡€è·¯ç”±
è¯¦æƒ…è§è·¯ç”±-åŸºç¡€è·¯ç”±ä¸€ç« ã€‚`},{header:"__MICRO_APP_BASE_APPLICATION__",slug:"micro-app-base-application",content:`æè¿°ï¼šåˆ¤æ–­åº”ç”¨æ˜¯å¦æ˜¯ä¸»åº”ç”¨
åœ¨æ‰§è¡ŒmicroApp.start()åæ­¤å€¼æ‰ä¼šç”Ÿæ•ˆ
if (window.__MICRO_APP_BASE_APPLICATION__) { console.log('æˆ‘æ˜¯ä¸»åº”ç”¨')
}`}]},{path:"/zh/jump.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:"æ¯ä¸ªåº”ç”¨çš„è·¯ç”±å®ä¾‹éƒ½æ˜¯ä¸åŒçš„ï¼Œåº”ç”¨çš„è·¯ç”±å®ä¾‹åªèƒ½æ§åˆ¶è‡ªèº«ï¼Œæ— æ³•å½±å“å…¶å®ƒåº”ç”¨ï¼ŒåŒ…æ‹¬ä¸»åº”ç”¨æ— æ³•é€šè¿‡æ§åˆ¶è‡ªèº«è·¯ç”±å½±å“åˆ°å­åº”ç”¨ã€‚ å¸¸è§çš„é—®é¢˜å¦‚ï¼šå¼€å‘è€…æƒ³é€šè¿‡ä¸»åº”ç”¨çš„ä¾§è¾¹æ è·³è½¬ï¼Œä»è€Œæ§åˆ¶å­åº”ç”¨çš„é¡µé¢ï¼Œè¿™å…¶å®æ˜¯åšä¸åˆ°çš„ï¼Œåªæœ‰å­åº”ç”¨çš„è·¯ç”±å®ä¾‹å¯ä»¥æ§åˆ¶è‡ªèº«çš„é¡µé¢ã€‚ è¦å®ç°åº”ç”¨ä¹‹é—´çš„è·³è½¬æœ‰ä¸¤ç§æ–¹å¼ï¼š"},{header:"æ–¹å¼ä¸€ã€window.history",slug:"æ–¹å¼ä¸€ã€window-history",content:`é€šè¿‡history.pushStateæˆ–history.replaceStateè¿›è¡Œè·³è½¬ã€‚
ä¾‹å¦‚ï¼š
window.history.pushState(history.state, '', 'page2') // ä¸»åŠ¨è§¦å‘ä¸€æ¬¡popstateäº‹ä»¶
window.dispatchEvent(new PopStateEvent('popstate', { state: history.state }))
å¯¹äºhashè·¯ç”±ä¹ŸåŒæ ·é€‚ç”¨
window.history.pushState(history.state, '', '#/page2') // ä¸»åŠ¨è§¦å‘ä¸€æ¬¡popstateäº‹ä»¶
window.dispatchEvent(new PopStateEvent('popstate', { state: history.state }))
æ³¨æ„äº‹é¡¹ popstateäº‹ä»¶æ˜¯å…¨å±€å‘é€çš„ï¼Œæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åº”ç”¨éƒ½ä¼šæ¥å—åˆ°æ–°çš„è·¯ç”±åœ°å€å¹¶è¿›è¡ŒåŒ¹é…ï¼Œè¦é˜²æ­¢å…œåº•åˆ°åº”ç”¨çš„404é¡µé¢ã€‚
window.historyå¹¶éé€‚ç”¨äºæ‰€æœ‰åœºæ™¯ï¼Œä¸€äº›æ¡†æ¶å¦‚vue-router4ï¼Œangularä¼šå‡ºç°é—®é¢˜ï¼Œæ­¤æ—¶å»ºè®®ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼2ã€3ã€‚`},{header:"æ–¹å¼äºŒã€é€šè¿‡æ•°æ®é€šä¿¡æ§åˆ¶è·³è½¬",slug:"æ–¹å¼äºŒã€é€šè¿‡æ•°æ®é€šä¿¡æ§åˆ¶è·³è½¬",content:`é€‚ç”¨åœºæ™¯: ä¸»åº”ç”¨æ§åˆ¶å­åº”ç”¨è·³è½¬
å­åº”ç”¨ä¸­ç›‘å¬æ•°æ®å˜åŒ–
// ç›‘å¬ä¸»åº”ç”¨ä¸‹å‘çš„æ•°æ®å˜åŒ–
window.microApp.addDataListener((data) => { // å½“ä¸»åº”ç”¨ä¸‹å‘è·³è½¬æŒ‡ä»¤æ—¶è¿›è¡Œè·³è½¬ if (data.path) { router.push(data.path) }
})
ä¸»åº”ç”¨ä¸‹å‘è·³è½¬æŒ‡ä»¤
import microApp from '@micro-zoe/micro-app' microApp.setData('å­åº”ç”¨name', { path: '/new-path/' })`},{header:"æ–¹å¼ä¸‰ã€ä¼ é€’è·¯ç”±å®ä¾‹æ–¹æ³•",slug:"æ–¹å¼ä¸‰ã€ä¼ é€’è·¯ç”±å®ä¾‹æ–¹æ³•",content:`é€‚ç”¨åœºæ™¯: å­åº”ç”¨æ§åˆ¶ä¸»åº”ç”¨è·³è½¬
ä¸»åº”ç”¨ä¸‹å‘pushStateå‡½æ•°ï¼š import { useEffect } from 'react'
import { useHistory } from 'react-router-dom'
import microApp, { removeDomScope } from '@micro-zoe/micro-app' export default () => { const history = useHistory() function pushState (path) { removeDomScope() history.push(path) } useEffect(() => { // ğŸ‘‡ ä¸»åº”ç”¨å‘å­åº”ç”¨ä¸‹å‘ä¸€ä¸ªåä¸ºpushStateçš„æ–¹æ³• microApp.setData(å­åº”ç”¨åç§°, { pushState }) }, []) return ( <div> <micro-app name='å­åº”ç”¨åç§°' url='url'></micro-app> </div> )
} <template> <micro-app name='å­åº”ç”¨åç§°' url='url' :data='microAppData' ></micro-app>
</template> <script>
import { removeDomScope } from '@micro-zoe/micro-app' export default { data () { return { microAppData: { pushState: (path) => { removeDomScope() this.$router.push(path) } } } },
}
<\/script> å­åº”ç”¨ä½¿ç”¨pushStateæ§åˆ¶ä¸»åº”ç”¨è·³è½¬ï¼š
window.microApp.getData().pushState(path)`}]},{path:"/zh/keep-alive.html",title:"keep-alive",pathLocale:"/",contents:[{header:"keep-alive",slug:"keep-alive",content:`åœ¨åº”ç”¨ä¹‹é—´åˆ‡æ¢æ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šæƒ³ä¿ç•™è¿™äº›åº”ç”¨çš„çŠ¶æ€ï¼Œä»¥ä¾¿æ¢å¤ç”¨æˆ·çš„æ“ä½œè¡Œä¸ºå’Œæå‡é‡å¤æ¸²æŸ“çš„æ€§èƒ½ï¼Œæ­¤æ—¶å¼€å¯keep-aliveæ¨¡å¼å¯ä»¥è¾¾åˆ°è¿™æ ·çš„æ•ˆæœã€‚
å¼€å¯keep-aliveåï¼Œåº”ç”¨å¸è½½æ—¶ä¸ä¼šé”€æ¯ï¼Œè€Œæ˜¯æ¨å…¥åå°è¿è¡Œã€‚`},{header:"ä½¿ç”¨æ–¹å¼",slug:"ä½¿ç”¨æ–¹å¼",content:"<micro-app name='xx' url='xx' keep-alive></micro-app>"},{header:"ç”Ÿå‘½å‘¨æœŸ",slug:"ç”Ÿå‘½å‘¨æœŸ",content:`keep-aliveæ¨¡å¼ä¸æ™®é€šæ¨¡å¼æœ€å¤§çš„ä¸åŒæ˜¯ç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºå®ƒä¸ä¼šè¢«çœŸæ­£çš„å¸è½½ï¼Œä¹Ÿå°±ä¸ä¼šè§¦å‘ unmount äº‹ä»¶ã€‚
ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š`},{header:"ä¸»åº”ç”¨",slug:"ä¸»åº”ç”¨",content:""},{header:"1. created",slug:"_1-created",content:"<micro-app>æ ‡ç­¾åˆå§‹åŒ–åï¼ŒåŠ è½½èµ„æºå‰è§¦å‘ã€‚"},{header:"2. beforemount",slug:"_2-beforemount",content:"åŠ è½½èµ„æºå®Œæˆåï¼Œå¼€å§‹æ¸²æŸ“ä¹‹å‰è§¦å‘(åªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡)ã€‚"},{header:"3. mounted",slug:"_3-mounted",content:"å­åº”ç”¨æ¸²æŸ“ç»“æŸåè§¦å‘(åªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡)ã€‚"},{header:"4. error",slug:"_4-error",content:"å­åº”ç”¨æ¸²æŸ“å‡ºé”™æ—¶è§¦å‘ï¼Œåªæœ‰ä¼šå¯¼è‡´æ¸²æŸ“ç»ˆæ­¢çš„é”™è¯¯æ‰ä¼šè§¦å‘æ­¤ç”Ÿå‘½å‘¨æœŸã€‚"},{header:"5. afterhidden",slug:"_5-afterhidden",content:"å­åº”ç”¨æ¨å…¥åå°æ—¶è§¦å‘ã€‚"},{header:"6. beforeshow",slug:"_6-beforeshow",content:"å­åº”ç”¨æ¨å…¥å‰å°ä¹‹å‰è§¦å‘(åˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ)ã€‚"},{header:"7. aftershow",slug:"_7-aftershow",content:"å­åº”ç”¨æ¨å…¥å‰å°ä¹‹åè§¦å‘(åˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ)ã€‚"},{header:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",slug:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",content:`å› ä¸ºReactä¸æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>æ ‡ç­¾æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfillï¼Œæ³¨é‡Šä¹Ÿè¦å¤åˆ¶ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='xx' url='xx' onCreated={() => console.log('micro-appå…ƒç´ è¢«åˆ›å»º')} onBeforemount={() => console.log('å³å°†è¢«æ¸²æŸ“ï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡')} onMounted={() => console.log('å·²ç»æ¸²æŸ“å®Œæˆï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡')} onAfterhidden={() => console.log('å·²æ¨å…¥åå°')} onBeforeshow={() => console.log('å³å°†æ¨å…¥å‰å°ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ')} onAftershow={() => console.log('å·²ç»æ¨å…¥å‰å°ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ')} onError={() => console.log('æ¸²æŸ“å‡ºé”™')}
/> vueä¸­ç›‘å¬æ–¹å¼å’Œæ™®é€šäº‹ä»¶ä¸€è‡´ã€‚
<template> <micro-app name='xx' url='xx' @created='created' @beforemount='beforemount' @mounted='mounted' @afterhidden='afterhidden' @beforeshow='beforeshow' @aftershow='aftershow' @error='error' />
</template> <script>
export default { methods: { created () { console.log('micro-appå…ƒç´ è¢«åˆ›å»º'), }, beforemount () { console.log('å³å°†è¢«æ¸²æŸ“ï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡'), }, mounted () { console.log('å·²ç»æ¸²æŸ“å®Œæˆï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡'), }, afterhidden () { console.log('å·²æ¨å…¥åå°'), }, beforeshow () { console.log('å³å°†æ¨å…¥å‰å°ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ'), }, aftershow () { console.log('å·²ç»æ¨å…¥å‰å°ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ'), }, error () { console.log('æ¸²æŸ“å‡ºé”™'), } }
}
<\/script>`},{header:"å­åº”ç”¨",slug:"å­åº”ç”¨",content:`keep-aliveæ¨¡å¼ä¸‹ï¼Œåœ¨å­åº”ç”¨å¸è½½ã€é‡æ–°æ¸²æŸ“æ—¶ï¼Œmicro-appéƒ½ä¼šå‘å­åº”ç”¨å‘é€åä¸ºappstate-changeçš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡ç›‘å¬è¯¥äº‹ä»¶è·å–å½“å‰çŠ¶æ€ï¼ŒçŠ¶æ€å€¼å¯ä»¥é€šè¿‡äº‹ä»¶å¯¹è±¡å±æ€§e.detail.appStateè·å–ã€‚
e.detail.appStateçš„å€¼æœ‰ä¸‰ä¸ªï¼šafterhiddenã€beforeshowã€aftershowï¼Œåˆ†åˆ«å¯¹åº”å¸è½½ã€å³å°†æ¸²æŸ“ã€å·²ç»æ¸²æŸ“ã€‚
// ç›‘å¬keep-aliveæ¨¡å¼ä¸‹çš„åº”ç”¨çŠ¶æ€
window.addEventListener('appstate-change', function (e) { if (e.detail.appState === 'afterhidden') { console.log('å·²å¸è½½') } else if (e.detail.appState === 'beforeshow') { console.log('å³å°†é‡æ–°æ¸²æŸ“') } else if (e.detail.appState === 'aftershow') { console.log('å·²ç»é‡æ–°æ¸²æŸ“') }
})
åº”ç”¨åˆå§‹åŒ–æ—¶ä¸ä¼šè§¦å‘appstate-changeäº‹ä»¶ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€å¦‚ä½•æ¢å¤é¡µé¢æ»šåŠ¨ä½ç½®ï¼Ÿ",slug:"_1ã€å¦‚ä½•æ¢å¤é¡µé¢æ»šåŠ¨ä½ç½®",content:"micro-appä¸ä¼šè®°å½•é¡µé¢æ»šåŠ¨ä½ç½®ï¼Œåº”ç”¨å†æ¬¡æ¸²æŸ“æ—¶ä¹Ÿä¸ä¼šè¿›è¡Œæ¢å¤ï¼Œéœ€è¦å¼€å‘è€…è¿›è¡Œè®°å½•å’Œæ¢å¤ã€‚"},{header:"2ã€å­åº”ç”¨å†…éƒ¨é¡µé¢åˆ‡æ¢åçŠ¶æ€ä¸¢å¤±",slug:"_2ã€å­åº”ç”¨å†…éƒ¨é¡µé¢åˆ‡æ¢åçŠ¶æ€ä¸¢å¤±",content:"micro-appçš„keep-aliveæ˜¯åº”ç”¨çº§åˆ«çš„ï¼Œå®ƒåªä¼šä¿ç•™å½“å‰æ­£åœ¨æ´»åŠ¨çš„é¡µé¢çŠ¶æ€ï¼Œå¦‚æœæƒ³è¦ç¼“å­˜å…·ä½“çš„é¡µé¢æˆ–ç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨å­åº”ç”¨æ¡†æ¶çš„èƒ½åŠ›ï¼Œå¦‚ï¼švueçš„keep-aliveã€‚"}]},{path:"/zh/life-cycles.html",title:"ç”Ÿå‘½å‘¨æœŸ",pathLocale:"/",contents:[{header:"ç”Ÿå‘½å‘¨æœŸ",slug:"ç”Ÿå‘½å‘¨æœŸ",content:"micro-appé€šè¿‡CustomEventå®šä¹‰ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­ä¼šè§¦å‘ç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚"},{header:"ç”Ÿå‘½å‘¨æœŸåˆ—è¡¨",slug:"ç”Ÿå‘½å‘¨æœŸåˆ—è¡¨",content:""},{header:"1. created",slug:"_1-created",content:"<micro-app>æ ‡ç­¾åˆå§‹åŒ–åï¼ŒåŠ è½½èµ„æºå‰è§¦å‘ã€‚"},{header:"2. beforemount",slug:"_2-beforemount",content:"åŠ è½½èµ„æºå®Œæˆåï¼Œå¼€å§‹æ¸²æŸ“ä¹‹å‰è§¦å‘ã€‚"},{header:"3. mounted",slug:"_3-mounted",content:"å­åº”ç”¨æ¸²æŸ“ç»“æŸåè§¦å‘ã€‚"},{header:"4. unmount",slug:"_4-unmount",content:"å­åº”ç”¨å¸è½½æ—¶è§¦å‘ã€‚"},{header:"5. error",slug:"_5-error",content:"å­åº”ç”¨æ¸²æŸ“å‡ºé”™æ—¶è§¦å‘ï¼Œåªæœ‰ä¼šå¯¼è‡´æ¸²æŸ“ç»ˆæ­¢çš„é”™è¯¯æ‰ä¼šè§¦å‘æ­¤ç”Ÿå‘½å‘¨æœŸã€‚"},{header:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",slug:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",content:`å› ä¸ºReactä¸æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>æ ‡ç­¾æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfillï¼Œæ³¨é‡Šä¹Ÿè¦å¤åˆ¶ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='xx' url='xx' onCreated={() => console.log('micro-appå…ƒç´ è¢«åˆ›å»º')} onBeforemount={() => console.log('å³å°†è¢«æ¸²æŸ“')} onMounted={() => console.log('å·²ç»æ¸²æŸ“å®Œæˆ')} onUnmount={() => console.log('å·²ç»å¸è½½')} onError={() => console.log('æ¸²æŸ“å‡ºé”™')}
/> vueä¸­ç›‘å¬æ–¹å¼å’Œæ™®é€šäº‹ä»¶ä¸€è‡´ã€‚
<template> <micro-app name='xx' url='xx' @created='created' @beforemount='beforemount' @mounted='mounted' @unmount='unmount' @error='error' />
</template> <script>
export default { methods: { created () { console.log('micro-appå…ƒç´ è¢«åˆ›å»º') }, beforemount () { console.log('å³å°†è¢«æ¸²æŸ“') }, mounted () { console.log('å·²ç»æ¸²æŸ“å®Œæˆ') }, unmount () { console.log('å·²ç»å¸è½½') }, error () { console.log('æ¸²æŸ“å‡ºé”™') } }
}
<\/script> æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚
const myApp = document.querySelector('micro-app[name=my-app]') myApp.addEventListener('created', () => { console.log('created')
}) myApp.addEventListener('beforemount', () => { console.log('beforemount')
}) myApp.addEventListener('mounted', () => { console.log('mounted')
}) myApp.addEventListener('unmount', () => { console.log('unmount')
}) myApp.addEventListener('error', () => { console.log('error')
})`},{header:"å…¨å±€ç›‘å¬",slug:"å…¨å±€ç›‘å¬",content:`å…¨å±€ç›‘å¬ä¼šåœ¨æ¯ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œæ—¶éƒ½ä¼šè§¦å‘ã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ lifeCycles: { created (e) { console.log('created') }, beforemount (e) { console.log('beforemount') }, mounted (e) { console.log('mounted') }, unmount (e) { console.log('unmount') }, error (e) { console.log('error') } }
})`},{header:"å…¨å±€äº‹ä»¶",slug:"å…¨å±€äº‹ä»¶",content:"åœ¨å­åº”ç”¨çš„åŠ è½½è¿‡ç¨‹ä¸­ï¼Œmicro-appä¼šå‘å­åº”ç”¨å‘é€ä¸€ç³»åˆ—äº‹ä»¶ï¼ŒåŒ…æ‹¬æ¸²æŸ“ã€å¸è½½ç­‰äº‹ä»¶ã€‚"},{header:"æ¸²æŸ“äº‹ä»¶",slug:"æ¸²æŸ“äº‹ä»¶",content:`é€šè¿‡å‘windowæ³¨å†Œonmountå‡½æ•°ï¼Œå¯ä»¥ç›‘å¬å­åº”ç”¨çš„æ¸²æŸ“äº‹ä»¶ã€‚
/** * åº”ç”¨æ¸²æŸ“æ—¶æ‰§è¡Œ * @param data åˆå§‹åŒ–æ•°æ® */
window.onmount = (data) => { console.log('å­åº”ç”¨å·²ç»æ¸²æŸ“', data)
}`},{header:"å¸è½½äº‹ä»¶",slug:"å¸è½½äº‹ä»¶",content:`é€šè¿‡å‘windowæ³¨å†Œonunmountå‡½æ•°ï¼Œå¯ä»¥ç›‘å¬å­åº”ç”¨çš„å¸è½½äº‹ä»¶ã€‚
/** * åº”ç”¨å¸è½½æ—¶æ‰§è¡Œ */
window.onunmount = () => { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ console.log('å­åº”ç”¨å·²ç»å¸è½½')
}
è¿˜å¯ä»¥é€šè¿‡window.addEventListenerç›‘å¬å­åº”ç”¨çš„å¸è½½äº‹ä»¶unmountã€‚
window.addEventListener('unmount', function () { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ console.log('å­åº”ç”¨å·²ç»å¸è½½')
})`}]},{path:"/zh/micro-app-devtools.html",title:"ğŸ“–ç®€ä»‹",pathLocale:"/",contents:[{header:"ğŸ“–ç®€ä»‹",slug:"ğŸ“–ç®€ä»‹",content:`Micro-App-DevToolsæ˜¯åŸºäºäº¬ä¸œé›¶å”®æ¨å‡ºçš„ä¸€æ¬¾ä¸ºmicro-appæ¡†æ¶è€Œå¼€å‘çš„chromeæ’ä»¶ï¼Œæ—¨åœ¨æ–¹ä¾¿å¼€å‘è€…å¯¹å¾®å‰ç«¯è¿›è¡Œæ•°æ®æŸ¥çœ‹ä»¥åŠè°ƒè¯•,æå‡å·¥ä½œæ•ˆç‡ã€‚
Github åœ°å€ä¸ºï¼šhttps://github.com/micro-zoe/micro-app-chrome-pluginï¼Œæ¬¢è¿ Star ä¸€ä¸‹`},{header:"å¦‚ä½•ä½¿ç”¨",slug:"å¦‚ä½•ä½¿ç”¨",content:"ä¸‹è½½æ’ä»¶åœ°å€ï¼Œï¼ˆæç¤ºï¼šæ— éœ€è§£å‹ï¼‰ï¼Œåœ¨chromeä¸­è¾“å…¥chrome://extensionsæ‰“å¼€æ‰©å±•ç¨‹åºï¼Œå°†å·²ä¸‹è½½çš„æ’ä»¶æ‹–å…¥ã€‚"},{header:"åŠŸèƒ½",slug:"åŠŸèƒ½",content:"æ‰“å¼€æ§åˆ¶å°ï¼Œé€‰ä¸­Micro app"},{header:"1ã€Environmentç¯å¢ƒ",slug:"_1ã€environmentç¯å¢ƒ",content:`å¯æŸ¥çœ‹Micro appçš„Environmentç¯å¢ƒå¦‚ä¸‹
'__MICRO_APP_ENVIRONMENT__': 'åˆ¤æ–­åº”ç”¨æ˜¯å¦åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­'
'__MICRO_APP_VERSION__': 'å¾®å‰ç«¯ç‰ˆæœ¬å·'
'__MICRO_APP_NAME__': 'åº”ç”¨åç§°'
'__MICRO_APP_PUBLIC_PATH__': 'å­åº”ç”¨çš„é™æ€èµ„æºå‰ç¼€'
'__MICRO_APP_BASE_ROUTE__': 'å­åº”ç”¨çš„åŸºç¡€è·¯ç”±'`},{header:"2ã€Communicateé€šè®¯",slug:"_2ã€communicateé€šè®¯",content:`æŸ¥çœ‹çˆ¶å­åº”ç”¨é€šè®¯
æ•°æ®é€šä¿¡é¢æ¿`},{header:"åŠŸèƒ½ä¸€ã€è·å–çˆ¶åº”ç”¨æ•°æ®",slug:"åŠŸèƒ½ä¸€ã€è·å–çˆ¶åº”ç”¨æ•°æ®",content:"ç‚¹å‡»æŒ‰é’®è·å–å½“å‰è¢«åµŒå…¥é¡µé¢åŸºåº§åº”ç”¨çš„JSONæ ¼å¼æ•°æ®"},{header:"åŠŸèƒ½äºŒã€å­åº”ç”¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿ",slug:"åŠŸèƒ½äºŒã€å­åº”ç”¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿ",content:`ç‚¹å‡»æŒ‰é’®è·³è½¬è‡³åŠŸèƒ½ä¸€ä¸­å­åº”ç”¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿé¡µé¢ï¼Œæ­¤å¤„æ¨¡ä»¿å†…åµŒå­åº”ç”¨ï¼Œä½¿ç”¨è¯´æ˜å¦‚ä¸‹æ‰€ç¤ºï¼š
åœ¨å­åº”ç”¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿé¡µé¢ä¸­è¾“å…¥å­é¡µé¢URLç­‰ä¿¡æ¯ aã€å­é¡µé¢URLï¼šæ­¤å¤„è¾“å…¥è¢«åŸºåº§åº”ç”¨åµŒå…¥çš„å­åº”ç”¨é“¾æ¥ bã€çˆ¶åº”ç”¨æ•°æ®ï¼šæ­¤å¤„è¾“å…¥JSONæ ¼å¼çš„çˆ¶åº”ç”¨éœ€è¦ä¼ ç»™å­åº”ç”¨çš„æ•°æ® cã€å­åº”ç”¨åµŒå…¥ä»£ç ï¼šæ­¤å¤„æ˜¾ç¤ºå­åº”ç”¨åµŒå…¥çš„ä»£ç  ä»¥ä¸Šå³å®Œæˆå¾®å‰ç«¯çš„åµŒå…¥ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š`},{header:"å¿«æ·æ‰“å¼€æ–¹å¼ä¸€",slug:"å¿«æ·æ‰“å¼€æ–¹å¼ä¸€",content:'ç‚¹å‡»å³ä¸Šè§’å›¾æ ‡å‡ºç°ç›®å½•,é€‰æ‹©"æ‰“å¼€å­åº”ç”¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿ"'},{header:"å¿«æ·æ‰“å¼€æ–¹å¼äºŒ",slug:"å¿«æ·æ‰“å¼€æ–¹å¼äºŒ",content:"ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹©micro-appä¸‹ï¼ŒäºŒçº§èœå•ç‚¹å­åº”ç”¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿ"},{header:"3ã€Viewå­åº”ç”¨è§†å›¾",slug:"_3ã€viewå­åº”ç”¨è§†å›¾",content:"æŸ¥çœ‹å­åº”ç”¨ç›¸å…³è§†å›¾ä¿¡æ¯"},{header:"æŸ¥çœ‹å­åº”ç”¨èŒƒå›´",slug:"æŸ¥çœ‹å­åº”ç”¨èŒƒå›´",content:"ç‚¹å‡»æŒ‰é’®å³å¯è·å–å½“å‰è¢«åµŒå…¥é¡µé¢åŸºåº§åº”ç”¨çš„è§†å›¾"},{header:"å¿«æ·æ‰“å¼€æ–¹å¼",slug:"å¿«æ·æ‰“å¼€æ–¹å¼",content:"ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹©micro-appä¸‹ï¼ŒäºŒçº§èœå•ç‚¹å‡»æŸ¥çœ‹å­åº”ç”¨èŒƒå›´"},{header:"4ã€Routeè·¯ç”±",slug:"_4ã€routeè·¯ç”±",content:"æŸ¥çœ‹å­åº”ç”¨è·¯ç”±ä¿¡æ¯"},{header:"åŠŸèƒ½ä¸€ã€è·å–å­åº”ç”¨è·¯ç”±",slug:"åŠŸèƒ½ä¸€ã€è·å–å­åº”ç”¨è·¯ç”±",content:"ç‚¹å‡»æŸ¥çœ‹å­åº”ç”¨URLæŒ‰é’®å³å¯è·å–å½“å‰é¡µé¢ä¸‹æ‰€æœ‰å­åº”ç”¨çš„è·¯ç”±åœ°å€"},{header:"åŠŸèƒ½äºŒã€å¤åˆ¶åŠæ‰“å¼€å­åº”ç”¨è·¯ç”±é“¾æ¥",slug:"åŠŸèƒ½äºŒã€å¤åˆ¶åŠæ‰“å¼€å­åº”ç”¨è·¯ç”±é“¾æ¥",content:"ç‚¹å‡»å¤åˆ¶æŒ‰é’®å¤åˆ¶å­åº”ç”¨è·¯ç”±ï¼Œç‚¹å‡»æ‰“å¼€æŒ‰é’®ç›´æ¥åœ¨æµè§ˆå™¨æ‰“å¼€å­åº”ç”¨é“¾æ¥åœ°å€"},{header:"ğŸ¤ å‚ä¸å…±å»º",slug:"ğŸ¤-å‚ä¸å…±å»º",content:`å¦‚æœæ‚¨å¯¹è¿™ä¸ªé¡¹ç›®æ„Ÿå…´è¶£ï¼Œæ¬¢è¿æpull requestå‚ä¸è´¡çŒ®ï¼Œä¹Ÿæ¬¢è¿ Star æ”¯æŒä¸€ä¸‹ ^_^
æ¬¢è¿å°ä¼™ä¼´ä»¬åŠ å…¥Micro-App-DevToolså¾®ä¿¡ç¾¤äº¤æµ^ ^`}]},{path:"/zh/nest.html",title:"å¤šå±‚åµŒå¥—",pathLocale:"/",contents:[{header:"å¤šå±‚åµŒå¥—",slug:"å¤šå±‚åµŒå¥—",content:`micro-appæ”¯æŒå¤šå±‚åµŒå¥—ï¼Œå³å­åº”ç”¨å¯ä»¥åµŒå…¥å…¶å®ƒå­åº”ç”¨ï¼Œä½†ä¸ºäº†é˜²æ­¢æ ‡ç­¾åå†²çªï¼Œå­åº”ç”¨ä¸­éœ€è¦åšä¸€äº›ä¿®æ”¹ã€‚
åœ¨å­åº”ç”¨ä¸­è®¾ç½®tagNameï¼š
microApp.start({ tagName: 'micro-app-xxx', // æ ‡ç­¾åç§°å¿…é¡»ä»¥ \`micro-app-\` å¼€å¤´
})
åœ¨å­åº”ç”¨ä¸­ä½¿ç”¨æ–°å®šä¹‰çš„æ ‡ç­¾è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ï¼š
<micro-app-xxx name='xx' url='xx'></micro-app-xxx>
æ³¨æ„
æ— è®ºåµŒå¥—å¤šå°‘å±‚ï¼Œnameéƒ½è¦ä¿è¯å…¨å±€å”¯ä¸€ã€‚`}]},{path:"/zh/plugins.html",title:"æ’ä»¶ç³»ç»Ÿ",pathLocale:"/",contents:[{header:"æ’ä»¶ç³»ç»Ÿ",slug:"æ’ä»¶ç³»ç»Ÿ",content:`å¾®å‰ç«¯çš„ä½¿ç”¨åœºæ™¯éå¸¸å¤æ‚ï¼Œæ²¡æœ‰å®Œç¾çš„æ²™ç®±æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ’ä»¶ç³»ç»Ÿï¼Œå®ƒèµ‹äºˆå¼€å‘è€…çµæ´»å¤„ç†é™æ€èµ„æºçš„èƒ½åŠ›ï¼Œå¯¹æœ‰é—®é¢˜çš„èµ„æºæ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚
æ’ä»¶ç³»ç»Ÿçš„ä¸»è¦ä½œç”¨å°±æ˜¯å¯¹jsè¿›è¡Œä¿®æ”¹ï¼Œæ¯ä¸€ä¸ªjsæ–‡ä»¶éƒ½ä¼šç»è¿‡æ’ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›jsè¿›è¡Œæ‹¦æˆªå’Œå¤„ç†ï¼Œå®ƒé€šå¸¸ç”¨äºä¿®å¤jsä¸­çš„é”™è¯¯æˆ–å‘å­åº”ç”¨æ³¨å…¥ä¸€äº›å…¨å±€å˜é‡ã€‚`},{header:"é€‚ç”¨åœºæ™¯",slug:"é€‚ç”¨åœºæ™¯",content:"é€šå¸¸æˆ‘ä»¬æ— æ³•æ§åˆ¶jsçš„è¡¨ç°ï¼Œæ¯”å¦‚åœ¨æ²™ç®±ä¸­ï¼Œé¡¶å±‚çš„å˜é‡æ˜¯æ— æ³•æ³„æ¼ä¸ºå…¨å±€å˜é‡çš„ï¼ˆå¦‚ var xx = , function xxx å®šä¹‰å˜é‡ï¼Œæ— æ³•é€šè¿‡window.xx è®¿é—®ï¼‰ï¼Œå¯¼è‡´jsæŠ¥é”™ï¼Œæ­¤æ—¶å¼€å‘è€…å¯ä»¥é€šè¿‡æ’ä»¶å¯¹jsè¿›è¡Œä¿®æ”¹å¤„ç†ã€‚"},{header:"ä½¿ç”¨æ–¹å¼",slug:"ä½¿ç”¨æ–¹å¼",content:"import microApp from '@micro-zoe/micro-app' microApp.start({ plugins: { // å…¨å±€æ’ä»¶ï¼Œä½œç”¨äºæ‰€æœ‰å­åº”ç”¨çš„jsæ–‡ä»¶ global?: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°ä¸»åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¿…å¡«ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å›codeå€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => code, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => code }> // å­åº”ç”¨æ’ä»¶ modules?: { // appNameä¸ºåº”ç”¨çš„åç§°ï¼Œè¿™äº›æ’ä»¶åªä¼šä½œç”¨äºæŒ‡å®šçš„åº”ç”¨ [appName: string]: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°ä¸»åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¯é€‰ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å›codeå€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => code, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => code }> } }\n})"},{header:"æ¡ˆä¾‹",slug:"æ¡ˆä¾‹",content:`import microApp from '@micro-zoe/micro-app' microApp.start({ plugins: { global: [ { scopeProperties: ['key', 'key', ...], // å¯é€‰ escapeProperties: ['key', 'key', ...], // å¯é€‰ excludeChecker: (url) => ['/foo.js', '/bar.css'].some(item => url.includes(item)), // å¯é€‰ options: é…ç½®é¡¹, // å¯é€‰ loader(code, url, options, info) { // å¯é€‰ console.log('å…¨å±€æ’ä»¶') return code }, processHtml(code, url, options, info) { // å¯é€‰ console.log('æ¯ä¸ªå­åº”ç”¨ HTML éƒ½ä¼šä¼ å…¥') return code }, } ], modules: { 'appName1': [{ loader(code, url, options, info) { if (url === 'xxx.js') { code = code.replace('var abc =', 'window.abc =') } return code } }], 'appName2': [{ scopeProperties: ['key', 'key', ...], // å¯é€‰ escapeProperties: ['key', 'key', ...], // å¯é€‰ ignoreChecker: (url) => ['/foo.js', '/bar.css'].some(item => url.includes(item)), // å¯é€‰ options: é…ç½®é¡¹, // å¯é€‰ loader(code, url, options, info) { // å¯é€‰ console.log('åªé€‚ç”¨äºappName2çš„æ’ä»¶') return code }, processHtml(code, url, options, info) { // å¯é€‰ console.log('åªé€‚ç”¨äº appName2 çš„ HTML å¤„ç†') return code }, }] } }
})`},{header:"1ã€åœ°å›¾æ’ä»¶",slug:"_1ã€åœ°å›¾æ’ä»¶",content:"å¾®å‰ç«¯ Micro-app åœ°å›¾æ’ä»¶ï¼Œé€‚é…é«˜å¾·ã€ç™¾åº¦ã€è…¾è®¯åœ°å›¾ ğŸ‰ğŸ‰ğŸ‰"},{header:"ä½¿ç”¨",slug:"ä½¿ç”¨",content:`Installationå®‰è£…åœ°å›¾æ’ä»¶ # with npm npm install @micro-zoe/micro-plugin-map --save-dev # with yarn yarn add @micro-zoe/micro-plugin-map --dev
Usage
we use the package like this step:
1ã€ä¸»ç”¨ï¼Œåœ¨å…¥å£å¤„å®‰è£…å¯¹åº”åœ°å›¾çš„sdk é«˜å¾·sdk https://webapi.amap.com/maps?v=2.0&key=xxxxxx
è…¾è®¯sdk https://map.qq.com/api/gljs?v=1.exp&key=xxxxxx
ç™¾åº¦sdk https://api.map.baidu.com/api?type=webgl&v=1.0&ak=xxxxxx 2ã€åœ¨ä¸»åº”ç”¨ä¸­ï¼Œä½¿ç”¨è¯¥åŒ… import microApp from '@micro-zoe/micro-app' import microPluginMap from '@micro-zoe/micro-plugin-map' // è®¾ç½®ä¸ºå…¨å±€æ’ä»¶ï¼Œä½œç”¨äºæ‰€æœ‰å­åº”ç”¨ microApp.start({ plugins: { global: [microPluginMap], } }) // æˆ–è€…è®¾ç½®ä¸ºæŸä¸ªå­åº”ç”¨çš„æ’ä»¶ï¼Œåªä½œç”¨äºå½“å‰å­åº”ç”¨ microApp.start({ plugins: { modules: { 'appName': [microPluginMap], } } })`},{header:"æ³¨æ„",slug:"æ³¨æ„",content:"ç›®å‰æ’ä»¶ç›®å‰ä»…åœ¨withæ²™ç®±ä¸‹é€‚ç”¨ æ’ä»¶ä»¥umdåŒæ­¥çš„æ–¹å¼å¼•å…¥sdkï¼Œå¼‚æ­¥åŠ è½½çš„æ–¹å¼æš‚ä¸æ”¯æŒ é«˜å¾·åœ°å›¾çš„ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œå¯ä»¥ä¸ç”¨è¿›è¡Œä»»ä½•æ“ä½œï¼Œé«˜å¾·åœ°å›¾è‹¥è®¾ç½®äº†ä½¿ç”¨ç™½åå•ï¼Œéœ€å°†ç™½åå•èŒƒå›´å›Šæ‹¬ä¸»åº”ç”¨åŸŸå è…¾è®¯åœ°å›¾ï¼Œä½¿ç”¨æ—¶å€™åªæ˜¯å¸¸è§„çš„è·¨è¶Šï¼Œç”¨æ­¤æ’ä»¶è¿›è¡Œå¸¸è§„ä½¿ç”¨å³å¯ï¼Œè…¾è®¯åœ°å›¾è‹¥è®¾ç½®äº†ä½¿ç”¨ç™½åå•ï¼Œéœ€å°†ç™½åå•èŒƒå›´å›Šæ‹¬ä¸»åº”ç”¨åŸŸå ç™¾åº¦åœ°å›¾ï¼Œä½¿ç”¨æ—¶æœ‰è·¨åŸŸé—®é¢˜ï¼Œå¯ç”¨æ­¤æ’ä»¶è¿›è¡Œå¤„ç†ï¼Œç™¾åº¦åœ°å›¾è‹¥è®¾ç½®äº†ä½¿ç”¨ç™½åå•ï¼Œéœ€å°†ç™½åå•èŒƒå›´å›Šæ‹¬ä¸»åº”ç”¨åŸŸå"},{header:"æºç ",slug:"æºç ",content:"micro-plugin-map æºç åœ°å€ï¼šhttps://github.com/micro-zoe/micro-plugin-map"}]},{path:"/zh/prefetch.html",title:"é¢„åŠ è½½",pathLocale:"/",contents:[{header:"é¢„åŠ è½½",slug:"é¢„åŠ è½½",content:`é¢„åŠ è½½æ˜¯æŒ‡åœ¨å­åº”ç”¨å°šæœªæ¸²æŸ“æ—¶æå‰åŠ è½½é™æ€èµ„æºï¼Œä»è€Œæå‡å­åº”ç”¨çš„é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦ã€‚
ä¸ºäº†ä¸å½±å“ä¸»åº”ç”¨çš„æ€§èƒ½ï¼Œé¢„åŠ è½½ä¼šåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´æ‰§è¡Œã€‚`},{header:"è¯­æ³•",slug:"è¯­æ³•",content:"microApp.preFetch(apps: app[] | () => app[], delay?: number)"},{header:"å‚æ•°",slug:"å‚æ•°",content:`apps
ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„æˆ–ä¸€ä¸ªè¿”å›æ•°ç»„çš„å‡½æ•°ï¼Œæ•°ç»„ä¼ å…¥çš„é…ç½®å¦‚ä¸‹ï¼š
app: { name: string, // åº”ç”¨åç§°ï¼Œå¿…ä¼  url: string, // åº”ç”¨åœ°å€ï¼Œå¿…ä¼  iframe: boolean, // æ˜¯å¦ä½¿ç”¨iframeæ²™ç®±ï¼Œviteåº”ç”¨å¿…ä¼ ï¼Œå…¶å®ƒåº”ç”¨å¯é€‰ inline: boolean, // æ˜¯å¦ä½¿ç”¨å†…è”æ¨¡å¼è¿è¡Œjsï¼Œå¯é€‰ 'disable-scopecss': boolean, // æ˜¯å¦å…³é—­æ ·å¼éš”ç¦»ï¼Œå¯é€‰ 'disable-sandbox': boolean, // æ˜¯å¦å…³é—­æ²™ç›’ï¼Œå¯é€‰ level: number, // é¢„åŠ è½½ç­‰çº§ï¼Œå¯é€‰ï¼ˆåˆ†ä¸ºä¸‰ä¸ªç­‰çº§ï¼š1ã€2ã€3ï¼Œ1è¡¨ç¤ºåªåŠ è½½èµ„æºï¼Œ2è¡¨ç¤ºåŠ è½½å¹¶è§£æï¼Œ3è¡¨ç¤ºåŠ è½½è§£æå¹¶æ¸²æŸ“ï¼Œé»˜è®¤ä¸º2ï¼‰ 'default-page': string, // æŒ‡å®šé»˜è®¤æ¸²æŸ“çš„é¡µé¢ï¼Œlevelä¸º3æ—¶æ‰ä¼šç”Ÿæ•ˆï¼Œå¯é€‰ 'disable-patch-request': boolean, // å…³é—­å­åº”ç”¨è¯·æ±‚çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œlevelä¸º3æ—¶æ‰ä¼šç”Ÿæ•ˆï¼Œå¯é€‰
}
delay å¯é€‰
ç¬¬äºŒä¸ªå‚æ•°ä¸ºå»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œé»˜è®¤å€¼ï¼š3000ã€‚
åœ¨é¢„åŠ è½½ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨requestIdleCallbackåŒ…è£¹æ¯ä¸ªé¢„åŠ è½½çš„æ“ä½œï¼Œä»¥å‡å°å¯¹ä¸»åº”ç”¨çš„å½±å“ï¼Œä½†è¿™ä¸æ˜¯å®Œç¾æ— ç¼ºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªå»¶è¿Ÿï¼Œåœ¨å»¶è¿Ÿæ—¶é—´ç»“æŸåæ‰å¼€å§‹é¢„åŠ è½½æ“ä½œï¼Œè¿›ä¸€æ­¥é™ä½å¯¹ä¸»åº”ç”¨å½±å“çš„å¯èƒ½æ€§ã€‚
å¦‚æœä¸»åº”ç”¨ä»ç„¶å—åˆ°äº†å½±å“ï¼Œå¯ä»¥å¢åŠ å»¶è¿Ÿæ—¶é—´ã€‚
ä¿®æ”¹delayçš„é»˜è®¤å€¼ï¼š
æˆ‘ä»¬å¯ä»¥åœ¨startæ–¹æ³•ä¸­ä¿®æ”¹delayçš„é»˜è®¤å€¼ï¼š
import microApp from '@micro-zoe/micro-app' microApp.start({ prefetchDelay: 5000, // ä¿®æ”¹delayé»˜è®¤å€¼ä¸º5000ms
})`},{header:"è¿›é˜¶",slug:"è¿›é˜¶",content:`é¢„åŠ è½½JSèµ„æºåˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼Œå¯¹åº”ä¸Šè¿°å‚æ•° - levelï¼š 1ã€åŠ è½½é™æ€èµ„æº
2ã€å°†è½½é™æ€èµ„æºè§£ææˆå¯æ‰§è¡Œä»£ç 
3ã€æ‰§è¡Œä»£ç å¹¶åœ¨åå°æ¸²æŸ“ levelåˆ†ä¸º1ã€2ã€3ä¸‰ä¸ªå±‚çº§ï¼Œé»˜è®¤å€¼ä¸º2ï¼Œè¡¨ç¤ºåŠ è½½é™æ€èµ„æºå¹¶è§£æã€‚
levelå€¼è¶Šé«˜ï¼Œåˆ™é¢„åŠ è½½çš„ç¨‹åº¦è¶Šæ·±ï¼Œå­åº”ç”¨é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦è¶Šå¿«ï¼Œä½†å ç”¨çš„å†…å­˜ä¹Ÿæ›´é«˜ï¼Œåä¹‹äº¦ç„¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚
æˆ‘ä»¬å¯ä»¥åœ¨startæ–¹æ³•ä¸­ä¿®æ”¹levelçš„é»˜è®¤å€¼ï¼š
import microApp from '@micro-zoe/micro-app' microApp.start({ prefetchLevel: 1, // ä¿®æ”¹levelé»˜è®¤å€¼ä¸º1
})
æç¤º
levelæˆ–prefetchLevelä¸º3æ—¶ï¼Œé¢„åŠ è½½å­åº”ç”¨çš„è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿæ— æ³•å…³é—­ã€‚`},{header:"ä½¿ç”¨æ–¹å¼",slug:"ä½¿ç”¨æ–¹å¼",content:`import microApp from '@micro-zoe/micro-app' // æ–¹å¼ä¸€ï¼šè®¾ç½®æ•°ç»„
microApp.preFetch([ { name: 'my-app1', url: 'xxx' }, // åŠ è½½èµ„æºå¹¶è§£æ { name: 'my-app2', url: 'xxx', level: 1 }, // åªåŠ è½½èµ„æº { name: 'my-app3', url: 'xxx', level: 3 }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“ { name: 'my-app4', url: 'xxx', level: 3, 'default-page': '/page2' }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“å­åº”ç”¨çš„page2é¡µé¢
]) // æ–¹å¼äºŒï¼šè®¾ç½®ä¸€ä¸ªè¿”å›æ•°ç»„çš„å‡½æ•°
microApp.preFetch(() => [ { name: 'my-app1', url: 'xxx' }, // åŠ è½½èµ„æºå¹¶è§£æ { name: 'my-app2', url: 'xxx', level: 1 }, // åªåŠ è½½èµ„æº { name: 'my-app3', url: 'xxx', level: 3 }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“ { name: 'my-app4', url: 'xxx', level: 3, 'default-page': '/page2' }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“å­åº”ç”¨çš„page2é¡µé¢
]) // æ–¹å¼ä¸‰ï¼šåœ¨startä¸­è®¾ç½®é¢„åŠ è½½æ•°ç»„
microApp.start({ preFetchApps: [ { name: 'my-app1', url: 'xxx' }, // åŠ è½½èµ„æºå¹¶è§£æ { name: 'my-app2', url: 'xxx', level: 1 }, // åªåŠ è½½èµ„æº { name: 'my-app3', url: 'xxx', level: 3 }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“ { name: 'my-app4', url: 'xxx', level: 3, 'default-page': '/page2' }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“å­åº”ç”¨çš„page2é¡µé¢ ],
}) // æ–¹å¼å››ï¼šåœ¨startä¸­è®¾ç½®ä¸€ä¸ªè¿”å›é¢„åŠ è½½æ•°ç»„çš„å‡½æ•°
microApp.start({ preFetchApps: () => [ { name: 'my-app1', url: 'xxx' }, // åŠ è½½èµ„æºå¹¶è§£æ { name: 'my-app2', url: 'xxx', level: 1 }, // åªåŠ è½½èµ„æº { name: 'my-app3', url: 'xxx', level: 3 }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“ { name: 'my-app4', url: 'xxx', level: 3, 'default-page': '/page2' }, // åŠ è½½èµ„æºã€è§£æå¹¶æ¸²æŸ“å­åº”ç”¨çš„page2é¡µé¢ ],
}) // è®¾ç½®å»¶è¿Ÿæ—¶é—´ï¼Œ5ç§’é’Ÿä¹‹åæ‰§è¡Œé¢„åŠ è½½
microApp.preFetch([ { name: 'my-app1', url: 'xxx' }, // åŠ è½½èµ„æºå¹¶è§£æ
], 5000)`},{header:"viteåº”ç”¨",slug:"viteåº”ç”¨",content:`å½“å­åº”ç”¨æ˜¯viteæ—¶ï¼Œé™¤äº†nameå’Œurlå¤–ï¼Œè¿˜è¦è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°iframeä¸ºtrueï¼Œå¼€å¯iframeæ²™ç®±ã€‚
ä¾‹å¦‚ï¼š
// é¢„åŠ è½½viteå­åº”ç”¨
microApp.preFetch([ { name: 'my-vite-app', url: 'xxx', iframe: true },
])`},{header:"è¡¥å……",slug:"è¡¥å……",content:`æ­£å¸¸æƒ…å†µä¸‹ï¼Œé¢„åŠ è½½åªéœ€è¦è®¾ç½®nameå’Œurlï¼Œå…¶å®ƒå‚æ•°ä¸éœ€è¦è®¾ç½®ã€‚
ä½†æˆ‘ä»¬è¿˜æ˜¯å»ºè®®é¢„åŠ è½½çš„é…ç½®å’Œ<micro-app>å…ƒç´ ä¸Šçš„é…ç½®ä¿æŒä¸€è‡´ã€‚
ä¾‹å¦‚ï¼š<micro-app>å…ƒç´ è®¾ç½®äº†disable-scopecsså…³é—­æ ·å¼éš”ç¦»ï¼Œé‚£ä¹ˆé¢„åŠ è½½ä¹Ÿæœ€å¥½ä¿æŒä¸€è‡´
<micro-app name='my-app' url='xxx' disable-scopecss></micro-app>
microApp.preFetch([ { name: 'my-app', url: 'xxx', 'disable-scopecss': true },
])`}]},{path:"/zh/questions.html",title:"",pathLocale:"/",contents:[{header:"1ã€æˆ‘éœ€è¦ç”¨åˆ°å¾®å‰ç«¯å—ï¼Ÿ",slug:"_1ã€æˆ‘éœ€è¦ç”¨åˆ°å¾®å‰ç«¯å—",content:`åœ¨æ­¤ä¹‹å‰å»ºè®®ä½ å…ˆé˜…è¯»Why Not Iframeã€‚
ç›¸æ¯”äºiframeï¼Œå¾®å‰ç«¯æ‹¥æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶å®ƒä¹Ÿè¦æ±‚å¼€å‘è€…å¯¹äºå‰ç«¯æ¡†æ¶å’Œè·¯ç”±åŸç†å…·æœ‰ä¸€å®šçš„ç†è§£ã€‚
å¾®å‰ç«¯çš„æœ¬è´¨æ˜¯å°†ä¸¤ä¸ªä¸ç›¸å…³çš„é¡µé¢å¼ºè¡Œåˆå¹¶ä¸ºä¸€ï¼Œè¿™å…¶ä¸­ä¸å¯é¿å…ä¼šå‡ºç°å„ç§å†²çªï¼Œè™½ç„¶å¾®å‰ç«¯æ¡†æ¶è§£å†³äº†å‡ ä¹æ‰€æœ‰çš„å†²çªï¼Œä½†å¶å°”ä¹Ÿä¼šæœ‰ç‰¹æ®Šæƒ…å†µå‡ºç°ï¼Œè¿™éœ€è¦å¼€å‘è€…å…·æœ‰å¤„ç†ç‰¹æ®Šæƒ…å†µçš„èƒ½åŠ›å’Œå¿ƒæ€ã€‚
å¾®å‰ç«¯ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒçš„å®ç°åŸç†æ³¨å®šæ— æ³•åƒiframeä¸€æ ·ç®€å•ç¨³å®šã€‚
å¦‚æœä½ ä¸çŸ¥é“è‡ªå·±æ˜¯å¦éœ€è¦ç”¨å¾®å‰ç«¯ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯ä¸éœ€è¦ã€‚`},{header:"2ã€å­åº”ç”¨ä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ",slug:"_2ã€å­åº”ç”¨ä¸€å®šè¦æ”¯æŒè·¨åŸŸå—",content:`æ˜¯çš„ï¼
å¦‚æœæ˜¯å¼€å‘ç¯å¢ƒï¼Œå¯ä»¥åœ¨webpack-dev-serverä¸­è®¾ç½®headersæ”¯æŒè·¨åŸŸã€‚
devServer: { headers: { 'Access-Control-Allow-Origin': '*', },
},
å¦‚æœæ˜¯çº¿ä¸Šç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡é…ç½®nginxæ”¯æŒè·¨åŸŸã€‚`},{header:"3ã€å…¼å®¹æ€§å¦‚ä½•",slug:"_3ã€å…¼å®¹æ€§å¦‚ä½•",content:`micro-appä¾èµ–äºCustomElementså’ŒProxyä¸¤ä¸ªè¾ƒæ–°çš„APIã€‚
å¯¹äºä¸æ”¯æŒCustomElementsçš„æµè§ˆå™¨ï¼Œå¯ä»¥é€šè¿‡å¼•å…¥polyfillè¿›è¡Œå…¼å®¹ï¼Œè¯¦æƒ…å¯å‚è€ƒï¼šwebcomponents/polyfillsã€‚
ä½†æ˜¯Proxyæš‚æ—¶æ²¡æœ‰åšå…¼å®¹ï¼Œæ‰€ä»¥å¯¹äºä¸æ”¯æŒProxyçš„æµè§ˆå™¨æ— æ³•è¿è¡Œmicro-appã€‚
æµè§ˆå™¨å…¼å®¹æ€§å¯ä»¥æŸ¥çœ‹ï¼šCan I Use
æ€»ä½“å¦‚ä¸‹ï¼š PCç«¯ï¼šé™¤äº†IEæµè§ˆå™¨ï¼Œå…¶å®ƒæµè§ˆå™¨åŸºæœ¬å…¼å®¹ã€‚
ç§»åŠ¨ç«¯ï¼šios10+ã€android5+`},{header:"4ã€micro-app æŠ¥é”™ an app named xx already exists",slug:"_4ã€micro-app-æŠ¥é”™-an-app-named-xx-already-exists",content:"è¿™æ˜¯nameåç§°å†²çªå¯¼è‡´çš„ï¼Œè¯·ç¡®ä¿æ¯ä¸ªå­åº”ç”¨çš„nameå€¼æ˜¯å”¯ä¸€çš„ã€‚"},{header:"5ã€ä¸»åº”ç”¨çš„æ ·å¼å½±å“åˆ°å­åº”ç”¨",slug:"_5ã€ä¸»åº”ç”¨çš„æ ·å¼å½±å“åˆ°å­åº”ç”¨",content:`è™½ç„¶æˆ‘ä»¬å°†å­åº”ç”¨çš„æ ·å¼è¿›è¡Œéš”ç¦»ï¼Œä½†ä¸»åº”ç”¨çš„æ ·å¼ä¾ç„¶ä¼šå½±å“åˆ°å­åº”ç”¨ï¼Œå¦‚æœå‘ç”Ÿå†²çªï¼Œæ¨èé€šè¿‡çº¦å®šå‰ç¼€æˆ–CSS Modulesæ–¹å¼è§£å†³ã€‚
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ant-designç­‰ç»„ä»¶åº“ï¼Œä¸€èˆ¬ä¼šæä¾›æ·»åŠ å‰ç¼€è¿›è¡Œæ ·å¼éš”ç¦»çš„åŠŸèƒ½ã€‚`},{header:"6ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°å¤–éƒ¨çœŸå®windowï¼Ÿ",slug:"_6ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°å¤–éƒ¨çœŸå®window",content:`ç›®å‰æœ‰3ç§æ–¹å¼åœ¨å­åº”ç”¨ä¸­è·å–å¤–éƒ¨çœŸå®window 1ã€new Function("return window")() æˆ– Function("return window")()
2ã€(0, eval)('window')
3ã€window.rawWindow`},{header:"7ã€é”™è¯¯ä¿¡æ¯ï¼šxxx undefined",slug:"_7ã€é”™è¯¯ä¿¡æ¯-xxx-undefined",content:`åŒ…æ‹¬ï¼š xxx is not defined
xxx is not a function
Cannot read properties of undefined åŸå› ï¼š
åœ¨å¾®å‰ç«¯çš„æ²™ç®±ç¯å¢ƒä¸­ï¼Œé¡¶å±‚å˜é‡ä¸ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ã€‚
ä¾‹å¦‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ var name æˆ– function name () {} å®šä¹‰çš„é¡¶å±‚å˜é‡ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œé€šè¿‡window.nameæˆ–nameå°±å¯ä»¥å…¨å±€è®¿é—®ã€‚
ä½†æ˜¯åœ¨æ²™ç®±ç¯å¢ƒä¸‹è¿™äº›é¡¶å±‚å˜é‡æ— æ³•æ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œwindow.nameæˆ–nameä¸ºundefinedï¼Œå¯¼è‡´å‡ºç°é—®é¢˜ã€‚
è§£å†³æ–¹å¼ï¼š
æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨ä¿®æ”¹
å°† var name æˆ– function name () {} ä¿®æ”¹ä¸º window.name = xx
æ–¹å¼äºŒï¼šé€šè¿‡æ’ä»¶ç³»ç»Ÿä¿®æ”¹å­åº”ç”¨ä»£ç 
æ¯”å¦‚å¸¸è§çš„åŠ è½½webpackæ‰“åŒ…çš„dllæ–‡ä»¶å¤±è´¥çš„é—®é¢˜ï¼Œå› ä¸ºdllæ–‡ä»¶çš„å†…å®¹å’Œjsåœ°å€ç›¸å¯¹å›ºå®šï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå…¨å±€æŸ¥æ‰¾å’Œä¿®æ”¹ã€‚
microApp.start({ plugins: { modules: { åº”ç”¨åç§°: [{ loader(code, url) { if (url === 'xxx.js') { code = code.replace('var xx_dll=', 'window.xx_dll=') } return code } }] } }
})`},{header:"8ã€jsonpè¯·æ±‚å¦‚ä½•å¤„ç†ï¼Ÿ",slug:"_8ã€jsonpè¯·æ±‚å¦‚ä½•å¤„ç†",content:"å‚è€ƒignore"},{header:"9ã€å­åº”ç”¨é€šè¿‡aæ ‡ç­¾ä¸‹è½½æ–‡ä»¶å¤±è´¥",slug:"_9ã€å­åº”ç”¨é€šè¿‡aæ ‡ç­¾ä¸‹è½½æ–‡ä»¶å¤±è´¥",content:`åŸå› ï¼š å½“è·¨åŸŸæ—¶(ä¸»åº”ç”¨å’Œæ–‡ä»¶åœ¨ä¸åŒåŸŸåä¸‹)ï¼Œæ— æ³•é€šè¿‡aæ ‡ç­¾çš„downloadå±æ€§å®ç°ä¸‹è½½ã€‚
è§£å†³æ–¹å¼ï¼š
æ–¹å¼1ï¼š è½¬æ¢ä¸ºblobå½¢å¼ä¸‹è½½
<a href='xxx.png' download="filename.png" @click='downloadFile'>ä¸‹è½½</a>
// é€šè¿‡blobä¸‹è½½æ–‡ä»¶
function downloadFile (e) { // å¾®å‰ç«¯ç¯å¢ƒä¸‹è½¬æ¢ä¸ºblobä¸‹è½½ï¼Œå­åº”ç”¨å•ç‹¬è¿è¡Œæ—¶ä¾ç„¶ä½¿ç”¨aæ ‡ç­¾ä¸‹è½½ if (window.__MICRO_APP_ENVIRONMENT__) { e.preventDefault() // æ³¨æ„hrefå¿…é¡»æ˜¯ç»å¯¹åœ°å€ fetch(e.target.href).then((res) => { res.blob().then((blob) => { const blobUrl = window.URL.createObjectURL(blob) // è½¬åŒ–ä¸ºblobURLåå†é€šè¿‡aæ ‡ç­¾ä¸‹è½½ const a = document.createElement('a') a.href = blobUrl a.download = 'filename.png' a.click() window.URL.revokeObjectURL(blobUrl) }) }) }
}
æ–¹å¼2ï¼š å°†æ–‡ä»¶æ”¾åˆ°ä¸»åº”ç”¨åŸŸåä¸‹ï¼Œåˆ¤æ–­å¾®å‰ç«¯ç¯å¢ƒä¸‹aæ ‡ç­¾hrefå±æ€§è®¾ç½®ä¸ºä¸»åº”ç”¨çš„æ–‡ä»¶åœ°å€`},{header:"10ã€iconfont å›¾æ ‡å†²çªäº†å¦‚ä½•å¤„ç†ï¼Ÿ",slug:"_10ã€iconfont-å›¾æ ‡å†²çªäº†å¦‚ä½•å¤„ç†",content:`äº§ç”ŸåŸå› 
è§£å†³æ–¹æ¡ˆ ä¸»åº”ç”¨å’Œå­åº”ç”¨ unicode ä½¿ç”¨åŒä¸€ç¼–ç å¯¼è‡´å›¾æ ‡å†²çª
é€‰æ‹©å†²çªå›¾æ ‡ï¼Œåœ¨iconfontä¸­ä¿®æ”¹å¯¹åº”çš„unicodeç¼–ç å¹¶é‡æ–°ç”Ÿæˆæ–‡ä»¶è¿›è¡Œæ›¿æ¢ ä¸»åº”ç”¨å’Œå­åº”ç”¨ class/fontFamily å†²çª
ä¿®æ”¹å†²çªåº”ç”¨ä¸‹ä½¿ç”¨iconfontçš„çš„ç›¸å…³ç±»åå’Œå¯¹åº”çš„font-faceä¸‹fontFamily ä¸»åº”ç”¨å’Œå­åº”ç”¨ class/fontFamily å†²çª è§£å†³ç¤ºä¾‹
@font-face {
- font-family: "iconfont";
+ font-family: "iconfont1"; src: url('iconfont.woff2?t=1704871404008') format('woff2'), url('iconfont.woff?t=1704871404008') format('woff'), url('iconfont.ttf?t=1704871404008') format('truetype');
} -.iconfont {
+.iconfont1 { font-family: "iconfont" !important; font-size: 16px; font-style: normal; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
} .right:before { content: "\\e7eb";
}
- <i className="iconfont right"></i>
+ <i className="iconfont1 right"></i>`}]},{path:"/zh/router.html",title:"è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ",pathLocale:"/",contents:[{header:"è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ",slug:"è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ",content:`MicroAppé€šè¿‡æ‹¦æˆªæµè§ˆå™¨è·¯ç”±äº‹ä»¶ä»¥åŠè‡ªå®šä¹‰çš„locationã€historyï¼Œå®ç°äº†ä¸€å¥—è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œå­åº”ç”¨è¿è¡Œåœ¨è¿™å¥—è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿä¸­ï¼Œå’Œä¸»åº”ç”¨çš„è·¯ç”±è¿›è¡Œéš”ç¦»ï¼Œé¿å…ç›¸äº’å½±å“ã€‚
è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿè¿˜æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·æå‡å¼€å‘æ•ˆç‡å’Œä½¿ç”¨ä½“éªŒã€‚`},{header:"è·¯ç”±æ¨¡å¼",slug:"è·¯ç”±æ¨¡å¼",content:`è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿåˆ†ä¸ºå››ç§æ¨¡å¼ï¼šsearchã€nativeã€native-scopeã€pure searchæ˜¯é»˜è®¤æ¨¡å¼ï¼Œé€šå¸¸ä¸éœ€è¦ç‰¹æ„è®¾ç½®ï¼Œsearchæ¨¡å¼ä¸‹å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯ä¼šä½œä¸ºqueryå‚æ•°åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Šï¼Œå¦‚ä¸‹ï¼š ä½¿ç”¨æ–¹å¼ï¼š
è®¾ç½®å•ä¸ªå­åº”ç”¨ï¼š
<micro-app name='xx' url='xx' router-mode='search'></micro-app>
å…¨å±€è®¾ç½®ï¼š
import microApp from '@micro-zoe/micro-app' microApp.start({ 'router-mode': 'search',
}) nativeæ¨¡å¼ä¸‹å­åº”ç”¨å®Œå…¨åŸºäºæµè§ˆå™¨è·¯ç”±ç³»ç»Ÿè¿›è¡Œæ¸²æŸ“ï¼Œæ¯”searchæ¨¡å¼æ‹¥æœ‰æ›´åŠ ç®€æ´ä¼˜é›…çš„çš„æµè§ˆå™¨åœ°å€ï¼Œä½†ç›¸åº”çš„éœ€è¦æ›´åŠ å¤æ‚çš„è·¯ç”±é…ç½®ï¼Œè¯¦æƒ…å‚è€ƒbrowser-router
ä½¿ç”¨æ–¹å¼ï¼š
è®¾ç½®å•ä¸ªå­åº”ç”¨ï¼š
<micro-app name='xx' url='xx' router-mode='native'></micro-app>
å…¨å±€è®¾ç½®ï¼š
import microApp from '@micro-zoe/micro-app' microApp.start({ 'router-mode': 'native',
}) native-scopeæ¨¡å¼çš„åŠŸèƒ½å’Œç”¨æ³•å’Œnativeæ¨¡å¼ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒç‚¹åœ¨äºnative-scopeæ¨¡å¼ä¸‹å­åº”ç”¨çš„åŸŸåæŒ‡å‘è‡ªèº«è€Œéä¸»åº”ç”¨ã€‚
ä½¿ç”¨æ–¹å¼ï¼š
è®¾ç½®å•ä¸ªå­åº”ç”¨ï¼š
<micro-app name='xx' url='xx' router-mode='native-scope'></micro-app>
å…¨å±€è®¾ç½®ï¼š
import microApp from '@micro-zoe/micro-app' microApp.start({ 'router-mode': 'native-scope',
}) pureæ¨¡å¼ä¸‹å­åº”ç”¨ç‹¬ç«‹äºæµè§ˆå™¨è¿›è¡Œæ¸²æŸ“ï¼Œå³ä¸ä¼šä¿®æ”¹æµè§ˆå™¨åœ°å€ï¼Œä¹Ÿä¸ä¼šå—å…¶å½±å“ï¼Œå…¶è¡¨ç°å’Œiframeç±»ä¼¼ã€‚
ä½¿ç”¨æ–¹å¼ï¼š
è®¾ç½®å•ä¸ªå­åº”ç”¨ï¼š
<micro-app name='xx' url='xx' router-mode='pure'></micro-app>
å…¨å±€è®¾ç½®ï¼š
import microApp from '@micro-zoe/micro-app' microApp.start({ 'router-mode': 'pure',
})`},{header:"é…ç½®é¡¹",slug:"é…ç½®é¡¹",content:""},{header:"1ã€å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ",slug:"_1ã€å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ",content:`å®é™…ä¸Šè™šæ‹Ÿè·¯ç”±ç³»ç»Ÿæ˜¯æ— æ³•å…³é—­çš„ï¼Œè¿™é‡Œçš„é…ç½®åªæ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹æ—§ç‰ˆæœ¬ï¼Œå®ƒçš„è¡¨ç°å’Œnativeè·¯ç”±æ¨¡å¼ä¸€è‡´ã€‚
ä½¿ç”¨æ–¹å¼ï¼š
1ã€è®¾ç½®å•ä¸ªå­åº”ç”¨
<micro-app name='xx' url='xx' disable-memory-router></micro-app>
2ã€å…¨å±€è®¾ç½®
import microApp from '@micro-zoe/micro-app' // åœ¨startä¸­å¢åŠ é…ç½®
microApp.start({ 'disable-memory-router': true, // å…³é—­è™šæ‹Ÿè·¯ç”±
})`},{header:"2ã€ä¿ç•™è·¯ç”±çŠ¶æ€",slug:"_2ã€ä¿ç•™è·¯ç”±çŠ¶æ€",content:`é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨å¸è½½åé‡æ–°æ¸²æŸ“ï¼Œå°†å’Œé¦–æ¬¡åŠ è½½ä¸€æ ·æ¸²æŸ“å­åº”ç”¨çš„é¦–é¡µã€‚
è®¾ç½®keep-router-stateå¯ä»¥ä¿ç•™å­åº”ç”¨è·¯ç”±çŠ¶æ€ï¼Œåœ¨å¸è½½åé‡æ–°æ¸²æŸ“æ—¶å°†æ¢å¤å¸è½½å‰çš„é¡µé¢ï¼ˆé¡µé¢ä¸­çš„çŠ¶æ€ä¸ä¿ç•™ï¼‰ã€‚
ä½¿ç”¨æ–¹å¼ï¼š
1ã€ä¿ç•™æŸä¸ªå­åº”ç”¨çš„è·¯ç”±çŠ¶æ€
<micro-app name='xx' url='xx' keep-router-state></micro-app>
2ã€ä¿ç•™æ‰€æœ‰å­åº”ç”¨çš„è·¯ç”±çŠ¶æ€
import microApp from '@micro-zoe/micro-app' // åœ¨startä¸­å¢åŠ é…ç½®
microApp.start({ 'keep-router-state': true, // ä¿ç•™è·¯ç”±çŠ¶æ€
})
æ³¨æ„ï¼š å¦‚æœå…³é—­äº†è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œkeep-router-stateä¹Ÿå°†å¤±æ•ˆã€‚
å½“è®¾ç½®äº†default-pageæ—¶keep-router-stateå°†å¤±æ•ˆï¼Œå› ä¸ºå®ƒçš„ä¼˜å…ˆçº§å°äºdefault-page`},{header:"å¯¼èˆª",slug:"å¯¼èˆª",content:`é€šè¿‡è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œè·¨åº”ç”¨çš„è·³è½¬ï¼Œå¦‚ï¼š ä¸»åº”ç”¨æ§åˆ¶å­åº”ç”¨è·³è½¬
å­åº”ç”¨æ§åˆ¶ä¸»åº”ç”¨è·³è½¬
å­åº”ç”¨æ§åˆ¶å…¶å®ƒå­åº”ç”¨è·³è½¬ ç”±äºnextjsçš„è·¯ç”±ç³»ç»Ÿéå¸¸ç‰¹æ®Šï¼Œå½“å­åº”ç”¨æ˜¯nextjsæ—¶æ— æ³•ç›´æ¥æ§åˆ¶è·³è½¬ï¼Œå‚è€ƒé€šè¿‡æ•°æ®é€šä¿¡æ§åˆ¶è·³è½¬`},{header:"router.push",slug:"router-push",content:`ä»‹ç»ï¼š æ§åˆ¶å­åº”ç”¨è·³è½¬ï¼Œå¹¶å‘è·¯ç”±å †æ ˆæ·»åŠ ä¸€æ¡æ–°çš„è®°å½•
/** * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name * @param {string} path å¿…å¡«ï¼Œå­åº”ç”¨é™¤åŸŸåå¤–çš„å…¨é‡åœ°å€(ä¹Ÿå¯ä»¥å¸¦ä¸ŠåŸŸå) * @param {boolean} replace å¯é€‰ï¼Œæ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ï¼Œä¸æ–°å¢å †æ ˆè®°å½•ï¼Œé»˜è®¤ä¸ºfalse */
router.push({ name: 'å­åº”ç”¨åç§°', path: 'é¡µé¢åœ°å€', replace: æ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ })
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // ä¸å¸¦åŸŸåçš„åœ°å€ï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1
microApp.router.push({name: 'my-app', path: '/page1'}) // å¸¦åŸŸåçš„åœ°å€ï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1
microApp.router.push({name: 'my-app', path: 'http://localhost:3000/page1'}) // å¸¦æŸ¥è¯¢å‚æ•°ï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1?id=9527
microApp.router.push({name: 'my-app', path: '/page1?id=9527'}) // å¸¦hashï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1#hash
microApp.router.push({name: 'my-app', path: '/page1#hash'}) // ä½¿ç”¨replaceæ¨¡å¼ï¼Œç­‰åŒäº router.replace({name: 'my-app', path: '/page1'})
microApp.router.push({name: 'my-app', path: '/page1', replace: true })`},{header:"router.replace",slug:"router-replace",content:`ä»‹ç»ï¼š æ§åˆ¶å­åº”ç”¨è·³è½¬ï¼Œä½†ä¸ä¼šå‘è·¯ç”±å †æ ˆæ·»åŠ æ–°çš„è®°å½•ï¼Œè€Œæ˜¯æ›¿æ¢æœ€æ–°çš„å †æ ˆè®°å½•ã€‚
/** * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name * @param {string} path å¿…å¡«ï¼Œå­åº”ç”¨é™¤åŸŸåå¤–çš„å…¨é‡åœ°å€(ä¹Ÿå¯ä»¥å¸¦ä¸ŠåŸŸå) * @param {boolean} replace å¯é€‰ï¼Œæ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ï¼Œé»˜è®¤ä¸ºtrue */
router.replace({ name: 'å­åº”ç”¨åç§°', path: 'é¡µé¢åœ°å€', replace: æ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ })
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // ä¸å¸¦åŸŸåçš„åœ°å€
microApp.router.replace({name: 'my-app', path: '/page1'}) // å¸¦åŸŸåçš„åœ°å€
microApp.router.replace({name: 'my-app', path: 'http://localhost:3000/page1'}) // å¸¦æŸ¥è¯¢å‚æ•°
microApp.router.replace({name: 'my-app', path: '/page1?id=9527'}) // å¸¦hash
microApp.router.replace({name: 'my-app', path: '/page1#hash'}) // å…³é—­replaceæ¨¡å¼ï¼Œç­‰åŒäº router.push({name: 'my-app', path: '/page1'})
microApp.router.replace({name: 'my-app', path: '/page1', replace: false })`},{header:"router.go",slug:"router-go",content:`ä»‹ç»ï¼š å®ƒçš„åŠŸèƒ½å’Œwindow.history.go(n)ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨å†å²å †æ ˆä¸­å‰è¿›æˆ–åé€€å¤šå°‘æ­¥ã€‚
/** * @param {number} n å‰è¿›æˆ–åé€€å¤šå°‘æ­¥ */
router.go(n)
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // è¿”å›ä¸€æ¡è®°å½•
microApp.router.go(-1) // å‰è¿› 3 æ¡è®°å½•
microApp.router.go(3)`},{header:"router.back",slug:"router-back",content:`ä»‹ç»ï¼š å®ƒçš„åŠŸèƒ½å’Œwindow.history.back()ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨å†å²å †æ ˆä¸­åé€€ä¸€æ­¥ã€‚
router.back()
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // è¿”å›ä¸€æ¡è®°å½•
microApp.router.back()`},{header:"router.forward",slug:"router-forward",content:`ä»‹ç»ï¼š å®ƒçš„åŠŸèƒ½å’Œwindow.history.forward()ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨å†å²å †æ ˆä¸­å‰è¿›ä¸€æ­¥ã€‚
router.forward()
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // å‰è¿›ä¸€æ¡è®°å½•
microApp.router.forward() å­åº”ç”¨çš„è·¯ç”±APIå’Œä¸»åº”ç”¨ä¿æŒä¸€è‡´ï¼Œä¸åŒç‚¹æ˜¯microAppæŒ‚è½½åœ¨windowä¸Šã€‚`},{header:"å­åº”ç”¨æ§åˆ¶ä¸»åº”ç”¨è·³è½¬",slug:"å­åº”ç”¨æ§åˆ¶ä¸»åº”ç”¨è·³è½¬",content:`é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨æ— æ³•ç›´æ¥æ§åˆ¶ä¸»åº”ç”¨çš„è·³è½¬ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªAPIï¼Œå°†ä¸»åº”ç”¨çš„è·¯ç”±å¯¹è±¡ä¼ é€’ç»™å­åº”ç”¨ã€‚
ä¸»åº”ç”¨
import microApp from '@micro-zoe/micro-app' // æ³¨å†Œä¸»åº”ç”¨è·¯ç”±
microApp.router.setBaseAppRouter(ä¸»åº”ç”¨çš„è·¯ç”±å¯¹è±¡)
å­åº”ç”¨
// è·å–ä¸»åº”ç”¨è·¯ç”±
const baseRouter = window.microApp.router.getBaseAppRouter() // æ§åˆ¶ä¸»åº”ç”¨è·³è½¬
baseRouter.ä¸»åº”ç”¨è·¯ç”±çš„æ–¹æ³•(...)`},{header:"æ§åˆ¶å…¶ä»–å­åº”ç”¨è·³è½¬",slug:"æ§åˆ¶å…¶ä»–å­åº”ç”¨è·³è½¬",content:""},{header:"router.push",slug:"router-push-1",content:`ä»‹ç»ï¼š æ§åˆ¶å…¶å®ƒå­åº”ç”¨è·³è½¬ï¼Œå¹¶å‘è·¯ç”±å †æ ˆæ·»åŠ ä¸€æ¡æ–°çš„è®°å½•
/** * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name * @param {string} path å¿…å¡«ï¼Œå­åº”ç”¨é™¤åŸŸåå¤–çš„å…¨é‡åœ°å€(ä¹Ÿå¯ä»¥å¸¦ä¸ŠåŸŸå) * @param {boolean} replace å¯é€‰ï¼Œæ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ï¼Œä¸æ–°å¢å †æ ˆè®°å½•ï¼Œé»˜è®¤ä¸ºfalse */
router.push({ name: 'å­åº”ç”¨åç§°', path: 'é¡µé¢åœ°å€', replace: æ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ })
ç¤ºä¾‹ï¼š
// ä¸å¸¦åŸŸåçš„åœ°å€ï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1
window.microApp.router.push({name: 'my-app', path: '/page1'}) // å¸¦åŸŸåçš„åœ°å€ï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1
window.microApp.router.push({name: 'my-app', path: 'http://localhost:3000/page1'}) // å¸¦æŸ¥è¯¢å‚æ•°ï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1?id=9527
window.microApp.router.push({name: 'my-app', path: '/page1?id=9527'}) // å¸¦hashï¼Œæ§åˆ¶å­åº”ç”¨my-appè·³è½¬/page1#hash
window.microApp.router.push({name: 'my-app', path: '/page1#hash'}) // ä½¿ç”¨replaceæ¨¡å¼ï¼Œç­‰åŒäº router.replace({name: 'my-app', path: '/page1'})
window.microApp.router.push({name: 'my-app', path: '/page1', replace: true })`},{header:"router.replace",slug:"router-replace-1",content:`ä»‹ç»ï¼š æ§åˆ¶å…¶å®ƒå­åº”ç”¨è·³è½¬ï¼Œä½†ä¸ä¼šå‘è·¯ç”±å †æ ˆæ·»åŠ æ–°çš„è®°å½•ï¼Œè€Œæ˜¯æ›¿æ¢æœ€æ–°çš„å †æ ˆè®°å½•ã€‚
/** * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name * @param {string} path å¿…å¡«ï¼Œå­åº”ç”¨é™¤åŸŸåå¤–çš„å…¨é‡åœ°å€(ä¹Ÿå¯ä»¥å¸¦ä¸ŠåŸŸå) * @param {boolean} replace å¯é€‰ï¼Œæ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ï¼Œé»˜è®¤ä¸ºtrue */
router.replace({ name: 'å­åº”ç”¨åç§°', path: 'é¡µé¢åœ°å€', replace: æ˜¯å¦ä½¿ç”¨replaceæ¨¡å¼ })
ç¤ºä¾‹ï¼š
// ä¸å¸¦åŸŸåçš„åœ°å€
window.microApp.router.replace({name: 'my-app', path: '/page1'}) // å¸¦åŸŸåçš„åœ°å€
window.microApp.router.replace({name: 'my-app', path: 'http://localhost:3000/page1'}) // å¸¦æŸ¥è¯¢å‚æ•°
window.microApp.router.replace({name: 'my-app', path: '/page1?id=9527'}) // å¸¦hash
window.microApp.router.replace({name: 'my-app', path: '/page1#hash'}) // å…³é—­replaceæ¨¡å¼ï¼Œç­‰åŒäº router.push({name: 'my-app', path: '/page1'})
window.microApp.router.replace({name: 'my-app', path: '/page1', replace: false })`},{header:"router.go",slug:"router-go-1",content:`ä»‹ç»ï¼š å®ƒçš„åŠŸèƒ½å’Œwindow.history.go(n)ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨å†å²å †æ ˆä¸­å‰è¿›æˆ–åé€€å¤šå°‘æ­¥ã€‚
/** * @param {number} n å‰è¿›æˆ–åé€€å¤šå°‘æ­¥ */
router.go(n)
ç¤ºä¾‹ï¼š
// è¿”å›ä¸€æ¡è®°å½•
window.microApp.router.go(-1) // å‰è¿› 3 æ¡è®°å½•
window.microApp.router.go(3)`},{header:"router.back",slug:"router-back-1",content:`ä»‹ç»ï¼š å®ƒçš„åŠŸèƒ½å’Œwindow.history.back()ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨å†å²å †æ ˆä¸­åé€€ä¸€æ­¥ã€‚
router.back()
ç¤ºä¾‹ï¼š
// è¿”å›ä¸€æ¡è®°å½•
window.microApp.router.back()`},{header:"router.forward",slug:"router-forward-1",content:`ä»‹ç»ï¼š å®ƒçš„åŠŸèƒ½å’Œwindow.history.forward()ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨å†å²å †æ ˆä¸­å‰è¿›ä¸€æ­¥ã€‚
router.forward()
ç¤ºä¾‹ï¼š
// å‰è¿›ä¸€æ¡è®°å½•
window.microApp.router.forward()`},{header:"è®¾ç½®é»˜è®¤é¡µé¢",slug:"è®¾ç½®é»˜è®¤é¡µé¢",content:`å­åº”ç”¨åŠ è½½åä¼šé»˜è®¤æ¸²æŸ“é¦–é¡µï¼Œä½†æˆ‘ä»¬å¸¸å¸¸å¸Œæœ›å­åº”ç”¨åŠ è½½åæ¸²æŸ“æŒ‡å®šçš„é¡µé¢ï¼Œæ­¤æ—¶å¯ä»¥è®¾ç½®defaultPageæŒ‡å®šå­åº”ç”¨æ¸²æŸ“çš„é¡µé¢ã€‚
æ–¹å¼ä¸€ï¼šè®¾ç½®default-pageå±æ€§
<micro-app default-page='é¡µé¢åœ°å€'></micro-app>
ç¤ºä¾‹ï¼š
<!-- ä¸å¸¦åŸŸåçš„åœ°å€ -->
<micro-app name='my-app' url='http://localhost:3000/' default-page='/page1'></micro-app> <!-- å¸¦åŸŸåçš„åœ°å€ -->
<micro-app name='my-app' url='http://localhost:3000/' default-page='http://localhost:3000/page1'></micro-app> <!-- å¸¦æŸ¥è¯¢å‚æ•° -->
<micro-app name='my-app' url='http://localhost:3000/' default-page='/page1?id=9527'></micro-app> <!-- å¸¦hash -->
<micro-app name='my-app' url='http://localhost:3000/' default-page='/page1#hash'></micro-app>
æ–¹å¼äºŒï¼šé€šè¿‡router APIè®¾ç½®
/** * è®¾ç½®å­åº”ç”¨é»˜è®¤é¡µé¢ * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name * @param {string} path å¿…å¡«ï¼Œé¡µé¢åœ°å€ */
router.setDefaultPage({ name: 'å­åº”ç”¨åç§°', path: 'é¡µé¢åœ°å€' }) /** * åˆ é™¤å­åº”ç”¨é»˜è®¤é¡µé¢ * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name */
router.removeDefaultPage(name: 'å­åº”ç”¨åç§°') /** * è·å–å­åº”ç”¨é»˜è®¤é¡µé¢ * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name */
router.getDefaultPage(name: 'å­åº”ç”¨åç§°')
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // ä¸å¸¦åŸŸåçš„åœ°å€
microApp.router.setDefaultPage({name: 'my-app', path: '/page1'}) // å¸¦åŸŸåçš„åœ°å€
microApp.router.setDefaultPage({name: 'my-app', path: 'http://localhost:3000/page1'}) // å¸¦æŸ¥è¯¢å‚æ•°
microApp.router.setDefaultPage({name: 'my-app', path: '/page1?id=9527'}) // å¸¦hash
microApp.router.setDefaultPage({name: 'my-app', path: '/page1#hash'}) // åˆ é™¤å­åº”ç”¨my-appçš„é»˜è®¤é¡µé¢
router.removeDefaultPage('my-app') // è·å–å­åº”ç”¨my-appçš„é»˜è®¤é¡µé¢
const defaultPage = router.getDefaultPage('my-app')`},{header:"å¯¼èˆªå®ˆå«",slug:"å¯¼èˆªå®ˆå«",content:"å¯¼èˆªå®ˆå«ç”¨äºç›‘å¬å­åº”ç”¨çš„è·¯ç”±å˜åŒ–ï¼Œç±»ä¼¼äºvue-routerçš„å…¨å±€å®ˆå«ï¼Œä¸åŒç‚¹æ˜¯MicroAppçš„å¯¼èˆªå®ˆå«æ— æ³•å–æ¶ˆè·³è½¬ã€‚"},{header:"å…¨å±€å‰ç½®å®ˆå«",slug:"å…¨å±€å‰ç½®å®ˆå«",content:`ä»‹ç»ï¼š ç›‘å¬æ‰€æœ‰æˆ–æŸä¸ªå­åº”ç”¨çš„è·¯ç”±å˜åŒ–ï¼Œåœ¨å­åº”ç”¨é¡µé¢æ¸²æŸ“å‰æ‰§è¡Œã€‚
ä½¿ç”¨èŒƒå›´ï¼š ä¸»åº”ç”¨
/** * @param {object} to å³å°†è¦è¿›å…¥çš„è·¯ç”± * @param {object} from æ­£è¦ç¦»å¼€çš„è·¯ç”± * @param {string} name å­åº”ç”¨çš„name * @return cancel function è§£ç»‘è·¯ç”±ç›‘å¬å‡½æ•° */
router.beforeEach((to, from, name) => {} | { name: (to, from) => {} })
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // ç›‘å¬æ‰€æœ‰å­åº”ç”¨çš„è·¯ç”±å˜åŒ–
microApp.router.beforeEach((to, from, appName) => { console.log('å…¨å±€å‰ç½®å®ˆå« beforeEach: ', to, from, appName)
}) // ç›‘å¬æŸä¸ªå­åº”ç”¨çš„è·¯ç”±å˜åŒ–
microApp.router.beforeEach({ å­åº”ç”¨1name (to, from) { console.log('æŒ‡å®šå­åº”ç”¨çš„å‰ç½®å®ˆå« beforeEach ', to, from) }, å­åº”ç”¨2name (to, from) { console.log('æŒ‡å®šå­åº”ç”¨çš„å‰ç½®å®ˆå« beforeEach ', to, from) }
}) // beforeEachä¼šè¿”å›ä¸€ä¸ªè§£ç»‘å‡½æ•°
const cancelCallback = microApp.router.beforeEach((to, from, appName) => { console.log('å…¨å±€å‰ç½®å®ˆå« beforeEach: ', to, from, appName)
}) // è§£ç»‘è·¯ç”±ç›‘å¬
cancelCallback()`},{header:"å…¨å±€åç½®å®ˆå«",slug:"å…¨å±€åç½®å®ˆå«",content:`ä»‹ç»ï¼š ç›‘å¬æ‰€æœ‰æˆ–æŸä¸ªå­åº”ç”¨çš„è·¯ç”±å˜åŒ–ï¼Œåœ¨å­åº”ç”¨é¡µé¢æ¸²æŸ“åæ‰§è¡Œã€‚
ä½¿ç”¨èŒƒå›´ï¼š ä¸»åº”ç”¨
/** * @param {object} to å·²ç»è¿›å…¥çš„è·¯ç”± * @param {object} from å·²ç»ç¦»å¼€çš„è·¯ç”± * @param {string} name å­åº”ç”¨çš„name * @return cancel function è§£ç»‘è·¯ç”±ç›‘å¬å‡½æ•° */
router.afterEach((to, from, name) => {} | { name: (to, from) => {} })
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // ç›‘å¬æ‰€æœ‰å­åº”ç”¨çš„è·¯ç”±å˜åŒ–
microApp.router.afterEach((to, from, appName) => { console.log('å…¨å±€åç½®å®ˆå« afterEach: ', to, from, appName)
}) // ç›‘å¬æŸä¸ªå­åº”ç”¨çš„è·¯ç”±å˜åŒ–
microApp.router.afterEach({ å­åº”ç”¨1name (to, from) { console.log('æŒ‡å®šå­åº”ç”¨çš„åç½®å®ˆå« afterEach ', to, from) }, å­åº”ç”¨2name (to, from) { console.log('æŒ‡å®šå­åº”ç”¨çš„åç½®å®ˆå« beforeEach ', to, from) }
}) // afterEachä¼šè¿”å›ä¸€ä¸ªè§£ç»‘å‡½æ•°
const cancelCallback = microApp.router.afterEach((to, from, appName) => { console.log('å…¨å±€åç½®å®ˆå« afterEach: ', to, from, appName)
}) // è§£ç»‘è·¯ç”±ç›‘å¬
cancelCallback()`},{header:"è·å–è·¯ç”±ä¿¡æ¯",slug:"è·å–è·¯ç”±ä¿¡æ¯",content:`ä»‹ç»ï¼š è·å–å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯ï¼Œè¿”å›å€¼ä¸å­åº”ç”¨çš„locationç›¸åŒ
/** * @param {string} name å¿…å¡«ï¼Œå­åº”ç”¨çš„name */
router.current.get(name)
ç¤ºä¾‹ï¼š import microApp from '@micro-zoe/micro-app' // è·å–å­åº”ç”¨my-appçš„è·¯ç”±ä¿¡æ¯ï¼Œè¿”å›å€¼ä¸å­åº”ç”¨çš„locationç›¸åŒ
const routeInfo = microApp.router.current.get('my-app') // è·å–å­åº”ç”¨my-appçš„è·¯ç”±ä¿¡æ¯ï¼Œè¿”å›å€¼ä¸å­åº”ç”¨çš„locationç›¸åŒ
const routeInfo = window.microApp.router.current.get('my-app')`},{header:"ç¼–è§£ç ",slug:"ç¼–è§£ç ",content:`ä»‹ç»ï¼š å­åº”ç”¨åŒæ­¥åˆ°æµè§ˆå™¨çš„è·¯ç”±ä¿¡æ¯æ˜¯ç»è¿‡ç‰¹æ®Šç¼–ç çš„(encodeURIComponent + ç‰¹æ®Šå­—ç¬¦è½¬è¯‘)ï¼Œå¦‚æœç”¨æˆ·æƒ³è¦ç¼–ç æˆ–è§£ç å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ç¼–è§£ç çš„APIã€‚ /** * ç¼–ç  * @param {string} path å¿…å¡«ï¼Œé¡µé¢åœ°å€ */
router.encode(path: string) /** * è§£ç  * @param {string} path å¿…å¡«ï¼Œé¡µé¢åœ°å€ */
router.decode(path: string)
ç¤ºä¾‹ï¼š import microApp from '@micro-zoe/micro-app' // è¿”å› %2Fpage1%2F
const encodeResult = microApp.router.encode('/page1/') // è¿”å› /page1/
const encodeResult = microApp.router.decode('%2Fpage1%2F') // è¿”å› %2Fpage1%2F
const encodeResult = window.microApp.router.encode('/page1/') // è¿”å› /page1/
const encodeResult = window.microApp.router.decode('%2Fpage1%2F')`},{header:"åŒæ­¥è·¯ç”±ä¿¡æ¯",slug:"åŒæ­¥è·¯ç”±ä¿¡æ¯",content:`åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¸»åº”ç”¨çš„è·³è½¬ä¼šå¯¼è‡´æµè§ˆå™¨åœ°å€ä¸Šå­åº”ç”¨ä¿¡æ¯ä¸¢å¤±ï¼Œæ­¤æ—¶å¯ä»¥ä¸»åŠ¨è°ƒç”¨æ–¹æ³•ï¼Œå°†å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Šã€‚
ä»‹ç»ï¼š ä¸»åŠ¨å°†å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Š
ä½¿ç”¨èŒƒå›´ï¼š ä¸»åº”ç”¨
/** * å°†æŒ‡å®šå­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Š * å¦‚æœåº”ç”¨æœªæ¸²æŸ“æˆ–å·²ç»å¸è½½ï¼Œåˆ™æ–¹æ³•æ— æ•ˆ * @param {string} name å­åº”ç”¨çš„åç§° */
router.attachToURL(name: string) /** * å°†æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Š * å®ƒæ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š * @param {boolean} includeHiddenApp æ˜¯å¦åŒ…å«å·²ç»éšè—çš„keep-aliveåº”ç”¨ï¼Œé»˜è®¤ä¸ºfalse * @param {boolean} includePreRender æ˜¯å¦åŒ…å«é¢„æ¸²æŸ“åº”ç”¨ï¼Œé»˜è®¤ä¸ºfalse */
router.attachAllToURL({ includeHiddenApp?: boolean, includePreRender?: boolean,
})
ç¤ºä¾‹ï¼š
import microApp from '@micro-zoe/micro-app' // å°†my-appçš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Š
microApp.router.attachToURL('my-app') // å°†æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Šï¼Œä¸åŒ…å«å¤„äºéšè—çŠ¶æ€çš„keep-aliveåº”ç”¨å’Œé¢„æ¸²æŸ“åº”ç”¨
microApp.router.attachAllToURL() // å°†æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Šï¼ŒåŒ…å«å¤„äºéšè—çŠ¶æ€çš„keep-aliveåº”ç”¨
microApp.router.attachAllToURL({ includeHiddenApp: true }) // å°†æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ä¸Šï¼ŒåŒ…å«é¢„æ¸²æŸ“åº”ç”¨
microApp.router.attachAllToURL({ includePreRender: true })`}]},{path:"/zh/sandbox.html",title:"JSæ²™ç®±",pathLocale:"/",contents:[{header:"JSæ²™ç®±",slug:"jsæ²™ç®±",content:""},{header:"æ²™ç®±ä»‹ç»",slug:"æ²™ç®±ä»‹ç»",content:`æˆ‘ä»¬ä½¿ç”¨Proxyæ‹¦æˆªäº†ç”¨æˆ·å…¨å±€æ“ä½œçš„è¡Œä¸ºï¼Œé˜²æ­¢å¯¹windowçš„è®¿é—®å’Œä¿®æ”¹ï¼Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“ã€‚micro-appä¸­çš„æ¯ä¸ªå­åº”ç”¨éƒ½è¿è¡Œåœ¨æ²™ç®±ç¯å¢ƒï¼Œä»¥è·å–ç›¸å¯¹çº¯å‡€çš„è¿è¡Œç©ºé—´ã€‚
æ²™ç®±æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸å»ºè®®å…³é—­ï¼Œä»¥é¿å…å‡ºç°ä¸å¯é¢„çŸ¥çš„é—®é¢˜ã€‚
å¦‚ä½•å…³é—­æ²™ç®±è¯·æŸ¥çœ‹ï¼šdisableSandbox`},{header:"æ³¨æ„äº‹é¡¹",slug:"æ³¨æ„äº‹é¡¹",content:""},{header:"1ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°çœŸå®window",slug:"_1ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°çœŸå®window",content:`ç›®å‰æœ‰3ç§æ–¹å¼åœ¨å­åº”ç”¨ä¸­è·å–å¤–éƒ¨çœŸå®window 1ã€new Function("return window")() æˆ– Function("return window")()
2ã€(0, eval)('window')
3ã€window.rawWindow`},{header:"2ã€å­åº”ç”¨æŠ›å‡ºé”™è¯¯ä¿¡æ¯ï¼šxxx æœªå®šä¹‰",slug:"_2ã€å­åº”ç”¨æŠ›å‡ºé”™è¯¯ä¿¡æ¯-xxx-æœªå®šä¹‰",content:`åŒ…æ‹¬ï¼š xxx is not defined
xxx is not a function
Cannot read properties of undefined åŸå› ï¼š
åœ¨æ²™ç®±ç¯å¢ƒä¸­ï¼Œé¡¶å±‚å˜é‡ä¸ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ã€‚
ä¾‹å¦‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ var name æˆ– function name () {} å®šä¹‰çš„é¡¶å±‚å˜é‡ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œé€šè¿‡window.nameæˆ–nameå°±å¯ä»¥å…¨å±€è®¿é—®ã€‚
ä½†æ˜¯åœ¨æ²™ç®±ç¯å¢ƒä¸‹è¿™äº›é¡¶å±‚å˜é‡æ— æ³•æ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œwindow.nameæˆ–nameçš„å€¼ä¸ºundefinedï¼Œå¯¼è‡´å‡ºç°é—®é¢˜ã€‚
è§£å†³æ–¹å¼ï¼š
æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨ä¿®æ”¹
å°† var name æˆ– function name () {} ä¿®æ”¹ä¸º window.name = xx
æ–¹å¼äºŒï¼šé€šè¿‡æ’ä»¶ç³»ç»Ÿä¿®æ”¹å­åº”ç”¨ä»£ç 
æ¯”å¦‚å¸¸è§çš„åŠ è½½webpackæ‰“åŒ…çš„dllæ–‡ä»¶å¤±è´¥çš„é—®é¢˜ï¼Œå› ä¸ºdllæ–‡ä»¶çš„å†…å®¹å’Œjsåœ°å€ç›¸å¯¹å›ºå®šï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå…¨å±€æŸ¥æ‰¾å’Œä¿®æ”¹ã€‚
microApp.start({ plugins: { modules: { åº”ç”¨åç§°: [{ loader(code, url) { if (url === 'xxx.js') { code = code.replace('var xx_dll=', 'window.xx_dll=') } return code } }] } }
})`},{header:"3ã€åŸºåº§å¦‚ä½•å¯¹å­åº”ç”¨ document çš„ä¸€äº›å±æ€§è¿›è¡Œè‡ªå®šä¹‰ä»£ç†æ‰©å±•",slug:"_3ã€åŸºåº§å¦‚ä½•å¯¹å­åº”ç”¨-document-çš„ä¸€äº›å±æ€§è¿›è¡Œè‡ªå®šä¹‰ä»£ç†æ‰©å±•",content:`åœºæ™¯ï¼š
å¾®å‰ç«¯æ¨¡å¼ä¸‹ï¼Œé€šå¸¸ç”±åŸºåº§è´Ÿè´£è®¾ç½®ç«™ç‚¹æ ‡é¢˜ï¼Œä¸å¸Œæœ›å—åˆ°å­åº”ç”¨çš„å¹²æ‰°ã€‚
ä½†æ˜¯å› ä¸º microApp å¯¹ documet çš„ä»£ç†å¤„ç†è¿‡ç¨‹ï¼Œå¹¶æ²¡æœ‰å¤„ç† document.titleï¼Œæ‰€ä»¥å­åº”ç”¨ä¸­å¯èƒ½é€šè¿‡ document.title = 'xxx' æ„å¤–æ”¹å˜äº†åŸºåº§çš„ç«™ç‚¹æ ‡é¢˜ã€‚
è§£å†³æ–¹å¼ï¼š
é€šè¿‡ customProxyDocumentProps å¯¹ document çš„å±æ€§è¿›è¡Œè‡ªå®šä¹‰ä»£ç†æ‰©å±•
é€šè¿‡ç»™titleè®¾ç½®ä¸€ä¸ªç©ºå‡½æ•°ï¼Œæ¥å¿½ç•¥ document.title æ‰§è¡Œ
microApp.start({ customProxyDocumentProperties: new Map([ ['title', (value) => {}] ]),
})`}]},{path:"/zh/scopecss.html",title:"æ ·å¼éš”ç¦»",pathLocale:"/",contents:[{header:"æ ·å¼éš”ç¦»",slug:"æ ·å¼éš”ç¦»",content:""},{header:"ä¸€ã€æ ·å¼éš”ç¦»",slug:"ä¸€ã€æ ·å¼éš”ç¦»",content:`MicroAppçš„æ ·å¼éš”ç¦»æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¼€å¯åä¼šä»¥<micro-app>æ ‡ç­¾ä½œä¸ºæ ·å¼ä½œç”¨åŸŸï¼Œåˆ©ç”¨æ ‡ç­¾çš„nameå±æ€§ä¸ºæ¯ä¸ªæ ·å¼æ·»åŠ å‰ç¼€ï¼Œå°†å­åº”ç”¨çš„æ ·å¼å½±å“ç¦é”¢åœ¨å½“å‰æ ‡ç­¾åŒºåŸŸã€‚
.test { color: red;
} /* è½¬æ¢ä¸º */
micro-app[name=xxx] .test { color: red;
}
ä½†ä¸»åº”ç”¨çš„æ ·å¼ä¾ç„¶ä¼šå¯¹å­åº”ç”¨äº§ç”Ÿå½±å“ï¼Œå¦‚æœå‘ç”Ÿæ ·å¼æ±¡æŸ“ï¼Œæ¨èé€šè¿‡çº¦å®šå‰ç¼€æˆ–CSS Modulesæ–¹å¼è§£å†³ã€‚`},{header:"äºŒã€ç¦ç”¨æ ·å¼éš”ç¦»",slug:"äºŒã€ç¦ç”¨æ ·å¼éš”ç¦»",content:"ç¦ç”¨æ ·å¼éš”ç¦»åˆ†å››ä¸ªå±‚æ¬¡ï¼š"},{header:"1ã€åœ¨æ‰€æœ‰åº”ç”¨ä¸­ç¦ç”¨",slug:"_1ã€åœ¨æ‰€æœ‰åº”ç”¨ä¸­ç¦ç”¨",content:`è¿™ä¸»è¦é€šè¿‡startæ–¹æ³•è¿›è¡Œå…¨å±€é…ç½®ï¼Œè®¾ç½®åæ‰€æœ‰åº”ç”¨çš„æ ·å¼éš”ç¦»éƒ½ä¼šåœæ­¢ã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ disableScopecss: true, // é»˜è®¤å€¼false
})
å¦‚æœå¸Œæœ›åœ¨æŸä¸ªåº”ç”¨ä¸­ä¸å—å…¨å±€é…ç½®æ§åˆ¶ï¼Œå¯ä»¥è®¾ç½®disableScopecss='false'
<micro-app name='xx' url='xx' disableScopecss='false'></micro-app>`},{header:"2ã€åœ¨æŸä¸€ä¸ªåº”ç”¨ä¸­ç¦ç”¨",slug:"_2ã€åœ¨æŸä¸€ä¸ªåº”ç”¨ä¸­ç¦ç”¨",content:`è®¾ç½®åï¼Œå½“å‰åº”ç”¨çš„æ‰€æœ‰csséƒ½ä¸ä¼šè¿›è¡Œæ ·å¼éš”ç¦»ã€‚
<micro-app name='xx' url='xx' disableScopecss æˆ– disable-scopecss></micro-app>`},{header:"3ã€åœ¨æŸä¸€ä¸ªæ–‡ä»¶ä¸­ç¦ç”¨",slug:"_3ã€åœ¨æŸä¸€ä¸ªæ–‡ä»¶ä¸­ç¦ç”¨",content:`å¯ä»¥åœ¨ä½ çš„cssæ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹æ ¼å¼çš„æ³¨é‡Šæ¥ç¦ç”¨æ ·å¼éš”ç¦»ï¼š
/*! scopecss-disable */
.test1 { color: red;
}
/*! scopecss-enable */
ä½ ä¹Ÿå¯ä»¥å¯¹æŒ‡å®šçš„é€‰æ‹©å™¨ç¦ç”¨æ ·å¼éš”ç¦»:
/*! scopecss-disable .test1, .test2 */
.test1 { color: red;
}
.test2 { color: yellow;
}
.test3 { color: green;
}
/*! scopecss-enable */
å¦‚æœæƒ³åœ¨æ•´ä¸ªæ–‡ä»¶èŒƒå›´å†…ç¦ç”¨æ ·å¼éš”ç¦»ï¼Œå°† /*! scopecss-disable */ æ³¨é‡Šæ”¾åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼š
/*! scopecss-disable */
...`},{header:"4ã€åœ¨æŸä¸€è¡Œä¸­ç¦ç”¨",slug:"_4ã€åœ¨æŸä¸€è¡Œä¸­ç¦ç”¨",content:`åœ¨æ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹æ ¼å¼çš„æ³¨é‡Šåœ¨æŸä¸€ç‰¹å®šçš„è¡Œä¸Šç¦ç”¨æ ·å¼éš”ç¦»ï¼š
/*! scopecss-disable-next-line */
.test1 { color: red;
} .test2 { /*! scopecss-disable-next-line */ background: url(/test.png);
}
Note
ä¸Šè¿°æ³¨é‡Šè§„åˆ™éƒ½ä»¥å¹å·å¼€å¤´(d/*! */)ï¼Œè¿™æ˜¯å› ä¸ºåœ¨buildæ—¶å¤§éƒ¨åˆ†é¡¹ç›®ä¼šå°†cssä¸­çš„æ³¨é‡Šåˆ é™¤ä»¥å‹ç¼©ä½“ç§¯ï¼Œå¹å·å¼€å¤´æ˜¯cssnanoçš„ä¸€ç§è§„åˆ™ï¼Œå¯ä»¥é˜²æ­¢åœ¨buildæ—¶æ³¨é‡Šè¢«åˆ é™¤discardcommentsã€‚
æˆ‘ä»¬ä»¥cssnanoä¸ºä¾‹ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯PostCSSä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„å‹ç¼©æ’ä»¶ï¼Œå¦‚æœä½ ä½¿ç”¨äº†å¦å¤–çš„å‹ç¼©å·¥å…·ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼Œé˜²æ­¢buildåçš„æ³¨é‡Šè¢«åˆ é™¤ã€‚`},{header:"ä¸‰ã€shadowDOM",slug:"ä¸‰ã€shadowdom",content:`shadowDOMå…·æœ‰æ›´å¥½çš„éš”ç¦»æ€§ï¼Œä½†ä¸€äº›æ¡†æ¶(å¦‚React)å¯¹shadowDOMçš„å…¼å®¹æ€§ä¸å¥½ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚
å¼€å¯shadowDOMåï¼Œé»˜è®¤çš„æ ·å¼éš”ç¦»å°†å¤±æ•ˆã€‚
å¼€å¯æ–¹å¼ï¼šshadowDOM`}]},{path:"/zh/start.html",title:"å¿«é€Ÿå¼€å§‹",pathLocale:"/",contents:[{header:"å¿«é€Ÿå¼€å§‹",slug:"å¿«é€Ÿå¼€å§‹",content:"æˆ‘ä»¬åˆ†åˆ«åˆ—å‡ºä¸»åº”ç”¨å’Œå­åº”ç”¨éœ€è¦è¿›è¡Œçš„ä¿®æ”¹ï¼Œå…·ä½“ä»‹ç»micro-appçš„ä½¿ç”¨æ–¹å¼ã€‚"},{header:"ä¸»åº”ç”¨",slug:"ä¸»åº”ç”¨",content:`1ã€å®‰è£…ä¾èµ–
npm i @micro-zoe/micro-app --save
2ã€åˆå§‹åŒ–micro-app
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start()
3ã€åµŒå…¥å­åº”ç”¨ export function MyPage () { return ( <div> <h1>å­åº”ç”¨ğŸ‘‡</h1> // nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ <micro-app name='my-app' url='http://localhost:3000/'></micro-app> </div> )
} <template> <div> <h1>å­åº”ç”¨ğŸ‘‡</h1> <!-- nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ --> <micro-app name='my-app' url='http://localhost:3000/'></micro-app> </div>
</template>`},{header:"å­åº”ç”¨",slug:"å­åº”ç”¨",content:`1ã€åœ¨webpack-dev-serverçš„headersä¸­è®¾ç½®è·¨åŸŸæ”¯æŒã€‚
devServer: { headers: { 'Access-Control-Allow-Origin': '*', }
},
å®Œæˆä»¥ä¸Šæ­¥éª¤å³å®Œæˆå¾®å‰ç«¯çš„æ¥å…¥ã€‚
Note nameï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦ç‰¹æ®Šç¬¦å·(ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿é™¤å¤–)
urlï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»æŒ‡å‘å­åº”ç”¨çš„index.htmlï¼Œå¦‚ï¼šhttp://localhost:3000/ æˆ– http://localhost:3000/index.html
å­åº”ç”¨å¿…é¡»æ”¯æŒè·¨åŸŸï¼Œè·¨åŸŸé…ç½®å‚è€ƒè¿™é‡Œ`}]},{path:"/zh/static-source.html",title:"èµ„æºç³»ç»Ÿ",pathLocale:"/",contents:[{header:"èµ„æºç³»ç»Ÿ",slug:"èµ„æºç³»ç»Ÿ",content:""},{header:"èµ„æºè·¯å¾„è‡ªåŠ¨è¡¥å…¨",slug:"èµ„æºè·¯å¾„è‡ªåŠ¨è¡¥å…¨",content:`æ˜¯æŒ‡å¯¹å­åº”ç”¨ç›¸å¯¹åœ°å€çš„èµ„æºè·¯å¾„è¿›è¡Œè¡¥å…¨ï¼Œä»¥ç¡®ä¿æ‰€æœ‰èµ„æºæ­£å¸¸åŠ è½½ï¼Œå®ƒæ˜¯micro-appé»˜è®¤æä¾›çš„åŠŸèƒ½ã€‚
å¦‚ï¼šå­åº”ç”¨ä¸­å¼•ç”¨å›¾ç‰‡/myapp/test.pngï¼Œåœ¨æœ€ç»ˆæ¸²æŸ“æ—¶ä¼šè¡¥å…¨ä¸ºhttp://localhost:8080/myapp/test.png
èµ„æºè·¯å¾„è¡¥å…¨åˆ†ä¸ºä¸¤ä¸ªæ–¹é¢ï¼š
1ã€é’ˆå¯¹èµ„æºæ ‡ç­¾
å¦‚ linkã€scriptã€img
2ã€é’ˆå¯¹cssçš„è¿œç¨‹èµ„æº
å¦‚ background-imageã€@font-face è‡ªåŠ¨è¡¥å…¨æœ‰æ—¶ä¼šå¤±æ•ˆï¼Œå› ä¸ºä¸€äº›æ¡†æ¶å’Œåº“åœ¨ç‰¹å®šåœºæ™¯ä¸‹åˆ›å»ºçš„å…ƒç´ æ— æ³•è¢«æ‹¦æˆªå’Œå¤„ç†ï¼Œæˆ–è€…å½“å…³é—­æ ·å¼éš”ç¦»å’Œæ²™ç®±æ—¶ï¼Œä¹Ÿä¼šå¯¼è‡´è‡ªåŠ¨è¡¥å…¨å¤±æ•ˆã€‚
æ­¤æ—¶æ¨èä½¿ç”¨ä¸‹é¢publicPathæ–¹æ¡ˆè§£å†³ã€‚`},{header:"publicPath",slug:"publicpath",content:`å¦‚æœè‡ªåŠ¨è¡¥å…¨å¤±è´¥ï¼Œå¯ä»¥é‡‡ç”¨è¿è¡Œæ—¶publicPathæ–¹æ¡ˆè§£å†³ã€‚
è¿™æ˜¯ç”±webpackæä¾›çš„åŠŸèƒ½ï¼Œä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€è®¾ç½®webpack.publicPathï¼Œè¯¦ç»†é…ç½®å‚è€ƒwebpackæ–‡æ¡£ publicPath
å¦‚æœä½ å·²ç»è®¾ç½®äº†publicPathä¸ºå¸¦åŸŸåçš„ç»å¯¹åœ°å€(å¦‚ï¼šhttps://xxx)ï¼Œåˆ™å¿½ç•¥æ­¤ç« èŠ‚`},{header:"è®¾ç½®æ–¹å¼",slug:"è®¾ç½®æ–¹å¼",content:`æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"èµ„æºå…±äº«",slug:"èµ„æºå…±äº«",content:`å½“å¤šä¸ªå­åº”ç”¨æ‹¥æœ‰ç›¸åŒçš„jsæˆ–cssèµ„æºï¼Œå¯ä»¥æŒ‡å®šè¿™äº›èµ„æºåœ¨å¤šä¸ªå­åº”ç”¨ä¹‹é—´å…±äº«ï¼Œåœ¨å­åº”ç”¨åŠ è½½æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­æå–æ•°æ®ï¼Œä»è€Œæé«˜æ¸²æŸ“æ•ˆç‡å’Œæ€§èƒ½ã€‚
è®¾ç½®èµ„æºå…±äº«çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š`},{header:"æ–¹å¼ä¸€ã€globalAssets",slug:"æ–¹å¼ä¸€ã€globalassets",content:`globalAssetsç”¨äºè®¾ç½®å…¨å±€å…±äº«èµ„æºï¼Œå®ƒå’Œé¢„åŠ è½½çš„æ€è·¯ç›¸åŒï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½èµ„æºå¹¶æ”¾å…¥ç¼“å­˜ã€‚
å½“å­åº”ç”¨åŠ è½½ç›¸åŒåœ°å€çš„jsæˆ–cssèµ„æºæ—¶ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­æå–æ•°æ®ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start({ globalAssets: { js: ['jsåœ°å€1', 'jsåœ°å€2', ...], // jsåœ°å€ css: ['cssåœ°å€1', 'cssåœ°å€2', ...], // cssåœ°å€ }
})`},{header:"æ–¹å¼äºŒã€global å±æ€§",slug:"æ–¹å¼äºŒã€global-å±æ€§",content:`åœ¨linkã€scriptè®¾ç½®globalå±æ€§ä¼šå°†æ–‡ä»¶æå–ä¸ºå…¬å…±æ–‡ä»¶ï¼Œå…±äº«ç»™å…¶å®ƒåº”ç”¨ã€‚
è®¾ç½®globalå±æ€§åæ–‡ä»¶ç¬¬ä¸€æ¬¡åŠ è½½ä¼šæ”¾å…¥å…¬å…±ç¼“å­˜ï¼Œå…¶å®ƒå­åº”ç”¨åŠ è½½ç›¸åŒçš„èµ„æºæ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å†…å®¹ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" global>
<script src="xx.js" global><\/script>`},{header:"èµ„æºè¿‡æ»¤",slug:"èµ„æºè¿‡æ»¤",content:""},{header:"æ–¹å¼ä¸€ï¼šexcludeAssetFilter",slug:"æ–¹å¼ä¸€-excludeassetfilter",content:`åœ¨startä¸­æ³¨å†ŒexcludeAssetFilterè¿‡æ»¤å‡½æ•°ï¼Œå¯ä»¥æŒ‡å®šéƒ¨åˆ†ç‰¹æ®Šçš„åŠ¨æ€åŠ è½½çš„å¾®åº”ç”¨èµ„æºï¼ˆcss/js) ä¸è¢« micro-app åŠ«æŒå¤„ç†ã€‚
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start({ excludeAssetFilter (assetUrl) { if (assetUrl === 'xxx') { return true // è¿”å›trueåˆ™micro-appä¸ä¼šåŠ«æŒå¤„ç†å½“å‰æ–‡ä»¶ } return false }
})`},{header:"æ–¹å¼äºŒï¼šé…ç½® exclude å±æ€§",slug:"æ–¹å¼äºŒ-é…ç½®-exclude-å±æ€§",content:`åœ¨linkã€scriptã€styleç­‰å…ƒç´ ä¸Šè®¾ç½®excludeå±æ€§è¿‡æ»¤è¿™äº›èµ„æºï¼Œå½“micro-appé‡åˆ°å¸¦æœ‰excludeå±æ€§çš„å…ƒç´ ä¼šè¿›è¡Œåˆ é™¤ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" exclude>
<script src="xx.js" exclude><\/script>
<style exclude></style>`}]},{path:"/zh/transfer.html",title:"0.xè¿ç§»åˆ°1.0",pathLocale:"/",contents:[{header:"0.xè¿ç§»åˆ°1.0",slug:"_0-xè¿ç§»åˆ°1-0",content:"ä»0.xç‰ˆæœ¬è¿ç§»åˆ°1.0åªé’ˆå¯¹äºæ—§é¡¹ç›®ï¼Œå¦‚æœåœ¨è¿ç§»ä¸­å‘ç°é—®é¢˜ï¼Œè¯·åŠæ—¶åé¦ˆã€‚"},{header:"è¿ç§»æ­¥éª¤",slug:"è¿ç§»æ­¥éª¤",content:`1ã€å®‰è£…æœ€æ–°ç‰ˆæœ¬
npm i @micro-zoe/micro-app@latest --save
2ã€åœ¨startä¸­å¢åŠ é…ç½®
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start({ 'disable-memory-router': true, // å…³é—­è™šæ‹Ÿè·¯ç”±ç³»ç»Ÿ 'disable-patch-request': true, // å…³é—­å¯¹å­åº”ç”¨è¯·æ±‚çš„æ‹¦æˆª
})`},{header:"viteè¿ç§»",slug:"viteè¿ç§»",content:`è¿™é‡Œåªé’ˆå¯¹å­åº”ç”¨æ˜¯viteçš„æƒ…å†µï¼Œä¸»åº”ç”¨ä¸ºviteä¸éœ€è¦ç‰¹æ®Šå¤„ç†ã€‚
å¦‚æœä½ å·²ç»æ¥å…¥viteå­åº”ç”¨ä¸”æ­£å¸¸è¿è¡Œï¼Œä¸å»ºè®®è¿›è¡Œè¿ç§»æ“ä½œï¼Œé™¤éé‡åˆ°é—®é¢˜ã€‚`},{header:"è¿ç§»æ­¥éª¤ï¼š",slug:"è¿ç§»æ­¥éª¤-1",content:""},{header:"æ­¥éª¤1ï¼šåˆ é™¤å­åº”ç”¨vite.config.jsä¸­çš„é…ç½®",slug:"æ­¥éª¤1-åˆ é™¤å­åº”ç”¨vite-config-jsä¸­çš„é…ç½®",content:""},{header:"æ­¥éª¤2ï¼šå¼€å¯iframeæ²™ç®±",slug:"æ­¥éª¤2-å¼€å¯iframeæ²™ç®±",content:`åˆ é™¤ä¹‹å‰çš„ä¸¤ä¸ªé…ç½®é¡¹ï¼šinlineã€disableSandboxï¼Œç„¶åå¼€å¯iframeæ²™ç®±ã€‚
<micro-app name='åç§°' url='åœ°å€' iframe></micro-app>`},{header:"æ­¥éª¤3ï¼šåˆ é™¤ä¸»åº”ç”¨ä¸­çš„è‡ªå®šä¹‰æ’ä»¶",slug:"æ­¥éª¤3-åˆ é™¤ä¸»åº”ç”¨ä¸­çš„è‡ªå®šä¹‰æ’ä»¶",content:""},{header:"æ­¥éª¤4ï¼šåˆ é™¤æ‰‹åŠ¨æ³¨å†Œçš„é€šä¿¡å¯¹è±¡",slug:"æ­¥éª¤4-åˆ é™¤æ‰‹åŠ¨æ³¨å†Œçš„é€šä¿¡å¯¹è±¡",content:"åˆ é™¤æ‰‹åŠ¨æ³¨å†Œçš„é€šä¿¡å¯¹è±¡ï¼Œæ”¹ç”¨é»˜è®¤çš„é€šä¿¡æ–¹å¼è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œå‚è€ƒæ•°æ®é€šä¿¡ç« èŠ‚ã€‚"}]},{path:"/v0/zh/",title:"",pathLocale:"/",contents:[{header:"å¾®å‰ç«¯",slug:"å¾®å‰ç«¯",content:`å¾®å‰ç«¯çš„æ¦‚å¿µæ˜¯ç”±ThoughtWorksåœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒåœ¨äºå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹è¿è¡Œã€ç‹¬ç«‹éƒ¨ç½²ï¼Œå†å°†è¿™äº›å°å‹åº”ç”¨èåˆä¸ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ï¼Œæˆ–è€…å°†åŸæœ¬è¿è¡Œå·²ä¹…ã€æ²¡æœ‰å…³è”çš„å‡ ä¸ªåº”ç”¨èåˆä¸ºä¸€ä¸ªåº”ç”¨ã€‚å¾®å‰ç«¯æ—¢å¯ä»¥å°†å¤šä¸ªé¡¹ç›®èåˆä¸ºä¸€ï¼Œåˆå¯ä»¥å‡å°‘é¡¹ç›®ä¹‹é—´çš„è€¦åˆï¼Œæå‡é¡¹ç›®æ‰©å±•æ€§ï¼Œç›¸æ¯”ä¸€æ•´å—çš„å‰ç«¯ä»“åº“ï¼Œå¾®å‰ç«¯æ¶æ„ä¸‹çš„å‰ç«¯ä»“åº“å€¾å‘äºæ›´å°æ›´çµæ´»ã€‚
å®ƒä¸»è¦è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š 1ã€éšç€é¡¹ç›®è¿­ä»£åº”ç”¨è¶Šæ¥è¶Šåºå¤§ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚
2ã€è·¨å›¢é˜Ÿæˆ–è·¨éƒ¨é—¨åä½œå¼€å‘é¡¹ç›®å¯¼è‡´æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚`},{header:"å…³äºmicro-app",slug:"å…³äºmicro-app",content:`åœ¨micro-appä¹‹å‰ï¼Œä¸šå†…å·²ç»æœ‰ä¸€äº›å¼€æºçš„å¾®å‰ç«¯æ¡†æ¶ï¼Œæ¯”è¾ƒæµè¡Œçš„æœ‰2ä¸ªï¼šsingle-spaå’Œqiankunã€‚
single-spaæ˜¯é€šè¿‡ç›‘å¬ url change äº‹ä»¶ï¼Œåœ¨è·¯ç”±å˜åŒ–æ—¶åŒ¹é…åˆ°æ¸²æŸ“çš„å­åº”ç”¨å¹¶è¿›è¡Œæ¸²æŸ“ï¼Œè¿™ä¸ªæ€è·¯ä¹Ÿæ˜¯ç›®å‰å®ç°å¾®å‰ç«¯çš„ä¸»æµæ–¹å¼ã€‚åŒæ—¶single-spaè¦æ±‚å­åº”ç”¨ä¿®æ”¹æ¸²æŸ“é€»è¾‘å¹¶æš´éœ²å‡ºä¸‰ä¸ªæ–¹æ³•ï¼šbootstrapã€mountã€unmountï¼Œåˆ†åˆ«å¯¹åº”åˆå§‹åŒ–ã€æ¸²æŸ“å’Œå¸è½½ï¼Œè¿™ä¹Ÿå¯¼è‡´å­åº”ç”¨éœ€è¦å¯¹å…¥å£æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚å› ä¸ºqiankunæ˜¯åŸºäºsingle-spaè¿›è¡Œå°è£…ï¼Œæ‰€ä»¥è¿™äº›ç‰¹ç‚¹ä¹Ÿè¢«qiankunç»§æ‰¿ä¸‹æ¥ï¼Œå¹¶ä¸”éœ€è¦å¯¹webpacké…ç½®è¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚
micro-appå¹¶æ²¡æœ‰æ²¿è¢­single-spaçš„æ€è·¯ï¼Œè€Œæ˜¯å€Ÿé‰´äº†WebComponentçš„æ€æƒ³ï¼Œé€šè¿‡CustomElementç»“åˆè‡ªå®šä¹‰çš„ShadowDomï¼Œå°†å¾®å‰ç«¯å°è£…æˆä¸€ä¸ªç±»WebComponentç»„ä»¶ï¼Œä»è€Œå®ç°å¾®å‰ç«¯çš„ç»„ä»¶åŒ–æ¸²æŸ“ã€‚å¹¶ä¸”ç”±äºè‡ªå®šä¹‰ShadowDomçš„éš”ç¦»ç‰¹æ€§ï¼Œmicro-appä¸éœ€è¦åƒsingle-spaå’Œqiankunä¸€æ ·è¦æ±‚å­åº”ç”¨ä¿®æ”¹æ¸²æŸ“é€»è¾‘å¹¶æš´éœ²å‡ºæ–¹æ³•ï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹webpacké…ç½®ï¼Œæ˜¯ç›®å‰å¸‚é¢ä¸Šæ¥å…¥å¾®å‰ç«¯æˆæœ¬æœ€ä½çš„æ–¹æ¡ˆã€‚`},{header:"æ¦‚å¿µå›¾",slug:"æ¦‚å¿µå›¾",content:""},{header:"micro-appçš„ä¼˜åŠ¿",slug:"micro-appçš„ä¼˜åŠ¿",content:""},{header:"1ã€ä½¿ç”¨ç®€å•",slug:"_1ã€ä½¿ç”¨ç®€å•",content:`æˆ‘ä»¬å°†æ‰€æœ‰åŠŸèƒ½éƒ½å°è£…åˆ°ä¸€ä¸ªç±»WebComponentç»„ä»¶ä¸­ï¼Œä»è€Œå®ç°åœ¨åŸºåº§åº”ç”¨ä¸­åµŒå…¥ä¸€è¡Œä»£ç å³å¯æ¸²æŸ“ä¸€ä¸ªå¾®å‰ç«¯åº”ç”¨ã€‚
åŒæ—¶micro-appè¿˜æä¾›äº†jsæ²™ç®±ã€æ ·å¼éš”ç¦»ã€å…ƒç´ éš”ç¦»ã€é¢„åŠ è½½ã€æ•°æ®é€šä¿¡ã€é™æ€èµ„æºè¡¥å…¨ç­‰ä¸€ç³»åˆ—å®Œå–„çš„åŠŸèƒ½ã€‚`},{header:"2ã€é›¶ä¾èµ–",slug:"_2ã€é›¶ä¾èµ–",content:"micro-appæ²¡æœ‰ä»»ä½•ä¾èµ–ï¼Œè¿™èµ‹äºˆå®ƒå°å·§çš„ä½“ç§¯å’Œæ›´é«˜çš„æ‰©å±•æ€§ã€‚"},{header:"3ã€å…¼å®¹æ‰€æœ‰æ¡†æ¶",slug:"_3ã€å…¼å®¹æ‰€æœ‰æ¡†æ¶",content:"ä¸ºäº†ä¿è¯å„ä¸ªä¸šåŠ¡ä¹‹é—´ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹éƒ¨ç½²çš„èƒ½åŠ›ï¼Œmicro-appåšäº†è¯¸å¤šå…¼å®¹ï¼Œåœ¨ä»»ä½•æŠ€æœ¯æ¡†æ¶ä¸­éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œã€‚"}]},{path:"/v0/zh/advanced.html",title:"é«˜çº§åŠŸèƒ½",pathLocale:"/",contents:[{header:"é«˜çº§åŠŸèƒ½",slug:"é«˜çº§åŠŸèƒ½",content:""},{header:"1ã€è‡ªå®šä¹‰fetch",slug:"_1ã€è‡ªå®šä¹‰fetch",content:`é€šè¿‡è‡ªå®šä¹‰fetchæ›¿æ¢æ¡†æ¶è‡ªå¸¦çš„fetchï¼Œå¯ä»¥ä¿®æ”¹fetché…ç½®(æ·»åŠ cookieæˆ–headerä¿¡æ¯ç­‰ç­‰)ï¼Œæˆ–æ‹¦æˆªHTMLã€JSã€CSSç­‰é™æ€èµ„æºã€‚
è‡ªå®šä¹‰çš„fetchå¿…é¡»æ˜¯ä¸€ä¸ªè¿”å›stringç±»å‹çš„Promiseã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ /** * è‡ªå®šä¹‰fetch * @param {string} url é™æ€èµ„æºåœ°å€ * @param {object} options fetchè¯·æ±‚é…ç½®é¡¹ * @param {string|null} appName åº”ç”¨åç§° * @returns Promise<string> */ fetch (url, options, appName) { if (url === 'http://localhost:3001/error.js') { // åˆ é™¤ http://localhost:3001/error.js çš„å†…å®¹ return Promise.resolve('') } const config = { // fetch é»˜è®¤ä¸å¸¦cookieï¼Œå¦‚æœéœ€è¦æ·»åŠ cookieéœ€è¦é…ç½®credentials credentials: 'include', // è¯·æ±‚æ—¶å¸¦ä¸Šcookie } return window.fetch(url, Object.assign(options, config)).then((res) => { return res.text() }) }
})
Note
å¦‚æœè·¨åŸŸè¯·æ±‚å¸¦cookieï¼Œé‚£ä¹ˆAccess-Control-Allow-Originä¸èƒ½è®¾ç½®ä¸º*ï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„`},{header:"2ã€æ€§èƒ½&å†…å­˜ä¼˜åŒ–",slug:"_2ã€æ€§èƒ½-å†…å­˜ä¼˜åŒ–",content:`micro-appæ”¯æŒä¸¤ç§æ¸²æŸ“å¾®å‰ç«¯çš„æ¨¡å¼ï¼Œé»˜è®¤æ¨¡å¼å’Œumdæ¨¡å¼ã€‚ é»˜è®¤æ¨¡å¼ï¼š å­åº”ç”¨åœ¨åˆæ¬¡æ¸²æŸ“å’Œåç»­æ¸²æŸ“æ—¶ä¼šé¡ºåºæ‰§è¡Œæ‰€æœ‰jsï¼Œä»¥ä¿è¯å¤šæ¬¡æ¸²æŸ“çš„ä¸€è‡´æ€§ã€‚
umdæ¨¡å¼ï¼š å­åº”ç”¨æš´éœ²å‡ºmountã€unmountæ–¹æ³•ï¼Œæ­¤æ—¶åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œæ‰€æœ‰jsï¼Œåç»­æ¸²æŸ“åªä¼šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨å¤šæ¬¡æ¸²æŸ“æ—¶å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œå†…å­˜è¡¨ç°ã€‚ æˆ‘çš„é¡¹ç›®æ˜¯å¦éœ€è¦åˆ‡æ¢ä¸ºumdæ¨¡å¼?
å¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½ä¸é¢‘ç¹ï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤æ¨¡å¼å³å¯ï¼Œå¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½éå¸¸é¢‘ç¹å»ºè®®ä½¿ç”¨umdæ¨¡å¼ã€‚
åˆ‡æ¢ä¸ºumdæ¨¡å¼ï¼šå­åº”ç”¨åœ¨windowä¸Šæ³¨å†Œmountå’Œunmountæ–¹æ³• // index.js
import React from "react"
import ReactDOM from "react-dom"
import App from './App' // ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•° -- å¿…å¡«
export function mount () { ReactDOM.render(<App />, document.getElementById("root"))
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•° -- å¿…å¡«
export function unmount () { ReactDOM.unmountComponentAtNode(document.getElementById("root"))
} // å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œæ³¨å†Œmountå’Œunmountæ–¹æ³•
if (window.__MICRO_APP_ENVIRONMENT__) { window[\`micro-app-\${window.__MICRO_APP_NAME__}\`] = { mount, unmount }
} else { // éå¾®å‰ç«¯ç¯å¢ƒç›´æ¥æ¸²æŸ“ mount()
} è¿™é‡Œåªä»‹ç»é…åˆvue-router3.xçš„ç”¨æ³•
// main.js
import Vue from 'vue'
import router from './router'
import App from './App.vue' let app = null
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•° -- å¿…å¡«
function mount () { app = new Vue({ router, render: h => h(App), }).$mount('#app')
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•° -- å¿…å¡«
function unmount () { app.$destroy() app.$el.innerHTML = '' app = null
} // å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œæ³¨å†Œmountå’Œunmountæ–¹æ³•
if (window.__MICRO_APP_ENVIRONMENT__) { window[\`micro-app-\${window.__MICRO_APP_NAME__}\`] = { mount, unmount }
} else { // éå¾®å‰ç«¯ç¯å¢ƒç›´æ¥æ¸²æŸ“ mount()
} è¿™é‡Œåªä»‹ç»é…åˆvue-router4.xçš„ç”¨æ³•
// main.js
import { createApp } from 'vue'
import * as VueRouter from 'vue-router'
import routes from './router'
import App from './App.vue' let app = null
let router = null
let history = null
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•° -- å¿…å¡«
function mount () { history = VueRouter.createWebHistory(window.__MICRO_APP_BASE_ROUTE__ || '/') router = VueRouter.createRouter({ history, routes, }) app = createApp(App) app.use(router) app.mount('#app')
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•° -- å¿…å¡«
function unmount () { app.unmount() history.destroy() app = null router = null history = null
} // å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œæ³¨å†Œmountå’Œunmountæ–¹æ³•
if (window.__MICRO_APP_ENVIRONMENT__) { window[\`micro-app-\${window.__MICRO_APP_NAME__}\`] = { mount, unmount }
} else { // éå¾®å‰ç«¯ç¯å¢ƒç›´æ¥æ¸²æŸ“ mount()
} ä»¥angular11ä¸ºä¾‹ã€‚
// main.ts
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
import { AppModule } from './app/app.module'; declare global { interface Window { microApp: any __MICRO_APP_NAME__: string __MICRO_APP_ENVIRONMENT__: string }
} let app = null;
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•° -- å¿…å¡«
async function mount () { app = await platformBrowserDynamic() .bootstrapModule(AppModule) .catch(err => console.error(err))
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•° -- å¿…å¡«
function unmount () { // angularåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æ‰§è¡Œdestroyæ—¶ä¼šåˆ é™¤æ ¹å…ƒç´ app-rootï¼Œæ­¤æ—¶å¯åˆ é™¤app.destroy()ä»¥é¿å…è¿™ä¸ªé—®é¢˜ app.destroy(); app = null;
} // å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œæ³¨å†Œmountå’Œunmountæ–¹æ³•
if (window.__MICRO_APP_ENVIRONMENT__) { window[\`micro-app-\${window.__MICRO_APP_NAME__}\`] = { mount, unmount }
} else { // éå¾®å‰ç«¯ç¯å¢ƒç›´æ¥æ¸²æŸ“ mount();
} å› ä¸ºviteä½œä¸ºå­åº”ç”¨æ—¶å…³é—­äº†æ²™ç®±ï¼Œå¯¼è‡´__MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_NAME__ä¸¤ä¸ªå˜é‡å¤±æ•ˆï¼Œæ‰€ä»¥éœ€è¦è‡ªè¡Œåˆ¤æ–­æ˜¯å¦å¾®å‰ç«¯ç¯å¢ƒä»¥åŠæ‰‹åŠ¨å¡«å†™åº”ç”¨nameå€¼ã€‚
è¿™é‡Œä»¥ vue3 + vue-router4 ä¸ºä¾‹ï¼š
// main.js
import { createApp } from 'vue'
import * as VueRouter from 'vue-router'
import routes from './router'
import App from './App.vue' let app = null
let router = null
let history = null
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•° -- å¿…å¡«
function mount () { history = VueRouter.createWebHashHistory() router = VueRouter.createRouter({ history, routes, }) app = createApp(App) app.use(router) app.mount('#app')
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•° -- å¿…å¡«
function unmount () { app.unmount() history.destroy() app = null router = null history = null
} // å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œæ³¨å†Œmountå’Œunmountæ–¹æ³•
if (å¦‚æœæ˜¯å¾®å‰ç«¯ç¯å¢ƒ) { // åº”ç”¨çš„nameå€¼ï¼Œå³ <micro-app> å…ƒç´ çš„nameå±æ€§å€¼ window[\`micro-app-\${åº”ç”¨çš„nameå€¼}\`] = { mount, unmount }
} else { // éå¾®å‰ç«¯ç¯å¢ƒç›´æ¥æ¸²æŸ“ mount()
} // entry.js // ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•° -- å¿…å¡«
function mount () { ...
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•° -- å¿…å¡«
function unmount () { ...
} // å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œæ³¨å†Œmountå’Œunmountæ–¹æ³•
if (window.__MICRO_APP_ENVIRONMENT__) { window[\`micro-app-\${window.__MICRO_APP_NAME__}\`] = { mount, unmount }
} else { // éå¾®å‰ç«¯ç¯å¢ƒç›´æ¥æ¸²æŸ“ mount()
}`},{header:"è‡ªå®šä¹‰åç§°",slug:"è‡ªå®šä¹‰åç§°",content:`é€šå¸¸æ³¨å†Œå‡½æ•°çš„å½¢å¼ä¸º window['micro-app-\${window.__MICRO_APP_NAME__}'] = {}ï¼Œä½†ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åç§°ï¼Œwindow['è‡ªå®šä¹‰çš„åç§°'] = {}
è‡ªå®šä¹‰çš„å€¼éœ€è¦åœ¨<micro-app>æ ‡ç­¾ä¸­é€šè¿‡libraryå±æ€§æŒ‡å®šã€‚
<micro-app name='xxx' url='xxx' library='è‡ªå®šä¹‰çš„åç§°' ğŸ‘ˆ
></micro-app>
Note mountå’Œunmountæ–¹æ³•éƒ½æ˜¯å¿…é¡»çš„
nextjs, nuxtjsç­‰ssræ¡†æ¶ä½œä¸ºå­åº”ç”¨æ—¶æš‚ä¸æ”¯æŒumdæ¨¡å¼
å› ä¸ºæ³¨å†Œäº†unmountå‡½æ•°ï¼Œæ‰€ä»¥å¸è½½ç›‘å¬äº‹ä»¶ window.addEventListener('unmount', () => {}) å°±ä¸éœ€è¦äº†
umdæ¨¡å¼ä¸‹ï¼Œå› ä¸ºåˆæ¬¡æ¸²æŸ“å’Œåç»­æ¸²æŸ“é€»è¾‘ä¸åŒï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå¦‚ï¼š#138`}]},{path:"/v0/zh/api.html",title:"",pathLocale:"/",contents:[{header:"start",slug:"start",content:"æè¿°ï¼š micro-appæ³¨å†Œå‡½æ•°ï¼Œå…¨å±€æ‰§è¡Œä¸€æ¬¡\nä»‹ç»ï¼š\nstart (options?: { tagName?: string, // æ ‡ç­¾åç§°ï¼Œé»˜è®¤ä¸ºmicro-app shadowDOM?: boolean, // æ˜¯å¦å¼€å¯shadowDOMï¼Œé»˜è®¤ä¸ºfalse destroy?: boolean, // æ˜¯å¦åœ¨å­åº”ç”¨å¸è½½æ—¶å¼ºåˆ¶é”€æ¯æ‰€æœ‰ç¼“å­˜èµ„æºï¼Œé»˜è®¤ä¸ºfalse inline?: boolean, // æ˜¯å¦ä½¿ç”¨å†…è”scriptæ–¹å¼æ‰§è¡Œjsï¼Œé»˜è®¤ä¸ºfalse disableScopecss?: boolean, // æ˜¯å¦å…¨å±€ç¦ç”¨æ ·å¼éš”ç¦»ï¼Œé»˜è®¤ä¸ºfalse disableSandbox?: boolean, // æ˜¯å¦å…¨å±€ç¦ç”¨æ²™ç®±ï¼Œé»˜è®¤ä¸ºfalse ssr?: boolean, // æ˜¯å¦å…¨å±€å¯ç”¨ssræ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalse // å…¨å±€ç”Ÿå‘½å‘¨æœŸ lifeCycles?: { created?(e?: CustomEvent): void beforemount?(e?: CustomEvent): void mounted?(e?: CustomEvent): void unmount?(e?: CustomEvent): void error?(e?: CustomEvent): void }, // é¢„åŠ è½½ï¼Œæ”¯æŒæ•°ç»„æˆ–å‡½æ•° preFetchApps?: Array<{ name: string, url: string, disableScopecss?: boolean, disableSandbox?: boolean, shadowDOM?: boolean }> | (() => Array<{ name: string, url: string, disableScopecss?: boolean, disableSandbox?: boolean, shadowDOM?: boolean }>), // æ’ä»¶ç³»ç»Ÿï¼Œç”¨äºå¤„ç†å­åº”ç”¨çš„jsæ–‡ä»¶ plugins?: { // å…¨å±€æ’ä»¶ï¼Œä½œç”¨äºæ‰€æœ‰å­åº”ç”¨çš„jsæ–‡ä»¶ global?: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°åŸºåº§åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¯é€‰ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => string, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => string }> // å­åº”ç”¨æ’ä»¶ modules?: { // appNameä¸ºåº”ç”¨çš„åç§°ï¼Œè¿™äº›æ’ä»¶åªä¼šä½œç”¨äºæŒ‡å®šçš„åº”ç”¨ [name: string]: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°åŸºåº§åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¿…å¡«ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å›codeå€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => string, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => string }> } }, // é‡å®šä¹‰fetchæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºæ‹¦æˆªèµ„æºè¯·æ±‚æ“ä½œ fetch?: (url: string, options: Record<string, any>, appName: string | null) => Promise<string> // è®¾ç½®å…¨å±€é™æ€èµ„æº globalAssets?: { js?: string[], // jsåœ°å€ css?: string[], // cssåœ°å€ },\n})\nä½¿ç”¨æ–¹å¼ï¼š\n// index.js\nimport microApp from '@micro-zoe/micro-app' microApp.start()"},{header:"preFetch",slug:"prefetch",content:`æè¿°ï¼š é¢„åŠ è½½ï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´ï¼Œä¾ç…§å¼€å‘è€…ä¼ å…¥çš„é¡ºåºï¼Œä¾æ¬¡åŠ è½½æ¯ä¸ªåº”ç”¨çš„é™æ€èµ„æº
ä»‹ç»ï¼š
preFetch([ { name: string, url: string, disableScopecss?: boolean, disableSandbox?: boolean, },
])
ä½¿ç”¨æ–¹å¼ï¼š
import { preFetch } from '@micro-zoe/micro-app' // æ–¹å¼ä¸€
preFetch([ { name: 'my-app1', url: 'xxx' }, { name: 'my-app2', url: 'xxx' },
]) // æ–¹å¼äºŒ
preFetch(() => [ { name: 'my-app1', url: 'xxx' }, { name: 'my-app2', url: 'xxx' },
])`},{header:"getActiveApps",slug:"getactiveapps",content:`æè¿°ï¼š è·å–æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨ï¼Œä¸åŒ…å«å·²å¸è½½å’Œé¢„åŠ è½½çš„åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.5.2åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
/** * @param excludeHiddenApp æ˜¯å¦è¿‡æ»¤å¤„äºéšè—çŠ¶æ€çš„keep-aliveåº”ç”¨ï¼Œé»˜è®¤false */
function getActiveApps(excludeHiddenApp?: boolean): string[]
ä½¿ç”¨æ–¹å¼ï¼š
import { getActiveApps } from '@micro-zoe/micro-app' getActiveApps() // [å­åº”ç”¨name, å­åº”ç”¨name, ...] getActiveApps(true) // å¤„äºéšè—çŠ¶æ€çš„keep-aliveå°†ä¼šè¢«è¿‡æ»¤`},{header:"getAllApps",slug:"getallapps",content:`æè¿°ï¼š è·å–æ‰€æœ‰å­åº”ç”¨ï¼ŒåŒ…å«å·²å¸è½½å’Œé¢„åŠ è½½çš„åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.5.2åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
function getAllApps(): string[]
ä½¿ç”¨æ–¹å¼ï¼š
import { getAllApps } from '@micro-zoe/micro-app' getAllApps() // [å­åº”ç”¨name, å­åº”ç”¨name, ...]`},{header:"version",slug:"version",content:`æè¿°ï¼š æŸ¥çœ‹ç‰ˆæœ¬å·
æ–¹å¼1ï¼š
import { version } from '@micro-zoe/micro-app'
æ–¹å¼2ï¼š é€šè¿‡micro-appå…ƒç´ ä¸Šçš„versionå±æ€§æŸ¥çœ‹
document.querySelector('micro-app').version`},{header:"pureCreateElement",slug:"purecreateelement",content:`æè¿°ï¼š åˆ›å»ºæ— ç»‘å®šçš„çº¯å‡€å…ƒç´ 
ä½¿ç”¨æ–¹å¼ï¼š
import { pureCreateElement } from '@micro-zoe/micro-app' const pureDiv = pureCreateElement('div') document.body.appendChild(pureDiv)`},{header:"removeDomScope",slug:"removedomscope",content:`æè¿°ï¼š è§£é™¤å…ƒç´ ç»‘å®šï¼Œé€šå¸¸ç”¨äºå—å­åº”ç”¨å…ƒç´ ç»‘å®šå½±å“ï¼Œå¯¼è‡´åŸºåº§å…ƒç´ é”™è¯¯ç»‘å®šåˆ°å­åº”ç”¨çš„æƒ…å†µ
ä½¿ç”¨æ–¹å¼ï¼š
import { removeDomScope } from '@micro-zoe/micro-app' // é‡ç½®ä½œç”¨åŸŸ
removeDomScope()`},{header:"EventCenterForMicroApp",slug:"eventcenterformicroapp",content:`æè¿°ï¼š åˆ›å»ºå­åº”ç”¨é€šä¿¡å¯¹è±¡ï¼Œç”¨äºæ²™ç®±å…³é—­æ—¶(å¦‚ï¼švite)ä¸å­åº”ç”¨è¿›è¡Œé€šä¿¡
ä½¿ç”¨æ–¹å¼ï¼š
import { EventCenterForMicroApp } from '@micro-zoe/micro-app' // æ¯ä¸ªå­åº”ç”¨æ ¹æ®appNameå•ç‹¬åˆ†é…ä¸€ä¸ªé€šä¿¡å¯¹è±¡
window.eventCenterForAppName = new EventCenterForMicroApp(appName)
è¯¦æƒ…æŸ¥çœ‹ï¼šå…³é—­æ²™ç®±åçš„é€šä¿¡æ–¹å¼`},{header:"unmountApp",slug:"unmountapp",content:`æè¿°ï¼š æ‰‹åŠ¨å¸è½½åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.6.1åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
// unmountApp å‚æ•°é…ç½®
interface unmountAppParams { /** * destroy: æ˜¯å¦å¼ºåˆ¶å¸è½½åº”ç”¨å¹¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œé»˜è®¤å€¼ï¼šfalse * ä¼˜å…ˆçº§: é«˜äº clearAliveState * å¯¹äºå·²ç»å¸è½½çš„åº”ç”¨: å½“å­åº”ç”¨å·²ç»å¸è½½æˆ–keep-aliveåº”ç”¨å·²ç»æ¨å…¥åå°ï¼Œåˆ™æ¸…é™¤åº”ç”¨çŠ¶æ€åŠç¼“å­˜èµ„æº * å¯¹äºæ­£åœ¨è¿è¡Œçš„åº”ç”¨: å½“å­åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œåˆ™å¸è½½åº”ç”¨å¹¶åˆ é™¤çŠ¶æ€åŠç¼“å­˜èµ„æº */ destroy?: boolean; /** * clearAliveState: æ˜¯å¦æ¸…ç©ºåº”ç”¨çš„ç¼“å­˜çŠ¶æ€ï¼Œé»˜è®¤å€¼ï¼šfalse * è§£é‡Š: å¦‚æœå­åº”ç”¨æ˜¯keep-aliveï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æºï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveï¼Œåˆ™æ‰§è¡Œæ­£å¸¸å¸è½½æµç¨‹ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº * è¡¥å……: æ— è®ºkeep-aliveåº”ç”¨æ­£åœ¨è¿è¡Œè¿˜æ˜¯å·²ç»æ¨å…¥åå°ï¼Œéƒ½å°†æ‰§è¡Œå¸è½½æ“ä½œï¼Œæ¸…ç©ºåº”ç”¨ç¼“å­˜çŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº */ clearAliveState?: boolean;
} function unmountApp(appName: string, options?: unmountAppParams): Promise<void>
ä½¿ç”¨æ–¹å¼ï¼š
// æ­£å¸¸æµç¨‹
unmountApp(å­åº”ç”¨åç§°).then(() => console.log('å¸è½½æˆåŠŸ')) // å¸è½½åº”ç”¨å¹¶æ¸…ç©ºç¼“å­˜èµ„æº
unmountApp(å­åº”ç”¨åç§°, { destroy: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœå­åº”ç”¨æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™æ­£å¸¸å¸è½½
unmountApp(å­åº”ç”¨åç§°, { clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœdestroyå’ŒclearAliveStateåŒæ—¶ä¸ºtrueï¼Œåˆ™clearAliveStateå°†å¤±æ•ˆ
unmountApp(å­åº”ç”¨åç§°, { destroy: true, clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ'))`},{header:"unmountAllApps",slug:"unmountallapps",content:`æè¿°ï¼š æ‰‹åŠ¨å¸è½½æ‰€æœ‰åº”ç”¨
ç‰ˆæœ¬é™åˆ¶ï¼š 0.6.1åŠä»¥ä¸Šç‰ˆæœ¬
ä»‹ç»ï¼š
// unmountAllApps å‚æ•°é…ç½®
interface unmountAppParams { /** * destroy: æ˜¯å¦å¼ºåˆ¶å¸è½½åº”ç”¨å¹¶åˆ é™¤ç¼“å­˜èµ„æºï¼Œé»˜è®¤å€¼ï¼šfalse * ä¼˜å…ˆçº§: é«˜äº clearAliveState * å¯¹äºå·²ç»å¸è½½çš„åº”ç”¨: å½“å­åº”ç”¨å·²ç»å¸è½½æˆ–keep-aliveåº”ç”¨å·²ç»æ¨å…¥åå°ï¼Œåˆ™æ¸…é™¤åº”ç”¨çŠ¶æ€åŠç¼“å­˜èµ„æº * å¯¹äºæ­£åœ¨è¿è¡Œçš„åº”ç”¨: å½“å­åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œåˆ™å¸è½½åº”ç”¨å¹¶åˆ é™¤çŠ¶æ€åŠç¼“å­˜èµ„æº */ destroy?: boolean; /** * clearAliveState: æ˜¯å¦æ¸…ç©ºåº”ç”¨çš„ç¼“å­˜çŠ¶æ€ï¼Œé»˜è®¤å€¼ï¼šfalse * è§£é‡Š: å¦‚æœå­åº”ç”¨æ˜¯keep-aliveï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æºï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveï¼Œåˆ™æ‰§è¡Œæ­£å¸¸å¸è½½æµç¨‹ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº * è¡¥å……: æ— è®ºkeep-aliveåº”ç”¨æ­£åœ¨è¿è¡Œè¿˜æ˜¯å·²ç»æ¨å…¥åå°ï¼Œéƒ½å°†æ‰§è¡Œå¸è½½æ“ä½œï¼Œæ¸…ç©ºåº”ç”¨ç¼“å­˜çŠ¶æ€ï¼Œå¹¶ä¿ç•™ç¼“å­˜èµ„æº */ clearAliveState?: boolean;
} function unmountAllApps(options?: unmountAppParams): Promise<void>
ä½¿ç”¨æ–¹å¼ï¼š
// æ­£å¸¸æµç¨‹
unmountAllApps().then(() => console.log('å¸è½½æˆåŠŸ')) // å¸è½½æ‰€æœ‰åº”ç”¨å¹¶æ¸…ç©ºç¼“å­˜èµ„æº
unmountAllApps({ destroy: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœå­åº”ç”¨æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™å¸è½½å¹¶æ¸…ç©ºçŠ¶æ€ï¼Œå¦‚æœå­åº”ç”¨ä¸æ˜¯keep-aliveåº”ç”¨ï¼Œåˆ™æ­£å¸¸å¸è½½
unmountAllApps({ clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ')) // å¦‚æœdestroyå’ŒclearAliveStateåŒæ—¶ä¸ºtrueï¼Œåˆ™clearAliveStateå°†å¤±æ•ˆ
unmountAllApps({ destroy: true, clearAliveState: true }).then(() => console.log('å¸è½½æˆåŠŸ'))`},{header:"setData",slug:"setdata",content:`æè¿°ï¼š å‘æŒ‡å®šçš„å­åº”ç”¨å‘é€æ•°æ®
ä»‹ç»ï¼š
setData(appName: String, data: Object)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // å‘é€æ•°æ®ç»™å­åº”ç”¨ my-appï¼ŒsetDataç¬¬äºŒä¸ªå‚æ•°åªæ¥å—å¯¹è±¡ç±»å‹
microApp.setData('my-app', {type: 'æ–°çš„æ•°æ®'})`},{header:"getData",slug:"getdata",content:`æè¿°ï¼š è·å–æŒ‡å®šçš„å­åº”ç”¨dataæ•°æ®
ä»‹ç»ï¼š
getData(appName: String): Object
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' const childData = microApp.getData('my-app') // è¿”å›my-appå­åº”ç”¨çš„dataæ•°æ®`},{header:"addDataListener",slug:"adddatalistener",content:`æè¿°ï¼š ç›‘å¬æŒ‡å®šå­åº”ç”¨çš„æ•°æ®å˜åŒ–
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * appName: åº”ç”¨åç§° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addDataListener(appName: string, dataListener: Function, autoTrigger?: boolean)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
} microApp.addDataListener('my-app', dataListener)`},{header:"removeDataListener",slug:"removedatalistener",content:`æè¿°ï¼š è§£é™¤åŸºåº§ç»‘å®šçš„æŒ‡å®šå­åº”ç”¨çš„æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
} // è§£ç»‘ç›‘å¬my-appå­åº”ç”¨çš„æ•°æ®ç›‘å¬å‡½æ•°
microApp.removeDataListener('my-app', dataListener)`},{header:"clearDataListener",slug:"cleardatalistener",content:`æè¿°ï¼š æ¸…ç©ºåŸºåº§ç»‘å®šçš„æŒ‡å®šå­åº”ç”¨çš„æ‰€æœ‰æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // æ¸…ç©ºæ‰€æœ‰ç›‘å¬appNameå­åº”ç”¨çš„æ•°æ®ç›‘å¬å‡½æ•°
microApp.clearDataListener('my-app')`},{header:"getGlobalData",slug:"getglobaldata",content:`æè¿°ï¼š è·å–å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // ç›´æ¥è·å–æ•°æ®
const globalData = microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ®`},{header:"addGlobalDataListener",slug:"addglobaldatalistener",content:`æè¿°ï¼š ç»‘å®šæ•°æ®ç›‘å¬å‡½æ•°
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addGlobalDataListener(dataListener: Function, autoTrigger?: boolean)
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} microApp.addGlobalDataListener(dataListener)`},{header:"removeGlobalDataListener",slug:"removeglobaldatalistener",content:`æè¿°ï¼š è§£ç»‘å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} microApp.removeGlobalDataListener(dataListener)`},{header:"clearGlobalDataListener",slug:"clearglobaldatalistener",content:`æè¿°ï¼š æ¸…ç©ºåŸºåº§åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' microApp.clearGlobalDataListener()`},{header:"setGlobalData",slug:"setglobaldata",content:`æè¿°ï¼š å‘é€å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
import microApp from '@micro-zoe/micro-app' // setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'})`},{header:"pureCreateElement",slug:"purecreateelement-1",content:`æè¿°ï¼š åˆ›å»ºæ— ç»‘å®šçš„çº¯å‡€å…ƒç´ ï¼Œè¯¥å…ƒç´ å¯ä»¥é€ƒç¦»å…ƒç´ éš”ç¦»çš„è¾¹ç•Œï¼Œä¸å—å­åº”ç”¨æ²™ç®±çš„æ§åˆ¶
ç‰ˆæœ¬é™åˆ¶ï¼š 0.8.2åŠä»¥ä¸Šç‰ˆæœ¬
ä½¿ç”¨æ–¹å¼ï¼š
const pureDiv = window.microApp.pureCreateElement('div') document.body.appendChild(pureDiv)`},{header:"removeDomScope",slug:"removedomscope-1",content:`æè¿°ï¼š è§£é™¤å…ƒç´ ç»‘å®šï¼Œé€šå¸¸ç”¨äºå—å­åº”ç”¨å…ƒç´ ç»‘å®šå½±å“ï¼Œå¯¼è‡´åŸºåº§å…ƒç´ é”™è¯¯ç»‘å®šåˆ°å­åº”ç”¨çš„æƒ…å†µ
ç‰ˆæœ¬é™åˆ¶ï¼š 0.8.2åŠä»¥ä¸Šç‰ˆæœ¬
ä½¿ç”¨æ–¹å¼ï¼š
// é‡ç½®ä½œç”¨åŸŸ
window.microApp.removeDomScope()`},{header:"rawWindow",slug:"rawwindow",content:`æè¿°ï¼š è·å–çœŸå®çš„window
ä½¿ç”¨æ–¹å¼ï¼š
window.rawWindow`},{header:"rawDocument",slug:"rawdocument",content:`æè¿°ï¼š è·å–çœŸå®çš„document
ä½¿ç”¨æ–¹å¼ï¼š
window.rawDocument`},{header:"getData",slug:"getdata-1",content:`æè¿°ï¼š è·å–åŸºåº§ä¸‹å‘çš„dataæ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
const data = window.microApp.getData() // è¿”å›åŸºåº§ä¸‹å‘çš„dataæ•°æ®`},{header:"addDataListener",slug:"adddatalistener-1",content:`æè¿°ï¼š ç»‘å®šæ•°æ®ç›‘å¬å‡½æ•°
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•°ï¼Œç›‘å¬å‡½æ•°åªæœ‰åœ¨æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse * !!!é‡è¦è¯´æ˜: å› ä¸ºå­åº”ç”¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„ï¼Œè€ŒåŸºåº§å‘é€æ•°æ®æ˜¯åŒæ­¥çš„ï¼Œ * å¦‚æœåœ¨å­åº”ç”¨æ¸²æŸ“ç»“æŸå‰åŸºåº§åº”ç”¨å‘é€æ•°æ®ï¼Œåˆ™åœ¨ç»‘å®šç›‘å¬å‡½æ•°å‰æ•°æ®å·²ç»å‘é€ï¼Œåœ¨åˆå§‹åŒ–åä¸ä¼šè§¦å‘ç»‘å®šå‡½æ•°ï¼Œ * ä½†è¿™ä¸ªæ•°æ®ä¼šæ”¾å…¥ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶å¯ä»¥è®¾ç½®autoTriggerä¸ºtrueä¸»åŠ¨è§¦å‘ä¸€æ¬¡ç›‘å¬å‡½æ•°æ¥è·å–æ•°æ®ã€‚ */
window.microApp.addDataListener(dataListener: Function, autoTrigger?: boolean)
ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®', data)
} window.microApp.addDataListener(dataListener)`},{header:"removeDataListener",slug:"removedatalistener-1",content:`æè¿°ï¼š è§£ç»‘æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®', data)
} window.microApp.removeDataListener(dataListener)`},{header:"clearDataListener",slug:"cleardatalistener-1",content:`æè¿°ï¼š æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰æ•°æ®ç›‘å¬å‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
ä½¿ç”¨æ–¹å¼ï¼š
window.microApp.clearDataListener()`},{header:"dispatch",slug:"dispatch",content:`æè¿°ï¼š å‘åŸºåº§åº”ç”¨å‘é€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
// dispatchåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})`},{header:"getGlobalData",slug:"getglobaldata-1",content:`æè¿°ï¼š è·å–å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
const globalData = window.microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ®`},{header:"addGlobalDataListener",slug:"addglobaldatalistener-1",content:`æè¿°ï¼š ç»‘å®šæ•°æ®ç›‘å¬å‡½æ•°
ä»‹ç»ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.microApp.addGlobalDataListener(dataListener: Function, autoTrigger?: boolean) ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} window.microApp.addGlobalDataListener(dataListener)`},{header:"removeGlobalDataListener",slug:"removeglobaldatalistener-1",content:`æè¿°ï¼š è§£ç»‘å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} window.microApp.removeGlobalDataListener(dataListener)`},{header:"clearGlobalDataListener",slug:"clearglobaldatalistener-1",content:`æè¿°ï¼š æ¸…ç©ºå½“å‰å­åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
ä½¿ç”¨æ–¹å¼ï¼š
window.microApp.clearGlobalDataListener()`},{header:"setGlobalData",slug:"setglobaldata-1",content:`æè¿°ï¼š å‘é€å…¨å±€æ•°æ®
ä½¿ç”¨æ–¹å¼ï¼š
// setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'})`}]},{path:"/v0/zh/changelog.html",title:"æ›´æ–°æ—¥å¿—",pathLocale:"/",contents:[{header:"æ›´æ–°æ—¥å¿—",slug:"æ›´æ–°æ—¥å¿—",content:"micro-app éµå¾ª Semantic Versioning 2.0.0 è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒã€‚"},{header:"å‘å¸ƒå‘¨æœŸ",slug:"å‘å¸ƒå‘¨æœŸ",content:`ä¸»ç‰ˆæœ¬å·ï¼šå«æœ‰ç ´åæ€§æ›´æ–°å’Œæ–°ç‰¹æ€§ï¼Œä¸åœ¨å‘å¸ƒå‘¨æœŸå†…ã€‚
æ¬¡ç‰ˆæœ¬å·ï¼šæ¯æœˆå‘å¸ƒä¸€ä¸ªå¸¦æœ‰æ–°ç‰¹æ€§çš„å‘ä¸‹å…¼å®¹çš„ç‰ˆæœ¬ã€‚
ä¿®è®¢ç‰ˆæœ¬å·ï¼šæ¯å‘¨æœ«ä¼šè¿›è¡Œæ—¥å¸¸ bugfix æ›´æ–°ã€‚ï¼ˆå¦‚æœæœ‰ç´§æ€¥çš„ bugfixï¼Œåˆ™ä»»ä½•æ—¶å€™éƒ½å¯å‘å¸ƒï¼‰`},{header:"1.0.0-alpha.6",slug:"_1-0-0-alpha-6",content:"2022-08-18 New ğŸ†• Bug Fix ğŸ ä¿®å¤äº†routerå…¨å±€å®ˆå«å‚æ•°å’Œæ–‡æ¡£ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ Update ğŸš€"},{header:"1.0.0-alpha.5",slug:"_1-0-0-alpha-5",content:"2022-08-01 New ğŸ†• æ–°å¢å­åº”ç”¨å…¨å±€é’©å­å‡½æ•°mount, unmountï¼Œç®€åŒ–æ¥å…¥æ­¥éª¤ã€‚ Update ğŸš€ æ›´æ–°äº†1.0ç‰ˆæœ¬æ–‡æ¡£ã€‚"},{header:"1.0.0-alpha.4",slug:"_1-0-0-alpha-4",content:`2022-07-30 New ğŸ†• æ–°å¢äº†é…ç½®disable-patch-requestï¼Œç”¨äºé˜»æ­¢MicroAppå¯¹å­åº”ç”¨fetchã€XMLHttpRequestç­‰è¯·æ±‚æ–¹æ³•çš„é‡å†™ã€‚ Bug Fix ğŸ ä¿®å¤äº†è®¾ç½®document.title, history.scrollRestorationæ—¶æŠ¥Illegal invocationé”™è¯¯çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨umdæ¨¡å¼éƒ¨åˆ†åœºæ™¯ä¸‹äºŒæ¬¡æ¸²æŸ“æ—¶å…¨å±€å˜é‡å’Œå…¨å±€äº‹ä»¶ä¸¢å¤±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†é«˜å¾·åœ°å›¾äºŒæ¬¡æ¸²æŸ“æ—¶åœ°å›¾æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†element-plusæŒ‰éœ€åŠ è½½æ—¶ï¼Œç‚¹å‡»ElSelectç»„ä»¶ç©ºç™½åŒºåŸŸæ— æ³•æ”¶èµ·çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹æ¯æ¬¡æ¸²æŸ“æ—¶fetchã€XMLHttpRequestç­‰APIè¢«é‡å†™çš„é—®é¢˜ã€‚ Update ğŸš€ æ›´æ–°äº†umdæ¨¡å¼ä¸‹å…¨å±€äº‹ä»¶å’Œå…¨å±€å˜é‡çš„å¤„ç†é€»è¾‘ï¼Œä¸å†ä¸»åŠ¨å¸è½½å…¨å±€äº‹ä»¶å’Œåˆ é™¤å…¨å±€å˜é‡ã€‚
ğŸš€ æ›´æ–°äº†1.0ç‰ˆæœ¬æ–‡æ¡£`},{header:"1.0.0-alpha.3",slug:"_1-0-0-alpha-3",content:`2022-07-21 New ğŸ†• é‡å†™äº†åŸºåº§çš„pushStateã€replaceStateæ–¹æ³•ï¼Œè‡ªåŠ¨å°†å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ã€‚
ğŸ†• é‡å†™äº†å­åº”ç”¨çš„Documentå¯¹è±¡ï¼Œæ¯ä¸ªå­åº”ç”¨æ‹¥æœ‰å•ç‹¬çš„Documentå®ä¾‹ã€‚ Bug Fix ğŸ ä¿®å¤äº†DocumentåŸå‹æ–¹æ³•ç»‘å®šåˆ°ProxyDocumentæ—¶æŠ¥é”™çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†è·¯ç”±ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚
ğŸš€ æ›´æ–°äº†æ¡ˆä¾‹ï¼Œå¢åŠ é€‚é…åœºæ™¯`},{header:"1.0.0-alpha.2",slug:"_1-0-0-alpha-2",content:`2022-07-15 New ğŸ†• æ–°å¢äº†attachToURLã€attachAllToURLæ–¹æ³•ï¼Œç”¨äºå°†å­åº”ç”¨çš„è·¯ç”±ä¿¡æ¯åŒæ­¥åˆ°æµè§ˆå™¨åœ°å€ã€‚
ğŸ†• æ–°å¢äº†setBaseRouterã€getBaseRouteræ–¹æ³•ï¼Œç”¨äºæ³¨å†Œå’Œä½¿ç”¨åŸºåº§è·¯ç”±ã€‚
ğŸ†• æ–°å¢äº†ProxyDocumentï¼Œä¸ºå­åº”ç”¨åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„documentå¯¹è±¡ã€‚ Bug Fix ğŸ ä¿®å¤äº†ant-design-vueçš„å¼¹çª—ç±»ç»„ä»¶åŠå…¶å®ƒç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå­åº”ç”¨å…ƒç´ é€ƒé€¸åˆ°åŸç”Ÿbodyä¸Šçš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨æœªè®¾ç½®public_pathæ—¶ï¼Œå­åº”ç”¨çš„èµ„æºåœ°å€è¡¥å…¨å¤±è´¥çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨åœ¨è°ƒç”¨fetchç­‰APIæ—¶ï¼Œå…ƒç´ ç»‘å®šæ²¡æœ‰è§£é™¤çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨@keyframesåç§°å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦æ—¶æ ·å¼éš”ç¦»å¤±è´¥çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†è·¯ç”±ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚
ğŸš€ æ›´æ–°äº†æ¡ˆä¾‹ã€‚`},{header:"1.0.0-alpha.1",slug:"_1-0-0-alpha-1",content:`2022-07-06 New ğŸ†• æ–°å¢äº†proxyRequestï¼Œç”¨äºæ‹¦æˆªfetchã€XMLHttpRequestã€EventSourceè¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ã€‚ Bug Fix ğŸ ä¿®å¤äº†é€šè¿‡create-react-appåˆ›å»ºçš„reactåº”ç”¨çƒ­æ›´æ–°æ—¶æŠ¥é”™çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å­åº”ç”¨æ‰§è¡ŒpushState/replaceStateæ—¶popStateEventäº‹ä»¶å¼‚å¸¸è§¦å‘çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†èµ„æºåŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚`},{header:"0.8.6",slug:"_0-8-6",content:`2022-06-30 New ğŸ†• åœ¨ plugin ä¸­å¢åŠ  excludeChecker å’Œ ignoreChecker ç”¨äºä¸»åº”ç”¨ä¸»åŠ¨å¿½ç•¥å­åº”ç”¨éƒ¨åˆ† script å’Œ linkã€‚
ğŸ†• æ–°å¢äº†processHtmlï¼Œç”¨äºåœ¨æ’ä»¶ä¸­å¤„ç†htmlã€‚ Update ğŸš€ ä¼˜åŒ–äº†èµ„æºåŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚
ğŸš€ ä¼˜åŒ–äº†å•å…ƒæµ‹è¯•ç›¸å…³ä»£ç ã€‚`},{header:"1.0.0-alpha.0",slug:"_1-0-0-alpha-0",content:"2022-06-30 New ğŸ†• æ–°å¢äº†ç‹¬ç«‹çš„è·¯ç”±ç³»ç»Ÿ - MemoryRouterï¼Œå®Œå–„JSæ²™ç®±ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨å¾ªç¯åµŒå¥—æ—¶iconfont.jsåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æŠ¥é”™çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ï¼Œæé«˜å¹¶è¡Œæ¸²æŸ“èƒ½åŠ›ã€‚"},{header:"0.8.5",slug:"_0-8-5",content:"2022-02-14 New ğŸ†• æ’ä»¶çš„loaderæ–¹æ³•ä¸­æ–°å¢åŒ…å«scriptä¿¡æ¯çš„infoå‚æ•°ã€‚"},{header:"0.8.4",slug:"_0-8-4",content:"2022-01-25 Bug Fix ğŸ ä¿®å¤äº†åœ¨ç«ç‹æµè§ˆå™¨80åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œæ ·å¼éš”ç¦»æ‰§è¡Œé€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚"},{header:"0.8.3",slug:"_0-8-3",content:"2022-01-20 Bug Fix ğŸ ä¿®å¤äº†åœ¨cssä¸­é€šè¿‡background-imageå¼•å…¥svgæ—¶ï¼Œæ ·å¼éš”ç¦»è§£æå¤±è´¥çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†æ ·å¼éš”ç¦»çš„é€»è¾‘ï¼Œæé«˜å…¼å®¹å’Œæ€§èƒ½ã€‚"},{header:"0.8.2",slug:"_0-8-2",content:`2022-01-14 New ğŸ†• æ–°å¢äº†å­åº”ç”¨pureCreateElementæ–¹æ³•ï¼Œç”¨äºåˆ›å»ºæ— ç»‘å®šçš„çº¯å‡€å…ƒç´ ã€‚
ğŸ†• æ–°å¢äº†å­åº”ç”¨removeDomScopeæ–¹æ³•ï¼Œç”¨äºè§£é™¤å…ƒç´ ç»‘å®šã€‚ Bug Fix ğŸ ä¿®å¤äº†åŸºåº§é€šè¿‡è¿œç¨‹è¿æ¥å¼•å…¥Vueï¼ŒåŠ è½½vueå­åº”ç”¨æŠ¥é”™çš„é—®é¢˜ï¼Œissue #234ã€‚ Update ğŸš€ ä¼˜åŒ–äº†é¢„åŠ è½½ç›¸å…³ä»£ç å’Œé€»è¾‘ï¼Œå‡å°å¯¹åŸºåº§é¡¹ç›®çš„å½±å“ã€‚`},{header:"0.8.1",slug:"_0-8-1",content:`2022-01-12 Bug Fix ğŸ ä¿®å¤äº†element-pluséƒ¨åˆ†ç»„ä»¶é€ƒç¦»å…ƒç´ éš”ç¦»çš„é—®é¢˜, issue #223ã€‚
ğŸ ä¿®å¤äº†åœ¨ä½¿ç”¨IE6ã€7 CSSHackæ—¶æ ·å¼è§£æå¤±è´¥çš„é—®é¢˜, issue #232ã€‚ Update ğŸš€ ä¼˜åŒ–äº†æ’ä»¶ç›¸å…³ä»£ç å’Œé€»è¾‘, PR #224 by LinFeng1997ã€‚
ğŸš€ ä¼˜åŒ–äº†æ²™ç®±ç›¸å…³ä»£ç å’Œé€»è¾‘ã€‚`},{header:"0.8.0",slug:"_0-8-0",content:`2022-01-07 New ğŸ†• æ–°å¢äº†åœ¨æ ·å¼éš”ç¦»ä¸‹çš„åŠ¨æ€å¿½ç•¥è§„åˆ™ã€‚ Bug Fix ğŸ ä¿®å¤äº†åœ¨ä½¿ç”¨csså˜é‡æ—¶å¯¼è‡´æ ·å¼ä¸¢å¤±çš„é—®é¢˜ï¼Œissue #157ã€#121ã€‚
ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†æµè§ˆå™¨(å¦‚ï¼šsafari)ä¸‹ï¼Œcssè¡¨ç°æœ‰å·®å¼‚çš„é—®é¢˜ã€‚ Update ğŸš€ æ ·å¼éš”ç¦»é‡æ„ï¼Œæå‡æ€§èƒ½å’Œå…¼å®¹æ€§ã€‚`},{header:"0.7.1",slug:"_0-7-1",content:`2021-12-31 Bug Fix ğŸ ä¿®å¤äº†linkæ ‡ç­¾åœ¨éheadæ—¶æ ·å¼ä¸¢å¤±çš„é—®é¢˜
ğŸ ä¿®å¤äº†é”™è¯¯è¡¥å…¨svgåœ°å€çš„é—®é¢˜ï¼ŒPR #207 by ickskyã€‚
ğŸ ä¿®å¤äº†åœ¨éƒ¨åˆ†æµè§ˆå™¨ä¸‹æŠ¥WeakRef is not definedé”™è¯¯çš„é—®é¢˜ã€‚`},{header:"0.7.0",slug:"_0-7-0",content:`2021-12-29 New ğŸ†• æ–°å¢Apiï¼Œå¯¹å¤–export MicroAppç±»ã€‚ Update ğŸš€ æ²™ç®±é‡æ„ï¼Œæ€§èƒ½ä¼˜åŒ–ã€‚
ğŸš€ ä¼˜åŒ–äº†execScriptsæ–¹æ³•ï¼Œä¸å†ä½¿ç”¨Promise.allï¼Œé˜²æ­¢å•æ–‡ä»¶åŠ è½½é”™è¯¯å¯¼è‡´åç»­æ–‡ä»¶æ— æ³•æ‰§è¡Œçš„é—®é¢˜ã€‚
ğŸš€ ä¼˜åŒ–äº†getActiveAppsæ–¹æ³•ï¼Œå¢åŠ å¯¹è¿‡æ»¤keep-aliveåº”ç”¨çš„æ”¯æŒã€‚`},{header:"0.6.2",slug:"_0-6-2",content:"2021-12-19 Bug Fix ğŸ ä¿®å¤äº†åœ¨SSRç¯å¢ƒä¸‹ï¼ŒæŠ›å‡ºImage is not definedçš„æŠ¥é”™é—®é¢˜ã€‚"},{header:"0.6.1",slug:"_0-6-1",content:`2021-12-17 New ğŸ†• æ–°å¢äº†unmountApp, unmountAllAppsæ–¹æ³•ï¼Œç”¨äºä¸»åŠ¨å¸è½½åº”ç”¨ã€‚
ğŸ†• æ–°å¢äº†å¯¹disable-sandbox, disable-scopecssé…ç½®çš„æ”¯æŒã€‚ Bug Fix ğŸ ä¿®å¤äº†é€šè¿‡new Image()åˆ›å»ºçš„å…ƒç´ é€ƒç¦»æ²™ç®±çš„é—®é¢˜ï¼Œissue #186ï¼ŒPR #187 by asiainfoliweiã€‚
ğŸ ä¿®å¤äº†é€šè¿‡cloneNodeåˆ›å»ºçš„å…ƒç´ é€ƒç¦»æ²™ç®±çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†å…ƒç´ éš”ç¦»patchåŸå‹é“¾æ–¹æ³•ç›¸å…³ä»£ç ã€‚
ğŸš€ ä¼˜åŒ–äº†kee-aliveå’Œdestoryç›¸å…³çš„å¤„ç†é€»è¾‘ã€‚
ğŸš€ ä¼˜åŒ–äº†unmountç”Ÿå‘½å‘¨æœŸçš„è§¦å‘æ—¶æœºï¼Œç§»åŠ¨åˆ°åº”ç”¨å½»åº•å¸è½½åæ‰§è¡Œã€‚`},{header:"0.6.0",slug:"_0-6-0",content:"2021-12-10 New ğŸ†• æ–°å¢äº†å¯¹keep-aliveæ¨¡å¼çš„æ”¯æŒã€‚"},{header:"0.5.3",slug:"_0-5-3",content:`2021-12-02 New ğŸ†• æ–°å¢äº†å¯¹ssræ¨¡å¼çš„å…¨å±€é…ç½®çš„æ”¯æŒã€‚ Bug Fix ğŸ ä¿®å¤äº†æ²™ç®±ä¸­æ³¨å†Œçš„å…¨å±€å˜é‡çš„æ˜ å°„keyåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æ²¡æœ‰åŠæ—¶åˆ é™¤çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨ä¸æ”¯æŒESModuleçš„é¡¹ç›®ä¸­ï¼Œå¼•å…¥polyfill/jsx-custom-eventæŠ¥é”™çš„é—®é¢˜ã€‚`},{header:"0.5.2",slug:"_0-5-2",content:"2021-11-25 Bug Fix ğŸ ä¿®å¤äº†index.d.tsä¸­getActiveAppsã€getAllAppsç±»å‹å£°æ˜é”™è¯¯çš„é—®é¢˜ã€‚"},{header:"0.5.1",slug:"_0-5-1",content:`2021-11-25 New ğŸ†• æ–°å¢äº†getActiveAppsæ–¹æ³•ï¼Œç”¨äºè·å–æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨ã€‚
ğŸ†• æ–°å¢äº†getAllAppsæ–¹æ³•ï¼Œç”¨äºè·å–æ‰€æœ‰å·²ç»æ³¨å†Œçš„å­åº”ç”¨ã€‚ Bug Fix ğŸ ä¿®å¤äº†linkã€styleå…ƒç´ æ ¼å¼åŒ–åé¡ºåºä¸ä¸€è‡´å¯¼è‡´çš„æ ·å¼ä¸¢å¤±çš„é—®é¢˜ã€‚`},{header:"0.5.0",slug:"_0-5-0",content:`2021-11-19 Bug Fix ğŸ ä¿®å¤äº†nameå¸¦æœ‰ç‰¹æ®Šç¬¦å·æ—¶æ ·å¼å¤±æ•ˆçš„é—®é¢˜ï¼Œåˆ é™¤nameä¸­çš„ç‰¹æ®Šç¬¦å·ã€‚
ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹ï¼Œåº”ç”¨å¸è½½å¹¶é‡æ–°æ¸²æŸ“æ—¶urlå†²çªï¼Œæ—§åº”ç”¨æ²¡æœ‰å¸è½½å¹²å‡€çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†åœ¨å…³é—­æ ·å¼éš”ç¦»æ—¶ï¼Œæ ·å¼å»¶è¿Ÿç”Ÿæ•ˆå¯¼è‡´é¡µé¢å¸ƒå±€é”™ä¹±çš„é—®é¢˜ã€‚
ğŸ ä¿®å¤äº†å¤šæ¬¡é‡å¤å‘headä¸­æ’å…¥åŒä¸€ä¸ªstyleå…ƒç´ ï¼Œå¯¼è‡´æ ·å¼å¤±æ•ˆçš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†åº”ç”¨äºŒæ¬¡æ¸²æŸ“æ—¶çš„æ€§èƒ½åŠå†…å­˜ã€‚
ğŸš€ ä¼˜åŒ–äº†æ ·å¼éš”ç¦»é€»è¾‘ï¼Œæ— è®ºæ˜¯å¦å…³é—­æ ·å¼éš”ç¦»ï¼Œå§‹ç»ˆå°†linkå…ƒç´ æå–è½¬æ¢ä¸ºstyleå…ƒç´ ã€‚`},{header:"0.4.3",slug:"_0-4-3",content:`2021-11-05 New ğŸ†• æ–°å¢äº†EventCenterForMicroAppæ–¹æ³•ï¼Œç”¨äºæ²™ç®±å…³é—­æ—¶å®ç°é€šä¿¡åŠŸèƒ½(å¦‚vite) Bug Fix ğŸ ä¿®å¤äº†åœ¨ä¸æ”¯æŒShadowRootçš„æµè§ˆå™¨ä¸­çš„æŠ¥é”™é—®é¢˜ï¼Œissue #134
ğŸ ä¿®å¤äº†å…ƒç´ æŸ¥è¯¢æ—¶å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æŠ¥é”™çš„é—®é¢˜ï¼Œissue #140`},{header:"0.4.2",slug:"_0-4-2",content:`2021-10-29 New ğŸ†• æ–°å¢äº†æ•°æ®é€šä¿¡ä¸­getGlobalDataæ–¹æ³•ï¼Œç”¨äºä¸»åŠ¨è·å–å…¨å±€æ•°æ®
ğŸ†• æ–°å¢äº†å¯¹mount, unmountæ–¹æ³•promiseç±»å‹çš„æ”¯æŒ
ğŸ†• æ–°å¢äº†destroyé…ç½®é¡¹ï¼Œç”¨äºæ›¿æ¢destoryï¼Œä½†ä¾ç„¶ä¿æŒå¯¹ä½ç‰ˆæœ¬çš„å…¼å®¹ï¼Œissue #132 Bug Fix ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹ï¼Œreact16åŠä»¥ä¸‹ç‰ˆæœ¬äºŒæ¬¡æ¸²æŸ“åè·¯ç”±è·³è½¬åˆ·æ–°é¡µé¢çš„é—®é¢˜
ğŸ ä¿®å¤äº†SSRå­åº”ç”¨äºŒæ¬¡æ¸²æŸ“æ—¶urlä¸åŒå¯¼è‡´æ¸²æŸ“å¤±è´¥çš„é—®é¢˜
ğŸ ä¿®å¤äº† react-inlinesvg æ— æ³•æ­£å¸¸æ¸²æŸ“çš„é—®é¢˜ï¼Œissue #56
ğŸ ä¿®å¤äº† safari æµè§ˆå™¨ä¸­ï¼Œåˆ›å»ºmoduleè„šæœ¬é”™è¯¯çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨é€šè¿‡definePropertyé‡å†™document.onclickæ—¶æŠ¥é”™çš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†MicroAppElementã€æ²™ç®±ç­‰ä»£ç 
ğŸš€ ä¼˜åŒ–äº†umdæ¨¡å¼ä¸‹ï¼Œå­åº”ç”¨åˆæ¬¡æ¸²æŸ“çš„é€Ÿåº¦
ğŸš€ ä¼˜åŒ–äº†åŠ¨æ€åˆ›å»ºçš„scriptå…ƒç´ srcæˆ–textContentä¸ºç©ºæ—¶çš„å¤„ç†é€»è¾‘
ğŸš€ ä¼˜åŒ–äº†mountedç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œæ—¶æœº`},{header:"0.4.1",slug:"_0-4-1",content:`2021-10-22 Bug Fix ğŸ ä¿®å¤äº†umdæ¨¡å¼ä¸‹ï¼Œåº”ç”¨äºŒæ¬¡æ¸²æŸ“æ—¶æ ·å¼ä¸¢å¤±çš„é—®é¢˜
ğŸ ä¿®å¤äº†èµ„æºåœ°å€ä¸ºç©ºæ—¶ï¼Œè¡¥å…¨é”™è¯¯çš„é—®é¢˜
ğŸ ä¿®å¤äº†å¯¹iframeå…ƒç´ srcå±æ€§çš„é”™è¯¯å¤„ç†
ğŸ ä¿®å¤äº†mountedç”Ÿå‘½å‘¨æœŸåœ¨å¼‚æ­¥è„šæœ¬ä¸­æ‰§è¡Œæ—¶æœºé”™è¯¯çš„é—®é¢˜
ğŸ ä¿®å¤äº†åœ¨éæ²™ç®±ç¯å¢ƒä¸‹ä½¿ç”¨umdæ¨¡å¼ï¼Œå¼€å¯destoryåï¼Œå¸è½½æ—¶æ³¨å†Œçš„å‡½æ•°æ²¡æœ‰å¸è½½çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨å¸¦æœ‰preloadæ—¶èµ„æºåŠ è½½ä¸¤æ¬¡çš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†åœ¨éinlineæ¨¡å¼ä¸‹ï¼Œmoduleç±»å‹scriptå…ƒç´ çš„æ‰§è¡Œæ–¹å¼
ğŸš€ ä¼˜åŒ–äº†æŠ¥é”™æ—¥å¿—ä¿¡æ¯ï¼Œå¢åŠ åº”ç”¨åç§°`},{header:"0.4.0",slug:"_0-4-0",content:`2021-10-15 New ğŸ†• æ–°å¢äº†ignoreå±æ€§ï¼Œç”¨äºå¿½ç•¥éƒ¨åˆ†éƒ¨åˆ†å…ƒç´ 
ğŸ†• æ–°å¢äº†å…¨å±€å˜é‡ __MICRO_APP_BASE_APPLICATION__ ç”¨äºæ ‡è®°å½“å‰åº”ç”¨ä¸ºåŸºåº§åº”ç”¨ Bug Fix ğŸ ä¿®å¤äº†å¯¹webpack5 & jsonp çš„æ”¯æŒ
ğŸ ä¿®å¤äº†angularä¸‹åŠ¨æ€è®¾ç½®urlå±æ€§å¯¼è‡´åŠ è½½å¤±è´¥çš„é—®é¢˜
ğŸ ä¿®å¤äº†åœ¨viteç¯å¢ƒä¸‹ï¼Œå†…å­˜ä¼˜åŒ–çš„æ”¯æŒ
ğŸ ä¿®å¤äº†script type ä¸ºç‰¹æ®Šæƒ…å†µä¸‹çš„å…œåº•å¤„ç†ï¼Œå¦‚application/json
ğŸ ä¿®å¤äº†å¾ªç¯åµŒå¥—æ—¶æ²¡æœ‰å®Œå…¨å¸è½½åº”ç”¨çš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†å¯¹ssrçš„æ”¯æŒæ–¹å¼
ğŸš€ ä¼˜åŒ–äº†åŠ¨æ€moduleçš„åˆ›å»ºå’Œæ¸²æŸ“
ğŸš€ ä¼˜åŒ–äº†å¯¹dataã€blobç±»å‹æ•°æ®çš„å¤„ç†`},{header:"0.3.3",slug:"_0-3-3",content:`2021-09-13 Bug Fix ğŸ ä¿®å¤äº†dataå±æ€§èµ‹å€¼åæ’å…¥æ–‡æ¡£æ—¶ï¼Œåˆå§‹åŒ–dataå€¼æ— æ³•é€šè¿‡setAttributeæ‹¦æˆªçš„é—®é¢˜
ğŸ ä¿®å¤äº†æ¸²æŸ“ç¼“å­˜micro-appå…ƒç´ æ—¶å¯¼è‡´çš„micro-app-head, micro-app-bodyé‡å¤çš„é—®é¢˜`},{header:"0.3.2",slug:"_0-3-2",content:`2021-09-10 New ğŸ†• æ–°å¢äº†baserouteé…ç½®é¡¹ï¼Œç”¨äºæ›¿æ¢baseurl
ğŸ†• æ–°å¢äº†__MICRO_APP_BASE_ROUTE__å…¨å±€å˜é‡ï¼Œç”¨äºæ›¿æ¢__MICRO_APP_BASE_URL__ Update ğŸš€ åºŸå¼ƒäº†baseurlå’Œ__MICRO_APP_BASE_URL__ï¼Œä½†ä¾ç„¶å…¼å®¹æ—§ç‰ˆ`},{header:"0.3.1",slug:"_0-3-1",content:"2021-09-08 Bug Fix ğŸ ä¿®å¤äº†micro-appå…ƒç´ å…ˆä½¿ç”¨åå®šä¹‰å¯¼è‡´startæ–¹æ³•é…ç½®å¤±æ•ˆçš„é—®é¢˜"},{header:"0.3.0",slug:"_0-3-0",content:`2021-09-07 New ğŸ†• æ–°å¢äº†å¯¹umdæ ¼å¼çš„æ”¯æŒ
ğŸ†• åºŸå¼ƒevalæ–¹æ³•ï¼Œä½¿ç”¨Functionè¿›è¡Œæ›¿æ¢ Bug Fix ğŸ ä¿®å¤äº†å­åº”ç”¨å¸è½½éƒ¨åˆ†å†…å­˜æ— æ³•é‡Šæ”¾çš„é—®é¢˜
ğŸ ä¿®å¤äº†widnow\\document\\timeräº‹ä»¶åœ¨umdæ¨¡å¼ä¸‹å¤šæ¬¡æ¸²æŸ“çš„é—®é¢˜
ğŸ ä¿®å¤äº†asyncå’Œdefer jsæ–‡ä»¶æ²¡æœ‰ç¼“å­˜çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨åŒæ—¶å­˜åœ¨å¤šä¸ªheadã€bodyå…ƒç´ æ—¶ï¼Œå…ƒç´ æ“ä½œå¼‚å¸¸çš„é—®é¢˜ã€‚ Update ğŸš€ ä¼˜åŒ–äº†ä¿®æ”¹name&urlå±æ€§åˆ‡æ¢åº”ç”¨çš„æ“ä½œï¼Œéƒ¨åˆ†åœºæ™¯ä¸‹è¢«æ›¿æ¢çš„åº”ç”¨å¯ä»¥è®¡å…¥ç¼“å­˜
ğŸš€ æ›´æ–°äº†å…¨å±€æ•°æ®é€šä¿¡å¸è½½æœºåˆ¶ï¼ŒåŸºåº§åº”ç”¨å’Œå­åº”ç”¨åªèƒ½å¸è½½è‡ªèº«çš„å…¨å±€ç›‘å¬å‡½æ•°`},{header:"0.2.5",slug:"_0-2-5",content:`2021-08-23 New ğŸ†• æ–°å¢äº†main-vue3-viteåŸºåº§åº”ç”¨æ¡ˆä¾‹ Bug Fix ğŸ ä¿®å¤äº†åœ¨vue3ä¸­nameè¢«åˆ é™¤å¯¼è‡´çš„æ ·å¼ä¸¢å¤±çš„é—®é¢˜
ğŸ ä¿®å¤äº†æ— æ³•é€‚é….nodeã€.phpã€.netåç¼€æ–‡ä»¶çš„é—®é¢˜
ğŸ ä¿®å¤äº†å­åº”ç”¨å¸è½½åä¾ç„¶å¯ä»¥é€šè¿‡å‰¯ä½œç”¨å‡½æ•°ç»‘å®šnameä½œç”¨åŸŸçš„é—®é¢˜ Update ğŸš€ ä¼˜åŒ–äº†cosoleæ—¥å¿—æ–¹æ³•å’Œä½¿ç”¨æ–¹å¼
ğŸš€ ä¼˜åŒ–äº†viteé€‚é…æ–¹å¼`},{header:"0.2.4",slug:"_0-2-4",content:`2021-08-13 New ğŸ†• æ–°å¢äº†starté…ç½®é¡¹globalAssetsï¼Œç”¨äºè®¾ç½®å…¨å±€å…±äº«èµ„æº Bug Fix ğŸ ä¿®å¤äº†åœ¨å­åº”ç”¨ä¸­è¯·æ±‚htmlå…ƒç´ è¢«æ‹¦æˆªçš„é—®é¢˜
ğŸ ä¿®å¤ä½ç‰ˆæœ¬nodejså¯¹äºrollup.config.jsæ‰§è¡Œé”™è¯¯çš„é—®é¢˜ Update ğŸš€ ä»£ç ä¼˜åŒ–`},{header:"0.2.3",slug:"_0-2-3",content:`2021-08-10 Bug Fix ğŸ ä¿®å¤äº†åˆ‡æ¢è‡³é¢„åŠ è½½appæ—¶æŠ¥app already existsé”™è¯¯
ğŸ ä¿®å¤äº†åœ°å€è¡¥å…¨å¯¹äºaå…ƒç´ çš„é”™è¯¯å¤„ç† Update ğŸš€ æ–‡æ¡£æ›´æ–°
ğŸš€ ä»£ç ä¼˜åŒ–
ğŸš€ æ›´æ–°å•å…ƒæµ‹è¯•`},{header:"0.2.2",slug:"_0-2-2",content:"2021-07-27 Bug Fix ğŸ ä¿®å¤äº†JSX.IntrinsicElementså±æ€§ç”Ÿå‘½ä¸¢å¤±çš„é—®é¢˜ Update ğŸš€ ä»£ç ä¼˜åŒ–"},{header:"0.2.0",slug:"_0-2-0",content:`2021-07-16 Bug Fix ğŸ ä¿®å¤äº†styled-componetsä¸‹æ ·å¼å¤±æ•ˆçš„é—®é¢˜
ğŸ ä¿®å¤äº†æ²™ç®±å…³é—­æ—¶ï¼Œæ’ä»¶ç³»ç»Ÿå¤±æ•ˆçš„é—®é¢˜
ğŸ ä¿®å¤äº†linkåœ°å€æ²¡æœ‰åè®®å‰ç¼€æ—¶è¡¥å…¨ç›¸å¯¹åœ°å€å¤±è´¥çš„é—®é¢˜ Update ğŸš€ æ¡ˆä¾‹åŠæ–‡æ¡£æ›´æ–°`},{header:"0.1.0",slug:"_0-1-0",content:"2021-07-09 ğŸ‰ v0.1.0æ­£å¼ç‰ˆå‘å¸ƒã€‚"}]},{path:"/v0/zh/chat.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:`Gitterç¾¤èŠ
GitHubè®¨è®ºç»„
BUGåé¦ˆ`}]},{path:"/v0/zh/configure.html",title:"é…ç½®é¡¹",pathLocale:"/",contents:[{header:"é…ç½®é¡¹",slug:"é…ç½®é¡¹",content:"é€šè¿‡é…ç½®é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šå¼€å¯æˆ–å…³é—­æŸäº›åŠŸèƒ½ã€‚"},{header:"name",slug:"name",content:`Desc: åº”ç”¨åç§°
Type: string
Default: å¿…ä¼ å‚æ•°
ä½¿ç”¨æ–¹å¼: <micro-app name='xx'></micro-app>
æ³¨æ„äº‹é¡¹: å¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦æœ‰é™¤ä¸­åˆ’çº¿å’Œä¸‹åˆ’çº¿å¤–çš„ç‰¹æ®Šç¬¦å· æ¯ä¸ªnameéƒ½å¯¹åº”ä¸€ä¸ªåº”ç”¨ï¼Œå½“å¤šä¸ªåº”ç”¨åŒæ—¶æ¸²æŸ“æ—¶ï¼Œnameä¸å¯ä»¥é‡å¤ã€‚
å½“nameçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¸è½½å½“å‰åº”ç”¨å¹¶é‡æ–°æ¸²æŸ“ã€‚`},{header:"url",slug:"url",content:`Desc: åº”ç”¨åœ°å€
Type: string
Default: å¿…ä¼ å‚æ•°
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx'></micro-app> åŸºåº§åº”ç”¨å’Œå­åº”ç”¨æœ¬è´¨æ˜¯åœ¨åŒä¸€ä¸ªé¡µé¢ï¼Œè¿™é‡Œçš„urlåªæ˜¯htmlåœ°å€ï¼Œå­åº”ç”¨çš„è·¯ç”±è¿˜æ˜¯åŸºäºæµè§ˆå™¨åœ°å€ã€‚
å½“urlçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¸è½½å½“å‰åº”ç”¨å¹¶æ ¹æ®æ–°çš„urlå€¼é‡æ–°æ¸²æŸ“ã€‚`},{header:"baseroute",slug:"baseroute",content:`Desc: å­åº”ç”¨çš„åŸºç¡€è·¯ç”±
Type: string
Default: ''
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' baseroute='/my-page/'></micro-app> åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸‹ï¼Œå­åº”ç”¨å¯ä»¥ä»window.__MICRO_APP_BASE_ROUTE__ä¸Šè·å–baserouteçš„å€¼ï¼Œç”¨äºè®¾ç½®åŸºç¡€è·¯ç”±ã€‚
å¦‚æœåŸºåº§åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œåˆ™ä¸éœ€è¦è®¾ç½®baserouteã€‚`},{header:"inline",slug:"inline",content:`Desc: æ˜¯å¦ä½¿ç”¨å†…è”script
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' inline></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨çš„jsä¼šè¢«æå–å¹¶åœ¨åå°è¿è¡Œï¼Œè¿™ä¼šå¯¼è‡´è°ƒè¯•å›°éš¾ã€‚
å¼€å¯inlineåï¼Œè¢«æå–çš„jsä¼šä½œä¸ºscriptæ ‡ç­¾æ’å…¥åº”ç”¨ä¸­è¿è¡Œï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­æ›´æ–¹ä¾¿è°ƒè¯•ã€‚
Note
å¼€å¯inlineåä¼šç¨å¾®æŸè€—æ€§èƒ½ï¼Œå»ºè®®åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ã€‚`},{header:"destroy",slug:"destroy",content:`Desc: å¸è½½æ—¶æ˜¯å¦å¼ºåˆ¶åˆ é™¤ç¼“å­˜èµ„æº
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' destroy></micro-app> é»˜è®¤æƒ…å†µä¸‹ï¼Œå­åº”ç”¨è¢«å¸è½½åä¼šç¼“å­˜é™æ€èµ„æºï¼Œä»¥ä¾¿åœ¨é‡æ–°æ¸²æŸ“æ—¶è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚
å¼€å¯destroyï¼Œå­åº”ç”¨åœ¨å¸è½½åä¼šæ¸…ç©ºç¼“å­˜èµ„æºï¼Œå†æ¬¡æ¸²æŸ“æ—¶é‡æ–°è¯·æ±‚æ•°æ®ã€‚`},{header:"disableScopecss",slug:"disablescopecss",content:`Desc: ç¦ç”¨æ ·å¼éš”ç¦»
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' disableScopecss æˆ– disable-scopecss></micro-app> ç¦ç”¨æ ·å¼éš”ç¦»å¯ä»¥æå‡é¡µé¢æ¸²æŸ“é€Ÿåº¦ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿å„åº”ç”¨ä¹‹é—´æ ·å¼ä¸ä¼šç›¸äº’æ±¡æŸ“ã€‚`},{header:"disableSandbox",slug:"disablesandbox",content:`Desc: ç¦ç”¨jsæ²™ç®±
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' disableSandbox æˆ– disable-sandbox></micro-app> ç¦ç”¨æ²™ç®±å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›ä¸å¯é¢„æ–™çš„é—®é¢˜ï¼Œé€šå¸¸æƒ…å†µä¸å»ºè®®è¿™æ ·åšã€‚
Note
ç¦ç”¨æ²™ç®±åä»¥ä¸‹åŠŸèƒ½å°†å¤±æ•ˆ: æ ·å¼éš”ç¦»
å…ƒç´ éš”ç¦»
é™æ€èµ„æºè·¯å¾„è¡¥å…¨
__MICRO_APP_ENVIRONMENT__ã€__MICRO_APP_PUBLIC_PATH__ç­‰å…¨å±€å˜é‡
baseroute`},{header:"ssr",slug:"ssr",content:`Desc: æ˜¯å¦å¼€å¯ssræ¨¡å¼
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' ssr></micro-app>
ç‰ˆæœ¬è¦æ±‚: 0.5.3åŠä»¥ä¸Šç‰ˆæœ¬ å½“å­åº”ç”¨æ˜¯ssråº”ç”¨æ—¶ï¼Œéœ€è¦è®¾ç½®ssrå±æ€§ï¼Œæ­¤æ—¶micro-appä¼šæ ¹æ®ssræ¨¡å¼åŠ è½½å­åº”ç”¨ã€‚`},{header:"keep-alive",slug:"keep-alive",content:`Desc: æ˜¯å¦å¼€å¯keep-aliveæ¨¡å¼
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' keep-alive></micro-app>
ç‰ˆæœ¬è¦æ±‚: 0.6.0åŠä»¥ä¸Šç‰ˆæœ¬ å¼€å¯keep-aliveåï¼Œåº”ç”¨å¸è½½æ—¶ä¼šè¿›å…¥ç¼“å­˜ï¼Œè€Œä¸æ˜¯é”€æ¯å®ƒä»¬ï¼Œä»¥ä¾¿ä¿ç•™åº”ç”¨çš„çŠ¶æ€å’Œæå‡é‡å¤æ¸²æŸ“çš„æ€§èƒ½ã€‚
keep-aliveçš„ä¼˜å…ˆçº§å°äºdestroyï¼Œå½“ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œkeep-aliveå°†å¤±æ•ˆã€‚`},{header:"shadowDOM",slug:"shadowdom",content:`Desc: æ˜¯å¦å¼€å¯shadowDOM
Type: string(boolean)
Default: false
ä½¿ç”¨æ–¹å¼: <micro-app name='xx' url='xx' shadowDOM></micro-app> shadowDOMå…·æœ‰æ›´å¼ºçš„æ ·å¼éš”ç¦»èƒ½åŠ›ï¼Œå¼€å¯åï¼Œ<micro-app>æ ‡ç­¾ä¼šæˆä¸ºä¸€ä¸ªçœŸæ­£çš„WebComponentã€‚
ä½†shadowDOMåœ¨Reactæ¡†æ¶åŠä¸€äº›UIåº“ä¸­çš„å…¼å®¹ä¸æ˜¯å¾ˆå¥½ï¼Œç»å¸¸ä¼šå‡ºç°ä¸€äº›ä¸å¯é¢„æ–™çš„é—®é¢˜ï¼Œé™¤éä½ å¾ˆæ¸…æ¥šå®ƒä¼šå¸¦æ¥çš„é—®é¢˜å¹¶æœ‰ä¿¡å¿ƒè§£å†³ï¼Œå¦åˆ™ä¸å»ºè®®ä½¿ç”¨ã€‚`},{header:"å…¨å±€é…ç½®",slug:"å…¨å±€é…ç½®",content:`å…¨å±€é…ç½®ä¼šå½±å“æ¯ä¸€ä¸ªå­åº”ç”¨ï¼Œè¯·å°å¿ƒä½¿ç”¨ï¼
ä½¿ç”¨æ–¹å¼
import microApp from '@micro-zoe/micro-app' microApp.start({ inline: true, // é»˜è®¤å€¼false destroy: true, // é»˜è®¤å€¼false disableScopecss: true, // é»˜è®¤å€¼false disableSandbox: true, // é»˜è®¤å€¼false shadowDOM: true, // é»˜è®¤å€¼false ssr: true, // é»˜è®¤å€¼false
})
å¦‚æœå¸Œæœ›åœ¨æŸä¸ªåº”ç”¨ä¸­ä¸ä½¿ç”¨å…¨å±€é…ç½®ï¼Œå¯ä»¥å•ç‹¬é…ç½®å…³é—­ï¼š
<micro-app name='xx' url='xx' inline='false' destroy='false' disableScopecss='false' disableSandbox='false' shadowDOM='false' ssr='false'
></micro-app>`},{header:"å…¶å®ƒé…ç½®",slug:"å…¶å®ƒé…ç½®",content:""},{header:"global",slug:"global",content:`å½“å¤šä¸ªå­åº”ç”¨ä½¿ç”¨ç›¸åŒçš„jsæˆ–cssèµ„æºï¼Œåœ¨linkã€scriptè®¾ç½®globalå±æ€§ä¼šå°†æ–‡ä»¶æå–ä¸ºå…¬å…±æ–‡ä»¶ï¼Œå…±äº«ç»™å…¶å®ƒåº”ç”¨ã€‚
è®¾ç½®globalå±æ€§åæ–‡ä»¶ç¬¬ä¸€æ¬¡åŠ è½½ä¼šæ”¾å…¥å…¬å…±ç¼“å­˜ï¼Œå…¶å®ƒå­åº”ç”¨åŠ è½½ç›¸åŒçš„èµ„æºæ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å†…å®¹ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" global>
<script src="xx.js" global><\/script>`},{header:"globalAssets",slug:"globalassets",content:`globalAssetsç”¨äºè®¾ç½®å…¨å±€å…±äº«èµ„æºï¼Œå®ƒå’Œé¢„åŠ è½½çš„æ€è·¯ç›¸åŒï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½èµ„æºå¹¶æ”¾å…¥ç¼“å­˜ï¼Œæé«˜æ¸²æŸ“æ•ˆç‡ã€‚
å½“å­åº”ç”¨åŠ è½½ç›¸åŒåœ°å€çš„jsæˆ–cssèµ„æºæ—¶ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­æå–æ•°æ®ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start({ globalAssets: { js: ['jsåœ°å€1', 'jsåœ°å€2', ...], // jsåœ°å€ css: ['cssåœ°å€1', 'cssåœ°å€2', ...], // cssåœ°å€ }
})`},{header:"exclude(è¿‡æ»¤å…ƒç´ )",slug:"exclude-è¿‡æ»¤å…ƒç´ ",content:`å½“å­åº”ç”¨ä¸éœ€è¦åŠ è½½æŸä¸ªjsæˆ–cssï¼Œå¯ä»¥é€šè¿‡åœ¨linkã€scriptã€styleè®¾ç½®excludeå±æ€§ï¼Œå½“micro-appé‡åˆ°å¸¦æœ‰excludeå±æ€§çš„å…ƒç´ ä¼šè¿›è¡Œåˆ é™¤ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" exclude>
<script src="xx.js" exclude><\/script>
<style exclude></style>`},{header:"ignore(å¿½ç•¥å…ƒç´ )",slug:"ignore-å¿½ç•¥å…ƒç´ ",content:`å½“linkã€scriptã€styleå…ƒç´ å…·æœ‰ignoreå±æ€§ï¼Œmicro-appä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ã€‚
ä½¿ç”¨åœºæ™¯ä¾‹å¦‚ï¼šjsonp
jsonpä¼šåˆ›å»ºä¸€ä¸ªscriptå…ƒç´ åŠ è½½æ•°æ®ï¼Œæ­£å¸¸æƒ…å†µscriptä¼šè¢«æ‹¦æˆªå¯¼è‡´jsonpè¯·æ±‚å¤±è´¥ï¼Œæ­¤æ—¶å¯ä»¥ç»™scriptå…ƒç´ æ·»åŠ ignoreå±æ€§ï¼Œè·³è¿‡æ‹¦æˆªã€‚
// ä¿®æ”¹jsonpæ–¹æ³•ï¼Œåœ¨åˆ›å»ºscriptå…ƒç´ åæ·»åŠ ignoreå±æ€§
const script = document.createElement('script')
script.setAttribute('ignore', 'true')`}]},{path:"/v0/zh/data.html",title:"æ•°æ®é€šä¿¡",pathLocale:"/",contents:[{header:"æ•°æ®é€šä¿¡",slug:"æ•°æ®é€šä¿¡",content:`micro-appæä¾›äº†ä¸€å¥—çµæ´»çš„æ•°æ®é€šä¿¡æœºåˆ¶ï¼Œæ–¹ä¾¿åŸºåº§åº”ç”¨å’Œå­åº”ç”¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚
æ­£å¸¸æƒ…å†µä¸‹ï¼ŒåŸºåº§åº”ç”¨å’Œå­åº”ç”¨ä¹‹é—´çš„é€šä¿¡æ˜¯ç»‘å®šçš„ï¼ŒåŸºåº§åº”ç”¨åªèƒ½å‘æŒ‡å®šçš„å­åº”ç”¨å‘é€æ•°æ®ï¼Œå­åº”ç”¨åªèƒ½å‘åŸºåº§å‘é€æ•°æ®ï¼Œè¿™ç§æ–¹å¼å¯ä»¥æœ‰æ•ˆçš„é¿å…æ•°æ®æ±¡æŸ“ï¼Œé˜²æ­¢å¤šä¸ªå­åº”ç”¨ä¹‹é—´ç›¸äº’å½±å“ã€‚
åŒæ—¶æˆ‘ä»¬ä¹Ÿæä¾›äº†å…¨å±€é€šä¿¡ï¼Œæ–¹ä¾¿è·¨åº”ç”¨ä¹‹é—´çš„æ•°æ®é€šä¿¡ã€‚`},{header:"ä¸€ã€å­åº”ç”¨è·å–æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®",slug:"ä¸€ã€å­åº”ç”¨è·å–æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®",content:`micro-appä¼šå‘å­åº”ç”¨æ³¨å…¥åç§°ä¸ºmicroAppçš„å…¨å±€å¯¹è±¡ï¼Œå­åº”ç”¨é€šè¿‡è¿™ä¸ªå¯¹è±¡å’ŒåŸºåº§åº”ç”¨è¿›è¡Œæ•°æ®äº¤äº’ã€‚
æœ‰ä¸¤ç§æ–¹å¼è·å–æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®ï¼š`},{header:"æ–¹å¼1ï¼šç›´æ¥è·å–æ•°æ®",slug:"æ–¹å¼1-ç›´æ¥è·å–æ•°æ®",content:"const data = window.microApp.getData() // è¿”å›åŸºåº§ä¸‹å‘çš„dataæ•°æ®"},{header:"æ–¹å¼2ï¼šç»‘å®šç›‘å¬å‡½æ•°",slug:"æ–¹å¼2-ç»‘å®šç›‘å¬å‡½æ•°",content:`function dataListener (data) { console.log('æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•°ï¼Œç›‘å¬å‡½æ•°åªæœ‰åœ¨æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse * !!!é‡è¦è¯´æ˜: å› ä¸ºå­åº”ç”¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„ï¼Œè€ŒåŸºåº§å‘é€æ•°æ®æ˜¯åŒæ­¥çš„ï¼Œ * å¦‚æœåœ¨å­åº”ç”¨æ¸²æŸ“ç»“æŸå‰åŸºåº§åº”ç”¨å‘é€æ•°æ®ï¼Œåˆ™åœ¨ç»‘å®šç›‘å¬å‡½æ•°å‰æ•°æ®å·²ç»å‘é€ï¼Œåœ¨åˆå§‹åŒ–åä¸ä¼šè§¦å‘ç»‘å®šå‡½æ•°ï¼Œ * ä½†è¿™ä¸ªæ•°æ®ä¼šæ”¾å…¥ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶å¯ä»¥è®¾ç½®autoTriggerä¸ºtrueä¸»åŠ¨è§¦å‘ä¸€æ¬¡ç›‘å¬å‡½æ•°æ¥è·å–æ•°æ®ã€‚ */
window.microApp.addDataListener(dataListener: Function, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
window.microApp.removeDataListener(dataListener: Function) // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
window.microApp.clearDataListener()`},{header:"äºŒã€å­åº”ç”¨å‘åŸºåº§åº”ç”¨å‘é€æ•°æ®",slug:"äºŒã€å­åº”ç”¨å‘åŸºåº§åº”ç”¨å‘é€æ•°æ®",content:`// dispatchåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})`},{header:"ä¸‰ã€åŸºåº§åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®",slug:"ä¸‰ã€åŸºåº§åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®",content:"åŸºåº§åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼š"},{header:"æ–¹å¼1: é€šè¿‡dataå±æ€§å‘é€æ•°æ®",slug:"æ–¹å¼1-é€šè¿‡dataå±æ€§å‘é€æ•°æ®",content:`åœ¨Reactä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>å…ƒç´ æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfill(æ³¨é‡Šä¹Ÿè¦å¤åˆ¶)ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='my-app' url='xx' data={this.state.dataForChild} // dataåªæ¥å—å¯¹è±¡ç±»å‹ï¼Œé‡‡ç”¨ä¸¥æ ¼å¯¹æ¯”(===)ï¼Œå½“ä¼ å…¥æ–°çš„dataå¯¹è±¡æ—¶ä¼šé‡æ–°å‘é€
/> vueä¸­å’Œç»‘å®šæ™®é€šå±æ€§æ–¹å¼ä¸€è‡´ã€‚
<template> <micro-app name='my-app' url='xx' :data='dataForChild' // dataåªæ¥å—å¯¹è±¡ç±»å‹ï¼Œæ•°æ®å˜åŒ–æ—¶ä¼šé‡æ–°å‘é€ />
</template> <script>
export default { data () { return { dataForChild: {type: 'å‘é€ç»™å­åº”ç”¨çš„æ•°æ®'} } }
}
<\/script>`},{header:"æ–¹å¼2: æ‰‹åŠ¨å‘é€æ•°æ®",slug:"æ–¹å¼2-æ‰‹åŠ¨å‘é€æ•°æ®",content:`æ‰‹åŠ¨å‘é€æ•°æ®éœ€è¦é€šè¿‡nameæŒ‡å®šæ¥å—æ•°æ®çš„å­åº”ç”¨ï¼Œæ­¤å€¼å’Œ<micro-app>å…ƒç´ ä¸­çš„nameä¸€è‡´ã€‚
import microApp from '@micro-zoe/micro-app' // å‘é€æ•°æ®ç»™å­åº”ç”¨ my-appï¼ŒsetDataç¬¬äºŒä¸ªå‚æ•°åªæ¥å—å¯¹è±¡ç±»å‹
microApp.setData('my-app', {type: 'æ–°çš„æ•°æ®'})`},{header:"å››ã€åŸºåº§åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®",slug:"å››ã€åŸºåº§åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®",content:"åŸºåº§åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®æœ‰ä¸‰ç§æ–¹å¼ï¼š"},{header:"æ–¹å¼1ï¼šç›´æ¥è·å–æ•°æ®",slug:"æ–¹å¼1-ç›´æ¥è·å–æ•°æ®-1",content:"import microApp from '@micro-zoe/micro-app' const childData = microApp.getData(appName) // è¿”å›å­åº”ç”¨çš„dataæ•°æ®"},{header:"æ–¹å¼2: ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ (datachange)",slug:"æ–¹å¼2-ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶-datachange",content:`åœ¨Reactä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>å…ƒç´ æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfill(æ³¨é‡Šä¹Ÿè¦å¤åˆ¶)ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='my-app' url='xx' // æ•°æ®åœ¨event.detail.dataå­—æ®µä¸­ï¼Œå­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange onDataChange={(e) => console.log('æ¥è‡ªå­åº”ç”¨çš„æ•°æ®ï¼š', e.detail.data)}
/> vueä¸­ç›‘å¬æ–¹å¼å’Œæ™®é€šäº‹ä»¶ä¸€è‡´ã€‚
<template> <micro-app name='my-app' url='xx' // æ•°æ®åœ¨äº‹ä»¶å¯¹è±¡çš„detail.dataå­—æ®µä¸­ï¼Œå­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange @datachange='handleDataChange' />
</template> <script>
export default { methods: { handleDataChange (e) { console.log('æ¥è‡ªå­åº”ç”¨çš„æ•°æ®ï¼š', e.detail.data) } }
}
<\/script>`},{header:"æ–¹å¼3: ç»‘å®šç›‘å¬å‡½æ•°",slug:"æ–¹å¼3-ç»‘å®šç›‘å¬å‡½æ•°",content:`ç»‘å®šç›‘å¬å‡½æ•°éœ€è¦é€šè¿‡nameæŒ‡å®šå­åº”ç”¨ï¼Œæ­¤å€¼å’Œ<micro-app>å…ƒç´ ä¸­çš„nameä¸€è‡´ã€‚
import microApp from '@micro-zoe/micro-app' function dataListener (data) { console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * appName: åº”ç”¨åç§° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addDataListener(appName: string, dataListener: Function, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬my-appå­åº”ç”¨çš„å‡½æ•°
microApp.removeDataListener(appName: string, dataListener: Function) // æ¸…ç©ºæ‰€æœ‰ç›‘å¬appNameå­åº”ç”¨çš„å‡½æ•°
microApp.clearDataListener(appName: string)`},{header:"å…¨å±€æ•°æ®é€šä¿¡",slug:"å…¨å±€æ•°æ®é€šä¿¡",content:"å…¨å±€æ•°æ®é€šä¿¡ä¼šå‘åŸºåº§åº”ç”¨å’Œæ‰€æœ‰å­åº”ç”¨å‘é€æ•°æ®ï¼Œåœ¨è·¨åº”ç”¨é€šä¿¡çš„åœºæ™¯ä¸­é€‚ç”¨ã€‚"},{header:"å‘é€å…¨å±€æ•°æ®",slug:"å‘é€å…¨å±€æ•°æ®",content:`import microApp from '@micro-zoe/micro-app' // setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'}) // setGlobalDataåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.setGlobalData({type: 'å…¨å±€æ•°æ®'})`},{header:"è·å–å…¨å±€æ•°æ®",slug:"è·å–å…¨å±€æ•°æ®",content:`import microApp from '@micro-zoe/micro-app' // ç›´æ¥è·å–æ•°æ®
const globalData = microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ® function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
microApp.addGlobalDataListener(dataListener: Function, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
microApp.removeGlobalDataListener(dataListener: Function) // æ¸…ç©ºåŸºåº§åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
microApp.clearGlobalDataListener() // ç›´æ¥è·å–æ•°æ®
const globalData = window.microApp.getGlobalData() // è¿”å›å…¨å±€æ•°æ® function dataListener (data) { console.log('å…¨å±€æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.microApp.addGlobalDataListener(dataListener: Function, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
window.microApp.removeGlobalDataListener(dataListener: Function) // æ¸…ç©ºå½“å‰å­åº”ç”¨ç»‘å®šçš„æ‰€æœ‰å…¨å±€æ•°æ®ç›‘å¬å‡½æ•°
window.microApp.clearGlobalDataListener()`},{header:"å…³é—­æ²™ç®±åçš„é€šä¿¡æ–¹å¼",slug:"å…³é—­æ²™ç®±åçš„é€šä¿¡æ–¹å¼",content:`æ²™ç®±å…³é—­åï¼Œå­åº”ç”¨é»˜è®¤çš„é€šä¿¡åŠŸèƒ½å¤±æ•ˆï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡æ‰‹åŠ¨æ³¨å†Œé€šä¿¡å¯¹è±¡å®ç°ä¸€è‡´çš„åŠŸèƒ½ã€‚
æ³¨å†Œæ–¹å¼ï¼šåœ¨åŸºåº§åº”ç”¨ä¸­ä¸ºå­åº”ç”¨åˆå§‹åŒ–é€šä¿¡å¯¹è±¡
import { EventCenterForMicroApp } from '@micro-zoe/micro-app' // æ³¨æ„ï¼šæ¯ä¸ªå­åº”ç”¨æ ¹æ®appNameå•ç‹¬åˆ†é…ä¸€ä¸ªé€šä¿¡å¯¹è±¡
window.eventCenterForAppxx = new EventCenterForMicroApp(appName)
å­åº”ç”¨å°±å¯ä»¥é€šè¿‡æ³¨å†Œçš„eventCenterForAppxxå¯¹è±¡è¿›è¡Œé€šä¿¡ï¼Œå…¶apiå’Œwindow.microAppä¸€è‡´ï¼ŒåŸºåº§é€šä¿¡æ–¹å¼æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚
å­åº”ç”¨é€šä¿¡æ–¹å¼ï¼š
// ç›´æ¥è·å–æ•°æ®
const data = window.eventCenterForAppxx.getData() // è¿”å›dataæ•°æ® function dataListener (data) { console.log('æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®', data)
} /** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.eventCenterForAppxx.addDataListener(dataListener: Function, autoTrigger?: boolean) // è§£ç»‘ç›‘å¬å‡½æ•°
window.eventCenterForAppxx.removeDataListener(dataListener: Function) // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
window.eventCenterForAppxx.clearDataListener() // å­åº”ç”¨å‘åŸºåº§åº”ç”¨å‘é€æ•°æ®ï¼Œåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.eventCenterForAppxx.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})
æç¤º dataåªæ¥å—å¯¹è±¡ç±»å‹
æ•°æ®å˜åŒ–æ—¶ä¼šè¿›è¡Œä¸¥æ ¼å¯¹æ¯”(===)ï¼Œç›¸åŒçš„dataå¯¹è±¡ä¸ä¼šè§¦å‘æ›´æ–°ã€‚
åœ¨å­åº”ç”¨å¸è½½æ—¶ï¼Œå­åº”ç”¨ä¸­æ‰€æœ‰çš„æ•°æ®ç»‘å®šå‡½æ•°ä¼šè‡ªåŠ¨è§£ç»‘ï¼ŒåŸºåº§åº”ç”¨ä¸­çš„æ•°æ®è§£ç»‘éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å¤„ç†ã€‚`}]},{path:"/v0/zh/deploy.html",title:"éƒ¨ç½²",pathLocale:"/",contents:[{header:"éƒ¨ç½²",slug:"éƒ¨ç½²",content:""},{header:"å‰è¨€",slug:"å‰è¨€",content:`æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ä¿æŒå¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒè·¯å¾„(å³webpackçš„publicPath)çš„ä¸€è‡´æ€§ï¼Œä»¥é¿å…åœ¨éƒ¨ç½²åå‡ºç°é—®é¢˜ï¼Œæ— è®ºæ˜¯åŸºåº§åº”ç”¨è¿˜æ˜¯å­åº”ç”¨ã€‚
æ¯”å¦‚ä¸€ä¸ªåº”ç”¨ï¼Œåœ¨éƒ¨ç½²æ—¶ä½œä¸ºæ–‡ä»¶å¤¹ my-app æ”¾å…¥æœåŠ¡å™¨æ ¹ç›®å½•ï¼Œé‚£ä¹ˆé…ç½®å¦‚ä¸‹ï¼š // webpack.config.js
module.exports = { output: { path: 'my-app', publicPath: process.env.NODE_ENV === 'production' ? '/my-app/' : '', // bad âŒ publicPath: '/my-app/', // good ğŸ‘ }
} // vue.config.js
module.exports = { outputDir: 'my-app', publicPath: process.env.NODE_ENV === 'production' ? '/my-app/' : '', // bad âŒ publicPath: '/my-app/', // good ğŸ‘
}`},{header:"ç¤ºä¾‹",slug:"ç¤ºä¾‹",content:`æ­£å¸¸æ¥è¯´åªè¦å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒèµ„æºè·¯å¾„ä¸€è‡´ï¼Œå¹¶åœ¨éƒ¨ç½²åè®¾ç½®å¥½nginxçš„è·¨åŸŸå³å¯ï¼Œåœ¨å¼€å‘ç¯å¢ƒæ­£å¸¸è¿è¡Œçš„é¡¹ç›®ï¼Œéƒ¨ç½²åˆ°æœåŠ¡å™¨åï¼Œç†è®ºä¸Šä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œã€‚
ä½†åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ä¼šå‡ºç°åœ°å€404ã€èµ„æºä¸¢å¤±ç­‰é—®é¢˜ï¼Œè¿™é€šå¸¸æ˜¯å› ä¸ºæœåŠ¡å™¨é…ç½®é”™è¯¯æˆ–è€…micro-appå…ƒç´ urlå±æ€§åœ°å€é”™è¯¯å¯¼è‡´ã€‚
æˆ‘ä»¬ä»¥micro-app-demoä¸ºä¾‹ä»‹ç»éƒ¨ç½²ç›¸å…³å†…å®¹ï¼Œä»¥ä¾›å¤§å®¶å‚è€ƒï¼Œå› ä¸ºmicro-app-demoè¦†ç›–äº†historyè·¯ç”±ã€hashè·¯ç”±ã€ssrã€æ ¹è·¯å¾„ã€äºŒçº§è·¯å¾„ç­‰å¤§éƒ¨åˆ†åœºæ™¯ï¼Œæ˜¯ä¸€ä¸ªå…¸å‹çš„æ¡ˆä¾‹ã€‚`},{header:"ä»£ç ä»“åº“ç›®å½•ç»“æ„ï¼š",slug:"ä»£ç ä»“åº“ç›®å½•ç»“æ„",content:`.
â”œâ”€â”€ child_apps
â”‚ â”œâ”€â”€ angular11 // å­åº”ç”¨ angular11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nextjs11 // å­åº”ç”¨ nextjs11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nuxtjs2 // å­åº”ç”¨ nuxtjs2 (historyè·¯ç”±) â”‚ â”œâ”€â”€ react16 // å­åº”ç”¨ react16 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ react17 // å­åº”ç”¨ react17 (hashè·¯ç”±)
â”‚ â”œâ”€â”€ sidebar // å­åº”ç”¨ sidebarï¼Œå…¬å…±ä¾§è¾¹æ 
â”‚ â”œâ”€â”€ vite-vue3 // å­åº”ç”¨ vite (hashè·¯ç”±)
â”‚ â”œâ”€â”€ vue2 // å­åº”ç”¨ vue2 (historyè·¯ç”±)
â”‚ â””â”€â”€ vue3 // å­åº”ç”¨ vue3 (historyè·¯ç”±)
â”œâ”€â”€ main_apps
â”‚ â”œâ”€â”€ angular11 // ä¸»åº”ç”¨ angular11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nextjs11 // ä¸»åº”ç”¨ nextjs11 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ nuxtjs2 // ä¸»åº”ç”¨ nuxtjs2 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ react16 // ä¸»åº”ç”¨ react16 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ react17 // ä¸»åº”ç”¨ react17 (historyè·¯ç”±)
â”‚ â”œâ”€â”€ vite-vue3 // ä¸»åº”ç”¨ vite (historyè·¯ç”±)
â”‚ â”œâ”€â”€ vue2 // ä¸»åº”ç”¨ vue2 (historyè·¯ç”±)
â”‚ â””â”€â”€ vue3 // ä¸»åº”ç”¨ vue3 (historyè·¯ç”±)
â”œâ”€â”€ package.json
â””â”€â”€ yarn.lock`},{header:"éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„ç›®å½•ç»“æ„ï¼š",slug:"éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„ç›®å½•ç»“æ„",content:`root(æœåŠ¡å™¨æ ¹ç›®å½•)
â”œâ”€â”€ child
â”‚ â”œâ”€â”€ angular11 // å­åº”ç”¨ angular11
â”‚ â”œâ”€â”€ react16 // å­åº”ç”¨ react16
â”‚ â”œâ”€â”€ react17 // å­åº”ç”¨ react17
â”‚ â”œâ”€â”€ sidebar // å­åº”ç”¨ sidebar
â”‚ â”œâ”€â”€ vite // å­åº”ç”¨ vite
â”‚ â”œâ”€â”€ vue2 // å­åº”ç”¨ vue2
â”‚ â”œâ”€â”€ vue3 // å­åº”ç”¨ vue3
â”‚ â”œâ”€â”€ nextjs11 // å­åº”ç”¨ nextjs11ï¼Œä¸ºæ¯ä¸ªåŸºåº§åº”ç”¨å•ç‹¬æ‰“åŒ…ï¼Œç«¯å£å·ï¼š5001~5009
â”‚ â””â”€â”€ nuxtjs2 // å­åº”ç”¨ nuxtjs2ï¼Œä¸ºæ¯ä¸ªåŸºåº§åº”ç”¨å•ç‹¬æ‰“åŒ…ï¼Œç«¯å£å·ï¼š6001~6009
â”‚ â”œâ”€â”€ main-angular11 // ä¸»åº”ç”¨ angular11
â”œâ”€â”€ main-react16 // ä¸»åº”ç”¨ react16
â”œâ”€â”€ main-react17 // ä¸»åº”ç”¨ react17
â”œâ”€â”€ main-vite // ä¸»åº”ç”¨ vite
â”œâ”€â”€ main-vue2 // ä¸»åº”ç”¨ vue2
â”œâ”€â”€ main-vue3 // ä¸»åº”ç”¨ vue3
â”œâ”€â”€ main-nextjs11 // ä¸»åº”ç”¨ nextjs11ï¼Œç›‘å¬ç«¯å£å·ï¼š5000
â”œâ”€â”€ main-nuxtjs2 // ä¸»åº”ç”¨ nuxtjs2ï¼Œç›‘å¬ç«¯å£å·ï¼š7000`},{header:"nginxé…ç½®å¦‚ä¸‹ï¼š",slug:"nginxé…ç½®å¦‚ä¸‹",content:`ä»¥ä¸‹é…ç½®ä»…ä¾›å‚è€ƒï¼Œå…·ä½“é¡¹ç›®æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ã€‚
# micro-zoe.com ç›¸å…³é…ç½®
server { listen 80; server_name www.micro-zoe.com micro-zoe.com; location / { root /root/mygit/micro-zoe; index index.php index.html index.htm; # add_header Cache-Control; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } } # ä¸»åº”ç”¨main-angular11 location /main-angular11 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-angular11/index.html; } # ä¸»åº”ç”¨main-react16 location /main-react16 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-react16/index.html; } # ä¸»åº”ç”¨main-react17 location /main-react17 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-react17/index.html; } # ä¸»åº”ç”¨main-vite location /main-vite { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-vite/index.html; } # ä¸»åº”ç”¨main-vue2 location /main-vue2 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-vue2/index.html; } # ä¸»åº”ç”¨main-vue3 location /main-vue3 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /main-vue3/index.html; } # å­åº”ç”¨child-angular11 location /child/angular11 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/angular11/index.html; } # å­åº”ç”¨child-react16 location /child/react16 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/react16/index.html; } # å­åº”ç”¨child-react17 location /child/react17 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/react17/index.html; } # å­åº”ç”¨child-sidebar location /child/sidebar { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/sidebar/index.html; } # å­åº”ç”¨child-vite location /child/vite { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/vite/index.html; } # å­åº”ç”¨child-vue2 location /child/vue2 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/vue2/index.html; } # å­åº”ç”¨child-vue3 location /child/vue3 { root /root/mygit/micro-zoe; add_header Access-Control-Allow-Origin *; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } try_files $uri $uri/ /child/vue3/index.html; } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }
} # ä¸»åº”ç”¨nextjs11éƒ¨ç½²åç›‘å¬5000ç«¯å£ï¼Œè®¾ç½®ä»£ç†æŒ‡å‘5000ç«¯å£ï¼Œåˆ™å¯ä»¥é€šè¿‡ nextjs11.micro-zoe.com è®¿é—®ä¸»åº”ç”¨
server { listen 80; server_name nextjs11.micro-zoe.com; root html; index index.html index.htm; location / { proxy_pass http://127.0.0.1:5000; proxy_set_header Host $host:80; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # add_header Cache-Control; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }
} # ä¸»åº”ç”¨nuxtjs2éƒ¨ç½²åç›‘å¬7000ç«¯å£ï¼Œè®¾ç½®ä»£ç†æŒ‡å‘7000ç«¯å£ï¼Œåˆ™å¯ä»¥é€šè¿‡ nuxtjs2.micro-zoe.com è®¿é—®ä¸»åº”ç”¨
server { listen 80; server_name nuxtjs2.micro-zoe.com; root html; index index.html index.htm; location / { proxy_pass http://127.0.0.1:7000; proxy_set_header Host $host:80; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # add_header Cache-Control; if ( $request_uri ~* ^.+.(js|css|jpg|png|gif|tif|dpg|jpeg|eot|svg|ttf|woff|json|mp4|rmvb|rm|wmv|avi|3gp)$ ){ add_header Cache-Control max-age=7776000; add_header Access-Control-Allow-Origin *; } } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }
}`},{header:"çº¿ä¸Šæ•ˆæœå¦‚ä¸‹ï¼š",slug:"çº¿ä¸Šæ•ˆæœå¦‚ä¸‹",content:`main-vue2ï¼šhttp://www.micro-zoe.com/main-vue2/
main-nextjs11ï¼šhttp://nextjs11.micro-zoe.com/
main-nuxtjs2ï¼šhttp://nuxtjs2.micro-zoe.com/`}]},{path:"/v0/zh/dom-scope.html",title:"å…ƒç´ éš”ç¦»",pathLocale:"/",contents:[{header:"å…ƒç´ éš”ç¦»",slug:"å…ƒç´ éš”ç¦»",content:`å…ƒç´ éš”ç¦»çš„æ¦‚å¿µæ¥è‡ªShadowDomï¼Œå³ShadowDomä¸­çš„å…ƒç´ å¯ä»¥å’Œå¤–éƒ¨çš„å…ƒç´ é‡å¤ä½†ä¸ä¼šå†²çªï¼Œmicro-appæ¨¡æ‹Ÿå®ç°äº†ç±»ä¼¼ShadowDomçš„åŠŸèƒ½ï¼Œå…ƒç´ ä¸ä¼šé€ƒç¦»<micro-app>å…ƒç´ è¾¹ç•Œï¼Œå­åº”ç”¨åªèƒ½å¯¹è‡ªèº«çš„å…ƒç´ è¿›è¡Œå¢ã€åˆ ã€æ”¹ã€æŸ¥çš„æ“ä½œã€‚
ä¸¾ä¸ªæ —å­ğŸŒ° :
åŸºåº§åº”ç”¨å’Œå­åº”ç”¨éƒ½æœ‰ä¸€ä¸ªå…ƒç´ <div id='root'></div>ï¼Œæ­¤æ—¶å­åº”ç”¨é€šè¿‡document.querySelector('#root')è·å–åˆ°çš„æ˜¯è‡ªå·±å†…éƒ¨çš„#rootå…ƒç´ ï¼Œè€Œä¸æ˜¯åŸºåº§åº”ç”¨çš„ã€‚
åŸºåº§åº”ç”¨å¯ä»¥è·å–å­åº”ç”¨çš„å…ƒç´ å—ï¼Ÿ
å¯ä»¥çš„ï¼
è¿™ä¸€ç‚¹å’ŒShadowDomä¸åŒï¼Œåœ¨å¾®å‰ç«¯ä¸‹åŸºåº§æ‹¥æœ‰ç»Ÿç­¹å…¨å±€çš„ä½œç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰å¯¹åŸºåº§åº”ç”¨æ“ä½œå­åº”ç”¨å…ƒç´ çš„è¡Œä¸ºè¿›è¡Œé™åˆ¶ã€‚`},{header:"è§£é™¤å…ƒç´ ç»‘å®š",slug:"è§£é™¤å…ƒç´ ç»‘å®š",content:`é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å­åº”ç”¨æ“ä½œå…ƒç´ æ—¶ä¼šç»‘å®šå…ƒç´ ä½œç”¨åŸŸï¼Œè€Œè§£ç»‘è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ“ä½œå…ƒç´ å¼‚å¸¸ï¼Œæ­¤æ—¶æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
æ–¹å¼ä¸€ï¼šæ‰§è¡ŒremoveDomScope
æ‰§è¡ŒremoveDomScopeæ–¹æ³•åï¼Œå…ƒç´ ä½œç”¨åŸŸä¼šé‡ç½®ä¸ºåŸºåº§åº”ç”¨ã€‚ import { removeDomScope } from '@micro-zoe/micro-app' // é‡ç½®ä½œç”¨åŸŸ
removeDomScope() // å…¨å±€è·å–idä¸ºrootçš„å…ƒç´ 
window.document.getElementById('root') // æ³¨æ„ä¸è¦ä½¿ç”¨window.rawWindow
const _window = new Function('return window')() // é‡ç½®ä½œç”¨åŸŸ
window.microApp.removeDomScope() // å…¨å±€è·å–idä¸ºrootçš„å…ƒç´ 
_window.document.getElementById('root') æ–¹å¼äºŒï¼šä½¿ç”¨setTimeout // ç­‰å¾…è§£ç»‘ç»“æŸåæ“ä½œå…ƒç´ 
setTimeout(() => { window.document.getElementById('root') // å…¨å±€è·å–idä¸ºrootçš„å…ƒç´ 
}, 0) // æ³¨æ„ä¸è¦ä½¿ç”¨window.rawWindow
const _window = new Function('return window')() // ç­‰å¾…è§£ç»‘ç»“æŸåæ“ä½œå…ƒç´ 
setTimeout(() => { _window.document.getElementById('root') // å…¨å±€è·å–idä¸ºrootçš„å…ƒç´ 
}, 0)`}]},{path:"/v0/zh/env.html",title:"ç¯å¢ƒå˜é‡",pathLocale:"/",contents:[{header:"ç¯å¢ƒå˜é‡",slug:"ç¯å¢ƒå˜é‡",content:""},{header:"__MICRO_APP_ENVIRONMENT__",slug:"micro-app-environment",content:`æè¿°ï¼šåˆ¤æ–­åº”ç”¨æ˜¯å¦åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­
åœ¨å­åº”ç”¨ä¸­é€šè¿‡ window.__MICRO_APP_ENVIRONMENT__ åˆ¤æ–­æ˜¯å¦åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­ã€‚
if (window.__MICRO_APP_ENVIRONMENT__) { console.log('æˆ‘åœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­')
}`},{header:"__MICRO_APP_NAME__",slug:"micro-app-name",content:`æè¿°ï¼šåº”ç”¨åç§°
åœ¨å­åº”ç”¨ä¸­é€šè¿‡ window.__MICRO_APP_NAME__ è·å–åº”ç”¨çš„nameå€¼ï¼Œå³<micro-app>æ ‡ç­¾çš„nameå€¼ã€‚`},{header:"__MICRO_APP_PUBLIC_PATH__",slug:"micro-app-public-path",content:`æè¿°ï¼šå­åº”ç”¨çš„é™æ€èµ„æºå‰ç¼€
ç”¨äºè®¾ç½®webpackåŠ¨æ€public-pathï¼Œå°†å­åº”ç”¨çš„é™æ€èµ„æºè¡¥å…¨ä¸º http å¼€å¤´çš„ç»å¯¹åœ°å€ã€‚
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
if (window.__MICRO_APP_ENVIRONMENT__) { __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨çš„å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
import './public-path'`},{header:"__MICRO_APP_BASE_ROUTE__",slug:"micro-app-base-route",content:`æè¿°ï¼šå­åº”ç”¨çš„åŸºç¡€è·¯ç”±
è¯¦æƒ…è§è·¯ç”±-åŸºç¡€è·¯ç”±ä¸€ç« ã€‚`},{header:"__MICRO_APP_BASE_APPLICATION__",slug:"micro-app-base-application",content:`æè¿°ï¼šåˆ¤æ–­åº”ç”¨æ˜¯å¦æ˜¯åŸºåº§åº”ç”¨
åœ¨æ‰§è¡ŒmicroApp.start()åæ­¤å€¼æ‰ä¼šç”Ÿæ•ˆ
if (window.__MICRO_APP_BASE_APPLICATION__) { console.log('æˆ‘æ˜¯åŸºåº§åº”ç”¨')
}`}]},{path:"/v0/zh/jump.html",title:"åº”ç”¨ä¹‹é—´è·³è½¬",pathLocale:"/",contents:[{header:"åº”ç”¨ä¹‹é—´è·³è½¬",slug:"åº”ç”¨ä¹‹é—´è·³è½¬",content:"æ¯ä¸ªåº”ç”¨çš„è·¯ç”±å®ä¾‹éƒ½æ˜¯ä¸åŒçš„ï¼Œåº”ç”¨çš„è·¯ç”±å®ä¾‹åªèƒ½æ§åˆ¶è‡ªèº«ï¼Œæ— æ³•å½±å“å…¶å®ƒåº”ç”¨ï¼ŒåŒ…æ‹¬åŸºåº§åº”ç”¨æ— æ³•é€šè¿‡æ§åˆ¶è‡ªèº«è·¯ç”±å½±å“åˆ°å­åº”ç”¨ã€‚ å¸¸è§çš„é—®é¢˜å¦‚ï¼šå¼€å‘è€…æƒ³é€šè¿‡åŸºåº§åº”ç”¨çš„ä¾§è¾¹æ è·³è½¬ï¼Œä»è€Œæ§åˆ¶å­åº”ç”¨çš„é¡µé¢ï¼Œè¿™å…¶å®æ˜¯åšä¸åˆ°çš„ï¼Œåªæœ‰å­åº”ç”¨çš„è·¯ç”±å®ä¾‹å¯ä»¥æ§åˆ¶è‡ªèº«çš„é¡µé¢ã€‚ è¦å®ç°åº”ç”¨ä¹‹é—´çš„è·³è½¬æœ‰ä¸¤ç§æ–¹å¼ï¼š"},{header:"æ–¹å¼ä¸€ã€window.history",slug:"æ–¹å¼ä¸€ã€window-history",content:`é€šè¿‡history.pushStateæˆ–history.replaceStateè¿›è¡Œè·³è½¬ã€‚
ä¾‹å¦‚ï¼š
window.history.pushState(history.state, '', 'page2') // ä¸»åŠ¨è§¦å‘ä¸€æ¬¡popstateäº‹ä»¶
window.dispatchEvent(new PopStateEvent('popstate', { state: history.state }))
å¯¹äºhashè·¯ç”±ä¹ŸåŒæ ·é€‚ç”¨
window.history.pushState(history.state, '', '#/page2') // ä¸»åŠ¨è§¦å‘ä¸€æ¬¡popstateäº‹ä»¶
window.dispatchEvent(new PopStateEvent('popstate', { state: history.state }))
æ³¨æ„äº‹é¡¹ popstateäº‹ä»¶æ˜¯å…¨å±€å‘é€çš„ï¼Œæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åº”ç”¨éƒ½ä¼šæ¥å—åˆ°æ–°çš„è·¯ç”±åœ°å€å¹¶è¿›è¡ŒåŒ¹é…ï¼Œè¦é˜²æ­¢å…œåº•åˆ°åº”ç”¨çš„404é¡µé¢ã€‚
window.historyå¹¶éé€‚ç”¨äºæ‰€æœ‰åœºæ™¯ï¼Œä¸€äº›æ¡†æ¶å¦‚vue-router4ï¼Œangularä¼šå‡ºç°é—®é¢˜ï¼Œæ­¤æ—¶å»ºè®®ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼2ã€3ã€‚`},{header:"æ–¹å¼äºŒã€é€šè¿‡æ•°æ®é€šä¿¡æ§åˆ¶è·³è½¬",slug:"æ–¹å¼äºŒã€é€šè¿‡æ•°æ®é€šä¿¡æ§åˆ¶è·³è½¬",content:`é€‚ç”¨åœºæ™¯: åŸºåº§æ§åˆ¶å­åº”ç”¨è·³è½¬
å­åº”ç”¨ä¸­ç›‘å¬æ•°æ®å˜åŒ–
// ç›‘å¬åŸºåº§ä¸‹å‘çš„æ•°æ®å˜åŒ–
window.microApp.addDataListener((data) => { // å½“åŸºåº§ä¸‹å‘è·³è½¬æŒ‡ä»¤æ—¶è¿›è¡Œè·³è½¬ if (data.path) { router.push(data.path) }
})
åŸºåº§ä¸‹å‘è·³è½¬æŒ‡ä»¤
import microApp from '@micro-zoe/micro-app' microApp.setData('å­åº”ç”¨name', { path: '/new-path/' })`},{header:"æ–¹å¼ä¸‰ã€ä¼ é€’è·¯ç”±å®ä¾‹æ–¹æ³•",slug:"æ–¹å¼ä¸‰ã€ä¼ é€’è·¯ç”±å®ä¾‹æ–¹æ³•",content:`é€‚ç”¨åœºæ™¯: å­åº”ç”¨æ§åˆ¶åŸºåº§è·³è½¬
åŸºåº§ä¸‹å‘pushStateå‡½æ•°ï¼š import { useEffect } from 'react'
import { useHistory } from 'react-router-dom'
import microApp, { removeDomScope } from '@micro-zoe/micro-app' export default () => { const history = useHistory() function pushState (path) { removeDomScope() history.push(path) } useEffect(() => { // ğŸ‘‡ åŸºåº§å‘å­åº”ç”¨ä¸‹å‘ä¸€ä¸ªåä¸ºpushStateçš„æ–¹æ³• microApp.setData(å­åº”ç”¨åç§°, { pushState }) }, []) return ( <div> <micro-app name='å­åº”ç”¨åç§°' url='url'></micro-app> </div> )
} <template> <micro-app name='å­åº”ç”¨åç§°' url='url' :data='microAppData' ></micro-app>
</template> <script>
import { removeDomScope } from '@micro-zoe/micro-app' export default { data () { return { microAppData: { pushState: (path) => { removeDomScope() this.$router.push(path) } } } },
}
<\/script> å­åº”ç”¨ä½¿ç”¨pushStateæ§åˆ¶åŸºåº§è·³è½¬ï¼š
window.microApp.getData().pushState(path)`}]},{path:"/v0/zh/keep-alive.html",title:"keep-alive",pathLocale:"/",contents:[{header:"keep-alive",slug:"keep-alive",content:`0.6.0åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ
åœ¨åº”ç”¨ä¹‹é—´åˆ‡æ¢æ—¶ï¼Œä½ æœ‰æ—¶ä¼šæƒ³ä¿ç•™è¿™äº›åº”ç”¨çš„çŠ¶æ€ï¼Œä»¥ä¾¿æ¢å¤ç”¨æˆ·çš„æ“ä½œè¡Œä¸ºå’Œæå‡é‡å¤æ¸²æŸ“çš„æ€§èƒ½ï¼Œæ­¤æ—¶å¼€å¯keep-aliveæ¨¡å¼å¯ä»¥è¾¾åˆ°è¿™æ ·çš„æ•ˆæœã€‚
å¼€å¯keep-aliveåï¼Œåº”ç”¨å¸è½½æ—¶ä¸ä¼šé”€æ¯ï¼Œè€Œæ˜¯æ¨å…¥åå°è¿è¡Œã€‚`},{header:"ä½¿ç”¨æ–¹å¼",slug:"ä½¿ç”¨æ–¹å¼",content:"<micro-app name='xx' url='xx' keep-alive></micro-app>"},{header:"ç”Ÿå‘½å‘¨æœŸ",slug:"ç”Ÿå‘½å‘¨æœŸ",content:`keep-aliveæ¨¡å¼ä¸æ™®é€šæ¨¡å¼æœ€å¤§çš„ä¸åŒæ˜¯ç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºå®ƒä¸ä¼šè¢«çœŸæ­£çš„å¸è½½ï¼Œä¹Ÿå°±ä¸ä¼šè§¦å‘ unmount äº‹ä»¶ã€‚
åœ¨åŸºåº§å’Œå­åº”ç”¨ä¸­çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š`},{header:"åŸºåº§åº”ç”¨",slug:"åŸºåº§åº”ç”¨",content:""},{header:"1. created",slug:"_1-created",content:"<micro-app>æ ‡ç­¾åˆå§‹åŒ–åï¼ŒåŠ è½½èµ„æºå‰è§¦å‘ã€‚"},{header:"2. beforemount",slug:"_2-beforemount",content:"åŠ è½½èµ„æºå®Œæˆåï¼Œå¼€å§‹æ¸²æŸ“ä¹‹å‰è§¦å‘(åªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡)ã€‚"},{header:"3. mounted",slug:"_3-mounted",content:"å­åº”ç”¨æ¸²æŸ“ç»“æŸåè§¦å‘(åªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡)ã€‚"},{header:"4. error",slug:"_4-error",content:"å­åº”ç”¨æ¸²æŸ“å‡ºé”™æ—¶è§¦å‘ï¼Œåªæœ‰ä¼šå¯¼è‡´æ¸²æŸ“ç»ˆæ­¢çš„é”™è¯¯æ‰ä¼šè§¦å‘æ­¤ç”Ÿå‘½å‘¨æœŸã€‚"},{header:"5. afterhidden",slug:"_5-afterhidden",content:"å­åº”ç”¨å¸è½½æ—¶è§¦å‘ã€‚"},{header:"6. beforeshow",slug:"_6-beforeshow",content:"å­åº”ç”¨å†æ¬¡æ¸²æŸ“ä¹‹å‰è§¦å‘(åˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ)ã€‚"},{header:"7. aftershow",slug:"_7-aftershow",content:"å­åº”ç”¨å†æ¬¡æ¸²æŸ“ä¹‹åè§¦å‘(åˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ)ã€‚"},{header:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",slug:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",content:`å› ä¸ºReactä¸æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>æ ‡ç­¾æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfillï¼Œæ³¨é‡Šä¹Ÿè¦å¤åˆ¶ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='xx' url='xx' onCreated={() => console.log('micro-appå…ƒç´ è¢«åˆ›å»º')} onBeforemount={() => console.log('å³å°†è¢«æ¸²æŸ“ï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡')} onMounted={() => console.log('å·²ç»æ¸²æŸ“å®Œæˆï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡')} onAfterhidden={() => console.log('å·²å¸è½½')} onBeforeshow={() => console.log('å³å°†é‡æ–°æ¸²æŸ“ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ')} onAftershow={() => console.log('å·²ç»é‡æ–°æ¸²æŸ“ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ')} onError={() => console.log('æ¸²æŸ“å‡ºé”™')}
/> vueä¸­ç›‘å¬æ–¹å¼å’Œæ™®é€šäº‹ä»¶ä¸€è‡´ã€‚
<template> <micro-app name='xx' url='xx' @created='created' @beforemount='beforemount' @mounted='mounted' @afterhidden='afterhidden' @beforeshow='beforeshow' @aftershow='aftershow' @error='error' />
</template> <script>
export default { methods: { created () { console.log('micro-appå…ƒç´ è¢«åˆ›å»º'), }, beforemount () { console.log('å³å°†è¢«æ¸²æŸ“ï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡'), }, mounted () { console.log('å·²ç»æ¸²æŸ“å®Œæˆï¼Œåªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡'), }, afterhidden () { console.log('å·²å¸è½½'), }, beforeshow () { console.log('å³å°†é‡æ–°æ¸²æŸ“ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ'), }, aftershow () { console.log('å·²ç»é‡æ–°æ¸²æŸ“ï¼Œåˆå§‹åŒ–æ—¶ä¸æ‰§è¡Œ'), }, error () { console.log('æ¸²æŸ“å‡ºé”™'), } }
}
<\/script>`},{header:"å­åº”ç”¨",slug:"å­åº”ç”¨",content:`keep-aliveæ¨¡å¼ä¸‹ï¼Œåœ¨å­åº”ç”¨å¸è½½ã€é‡æ–°æ¸²æŸ“æ—¶ï¼Œmicro-appéƒ½ä¼šå‘å­åº”ç”¨å‘é€åä¸ºappstate-changeçš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡ç›‘å¬è¯¥äº‹ä»¶è·å–å½“å‰çŠ¶æ€ï¼ŒçŠ¶æ€å€¼å¯ä»¥é€šè¿‡äº‹ä»¶å¯¹è±¡å±æ€§e.detail.appStateè·å–ã€‚
e.detail.appStateçš„å€¼æœ‰ä¸‰ä¸ªï¼šafterhiddenã€beforeshowã€aftershowï¼Œåˆ†åˆ«å¯¹åº”å¸è½½ã€å³å°†æ¸²æŸ“ã€å·²ç»æ¸²æŸ“ã€‚
// ç›‘å¬keep-aliveæ¨¡å¼ä¸‹çš„åº”ç”¨çŠ¶æ€
window.addEventListener('appstate-change', function (e) { if (e.detail.appState === 'afterhidden') { console.log('å·²å¸è½½') } else if (e.detail.appState === 'beforeshow') { console.log('å³å°†é‡æ–°æ¸²æŸ“') } else if (e.detail.appState === 'aftershow') { console.log('å·²ç»é‡æ–°æ¸²æŸ“') }
})
åº”ç”¨åˆå§‹åŒ–æ—¶ä¸ä¼šè§¦å‘appstate-changeäº‹ä»¶ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€å†æ¬¡æ¸²æŸ“æ—¶urlå’Œé¡µé¢ä¸åŒ¹é…",slug:"_1ã€å†æ¬¡æ¸²æŸ“æ—¶urlå’Œé¡µé¢ä¸åŒ¹é…",content:`keep-aliveçš„åº”ç”¨åœ¨å¸è½½æ—¶ä¼šä¿ç•™é¡µé¢çŠ¶æ€ï¼Œå†æ¬¡æ¸²æŸ“æ—¶ç›´æ¥æ¢å¤ï¼Œå½“åº”ç”¨å†æ¬¡æ¸²æŸ“æ—¶çš„urlä¸ç¦»å¼€æ—¶ä¸ä¸€è‡´ï¼Œåˆ™å‡ºç°urlå’Œé¡µé¢ä¸åŒ¹é…çš„é—®é¢˜ã€‚
å¦‚æœè¿™ä¸ªé—®é¢˜å¯¹ä½ é€ æˆäº†å›°æ‰°ï¼Œå¯ä»¥é€šè¿‡ç›‘å¬appstate-changeäº‹ä»¶ï¼Œåœ¨beforeshowæ—¶è¿›è¡Œä¿®å¤ï¼Œæ ¹æ®urlè·³è½¬å¯¹åº”çš„é¡µé¢ã€‚`},{header:"2ã€å¦‚ä½•æ¢å¤é¡µé¢æ»šåŠ¨ä½ç½®ï¼Ÿ",slug:"_2ã€å¦‚ä½•æ¢å¤é¡µé¢æ»šåŠ¨ä½ç½®",content:"micro-appä¸ä¼šè®°å½•é¡µé¢æ»šåŠ¨ä½ç½®ï¼Œåº”ç”¨å†æ¬¡æ¸²æŸ“æ—¶ä¹Ÿä¸ä¼šè¿›è¡Œæ¢å¤ï¼Œéœ€è¦å¼€å‘è€…è¿›è¡Œè®°å½•å’Œæ¢å¤ã€‚"},{header:"3ã€å­åº”ç”¨å†…éƒ¨é¡µé¢åˆ‡æ¢åçŠ¶æ€ä¸¢å¤±",slug:"_3ã€å­åº”ç”¨å†…éƒ¨é¡µé¢åˆ‡æ¢åçŠ¶æ€ä¸¢å¤±",content:"micro-appçš„keep-aliveæ˜¯åº”ç”¨çº§åˆ«çš„ï¼Œå®ƒåªä¼šä¿ç•™å½“å‰æ­£åœ¨æ´»åŠ¨çš„é¡µé¢çŠ¶æ€ï¼Œä»¥ä¿è¯åº”ç”¨è¢«å¸è½½å’Œé‡æ–°æ¸²æŸ“æ—¶çš„çŠ¶æ€ä¿ç•™ï¼Œå¦‚æœæƒ³è¦ç¼“å­˜å…·ä½“çš„é¡µé¢æˆ–ç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨å­åº”ç”¨æ¡†æ¶çš„èƒ½åŠ›ï¼Œå¦‚ï¼švueçš„keep-aliveã€‚"}]},{path:"/v0/zh/life-cycles.html",title:"ç”Ÿå‘½å‘¨æœŸ",pathLocale:"/",contents:[{header:"ç”Ÿå‘½å‘¨æœŸ",slug:"ç”Ÿå‘½å‘¨æœŸ",content:"micro-appé€šè¿‡CustomEventå®šä¹‰ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­ä¼šè§¦å‘ç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚"},{header:"ç”Ÿå‘½å‘¨æœŸåˆ—è¡¨",slug:"ç”Ÿå‘½å‘¨æœŸåˆ—è¡¨",content:""},{header:"1. created",slug:"_1-created",content:"<micro-app>æ ‡ç­¾åˆå§‹åŒ–åï¼ŒåŠ è½½èµ„æºå‰è§¦å‘ã€‚"},{header:"2. beforemount",slug:"_2-beforemount",content:"åŠ è½½èµ„æºå®Œæˆåï¼Œå¼€å§‹æ¸²æŸ“ä¹‹å‰è§¦å‘ã€‚"},{header:"3. mounted",slug:"_3-mounted",content:"å­åº”ç”¨æ¸²æŸ“ç»“æŸåè§¦å‘ã€‚"},{header:"4. unmount",slug:"_4-unmount",content:"å­åº”ç”¨å¸è½½æ—¶è§¦å‘ã€‚"},{header:"5. error",slug:"_5-error",content:"å­åº”ç”¨æ¸²æŸ“å‡ºé”™æ—¶è§¦å‘ï¼Œåªæœ‰ä¼šå¯¼è‡´æ¸²æŸ“ç»ˆæ­¢çš„é”™è¯¯æ‰ä¼šè§¦å‘æ­¤ç”Ÿå‘½å‘¨æœŸã€‚"},{header:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",slug:"ç›‘å¬ç”Ÿå‘½å‘¨æœŸ",content:`å› ä¸ºReactä¸æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚
åœ¨<micro-app>æ ‡ç­¾æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfillï¼Œæ³¨é‡Šä¹Ÿè¦å¤åˆ¶ã€‚
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
å¼€å§‹ä½¿ç”¨
<micro-app name='xx' url='xx' onCreated={() => console.log('micro-appå…ƒç´ è¢«åˆ›å»º')} onBeforemount={() => console.log('å³å°†è¢«æ¸²æŸ“')} onMounted={() => console.log('å·²ç»æ¸²æŸ“å®Œæˆ')} onUnmount={() => console.log('å·²ç»å¸è½½')} onError={() => console.log('æ¸²æŸ“å‡ºé”™')}
/> vueä¸­ç›‘å¬æ–¹å¼å’Œæ™®é€šäº‹ä»¶ä¸€è‡´ã€‚
<template> <micro-app name='xx' url='xx' @created='created' @beforemount='beforemount' @mounted='mounted' @unmount='unmount' @error='error' />
</template> <script>
export default { methods: { created () { console.log('micro-appå…ƒç´ è¢«åˆ›å»º') }, beforemount () { console.log('å³å°†è¢«æ¸²æŸ“') }, mounted () { console.log('å·²ç»æ¸²æŸ“å®Œæˆ') }, unmount () { console.log('å·²ç»å¸è½½') }, error () { console.log('æ¸²æŸ“å‡ºé”™') } }
}
<\/script> æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚
const myApp = document.querySelector('micro-app[name=my-app]') myApp.addEventListener('created', () => { console.log('created')
}) myApp.addEventListener('beforemount', () => { console.log('beforemount')
}) myApp.addEventListener('mounted', () => { console.log('mounted')
}) myApp.addEventListener('unmount', () => { console.log('unmount')
}) myApp.addEventListener('error', () => { console.log('error')
})`},{header:"å…¨å±€ç›‘å¬",slug:"å…¨å±€ç›‘å¬",content:`å…¨å±€ç›‘å¬ä¼šåœ¨æ¯ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œæ—¶éƒ½ä¼šè§¦å‘ã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ lifeCycles: { created (e) { console.log('created') }, beforemount (e) { console.log('beforemount') }, mounted (e) { console.log('mounted') }, unmount (e) { console.log('unmount') }, error (e) { console.log('error') } }
})`},{header:"å­åº”ç”¨å¸è½½",slug:"å­åº”ç”¨å¸è½½",content:`å¯¹äºå­åº”ç”¨åªæœ‰ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸï¼ŒæŒ‚è½½å’Œå¸è½½ã€‚
æŒ‚è½½ï¼šå­åº”ç”¨çš„jsè¢«æ‰§è¡Œåˆ™ä¸ºæŒ‚è½½ï¼Œæ‰€ä»¥ä¸éœ€è¦ç‰¹æ®Šçš„ç›‘å¬ï¼Œä¸€èˆ¬åœ¨å…¥å£jsæ–‡ä»¶ä¸­è¿›è¡ŒæŒ‚è½½ç›¸å…³æ“ä½œã€‚
å¸è½½ï¼šå­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œå¼€å‘è€…å¯ä»¥åœ¨æ­¤è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// å­åº”ç”¨å¸è½½
window.addEventListener('unmount', function () { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ
})`}]},{path:"/v0/zh/nest.html",title:"å¤šå±‚åµŒå¥—",pathLocale:"/",contents:[{header:"å¤šå±‚åµŒå¥—",slug:"å¤šå±‚åµŒå¥—",content:`micro-appæ”¯æŒå¤šå±‚åµŒå¥—ï¼Œå³å­åº”ç”¨å¯ä»¥åµŒå…¥å…¶å®ƒå­åº”ç”¨ï¼Œä½†ä¸ºäº†é˜²æ­¢æ ‡ç­¾åå†²çªï¼Œå­åº”ç”¨ä¸­éœ€è¦åšä¸€äº›ä¿®æ”¹ã€‚
åœ¨å­åº”ç”¨ä¸­è®¾ç½®tagNameï¼š
microApp.start({ tagName: 'micro-app-xxx', // æ ‡ç­¾åç§°å¿…é¡»ä»¥ \`micro-app-\` å¼€å¤´
})
åœ¨å­åº”ç”¨ä¸­ä½¿ç”¨æ–°å®šä¹‰çš„æ ‡ç­¾è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ï¼š
<micro-app-xxx name='xx' url='xx'></micro-app-xxx>
æ³¨æ„
æ— è®ºåµŒå¥—å¤šå°‘å±‚ï¼Œnameéƒ½è¦ä¿è¯å…¨å±€å”¯ä¸€ã€‚`}]},{path:"/v0/zh/plugins.html",title:"æ’ä»¶ç³»ç»Ÿ",pathLocale:"/",contents:[{header:"æ’ä»¶ç³»ç»Ÿ",slug:"æ’ä»¶ç³»ç»Ÿ",content:`å¾®å‰ç«¯çš„ä½¿ç”¨åœºæ™¯éå¸¸å¤æ‚ï¼Œæ²¡æœ‰å®Œç¾çš„æ²™ç®±æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ’ä»¶ç³»ç»Ÿï¼Œå®ƒèµ‹äºˆå¼€å‘è€…çµæ´»å¤„ç†é™æ€èµ„æºçš„èƒ½åŠ›ï¼Œå¯¹æœ‰é—®é¢˜çš„èµ„æºæ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚
æ’ä»¶ç³»ç»Ÿçš„ä¸»è¦ä½œç”¨å°±æ˜¯å¯¹jsè¿›è¡Œä¿®æ”¹ï¼Œæ¯ä¸€ä¸ªjsæ–‡ä»¶éƒ½ä¼šç»è¿‡æ’ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›jsè¿›è¡Œæ‹¦æˆªå’Œå¤„ç†ï¼Œå®ƒé€šå¸¸ç”¨äºä¿®å¤jsä¸­çš„é”™è¯¯æˆ–å‘å­åº”ç”¨æ³¨å…¥ä¸€äº›å…¨å±€å˜é‡ã€‚`},{header:"é€‚ç”¨åœºæ™¯",slug:"é€‚ç”¨åœºæ™¯",content:"é€šå¸¸æˆ‘ä»¬æ— æ³•æ§åˆ¶jsçš„è¡¨ç°ï¼Œæ¯”å¦‚åœ¨æ²™ç®±ä¸­ï¼Œé¡¶å±‚çš„å˜é‡æ˜¯æ— æ³•æ³„æ¼ä¸ºå…¨å±€å˜é‡çš„ï¼ˆå¦‚ var xx = , function xxx å®šä¹‰å˜é‡ï¼Œæ— æ³•é€šè¿‡window.xx è®¿é—®ï¼‰ï¼Œå¯¼è‡´jsæŠ¥é”™ï¼Œæ­¤æ—¶å¼€å‘è€…å¯ä»¥é€šè¿‡æ’ä»¶å¯¹jsè¿›è¡Œä¿®æ”¹å¤„ç†ã€‚"},{header:"ä½¿ç”¨æ–¹å¼",slug:"ä½¿ç”¨æ–¹å¼",content:"import microApp from '@micro-zoe/micro-app' microApp.start({ plugins: { // å…¨å±€æ’ä»¶ï¼Œä½œç”¨äºæ‰€æœ‰å­åº”ç”¨çš„jsæ–‡ä»¶ global?: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°åŸºåº§åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¿…å¡«ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å›codeå€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => code, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => code }> // å­åº”ç”¨æ’ä»¶ modules?: { // appNameä¸ºåº”ç”¨çš„åç§°ï¼Œè¿™äº›æ’ä»¶åªä¼šä½œç”¨äºæŒ‡å®šçš„åº”ç”¨ [appName: string]: Array<{ // å¯é€‰ï¼Œå¼ºéš”ç¦»çš„å…¨å±€å˜é‡(é»˜è®¤æƒ…å†µä¸‹å­åº”ç”¨æ— æ³•æ‰¾åˆ°çš„å…¨å±€å˜é‡ä¼šå…œåº•åˆ°åŸºåº§åº”ç”¨ä¸­ï¼ŒscopePropertieså¯ä»¥ç¦æ­¢è¿™ç§æƒ…å†µ) scopeProperties?: string[], // å¯é€‰ï¼Œå¯ä»¥é€ƒé€¸åˆ°å¤–éƒ¨çš„å…¨å±€å˜é‡(escapePropertiesä¸­çš„å˜é‡ä¼šåŒæ—¶èµ‹å€¼åˆ°å­åº”ç”¨å’Œå¤–éƒ¨çœŸå®çš„windowä¸Š) escapeProperties?: string[], // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` åˆ™å¿½ç•¥ script å’Œ link æ ‡ç­¾çš„åˆ›å»º excludeChecker?: (url: string) => boolean // å¯é€‰ï¼Œå¦‚æœå‡½æ•°è¿”å› `true` ï¼Œåˆ™ micro-app ä¸ä¼šå¤„ç†å®ƒï¼Œå…ƒç´ å°†åŸå°ä¸åŠ¨è¿›è¡Œæ¸²æŸ“ ignoreChecker?: (url: string) => boolean // å¯é€‰ï¼Œä¼ é€’ç»™loaderçš„é…ç½®é¡¹ options?: any, // å¯é€‰ï¼Œjså¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å›codeå€¼ loader?: (code: string, url: string, options: any, info: sourceScriptInfo) => code, // å¯é€‰ï¼Œhtml å¤„ç†å‡½æ•°ï¼Œå¿…é¡»è¿”å› code å€¼ processHtml?: (code: string, url: string, options: unknown) => code }> } }\n})"},{header:"æ¡ˆä¾‹",slug:"æ¡ˆä¾‹",content:`import microApp from '@micro-zoe/micro-app' microApp.start({ plugins: { global: [ { scopeProperties: ['key', 'key', ...], // å¯é€‰ escapeProperties: ['key', 'key', ...], // å¯é€‰ excludeChecker: (url) => ['/foo.js', '/bar.css'].some(item => url.includes(item)), // å¯é€‰ options: é…ç½®é¡¹, // å¯é€‰ loader(code, url, options, info) { // å¯é€‰ console.log('å…¨å±€æ’ä»¶') return code }, processHtml(code, url, options, info) { // å¯é€‰ console.log('æ¯ä¸ªå­åº”ç”¨ HTML éƒ½ä¼šä¼ å…¥') return code }, } ], modules: { 'appName1': [{ loader(code, url, options, info) { if (url === 'xxx.js') { code = code.replace('var abc =', 'window.abc =') } return code } }], 'appName2': [{ scopeProperties: ['key', 'key', ...], // å¯é€‰ escapeProperties: ['key', 'key', ...], // å¯é€‰ ignoreChecker: (url) => ['/foo.js', '/bar.css'].some(item => url.includes(item)), // å¯é€‰ options: é…ç½®é¡¹, // å¯é€‰ loader(code, url, options, info) { // å¯é€‰ console.log('åªé€‚ç”¨äºappName2çš„æ’ä»¶') return code }, processHtml(code, url, options, info) { // å¯é€‰ console.log('åªé€‚ç”¨äº appName2 çš„ HTML å¤„ç†') return code }, }] } }
})`},{header:"æ’ä»¶åˆ—è¡¨",slug:"æ’ä»¶åˆ—è¡¨",content:""},{header:"1ã€åœ°å›¾æ’ä»¶",slug:"_1ã€åœ°å›¾æ’ä»¶",content:"å¾®å‰ç«¯ Micro-app åœ°å›¾æ’ä»¶ï¼Œé€‚é…é«˜å¾·ã€ç™¾åº¦ã€è…¾è®¯åœ°å›¾ ğŸ‰ğŸ‰ğŸ‰"},{header:"ä½¿ç”¨",slug:"ä½¿ç”¨",content:`Installationå®‰è£…åœ°å›¾æ’ä»¶ # with npm npm install @micro-zoe/micro-plugin-map --save-dev # with yarn yarn add @micro-zoe/micro-plugin-map --dev
Usage
we use the package like this step:
1ã€ä¸»ç”¨ï¼Œåœ¨å…¥å£å¤„å®‰è£…å¯¹åº”åœ°å›¾çš„sdk é«˜å¾·sdk https://webapi.amap.com/maps?v=2.0&key=xxxxxx
è…¾è®¯sdk https://map.qq.com/api/gljs?v=1.exp&key=xxxxxx
ç™¾åº¦sdk https://api.map.baidu.com/api?type=webgl&v=1.0&ak=xxxxxx 2ã€åœ¨ä¸»åº”ç”¨ä¸­ï¼Œä½¿ç”¨è¯¥åŒ… import microApp from '@micro-zoe/micro-app' import microPluginMap from '@micro-zoe/micro-plugin-map' // è®¾ç½®ä¸ºå…¨å±€æ’ä»¶ï¼Œä½œç”¨äºæ‰€æœ‰å­åº”ç”¨ microApp.start({ plugins: { global: [microPluginMap], } }) // æˆ–è€…è®¾ç½®ä¸ºæŸä¸ªå­åº”ç”¨çš„æ’ä»¶ï¼Œåªä½œç”¨äºå½“å‰å­åº”ç”¨ microApp.start({ plugins: { modules: { 'appName': [microPluginMap], } } })`},{header:"æ³¨æ„",slug:"æ³¨æ„",content:"ç›®å‰æ’ä»¶ç›®å‰ä»…åœ¨withæ²™ç®±ä¸‹é€‚ç”¨ æ’ä»¶ä»¥umdåŒæ­¥çš„æ–¹å¼å¼•å…¥sdkï¼Œå¼‚æ­¥åŠ è½½çš„æ–¹å¼æš‚ä¸æ”¯æŒ é«˜å¾·åœ°å›¾çš„ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œå¯ä»¥ä¸ç”¨è¿›è¡Œä»»ä½•æ“ä½œï¼Œé«˜å¾·åœ°å›¾è‹¥è®¾ç½®äº†ä½¿ç”¨ç™½åå•ï¼Œéœ€å°†ç™½åå•èŒƒå›´å›Šæ‹¬ä¸»åº”ç”¨åŸŸå è…¾è®¯åœ°å›¾ï¼Œä½¿ç”¨æ—¶å€™åªæ˜¯å¸¸è§„çš„è·¨è¶Šï¼Œç”¨æ­¤æ’ä»¶è¿›è¡Œå¸¸è§„ä½¿ç”¨å³å¯ï¼Œè…¾è®¯åœ°å›¾è‹¥è®¾ç½®äº†ä½¿ç”¨ç™½åå•ï¼Œéœ€å°†ç™½åå•èŒƒå›´å›Šæ‹¬ä¸»åº”ç”¨åŸŸå ç™¾åº¦åœ°å›¾ï¼Œä½¿ç”¨æ—¶æœ‰è·¨åŸŸé—®é¢˜ï¼Œå¯ç”¨æ­¤æ’ä»¶è¿›è¡Œå¤„ç†ï¼Œç™¾åº¦åœ°å›¾è‹¥è®¾ç½®äº†ä½¿ç”¨ç™½åå•ï¼Œéœ€å°†ç™½åå•èŒƒå›´å›Šæ‹¬ä¸»åº”ç”¨åŸŸå"},{header:"æºç ",slug:"æºç ",content:"micro-plugin-map æºç åœ°å€ï¼šhttps://github.com/micro-zoe/micro-plugin-map"}]},{path:"/v0/zh/prefetch.html",title:"é¢„åŠ è½½",pathLocale:"/",contents:[{header:"é¢„åŠ è½½",slug:"é¢„åŠ è½½",content:`é¢„åŠ è½½æ˜¯æŒ‡åœ¨åº”ç”¨å°šæœªæ¸²æŸ“æ—¶æå‰åŠ è½½èµ„æºå¹¶ç¼“å­˜ï¼Œä»è€Œæå‡é¦–å±æ¸²æŸ“é€Ÿåº¦ã€‚
é¢„åŠ è½½å¹¶ä¸æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œå®ƒä¼šåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´ï¼Œä¾ç…§å¼€å‘è€…ä¼ å…¥çš„é¡ºåºï¼Œä¾æ¬¡åŠ è½½æ¯ä¸ªåº”ç”¨çš„é™æ€èµ„æºï¼Œä»¥ç¡®ä¿ä¸ä¼šå½±å“åŸºåº§åº”ç”¨çš„æ€§èƒ½ã€‚`},{header:"microApp.preFetch(Array<app> | Function => Array<app>)",slug:"microapp-prefetch-array-app-function-array-app",content:`preFetchæ¥å—appæ•°ç»„æˆ–ä¸€ä¸ªè¿”å›appæ•°ç»„çš„å‡½æ•°ï¼Œappçš„å€¼å¦‚ä¸‹ï¼š
app: { name: string, // åº”ç”¨åç§°ï¼Œå¿…ä¼  url: string, // åº”ç”¨åœ°å€ï¼Œå¿…ä¼  disableScopecss?: boolean // æ˜¯å¦å…³é—­æ ·å¼éš”ç¦»ï¼Œéå¿…ä¼  disableSandbox?: boolean // æ˜¯å¦å…³é—­æ²™ç›’ï¼Œéå¿…ä¼ 
}`},{header:"ä½¿ç”¨æ–¹å¼",slug:"ä½¿ç”¨æ–¹å¼",content:`import microApp from '@micro-zoe/micro-app' // æ–¹å¼ä¸€
microApp.preFetch([ { name: 'my-app', url: 'xxx' }
]) // æ–¹å¼äºŒ
microApp.preFetch(() => [ { name: 'my-app', url: 'xxx' }
]) // æ–¹å¼ä¸‰
microApp.start({ preFetchApps: [ { name: 'my-app', url: 'xxx' } ], // å‡½æ•°ç±»å‹ // preFetchApps: () => [ // { name: 'my-app', url: 'xxx' } // ],
})
Note é¢„åŠ è½½å…¥å‚ï¼šdisableScopecssã€disableSandbox å¿…é¡»å’Œ <micro-app>é…ç½®é¡¹ä¿æŒä¸€è‡´ã€‚å¦‚æœäº§ç”Ÿå†²çªï¼Œä»¥å…ˆæ‰§è¡Œçš„ä¸€æ–¹ä¸ºå‡†ã€‚
å¦‚æœå­åº”ç”¨å¼€å¯äº†shadowDOMï¼Œåˆ™é¢„åŠ è½½ä¸­çš„disableScopecsséœ€è¦è®¾ç½®ä¸ºtrue`}]},{path:"/v0/zh/questions.html",title:"å¸¸è§é—®é¢˜",pathLocale:"/",contents:[{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€æˆ‘éœ€è¦ç”¨åˆ°å¾®å‰ç«¯å—ï¼Ÿ",slug:"_1ã€æˆ‘éœ€è¦ç”¨åˆ°å¾®å‰ç«¯å—",content:`åœ¨æ­¤ä¹‹å‰å»ºè®®ä½ å…ˆé˜…è¯»Why Not Iframeã€‚
ç›¸æ¯”äºiframeï¼Œå¾®å‰ç«¯æ‹¥æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶å®ƒä¹Ÿè¦æ±‚å¼€å‘è€…å¯¹äºå‰ç«¯æ¡†æ¶å’Œè·¯ç”±åŸç†å…·æœ‰ä¸€å®šçš„ç†è§£ã€‚
å¾®å‰ç«¯çš„æœ¬è´¨æ˜¯å°†ä¸¤ä¸ªä¸ç›¸å…³çš„é¡µé¢å¼ºè¡Œåˆå¹¶ä¸ºä¸€ï¼Œè¿™å…¶ä¸­ä¸å¯é¿å…ä¼šå‡ºç°å„ç§å†²çªï¼Œè™½ç„¶å¾®å‰ç«¯æ¡†æ¶è§£å†³äº†å‡ ä¹æ‰€æœ‰çš„å†²çªï¼Œä½†å¶å°”ä¹Ÿä¼šæœ‰ç‰¹æ®Šæƒ…å†µå‡ºç°ï¼Œè¿™éœ€è¦å¼€å‘è€…å…·æœ‰å¤„ç†ç‰¹æ®Šæƒ…å†µçš„èƒ½åŠ›å’Œå¿ƒæ€ã€‚
å¾®å‰ç«¯ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒçš„å®ç°åŸç†æ³¨å®šæ— æ³•åƒiframeä¸€æ ·ç®€å•ç¨³å®šã€‚
å¦‚æœä½ ä¸çŸ¥é“è‡ªå·±æ˜¯å¦éœ€è¦ç”¨å¾®å‰ç«¯ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯ä¸éœ€è¦ã€‚`},{header:"2ã€å­åº”ç”¨ä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ",slug:"_2ã€å­åº”ç”¨ä¸€å®šè¦æ”¯æŒè·¨åŸŸå—",content:`æ˜¯çš„ï¼
å¦‚æœæ˜¯å¼€å‘ç¯å¢ƒï¼Œå¯ä»¥åœ¨webpack-dev-serverä¸­è®¾ç½®headersæ”¯æŒè·¨åŸŸã€‚
devServer: { headers: { 'Access-Control-Allow-Origin': '*', },
},
å¦‚æœæ˜¯çº¿ä¸Šç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡é…ç½®nginxæ”¯æŒè·¨åŸŸã€‚`},{header:"3ã€å…¼å®¹æ€§å¦‚ä½•",slug:"_3ã€å…¼å®¹æ€§å¦‚ä½•",content:`micro-appä¾èµ–äºCustomElementså’ŒProxyä¸¤ä¸ªè¾ƒæ–°çš„APIã€‚
å¯¹äºä¸æ”¯æŒCustomElementsçš„æµè§ˆå™¨ï¼Œå¯ä»¥é€šè¿‡å¼•å…¥polyfillè¿›è¡Œå…¼å®¹ï¼Œè¯¦æƒ…å¯å‚è€ƒï¼šwebcomponents/polyfillsã€‚
ä½†æ˜¯Proxyæš‚æ—¶æ²¡æœ‰åšå…¼å®¹ï¼Œæ‰€ä»¥å¯¹äºä¸æ”¯æŒProxyçš„æµè§ˆå™¨æ— æ³•è¿è¡Œmicro-appã€‚
æµè§ˆå™¨å…¼å®¹æ€§å¯ä»¥æŸ¥çœ‹ï¼šCan I Use
æ€»ä½“å¦‚ä¸‹ï¼š PCç«¯ï¼šé™¤äº†IEæµè§ˆå™¨ï¼Œå…¶å®ƒæµè§ˆå™¨åŸºæœ¬å…¼å®¹ã€‚
ç§»åŠ¨ç«¯ï¼šios10+ã€android5+`},{header:"4ã€å¾®åº”ç”¨æ— æ³•æ¸²æŸ“ä½†æ²¡æœ‰æŠ¥é”™",slug:"_4ã€å¾®åº”ç”¨æ— æ³•æ¸²æŸ“ä½†æ²¡æœ‰æŠ¥é”™",content:"è¯·æ£€æŸ¥è·¯ç”±é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œè¯¦æƒ…æŸ¥çœ‹è·¯ç”±ä¸€ç« ï¼Œæˆ–è€…ä¸‹é¢ç¬¬5æ¡ï¼šjsonpFunctionæ˜¯å¦å†²çª"},{header:"5ã€webpack-jsonpfunction-å†²çªå¯¼è‡´æ¸²æŸ“å¤±è´¥",slug:"_5ã€webpack-jsonpfunction-å†²çªå¯¼è‡´æ¸²æŸ“å¤±è´¥",content:`è¿™ç§æƒ…å†µå¸¸è§äºå¤šä¸ªåº”ç”¨éƒ½æ˜¯é€šè¿‡create-react-appç­‰ç±»ä¼¼è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œæˆ–ä¸€ä¸ªåº”ç”¨å¤šæ¬¡é‡å¤æ¸²æŸ“ã€‚
å› ä¸ºç›¸åŒçš„jsonpFunctionåç§°ä¼šå¯¼è‡´èµ„æºåŠ è½½æ··ä¹±ã€‚
è§£å†³æ–¹å¼ï¼šä¿®æ”¹å­åº”ç”¨çš„webpacké…ç½® // webpack.config.js
module.exports = { output: { ... jsonpFunction: \`webpackJsonp_custom_app_name\`, globalObject: 'window', },
} // webpack.config.js
module.exports = { output: { ... chunkLoadingGlobal: 'webpackJsonp_custom_app_name', globalObject: 'window', },
}`},{header:"6ã€å¼€å‘æ—¶æ¯æ¬¡ä¿å­˜æ–‡ä»¶æ—¶æŠ¥é”™ (çƒ­æ›´æ–°å¯¼è‡´æŠ¥é”™)",slug:"_6ã€å¼€å‘æ—¶æ¯æ¬¡ä¿å­˜æ–‡ä»¶æ—¶æŠ¥é”™-çƒ­æ›´æ–°å¯¼è‡´æŠ¥é”™",content:"åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œçƒ­æ›´æ–°ä¼šå¯¼è‡´ä¿å­˜æ—¶æŠ¥é”™ï¼Œè¯·å…³é—­çƒ­æ›´æ–°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨å°è¯•æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚"},{header:"7ã€vue3çš„é—®é¢˜",slug:"_7ã€vue3çš„é—®é¢˜",content:`1ã€æ ·å¼å¤±æ•ˆ
é€šè¿‡ç¦ç”¨æ ·å¼éš”ç¦»è§£å†³ã€‚
2ã€å›¾ç‰‡ç­‰é™æ€èµ„æºæ— æ³•æ­£å¸¸åŠ è½½
vue3ä¸­éœ€è¦é…ç½®publicPathè¡¥å…¨èµ„æºè·¯å¾„ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹publicPath`},{header:"8ã€å¼€å‘ç¯å¢ƒä¸­æ¸²æŸ“angularå­åº”ç”¨æŠ¥é”™",slug:"_8ã€å¼€å‘ç¯å¢ƒä¸­æ¸²æŸ“angularå­åº”ç”¨æŠ¥é”™",content:`ç›®å‰éœ€è¦å…³é—­angularçš„çƒ­æ›´æ–°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨å°è¯•æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚
"scripts": { "start": "ng serve --live-reload false",
},`},{header:"9ã€micro-app æŠ¥é”™ an app named xx already exists",slug:"_9ã€micro-app-æŠ¥é”™-an-app-named-xx-already-exists",content:"è¿™æ˜¯nameåç§°å†²çªå¯¼è‡´çš„ï¼Œè¯·ç¡®ä¿æ¯ä¸ªå­åº”ç”¨çš„nameå€¼æ˜¯å”¯ä¸€çš„ã€‚"},{header:"10ã€åŸºåº§åº”ç”¨çš„æ ·å¼å½±å“åˆ°å­åº”ç”¨",slug:"_10ã€åŸºåº§åº”ç”¨çš„æ ·å¼å½±å“åˆ°å­åº”ç”¨",content:`è™½ç„¶æˆ‘ä»¬å°†å­åº”ç”¨çš„æ ·å¼è¿›è¡Œéš”ç¦»ï¼Œä½†åŸºåº§åº”ç”¨çš„æ ·å¼ä¾ç„¶ä¼šå½±å“åˆ°å­åº”ç”¨ï¼Œå¦‚æœå‘ç”Ÿå†²çªï¼Œæ¨èé€šè¿‡çº¦å®šå‰ç¼€æˆ–CSS Modulesæ–¹å¼è§£å†³ã€‚
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ant-designç­‰ç»„ä»¶åº“ï¼Œä¸€èˆ¬ä¼šæä¾›æ·»åŠ å‰ç¼€è¿›è¡Œæ ·å¼éš”ç¦»çš„åŠŸèƒ½ã€‚`},{header:"11ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°å¤–éƒ¨çœŸå®windowï¼Ÿ",slug:"_11ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°å¤–éƒ¨çœŸå®window",content:`ç›®å‰æœ‰3ç§æ–¹å¼åœ¨å­åº”ç”¨ä¸­è·å–å¤–éƒ¨çœŸå®window 1ã€new Function("return window")() æˆ– Function("return window")()
2ã€(0, eval)('window')
3ã€window.rawWindow`},{header:"12ã€é”™è¯¯ä¿¡æ¯ï¼šxxx æœªå®šä¹‰",slug:"_12ã€é”™è¯¯ä¿¡æ¯-xxx-æœªå®šä¹‰",content:`åŒ…æ‹¬ï¼š xxx is not defined
xxx is not a function
Cannot read properties of undefined åŸå› ï¼š
åœ¨å¾®å‰ç«¯çš„æ²™ç®±ç¯å¢ƒä¸­ï¼Œé¡¶å±‚å˜é‡ä¸ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ã€‚
ä¾‹å¦‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ var name æˆ– function name () {} å®šä¹‰çš„é¡¶å±‚å˜é‡ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œé€šè¿‡window.nameæˆ–nameå°±å¯ä»¥å…¨å±€è®¿é—®ã€‚
ä½†æ˜¯åœ¨æ²™ç®±ç¯å¢ƒä¸‹è¿™äº›é¡¶å±‚å˜é‡æ— æ³•æ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œwindow.nameæˆ–nameä¸ºundefinedï¼Œå¯¼è‡´å‡ºç°é—®é¢˜ã€‚
è§£å†³æ–¹å¼ï¼š
æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨ä¿®æ”¹
å°† var name æˆ– function name () {} ä¿®æ”¹ä¸º window.name = xx
æ–¹å¼äºŒï¼šé€šè¿‡æ’ä»¶ç³»ç»Ÿä¿®æ”¹å­åº”ç”¨ä»£ç 
æ¯”å¦‚å¸¸è§çš„åŠ è½½webpackæ‰“åŒ…çš„dllæ–‡ä»¶å¤±è´¥çš„é—®é¢˜ï¼Œå› ä¸ºdllæ–‡ä»¶çš„å†…å®¹å’Œjsåœ°å€ç›¸å¯¹å›ºå®šï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå…¨å±€æŸ¥æ‰¾å’Œä¿®æ”¹ã€‚
microApp.start({ plugins: { modules: { åº”ç”¨åç§°: [{ loader(code, url) { if (url === 'xxx.js') { code = code.replace('var xx_dll=', 'window.xx_dll=') } return code } }] } }
})`},{header:"13ã€å­åº”ç”¨åŠ è½½sockjs-nodeå¤±è´¥",slug:"_13ã€å­åº”ç”¨åŠ è½½sockjs-nodeå¤±è´¥",content:`è¿™ä¸ªé—®é¢˜å¸¸è§äºcreate-react-appåˆ›å»ºçš„å­åº”ç”¨ï¼Œæ¨èé€šè¿‡æ’ä»¶ç³»ç»Ÿæ¥è§£å†³ã€‚
microApp.start({ plugins: { modules: { 'å­åº”ç”¨name': [{ loader(code) { if (code.indexOf('sockjs-node') > -1) { code = code.replace('window.location.port', 'å­åº”ç”¨ç«¯å£').replace('window.location.hostname', 'å­åº”ç”¨hostï¼Œå¦‚æœå’ŒåŸºåº§ç›¸åŒåˆ™ä¸éœ€è¦æ›¿æ¢hostname') } return code } }], } }
})
å®é™…æƒ…å†µå¯èƒ½æ›´åŠ å¤æ‚ï¼Œä¸Šé¢åªæ˜¯ä¸€ç§è§£å†³æ€è·¯ã€‚`},{header:"14ã€å­åº”ç”¨è¯·æ±‚æ¥å£å¤±è´¥",slug:"_14ã€å­åº”ç”¨è¯·æ±‚æ¥å£å¤±è´¥",content:`1ã€è¯·ç¡®ä¿æ¥å£è¯·æ±‚æ²¡æœ‰è·¨åŸŸé—®é¢˜ï¼Œå› ä¸ºå­åº”ç”¨è¢«åŠ è½½åˆ°åŸºåº§æ¸²æŸ“ï¼Œæ‰€ä»¥è¯·æ±‚æ¥å£æ˜¯ä»åŸºåº§å‘é€ã€‚ 2ã€è¯·æ±‚çš„æ¥å£ä¸ºç›¸å¯¹åœ°å€ï¼Œä¼šä»¥åŸºåº§åŸŸåè¿›è¡Œè¡¥å…¨ï¼Œå¯¼è‡´æŠ¥é”™ã€‚
å¦‚ï¼šfetch('/api/data')ï¼Œåœ¨è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨è¢«æµè§ˆå™¨è¡¥å…¨ä¸ºfetch(åŸºåº§åŸŸå + '/api/data')
ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå­åº”ç”¨éœ€è¦ä½¿ç”¨å®Œæ•´çš„åœ°å€ï¼šfetch(å­åº”ç”¨åŸŸå + '/api/data')`},{header:"15ã€å­åº”ç”¨åå‘ä»£ç†å¤±è´¥",slug:"_15ã€å­åº”ç”¨åå‘ä»£ç†å¤±è´¥",content:`è§£å†³æ–¹å¼ï¼š å­åº”ç”¨ä½¿ç”¨å®Œæ•´çš„åœ°å€å‘é€è¯·æ±‚
å¦‚ï¼šfetch('/api/data') æ”¹ä¸º fetch(å­åº”ç”¨åŸŸå + '/api/data')
å¦‚æœè¿˜æ˜¯æŠ¥è·¨åŸŸé—®é¢˜ï¼Œåˆ™æ˜¯æœåŠ¡ç«¯åšäº†é™åˆ¶ï¼Œæ­¤æ—¶éœ€è¦æ’¤é™¤ä¸Šè¿°æ“ä½œï¼Œå¹¶å°†å­åº”ç”¨çš„ä»£ç†æ”¾åˆ°åŸºåº§åº”ç”¨ä¸­ã€‚`},{header:"16ã€å­åº”ç”¨å¤šæ¬¡æ¸²æŸ“åå†…å­˜è¶Šæ¥è¶Šå¤§",slug:"_16ã€å­åº”ç”¨å¤šæ¬¡æ¸²æŸ“åå†…å­˜è¶Šæ¥è¶Šå¤§",content:"å‚è€ƒå†…å­˜ä¼˜åŒ–ä¸€ç« "},{header:"17ã€å­åº”ç”¨ä¹‹é—´å¦‚ä½•è·³è½¬",slug:"_17ã€å­åº”ç”¨ä¹‹é—´å¦‚ä½•è·³è½¬",content:"å‚è€ƒåº”ç”¨ä¹‹é—´å¦‚ä½•è·³è½¬ä¸€ç« "},{header:"18ã€jsonpè¯·æ±‚å¦‚ä½•å¤„ç†ï¼Ÿ",slug:"_18ã€jsonpè¯·æ±‚å¦‚ä½•å¤„ç†",content:"å‚è€ƒignore"},{header:"19ã€å­åº”ç”¨é€šè¿‡aæ ‡ç­¾ä¸‹è½½æ–‡ä»¶å¤±è´¥",slug:"_19ã€å­åº”ç”¨é€šè¿‡aæ ‡ç­¾ä¸‹è½½æ–‡ä»¶å¤±è´¥",content:`åŸå› ï¼š å½“è·¨åŸŸæ—¶(åŸºåº§å’Œæ–‡ä»¶åœ¨ä¸åŒåŸŸåä¸‹)ï¼Œæ— æ³•é€šè¿‡aæ ‡ç­¾çš„downloadå±æ€§å®ç°ä¸‹è½½ã€‚
è§£å†³æ–¹å¼ï¼š
æ–¹å¼1ï¼š è½¬æ¢ä¸ºblobå½¢å¼ä¸‹è½½
<a href='xxx.png' download="filename.png" @click='downloadFile'>ä¸‹è½½</a>
// é€šè¿‡blobä¸‹è½½æ–‡ä»¶
function downloadFile (e) { // å¾®å‰ç«¯ç¯å¢ƒä¸‹è½¬æ¢ä¸ºblobä¸‹è½½ï¼Œå­åº”ç”¨å•ç‹¬è¿è¡Œæ—¶ä¾ç„¶ä½¿ç”¨aæ ‡ç­¾ä¸‹è½½ if (window.__MICRO_APP_ENVIRONMENT__) { e.preventDefault() // æ³¨æ„hrefå¿…é¡»æ˜¯ç»å¯¹åœ°å€ fetch(e.target.href).then((res) => { res.blob().then((blob) => { const blobUrl = window.URL.createObjectURL(blob) // è½¬åŒ–ä¸ºblobURLåå†é€šè¿‡aæ ‡ç­¾ä¸‹è½½ const a = document.createElement('a') a.href = blobUrl a.download = 'filename.png' a.click() window.URL.revokeObjectURL(blobUrl) }) }) }
}
æ–¹å¼2ï¼š å°†æ–‡ä»¶æ”¾åˆ°åŸºåº§åŸŸåä¸‹ï¼Œåˆ¤æ–­å¾®å‰ç«¯ç¯å¢ƒä¸‹aæ ‡ç­¾hrefå±æ€§è®¾ç½®ä¸ºåŸºåº§çš„æ–‡ä»¶åœ°å€`}]},{path:"/v0/zh/route.html",title:"è·¯ç”±",pathLocale:"/",contents:[{header:"è·¯ç”±",slug:"è·¯ç”±",content:"å¾®å‰ç«¯çš„æ¸²æŸ“ç¦»ä¸å¼€è·¯ç”±ï¼Œè€Œè·¯ç”±é…ç½®æ˜¯æœ€å®¹æ˜“å‡ºé—®é¢˜çš„åœ°æ–¹ã€‚"},{header:"è·¯ç”±é…ç½®",slug:"è·¯ç”±é…ç½®",content:""},{header:"è·¯ç”±ç±»å‹çº¦æŸ",slug:"è·¯ç”±ç±»å‹çº¦æŸ",content:`1ã€åŸºåº§æ˜¯hashè·¯ç”±ï¼Œå­åº”ç”¨ä¹Ÿå¿…é¡»æ˜¯hashè·¯ç”±
2ã€åŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥æ˜¯hashæˆ–historyè·¯ç”±`},{header:"åŸºç¡€è·¯ç”±",slug:"åŸºç¡€è·¯ç”±",content:`ä½œç”¨ï¼š
é€šå¸¸åŸºåº§åº”ç”¨å’Œå­åº”ç”¨å„æœ‰ä¸€å¥—è·¯ç”±ç³»ç»Ÿï¼Œä¸ºäº†é˜²æ­¢å†²çªï¼ŒåŸºåº§éœ€è¦åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨ï¼Œç§°ä¹‹ä¸ºåŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥åœ¨è¿™ä¸ªè·¯ç”±ä¸‹æ¸²æŸ“ï¼Œä½†ä¸èƒ½è¶…å‡ºè¿™ä¸ªè·¯ç”±çš„èŒƒå›´ï¼Œè¿™å°±æ˜¯åŸºç¡€è·¯ç”±çš„ä½œç”¨ã€‚
ä½¿ç”¨æ–¹å¼
åŸºåº§åº”ç”¨ä¸­é€šè¿‡è®¾ç½® <micro-app>çš„baserouteå±æ€§ä¸‹å‘ï¼Œå­åº”ç”¨é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–æ­¤å€¼å¹¶è®¾ç½®åŸºç¡€è·¯ç”±ã€‚
æ³¨æ„ç‚¹ï¼š 1ã€å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œä¸éœ€è¦è®¾ç½®åŸºç¡€è·¯ç”±baseroute
2ã€å¦‚æœå­åº”ç”¨åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œæ²¡æœ‰ä½¿ç”¨react-routerï¼Œvue-routerä¹‹ç±»ï¼Œä¹Ÿä¸éœ€è¦è®¾ç½®åŸºç¡€è·¯ç”±baseroute
3ã€vue-routeråœ¨hashæ¨¡å¼ä¸‹æ— æ³•é€šè¿‡baseè®¾ç½®åŸºç¡€è·¯ç”±ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªç©ºçš„è·¯ç”±é¡µé¢ï¼Œå°†å…¶å®ƒè·¯ç”±ä½œä¸ºå®ƒçš„childrenï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹ï¼š import RootApp from './root-app.vue' const routes = [ { path: window.__MICRO_APP_BASE_ROUTE__ || '/', component: RootApp, children: [ // å…¶ä»–çš„è·¯ç”±éƒ½å†™åˆ°è¿™é‡Œ ], },
]
root-app.vueå†…å®¹å¦‚ä¸‹ï¼š
<template> <router-view />
</template>
ç¤ºä¾‹ // router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom'
import ChildPage from './child-page' export default function AppRoute () { return ( <BrowserRouter> <Switch> // éä¸¥æ ¼åŒ¹é…ï¼Œ/child/* éƒ½æŒ‡å‘ChildPageç»„ä»¶ // /child å°±æ˜¯åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±baseroute <Route path='/child'> <ChildPage /> </Route> </Switch> </BrowserRouter> )
} // child-page.js
export function ChildPage () { return ( <div> <h1>å­åº”ç”¨</h1> <micro-app name='child-app' url='http://localhost:3000/' baseroute='/child'></micro-app> </div> )
} import { BrowserRouter, Switch, Route } from 'react-router-dom' export default function AppRoute () { return ( // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–åŸºåº§ä¸‹å‘çš„baserouteï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™æ­¤å€¼é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² <BrowserRouter basename={window.__MICRO_APP_BASE_ROUTE__ || '/'}> ... </BrowserRouter> )
} // router.js
import Vue from 'vue'
import VueRouter from 'vue-router'
import ChildPage from './child-page.vue' Vue.use(VueRouter) const routes = [ { // /child/* éƒ½æŒ‡å‘ChildPageç»„ä»¶ path: '/child/*', // vue-router@4.x pathçš„å†™æ³•ä¸ºï¼š'/child/:page*' name: 'child', component: ChildPage, },
] export default routes // child-page.vue
<template> <div> <h1>å­åº”ç”¨</h1> <micro-app name='child-app' url='http://localhost:3000/' baseroute='/child'></micro-app> </div>
</template> import Vue from 'vue'
import VueRouter from 'vue-router'
import routes from './router' const router = new VueRouter({ // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–åŸºåº§ä¸‹å‘çš„baserouteï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™æ­¤å€¼é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² base: window.__MICRO_APP_BASE_ROUTE__ || '/', routes,
}) let app = new Vue({ router, render: h => h(App),
}).$mount('#app') æç¤º
vue-router@4.xè®¾ç½®baseçš„æ–¹å¼è¯·æŸ¥çœ‹ https://next.router.vuejs.org/`},{header:"urlå±æ€§å’Œå­åº”ç”¨è·¯ç”±çš„å…³ç³»",slug:"urlå±æ€§å’Œå­åº”ç”¨è·¯ç”±çš„å…³ç³»",content:`ç­”ï¼šæ²¡æœ‰å…³ç³»ï¼
micro-appçš„urlå±æ€§åªæ˜¯htmlçš„åœ°å€ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯åŠ è½½htmlèµ„æºã€‚`},{header:"å­åº”ç”¨ä¸ä¼šæ ¹æ®micro-appçš„urlå±æ€§æ¸²æŸ“å¯¹åº”çš„é¡µé¢ï¼Œè€Œæ˜¯æ ¹æ®æµè§ˆå™¨åœ°å€æ¸²æŸ“å¯¹åº”çš„é¡µé¢ã€‚",slug:"å­åº”ç”¨ä¸ä¼šæ ¹æ®micro-appçš„urlå±æ€§æ¸²æŸ“å¯¹åº”çš„é¡µé¢-è€Œæ˜¯æ ¹æ®æµè§ˆå™¨åœ°å€æ¸²æŸ“å¯¹åº”çš„é¡µé¢ã€‚",content:`ä¸¾ä¸ªæ —å­ ğŸŒ° :
æµè§ˆå™¨åœ°å€ä¸ºï¼šhttp://localhost:3000/page1/ï¼Œæ­¤æ—¶è·¯ç”±åœ°å€ä¸ºpage1ã€‚
åŸºåº§åº”ç”¨ä¼šåŒ¹é…page1å¹¶æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œå­åº”ç”¨ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæµè§ˆå™¨åœ°å€ä¼šåŒæ—¶å½±å“åˆ°åŸºåº§åº”ç”¨å’Œå­åº”ç”¨ï¼Œå› ä¸ºæ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€å¥—è‡ªå·±çš„è·¯ç”±ç³»ç»Ÿï¼Œå®ƒä»¬æ˜¯å¯ä»¥å…±å­˜çš„ï¼Œä¸ä¼šå†²çªã€‚
æ­¤æ—¶æˆ‘ä»¬è¦æ¸²æŸ“å­åº”ç”¨http://www.xxx.com/çš„page1é¡µé¢ï¼Œé‚£ä¹ˆmicro-appçš„urlå±æ€§å¡«å†™çš„æ˜¯http://www.xxx.com/ï¼Œè€Œä¸æ˜¯http://www.xxx.com/page1/ã€‚
<micro-app url='http://www.xxx.com/'></micro-app>
å­åº”ç”¨åŠ è½½å®Œæˆåä¼šæ ¹æ®æµè§ˆå™¨çš„åœ°å€page1åŒ¹é…å¹¶æ¸²æŸ“å¯¹åº”çš„é¡µé¢ã€‚
åŒç†ï¼Œé¡µé¢å‚æ•°å’Œhashä¹Ÿæ˜¯ä»¥æµè§ˆå™¨ä¸ºå‡†ã€‚
æ —å­2 ğŸŒ° :
å­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œæˆ‘ä»¬è¦æ¸²æŸ“å­åº”ç”¨çš„page1é¡µé¢ï¼Œé‚£ä¹ˆåœ¨micro-appçš„urlå±æ€§ä¸Šè®¾ç½®hashå€¼æ˜¯æ— æ•ˆçš„ï¼Œ#/page1åº”è¯¥æ·»åŠ åˆ°æµè§ˆå™¨åœ°å€ä¸Šã€‚
<!-- âŒ è¿™é‡Œçš„#/page1æ˜¯æ— æ•ˆçš„ï¼Œåº”è¯¥æ·»åŠ åˆ°æµè§ˆå™¨åœ°å€ä¸Š -->
<micro-app url='http://www.xxx.com/#/page1'></micro-app> <!-- âœ”ï¸ è¿™ä¸ªurlæ‰æ˜¯æ­£ç¡®çš„ -->
<micro-app url='http://www.xxx.com/'></micro-app>
æ —å­3 ğŸŒ° :
åŸºåº§åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œæˆ‘ä»¬è¦è·³è½¬åŸºåº§åº”ç”¨çš„my-appé¡µé¢ï¼Œé¡µé¢ä¸­åµŒå…¥å­åº”ç”¨ï¼Œæˆ‘ä»¬è¦å±•ç°å­åº”ç”¨çš„page1é¡µé¢ã€‚
é‚£ä¹ˆæµè§ˆå™¨åœ°å€åº”è¯¥ä¸ºï¼šåŸŸå/my-page#/page1ï¼Œæˆ‘ä»¬åœ¨åŸºåº§ä¸­è·³è½¬my-appé¡µé¢çš„å‚æ•°ä¸ºï¼šrouter.push('/my-page#/page1')
æ­¤æ—¶æµç¨‹ä¸ºï¼šåŸºåº§åº”ç”¨åŒ¹é…åˆ°/my-pageè·¯å¾„å¹¶æ¸²æŸ“my-appé¡µé¢ï¼Œå› ä¸ºmy-appé¡µé¢ä¸­åµŒå…¥äº†å­åº”ç”¨ï¼Œæ­¤æ—¶å­åº”ç”¨å¼€å§‹åŠ è½½å¹¶æ¸²æŸ“ï¼Œå­åº”ç”¨åœ¨æ¸²æŸ“æ—¶ä¼šåŒ¹é…åˆ°#/page1å¹¶æ¸²æŸ“page1é¡µé¢ã€‚
micro-appé…ç½®å¦‚ä¸‹ï¼š
<!-- æ­¤æ—¶ä¸éœ€è¦è®¾ç½®baseroute -->
<micro-app url='http://www.xxx.com/index.html'></micro-app>
æ —å­4 ğŸŒ° :
åŸºåº§åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨ä¹Ÿæ˜¯historyè·¯ç”±ï¼Œæˆ‘ä»¬è¦è·³è½¬åŸºåº§åº”ç”¨çš„my-appé¡µé¢ï¼Œmy-appé¡µé¢ä¸­åµŒå…¥å­åº”ç”¨ï¼Œæˆ‘ä»¬è¦å±•ç°å­åº”ç”¨çš„page1é¡µé¢ã€‚
é‚£ä¹ˆæµè§ˆå™¨åœ°å€åº”è¯¥ä¸ºï¼šåŸŸå/my-page/page1ï¼Œæˆ‘ä»¬åœ¨åŸºåº§ä¸­è·³è½¬çš„å‚æ•°ä¸ºï¼šrouter.push('/my-page/page1')
æ­¤æ—¶æµç¨‹ä¸ºï¼šåŸºåº§åº”ç”¨åŒ¹é…åˆ°/my-pageè·¯å¾„å¹¶æ¸²æŸ“my-appé¡µé¢ï¼Œå› ä¸ºmy-appé¡µé¢ä¸­åµŒå…¥äº†å­åº”ç”¨ï¼Œæ­¤æ—¶å­åº”ç”¨å¼€å§‹åŠ è½½å¹¶æ¸²æŸ“ï¼Œå­åº”ç”¨åœ¨æ¸²æŸ“æ—¶ä¼šåŒ¹é…åˆ°/my-page/page1å¹¶æ¸²æŸ“page1é¡µé¢ã€‚
micro-appé…ç½®å¦‚ä¸‹ï¼š
è¿™å°±æ˜¯åœ¨å¿«é€Ÿå¼€å§‹ä¸€ç« ä¸­æåˆ°çš„æ¡ˆä¾‹ã€‚
<!-- å­åº”ç”¨é€šè¿‡baserouteè®¾ç½®åŸºç¡€è·¯ç”±ï¼Œè·¯ç”± /page1 å˜ä¸º /my-page/page1 -->
<micro-app url='http://www.xxx.com/index.html' baseroute='/my-page'></micro-app>
æç¤º
å¦‚æœä½ çœ‹åˆ°è¿™é‡Œè¿˜æ˜¯æ— æ³•æ­£ç¡®è®¾ç½®è·¯ç”±ï¼Œé‚£ä¹ˆå°†åŸºåº§åº”ç”¨è®¾ç½®ä¸ºhistoryè·¯ç”±ï¼Œå­åº”ç”¨è®¾ç½®ä¸ºhashè·¯ç”±ï¼Œå¯ä»¥ä¸€åŠ³æ°¸é€¸è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œæ­¤æ—¶ä¸éœ€è¦è®¾ç½®baserouteï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹åŸºåº§å’Œå­åº”ç”¨çš„ä»»ä½•è·¯ç”±è®¾ç½®ã€‚`}]},{path:"/v0/zh/sandbox.html",title:"JSæ²™ç®±",pathLocale:"/",contents:[{header:"JSæ²™ç®±",slug:"jsæ²™ç®±",content:""},{header:"æ²™ç®±ä»‹ç»",slug:"æ²™ç®±ä»‹ç»",content:`æˆ‘ä»¬ä½¿ç”¨Proxyæ‹¦æˆªäº†ç”¨æˆ·å…¨å±€æ“ä½œçš„è¡Œä¸ºï¼Œé˜²æ­¢å¯¹windowçš„è®¿é—®å’Œä¿®æ”¹ï¼Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“ã€‚micro-appä¸­çš„æ¯ä¸ªå­åº”ç”¨éƒ½è¿è¡Œåœ¨æ²™ç®±ç¯å¢ƒï¼Œä»¥è·å–ç›¸å¯¹çº¯å‡€çš„è¿è¡Œç©ºé—´ã€‚
æ²™ç®±æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸å»ºè®®å…³é—­ï¼Œä»¥é¿å…å‡ºç°ä¸å¯é¢„çŸ¥çš„é—®é¢˜ã€‚
å¦‚ä½•å…³é—­æ²™ç®±è¯·æŸ¥çœ‹ï¼šdisableSandbox`},{header:"æ³¨æ„äº‹é¡¹",slug:"æ³¨æ„äº‹é¡¹",content:""},{header:"1ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°çœŸå®window",slug:"_1ã€å­åº”ç”¨åœ¨æ²™ç®±ç¯å¢ƒä¸­å¦‚ä½•è·å–åˆ°çœŸå®window",content:`ç›®å‰æœ‰3ç§æ–¹å¼åœ¨å­åº”ç”¨ä¸­è·å–å¤–éƒ¨çœŸå®window 1ã€new Function("return window")() æˆ– Function("return window")()
2ã€(0, eval)('window')
3ã€window.rawWindow`},{header:"2ã€å­åº”ç”¨æŠ›å‡ºé”™è¯¯ä¿¡æ¯ï¼šxxx æœªå®šä¹‰",slug:"_2ã€å­åº”ç”¨æŠ›å‡ºé”™è¯¯ä¿¡æ¯-xxx-æœªå®šä¹‰",content:`åŒ…æ‹¬ï¼š xxx is not defined
xxx is not a function
Cannot read properties of undefined åŸå› ï¼š
åœ¨æ²™ç®±ç¯å¢ƒä¸­ï¼Œé¡¶å±‚å˜é‡ä¸ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ã€‚
ä¾‹å¦‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ var name æˆ– function name () {} å®šä¹‰çš„é¡¶å±‚å˜é‡ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œé€šè¿‡window.nameæˆ–nameå°±å¯ä»¥å…¨å±€è®¿é—®ã€‚
ä½†æ˜¯åœ¨æ²™ç®±ç¯å¢ƒä¸‹è¿™äº›é¡¶å±‚å˜é‡æ— æ³•æ³„æ¼ä¸ºå…¨å±€å˜é‡ï¼Œwindow.nameæˆ–nameçš„å€¼ä¸ºundefinedï¼Œå¯¼è‡´å‡ºç°é—®é¢˜ã€‚
è§£å†³æ–¹å¼ï¼š
æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨ä¿®æ”¹
å°† var name æˆ– function name () {} ä¿®æ”¹ä¸º window.name = xx
æ–¹å¼äºŒï¼šé€šè¿‡æ’ä»¶ç³»ç»Ÿä¿®æ”¹å­åº”ç”¨ä»£ç 
æ¯”å¦‚å¸¸è§çš„åŠ è½½webpackæ‰“åŒ…çš„dllæ–‡ä»¶å¤±è´¥çš„é—®é¢˜ï¼Œå› ä¸ºdllæ–‡ä»¶çš„å†…å®¹å’Œjsåœ°å€ç›¸å¯¹å›ºå®šï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå…¨å±€æŸ¥æ‰¾å’Œä¿®æ”¹ã€‚
microApp.start({ plugins: { modules: { åº”ç”¨åç§°: [{ loader(code, url) { if (url === 'xxx.js') { code = code.replace('var xx_dll=', 'window.xx_dll=') } return code } }] } }
})`}]},{path:"/v0/zh/scopecss.html",title:"æ ·å¼éš”ç¦»",pathLocale:"/",contents:[{header:"æ ·å¼éš”ç¦»",slug:"æ ·å¼éš”ç¦»",content:""},{header:"ä¸€ã€æ ·å¼éš”ç¦»",slug:"ä¸€ã€æ ·å¼éš”ç¦»",content:`MicroAppçš„æ ·å¼éš”ç¦»æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¼€å¯åä¼šä»¥<micro-app>æ ‡ç­¾ä½œä¸ºæ ·å¼ä½œç”¨åŸŸï¼Œåˆ©ç”¨æ ‡ç­¾çš„nameå±æ€§ä¸ºæ¯ä¸ªæ ·å¼æ·»åŠ å‰ç¼€ï¼Œå°†å­åº”ç”¨çš„æ ·å¼å½±å“ç¦é”¢åœ¨å½“å‰æ ‡ç­¾åŒºåŸŸã€‚
.test { color: red;
} /* è½¬æ¢ä¸º */
micro-app[name=xxx] .test { color: red;
}
ä½†åŸºåº§åº”ç”¨çš„æ ·å¼ä¾ç„¶ä¼šå¯¹å­åº”ç”¨äº§ç”Ÿå½±å“ï¼Œå¦‚æœå‘ç”Ÿæ ·å¼æ±¡æŸ“ï¼Œæ¨èé€šè¿‡çº¦å®šå‰ç¼€æˆ–CSS Modulesæ–¹å¼è§£å†³ã€‚`},{header:"äºŒã€ç¦ç”¨æ ·å¼éš”ç¦»",slug:"äºŒã€ç¦ç”¨æ ·å¼éš”ç¦»",content:"ç¦ç”¨æ ·å¼éš”ç¦»åˆ†å››ä¸ªå±‚æ¬¡ï¼š"},{header:"1ã€åœ¨æ‰€æœ‰åº”ç”¨ä¸­ç¦ç”¨",slug:"_1ã€åœ¨æ‰€æœ‰åº”ç”¨ä¸­ç¦ç”¨",content:`è¿™ä¸»è¦é€šè¿‡startæ–¹æ³•è¿›è¡Œå…¨å±€é…ç½®ï¼Œè®¾ç½®åæ‰€æœ‰åº”ç”¨çš„æ ·å¼éš”ç¦»éƒ½ä¼šåœæ­¢ã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ disableScopecss: true, // é»˜è®¤å€¼false
})
å¦‚æœå¸Œæœ›åœ¨æŸä¸ªåº”ç”¨ä¸­ä¸å—å…¨å±€é…ç½®æ§åˆ¶ï¼Œå¯ä»¥è®¾ç½®disableScopecss='false'
<micro-app name='xx' url='xx' disableScopecss='false'></micro-app>`},{header:"2ã€åœ¨æŸä¸€ä¸ªåº”ç”¨ä¸­ç¦ç”¨",slug:"_2ã€åœ¨æŸä¸€ä¸ªåº”ç”¨ä¸­ç¦ç”¨",content:`è®¾ç½®åï¼Œå½“å‰åº”ç”¨çš„æ‰€æœ‰csséƒ½ä¸ä¼šè¿›è¡Œæ ·å¼éš”ç¦»ã€‚
<micro-app name='xx' url='xx' disableScopecss æˆ– disable-scopecss></micro-app>`},{header:"3ã€åœ¨æŸä¸€ä¸ªæ–‡ä»¶ä¸­ç¦ç”¨",slug:"_3ã€åœ¨æŸä¸€ä¸ªæ–‡ä»¶ä¸­ç¦ç”¨",content:`å¯ä»¥åœ¨ä½ çš„cssæ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹æ ¼å¼çš„æ³¨é‡Šæ¥ç¦ç”¨æ ·å¼éš”ç¦»ï¼š
/*! scopecss-disable */
.test1 { color: red;
}
/*! scopecss-enable */
ä½ ä¹Ÿå¯ä»¥å¯¹æŒ‡å®šçš„é€‰æ‹©å™¨ç¦ç”¨æ ·å¼éš”ç¦»:
/*! scopecss-disable .test1, .test2 */
.test1 { color: red;
}
.test2 { color: yellow;
}
.test3 { color: green;
}
/*! scopecss-enable */
å¦‚æœæƒ³åœ¨æ•´ä¸ªæ–‡ä»¶èŒƒå›´å†…ç¦ç”¨æ ·å¼éš”ç¦»ï¼Œå°† /*! scopecss-disable */ æ³¨é‡Šæ”¾åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼š
/*! scopecss-disable */
...`},{header:"4ã€åœ¨æŸä¸€è¡Œä¸­ç¦ç”¨",slug:"_4ã€åœ¨æŸä¸€è¡Œä¸­ç¦ç”¨",content:`åœ¨æ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹æ ¼å¼çš„æ³¨é‡Šåœ¨æŸä¸€ç‰¹å®šçš„è¡Œä¸Šç¦ç”¨æ ·å¼éš”ç¦»ï¼š
/*! scopecss-disable-next-line */
.test1 { color: red;
} .test2 { /*! scopecss-disable-next-line */ background: url(/test.png);
}
Note
ä¸Šè¿°æ³¨é‡Šè§„åˆ™éƒ½ä»¥å¹å·å¼€å¤´(d/*! */)ï¼Œè¿™æ˜¯å› ä¸ºåœ¨buildæ—¶å¤§éƒ¨åˆ†é¡¹ç›®ä¼šå°†cssä¸­çš„æ³¨é‡Šåˆ é™¤ä»¥å‹ç¼©ä½“ç§¯ï¼Œå¹å·å¼€å¤´æ˜¯cssnanoçš„ä¸€ç§è§„åˆ™ï¼Œå¯ä»¥é˜²æ­¢åœ¨buildæ—¶æ³¨é‡Šè¢«åˆ é™¤discardcommentsã€‚
æˆ‘ä»¬ä»¥cssnanoä¸ºä¾‹ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯PostCSSä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„å‹ç¼©æ’ä»¶ï¼Œå¦‚æœä½ ä½¿ç”¨äº†å¦å¤–çš„å‹ç¼©å·¥å…·ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼Œé˜²æ­¢buildåçš„æ³¨é‡Šè¢«åˆ é™¤ã€‚`},{header:"ä¸‰ã€shadowDOM",slug:"ä¸‰ã€shadowdom",content:`shadowDOMå…·æœ‰æ›´å¥½çš„éš”ç¦»æ€§ï¼Œä½†ä¸€äº›æ¡†æ¶(å¦‚React)å¯¹shadowDOMçš„å…¼å®¹æ€§ä¸å¥½ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚
å¼€å¯shadowDOMåï¼Œé»˜è®¤çš„æ ·å¼éš”ç¦»å°†å¤±æ•ˆã€‚
å¼€å¯æ–¹å¼ï¼šshadowDOM`}]},{path:"/v0/zh/start.html",title:"å¿«é€Ÿå¼€å§‹",pathLocale:"/",contents:[{header:"å¿«é€Ÿå¼€å§‹",slug:"å¿«é€Ÿå¼€å§‹",content:"æˆ‘ä»¬åˆ†åˆ«åˆ—å‡ºåŸºåº§åº”ç”¨å’Œå­åº”ç”¨éœ€è¦è¿›è¡Œçš„ä¿®æ”¹ï¼Œå…·ä½“ä»‹ç»micro-appçš„ä½¿ç”¨æ–¹å¼ã€‚"},{header:"åŸºåº§åº”ç”¨",slug:"åŸºåº§åº”ç”¨",content:`1ã€å®‰è£…ä¾èµ–
npm i @micro-zoe/micro-app --save
2ã€åœ¨å…¥å£å¤„å¼•å…¥
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start()
3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨ // router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom'
import MyPage from './my-page' export default function AppRoute () { return ( <BrowserRouter> <Switch> // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢ <Route path='/my-page'> <MyPage /> </Route> </Switch> </BrowserRouter> )
} // router.js
import Vue from 'vue'
import VueRouter from 'vue-router'
import MyPage from './my-page.vue' Vue.use(VueRouter) const routes = [ { // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢ path: '/my-page/*', // vue-router@4.x pathçš„å†™æ³•ä¸ºï¼š'/my-page/:page*' name: 'my-page', component: MyPage, },
] export default routes 4ã€åœ¨MyPageé¡µé¢ä¸­åµŒå…¥å­åº”ç”¨ // my-page.js
export function MyPage () { return ( <div> <h1>å­åº”ç”¨</h1> // name(å¿…ä¼ )ï¼šåº”ç”¨åç§° // url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html // baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ \`/my-page\` <micro-app name='app1' url='http://localhost:3000/' baseroute='/my-page'></micro-app> </div> )
} <!-- my-page.vue -->
<template> <div> <h1>å­åº”ç”¨</h1> <!-- name(å¿…ä¼ )ï¼šåº”ç”¨åç§° url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ \`/my-page\` --> <micro-app name='app1' url='http://localhost:3000/' baseroute='/my-page'></micro-app> </div>
</template>`},{header:"å­åº”ç”¨",slug:"å­åº”ç”¨",content:`1ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§åº”ç”¨æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥) // router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom' export default function AppRoute () { return ( // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–åŸºåº§ä¸‹å‘çš„baserouteï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™æ­¤å€¼é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² <BrowserRouter basename={window.__MICRO_APP_BASE_ROUTE__ || '/'}> ... </BrowserRouter> )
} // main.js
import Vue from 'vue'
import VueRouter from 'vue-router'
import routes from './router' const router = new VueRouter({ // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå­åº”ç”¨å¯ä»¥é€šè¿‡window.__MICRO_APP_BASE_ROUTE__è·å–åŸºåº§ä¸‹å‘çš„baserouteï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™æ­¤å€¼é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² base: window.__MICRO_APP_BASE_ROUTE__ || '/', routes,
}) let app = new Vue({ router, render: h => h(App),
}).$mount('#app') 2ã€åœ¨webpack-dev-serverçš„headersä¸­è®¾ç½®è·¨åŸŸæ”¯æŒã€‚
devServer: { headers: { 'Access-Control-Allow-Origin': '*', }
},
å®Œæˆä»¥ä¸Šæ­¥éª¤å¾®å‰ç«¯å³å¯æ­£å¸¸æ¸²æŸ“ã€‚
Note nameå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦æœ‰é™¤ä¸­åˆ’çº¿å’Œä¸‹åˆ’çº¿å¤–çš„ç‰¹æ®Šç¬¦å·
urlåªæ˜¯htmlåœ°å€ï¼Œå­åº”ç”¨çš„é¡µé¢æ¸²æŸ“è¿˜æ˜¯åŸºäºæµè§ˆå™¨åœ°å€çš„ï¼Œå…³äºè¿™ç‚¹è¯·æŸ¥çœ‹è·¯ç”±ä¸€ç« 
baserouteçš„ä½œç”¨è¯·æŸ¥çœ‹è·¯ç”±é…ç½®
å­åº”ç”¨å¿…é¡»æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œè·¨åŸŸé…ç½®å‚è€ƒè¿™é‡Œ`}]},{path:"/v0/zh/static-source.html",title:"é™æ€èµ„æº",pathLocale:"/",contents:[{header:"é™æ€èµ„æº",slug:"é™æ€èµ„æº",content:""},{header:"èµ„æºè·¯å¾„è‡ªåŠ¨è¡¥å…¨",slug:"èµ„æºè·¯å¾„è‡ªåŠ¨è¡¥å…¨",content:`æ˜¯æŒ‡å¯¹å­åº”ç”¨ç›¸å¯¹åœ°å€çš„èµ„æºè·¯å¾„è¿›è¡Œè¡¥å…¨ï¼Œä»¥ç¡®ä¿æ‰€æœ‰èµ„æºæ­£å¸¸åŠ è½½ï¼Œå®ƒæ˜¯micro-appé»˜è®¤æä¾›çš„åŠŸèƒ½ã€‚
å¦‚ï¼šå­åº”ç”¨ä¸­å¼•ç”¨å›¾ç‰‡/myapp/test.pngï¼Œåœ¨æœ€ç»ˆæ¸²æŸ“æ—¶ä¼šè¡¥å…¨ä¸ºhttp://localhost:8080/myapp/test.png
èµ„æºè·¯å¾„è¡¥å…¨åˆ†ä¸ºä¸¤ä¸ªæ–¹é¢ï¼š
1ã€é’ˆå¯¹èµ„æºæ ‡ç­¾
å¦‚ linkã€scriptã€img
2ã€é’ˆå¯¹cssçš„è¿œç¨‹èµ„æº
å¦‚ background-imageã€@font-face è‡ªåŠ¨è¡¥å…¨æœ‰æ—¶ä¼šå¤±æ•ˆï¼Œå› ä¸ºä¸€äº›æ¡†æ¶å’Œåº“åœ¨ç‰¹å®šåœºæ™¯ä¸‹åˆ›å»ºçš„å…ƒç´ æ— æ³•è¢«æ‹¦æˆªå’Œå¤„ç†ï¼Œæˆ–è€…å½“å…³é—­æ ·å¼éš”ç¦»å’Œæ²™ç®±æ—¶ï¼Œä¹Ÿä¼šå¯¼è‡´è‡ªåŠ¨è¡¥å…¨å¤±æ•ˆã€‚
æ­¤æ—¶æ¨èä½¿ç”¨ä¸‹é¢publicPathæ–¹æ¡ˆè§£å†³ã€‚`},{header:"publicPath",slug:"publicpath",content:`å¦‚æœè‡ªåŠ¨è¡¥å…¨å¤±è´¥ï¼Œå¯ä»¥é‡‡ç”¨è¿è¡Œæ—¶publicPathæ–¹æ¡ˆè§£å†³ã€‚
è¿™æ˜¯ç”±webpackæä¾›çš„åŠŸèƒ½ï¼Œä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€è®¾ç½®webpack.publicPathï¼Œè¯¦ç»†é…ç½®å‚è€ƒwebpackæ–‡æ¡£ publicPath
å¦‚æœä½ å·²ç»è®¾ç½®äº†publicPathä¸ºå¸¦åŸŸåçš„ç»å¯¹åœ°å€(å¦‚ï¼šhttps://xxx)ï¼Œåˆ™å¿½ç•¥æ­¤ç« èŠ‚`},{header:"è®¾ç½®æ–¹å¼",slug:"è®¾ç½®æ–¹å¼",content:`æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"èµ„æºå…±äº«",slug:"èµ„æºå…±äº«",content:`å½“å¤šä¸ªå­åº”ç”¨æ‹¥æœ‰ç›¸åŒçš„jsæˆ–cssèµ„æºï¼Œå¯ä»¥æŒ‡å®šè¿™äº›èµ„æºåœ¨å¤šä¸ªå­åº”ç”¨ä¹‹é—´å…±äº«ï¼Œåœ¨å­åº”ç”¨åŠ è½½æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­æå–æ•°æ®ï¼Œä»è€Œæé«˜æ¸²æŸ“æ•ˆç‡å’Œæ€§èƒ½ã€‚
è®¾ç½®èµ„æºå…±äº«çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š`},{header:"æ–¹å¼ä¸€ã€globalAssets",slug:"æ–¹å¼ä¸€ã€globalassets",content:`globalAssetsç”¨äºè®¾ç½®å…¨å±€å…±äº«èµ„æºï¼Œå®ƒå’Œé¢„åŠ è½½çš„æ€è·¯ç›¸åŒï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½èµ„æºå¹¶æ”¾å…¥ç¼“å­˜ã€‚
å½“å­åº”ç”¨åŠ è½½ç›¸åŒåœ°å€çš„jsæˆ–cssèµ„æºæ—¶ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­æå–æ•°æ®ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
// index.js
import microApp from '@micro-zoe/micro-app' microApp.start({ globalAssets: { js: ['jsåœ°å€1', 'jsåœ°å€2', ...], // jsåœ°å€ css: ['cssåœ°å€1', 'cssåœ°å€2', ...], // cssåœ°å€ }
})`},{header:"æ–¹å¼äºŒã€global å±æ€§",slug:"æ–¹å¼äºŒã€global-å±æ€§",content:`åœ¨linkã€scriptè®¾ç½®globalå±æ€§ä¼šå°†æ–‡ä»¶æå–ä¸ºå…¬å…±æ–‡ä»¶ï¼Œå…±äº«ç»™å…¶å®ƒåº”ç”¨ã€‚
è®¾ç½®globalå±æ€§åæ–‡ä»¶ç¬¬ä¸€æ¬¡åŠ è½½ä¼šæ”¾å…¥å…¬å…±ç¼“å­˜ï¼Œå…¶å®ƒå­åº”ç”¨åŠ è½½ç›¸åŒçš„èµ„æºæ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å†…å®¹ï¼Œä»è€Œæå‡æ¸²æŸ“é€Ÿåº¦ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" global>
<script src="xx.js" global><\/script>`},{header:"èµ„æºè¿‡æ»¤",slug:"èµ„æºè¿‡æ»¤",content:`å½“å­åº”ç”¨ä¸éœ€è¦åŠ è½½æŸä¸ªjsæˆ–cssï¼Œå¯ä»¥é€šè¿‡åœ¨linkã€scriptã€styleè®¾ç½®excludeå±æ€§è¿‡æ»¤è¿™äº›èµ„æºï¼Œå½“micro-appé‡åˆ°å¸¦æœ‰excludeå±æ€§çš„å…ƒç´ ä¼šè¿›è¡Œåˆ é™¤ã€‚
ä½¿ç”¨æ–¹å¼
<link rel="stylesheet" href="xx.css" exclude>
<script src="xx.js" exclude><\/script>
<style exclude></style>`}]},{path:"/zh/framework/angular.html",title:"Angular",pathLocale:"/",contents:[{header:"Angular",slug:"angular",content:"æœ¬ç¯‡ä»¥angular 11ä½œä¸ºæ¡ˆä¾‹ä»‹ç»angularçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬angularæ¥å…¥æ–¹å¼ä¼šåœ¨åç»­è¡¥å……ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºä¸»åº”ç”¨",slug:"ä½œä¸ºä¸»åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åˆå§‹åŒ–micro-app",slug:"_2ã€åˆå§‹åŒ–micro-app",content:`// main.ts
import microApp from '@micro-zoe/micro-app' microApp.start()`},{header:"3ã€å¢åŠ å¯¹WebComponentçš„æ”¯æŒ",slug:"_3ã€å¢åŠ å¯¹webcomponentçš„æ”¯æŒ",content:`åœ¨app/app.module.tsä¸­æ·»åŠ  CUSTOM_ELEMENTS_SCHEMA åˆ° @NgModule.schemas
// app/app.module.ts
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core'; @NgModule({ schemas: [CUSTOM_ELEMENTS_SCHEMA],
})`},{header:"4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:`<!-- app/my-page/my-page.component.html -->
<div> <h1>å­åº”ç”¨</h1> <!-- nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ --> <micro-app name='my-app' url='http://localhost:3000/'></micro-app>
</div>
Note nameï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦ç‰¹æ®Šç¬¦å·(ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿é™¤å¤–)
urlï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»æŒ‡å‘å­åº”ç”¨çš„index.htmlï¼Œå¦‚ï¼šhttp://localhost:3000/ æˆ– http://localhost:3000/index.html`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€åœ¨ä¸»åº”ç”¨ä¸­å¼•å…¥zone.js",slug:"_1ã€åœ¨ä¸»åº”ç”¨ä¸­å¼•å…¥zone-js",content:`å¦‚æœä¸»åº”ç”¨éangularï¼Œé‚£ä¹ˆä¸»åº”ç”¨éœ€è¦å¼•å…¥zone.jsæ‰èƒ½æ­£ç¡®åŠ è½½angularå­åº”ç”¨ã€‚
æ­¥éª¤1ã€å®‰è£…ä¾èµ–
npm i zone.js --save
æ­¥éª¤2ã€åœ¨ä¸»åº”ç”¨ä¸­å¼•å…¥zone.js
import 'zone.js'`},{header:"2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`angularå®˜æ–¹è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®åœ¨å¼€å‘ç¯å¢ƒä¸‹é»˜è®¤æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œä¸éœ€è¦ç‰¹æ®Šå¤„ç†ã€‚
å…¶å®ƒé¡¹ç›®åœ¨webpack-dev-serverä¸­æ·»åŠ headersã€‚
headers: { 'Access-Control-Allow-Origin': '*',
}`},{header:"3ã€ç›‘å¬å¸è½½äº‹ä»¶",slug:"_3ã€ç›‘å¬å¸è½½äº‹ä»¶",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// main.ts
let app: void | NgModuleRef<AppModule>
platformBrowserDynamic() .bootstrapModule(AppModule) .then((res: NgModuleRef<AppModule>) => { app = res }) // ç›‘å¬å¸è½½æ“ä½œ
window.unmount = () => { app && app.destroy(); app = undefined;
}
å®Œæˆä»¥ä¸Šæ­¥éª¤å¾®å‰ç«¯å³å¯æ­£å¸¸æ¸²æŸ“ã€‚`},{header:"å¯é€‰è®¾ç½®",slug:"å¯é€‰è®¾ç½®",content:"ä»¥ä¸‹é…ç½®æ˜¯é’ˆå¯¹å­åº”ç”¨çš„ï¼Œå®ƒä»¬æ˜¯å¯é€‰çš„ï¼Œå»ºè®®æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©è®¾ç½®ã€‚"},{header:"1ã€å¼€å¯umdæ¨¡å¼ï¼Œä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½",slug:"_1ã€å¼€å¯umdæ¨¡å¼-ä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½",content:`MicroAppæ”¯æŒä¸¤ç§æ¸²æŸ“å¾®å‰ç«¯çš„æ¨¡å¼ï¼Œé»˜è®¤æ¨¡å¼å’Œumdæ¨¡å¼ã€‚ é»˜è®¤æ¨¡å¼ï¼š å­åº”ç”¨åœ¨åˆæ¬¡æ¸²æŸ“å’Œåç»­æ¸²æŸ“æ—¶ä¼šé¡ºåºæ‰§è¡Œæ‰€æœ‰jsï¼Œä»¥ä¿è¯å¤šæ¬¡æ¸²æŸ“çš„ä¸€è‡´æ€§ã€‚
umdæ¨¡å¼ï¼š å­åº”ç”¨æš´éœ²å‡ºmountã€unmountæ–¹æ³•ï¼Œæ­¤æ—¶åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œæ‰€æœ‰jsï¼Œåç»­æ¸²æŸ“åªä¼šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨å¤šæ¬¡æ¸²æŸ“æ—¶å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œå†…å­˜è¡¨ç°ã€‚ å¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½ä¸é¢‘ç¹ï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤æ¨¡å¼å³å¯ï¼Œå¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½éå¸¸é¢‘ç¹å»ºè®®ä½¿ç”¨umdæ¨¡å¼ã€‚
// main.ts
import { NgModuleRef } from '@angular/core';
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
import { AppModule } from './app/app.module'; declare global { interface Window { microApp: any mount: CallableFunction unmount: CallableFunction __MICRO_APP_ENVIRONMENT__: string }
} let app: void | NgModuleRef<AppModule>
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•°ï¼Œå­åº”ç”¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ
window.mount = () => { platformBrowserDynamic() .bootstrapModule(AppModule) .then((res: NgModuleRef<AppModule>) => { app = res }) .catch(err => console.error(err))
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•°ï¼Œå°±æ˜¯ä¸Šé¢æ­¥éª¤2ä¸­çš„å¸è½½å‡½æ•°
window.unmount = () => { // angularåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æ‰§è¡Œdestroyæ—¶ä¼šåˆ é™¤æ ¹å…ƒç´ app-rootï¼Œå¯¼è‡´åœ¨æ­¤æ¸²æŸ“æ—¶æŠ¥é”™ï¼Œæ­¤æ—¶å¯åˆ é™¤app.destroy()æ¥é¿å…è¿™ä¸ªé—®é¢˜ app && app.destroy(); app = undefined;
} // å¦‚æœä¸åœ¨å¾®å‰ç«¯ç¯å¢ƒï¼Œåˆ™ç›´æ¥æ‰§è¡Œmountæ¸²æŸ“
if (!window.__MICRO_APP_ENVIRONMENT__) { window.mount();
}`},{header:"2ã€è®¾ç½® webpack.jsonpFunction",slug:"_2ã€è®¾ç½®-webpack-jsonpfunction",content:`å¦‚æœå¾®å‰ç«¯æ­£å¸¸è¿è¡Œï¼Œåˆ™å¯ä»¥å¿½ç•¥è¿™ä¸€æ­¥ã€‚
å¦‚æœå­åº”ç”¨èµ„æºåŠ è½½æ··ä¹±å¯¼è‡´æ¸²æŸ“å¤±è´¥ï¼Œå¯ä»¥å°è¯•è®¾ç½®jsonpFunctionæ¥è§£å†³ï¼Œå› ä¸ºç›¸åŒçš„jsonpFunctionåç§°ä¼šå¯¼è‡´èµ„æºæ±¡æŸ“ã€‚
è¿™ç§æƒ…å†µå¸¸è§äºä¸»åº”ç”¨å’Œå­åº”ç”¨éƒ½æ˜¯é€šè¿‡create-react-appç­‰è„šæ‰‹æ¶åˆ›å»ºçš„reacté¡¹ç›®ï¼Œvueé¡¹ç›®ä¸­å¹¶ä¸å¸¸è§ã€‚
è§£å†³æ–¹å¼ï¼šä¿®æ”¹å­åº”ç”¨çš„webpacké…ç½® // webpack.config.js
module.exports = { output: { ... jsonpFunction: \`webpackJsonp_è‡ªå®šä¹‰åç§°\`, globalObject: 'window', },
} // webpack.config.js
module.exports = { output: { ... chunkLoadingGlobal: 'webpackJsonp_è‡ªå®šä¹‰åç§°', globalObject: 'window', },
}`},{header:"3ã€è®¾ç½® publicPath",slug:"_3ã€è®¾ç½®-publicpath",content:`å¦‚æœå­åº”ç”¨å‡ºç°é™æ€èµ„æºåœ°å€404(jsã€cssã€å›¾ç‰‡)ï¼Œå»ºè®®è®¾ç½®publicPathæ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
publicPathæ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è¡¥å…¨é™æ€èµ„æºçš„åœ°å€ï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ publicPath
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.tsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.ts
// entry
import './public-path'`},{header:"4ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",slug:"_4ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",content:`MicroAppæœ‰ä¸¤ç§æ²™ç®±æ–¹æ¡ˆï¼šwithæ²™ç®±å’Œiframeæ²™ç®±ã€‚
é»˜è®¤å¼€å¯withæ²™ç®±ï¼Œå¦‚æœwithæ²™ç®±æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å°è¯•åˆ‡æ¢åˆ°iframeæ²™ç®±ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€é€šè¿‡micro-appæ•°æ®é€šä¿¡ä¿®æ”¹angularç»„ä»¶æ•°æ®åè§†å›¾ä¸æ›´æ–°",slug:"_1ã€é€šè¿‡micro-appæ•°æ®é€šä¿¡ä¿®æ”¹angularç»„ä»¶æ•°æ®åè§†å›¾ä¸æ›´æ–°",content:`åŸå› ï¼š å› ä¸ºåœ¨angularåŒºåŸŸå¤–è°ƒç”¨äº†å†…éƒ¨çš„ä»£ç (ä¸»åº”ç”¨å’Œå­åº”ç”¨å±äºä¸åŒçš„angularåŒºåŸŸ)ï¼Œangularæ— æ³•çŸ¥é“çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ã€‚
è§£å†³æ–¹å¼ï¼š é€šè¿‡ngZone.run()è§¦å‘æ›´æ”¹æ£€æµ‹ï¼Œå…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š`},{header:"2ã€ä¸»åº”ç”¨æ˜¯reactã€nextjsåº”ç”¨ï¼Œå¼•å…¥zone.jsåå¯¼è‡´micro-appå…ƒç´ ç”Ÿå‘½å‘¨æœŸå¼‚å¸¸",slug:"_2ã€ä¸»åº”ç”¨æ˜¯reactã€nextjsåº”ç”¨-å¼•å…¥zone-jsåå¯¼è‡´micro-appå…ƒç´ ç”Ÿå‘½å‘¨æœŸå¼‚å¸¸",content:"ç›®å‰æ— æ³•è§£å†³ï¼Œè¯·æš‚åœä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚"}]},{path:"/zh/framework/introduce.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:`ä¸Šé¢çš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬ä»åŠŸèƒ½çš„è§’åº¦ä»‹ç»å¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œè¿™å¯¼è‡´æ•´ä½“çš„é€»è¾‘ä¸è¿è´¯ã€‚
åœ¨æ‰‹æŠŠæ‰‹ç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬ä¼šä¾§é‡äºå‰ç«¯æ¡†æ¶æœ¬èº«ï¼Œè¯¦ç»†ä»‹ç»å®ƒä»¬ä½œä¸ºä¸»åº”ç”¨å’Œå­åº”ç”¨å¦‚ä½•æ¥å…¥å¾®å‰ç«¯ã€‚
æˆ‘ä»¬åˆ—ä¸¾æ¯”è¾ƒæµè¡Œçš„å‰ç«¯æ¡†æ¶ï¼ŒæŒ‡å‡ºå„æ¡†æ¶çš„æ³¨æ„äº‹é¡¹ï¼Œè§„é¿å„ç§å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚
ç›®å‰æœ‰ï¼š react
vue
vite
angular
nextjs
nuxtjs æç¤º
ä»¥ä¸Šæ¡†æ¶å¯ä»¥ä»»æ„ç»„åˆï¼Œæ¢å¥è¯è¯´ä»»ä½•ä¸€ä¸ªæ¡†æ¶éƒ½å¯ä»¥ä½œä¸ºä¸»åº”ç”¨åµŒå…¥å…¶å®ƒç±»å‹çš„å­åº”ç”¨ï¼Œä»»ä½•ä¸€ä¸ªæ¡†æ¶ä¹Ÿå¯ä»¥ä½œä¸ºå­åº”ç”¨è¢«å…¶å®ƒæ¡†æ¶åµŒå…¥ï¼ŒåŒ…æ‹¬ä¸Šé¢æ²¡æœ‰åˆ—ä¸¾å‡ºçš„å…¶å®ƒåº“ï¼Œå¦‚ svelteã€umi ...
æˆ‘ä»¬åªåˆ—ä¸¾äº†éƒ¨åˆ†æ¡†æ¶ï¼Œå¦‚æœæœ‰å…¶å®ƒæ¡†æ¶éœ€æ±‚ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚`}]},{path:"/zh/framework/nextjs.html",title:"Nextjs",pathLocale:"/",contents:[{header:"Nextjs",slug:"nextjs",content:"æœ¬ç¯‡ä»¥nextjs 11ä½œä¸ºæ¡ˆä¾‹ä»‹ç»nextjsçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬nextjsæ¥å…¥æ–¹å¼ä¼šåœ¨åç»­è¡¥å……ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºä¸»åº”ç”¨",slug:"ä½œä¸ºä¸»åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åˆå§‹åŒ–micro-app",slug:"_2ã€åˆå§‹åŒ–micro-app",content:`å› ä¸ºwebComponentåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨pages/_app.jsxçš„useEffectä¸­è¿›è¡Œåˆå§‹åŒ–ã€‚
// pages/_app.jsx
import { useEffect } from 'react'
import microApp from '@micro-zoe/micro-app' function MyApp({ Component, pageProps }) { useEffect(() => { // åˆå§‹åŒ–micro-app microApp.start() }, []) return <Component {...pageProps} />
} export default MyApp`},{header:"3ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_3ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:`å› ä¸ºmicro-appåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥åœ¨useEffectä¸­é€šè¿‡å˜é‡æ§åˆ¶å­åº”ç”¨æ˜¾ç¤ºã€‚
// pages/my-page.js
import { useState, useEffect } from 'react' const MyPage = () => { const [show, changeShow] = useState(false) useEffect(() => { changeShow(true) }, []) return ( <div> <h1>å­åº”ç”¨</h1> { // nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ show && (<micro-app name='my-app' url='http://localhost:3000/'></micro-app>) } </div> )
} export default MyPage
Note nameï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦ç‰¹æ®Šç¬¦å·(ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿é™¤å¤–)
urlï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»æŒ‡å‘å­åº”ç”¨çš„index.htmlï¼Œå¦‚ï¼šhttp://localhost:3000/ æˆ– http://localhost:3000/index.html`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€åœ¨ä¸»åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",slug:"_1ã€åœ¨ä¸»åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",content:`å½“å­åº”ç”¨æ˜¯ssråº”ç”¨æ—¶ï¼Œä¸»åº”ç”¨éœ€è¦åœ¨micro-appå…ƒç´ ä¸Šæ·»åŠ ssrå±æ€§ï¼Œæ­¤æ—¶micro-appä¼šæ ¹æ®ssræ¨¡å¼åŠ è½½å­åº”ç”¨ã€‚
<micro-app name='xx' url='xx' ssr></micro-app>`},{header:"2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`é€šè¿‡è‡ªå®šä¹‰æœåŠ¡è®¾ç½®è·¨åŸŸè®¿é—®ï¼Œè¯¦æƒ…å‚è€ƒ custom-server
æ­¥éª¤1ã€åœ¨æ ¹ç›®å½•åˆ›å»ºserver.js
server.jsçš„å†…å®¹å¦‚ä¸‹ï¼š
// server.js
const express = require('express')
const next = require('next')
const config = require('./next.config') const port = parseInt(process.env.PORT, 10) || 3000
const dev = process.env.NODE_ENV !== 'production'
const app = next({ dev })
const handle = app.getRequestHandler() app.prepare().then(() => { const server = express() // è®¾ç½®è·¨åŸŸæ”¯æŒ server.all('*', (req, res) => { res.setHeader('access-control-allow-origin', '*') return handle(req, res) }) server.listen(port, (err) => { if (err) throw err console.log(\`> Ready on http://localhost:\${port}/\`) })
})
æ­¥éª¤2ã€ä¿®æ”¹package.jsonä¸­çš„scriptsï¼Œå¦‚ä¸‹ï¼š
"scripts": { "dev": "node server.js", "build": "next build", "start": "cross-env NODE_ENV=production node server.js"
}`},{header:"3ã€è®¾ç½®assetPrefix å’Œ publicRuntimeConfig",slug:"_3ã€è®¾ç½®assetprefix-å’Œ-publicruntimeconfig",content:`åœ¨next.config.jsä¸­è®¾ç½®assetPrefixï¼Œä¸ºé™æ€èµ„æºæ·»åŠ è·¯å¾„å‰ç¼€ï¼Œé¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µã€‚
// next.config.js
const basePath = 'åŸºç¡€è·¯ç”±' // é»˜è®¤ä¸º '/'
// é™æ€èµ„æºè·¯å¾„å‰ç¼€
const assetPrefix = process.env.NODE_ENV === 'production' ? \`çº¿ä¸ŠåŸŸå\${basePath}\` : \`http://localhost:\${process.env.PORT || 3000}\${basePath}\` module.exports = { basePath, assetPrefix, // æ·»åŠ  assetPrefix åœ°å€åˆ° publicRuntimeConfig publicRuntimeConfig: { assetPrefix, },
}
assetPrefixåªå¯¹jsã€cssç­‰é™æ€èµ„æºç”Ÿæ•ˆï¼Œå¯¹æœ¬åœ°å›¾ç‰‡æ— æ•ˆã€‚
ä¸ºæ­¤æˆ‘ä»¬å°†assetPrefixä½œä¸ºå‚æ•°ä¼ å…¥publicRuntimeConfigï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨é€šè¿‡publicRuntimeConfigè¡¥å…¨å›¾ç‰‡åœ°å€ã€‚
æ–¹å¼å¦‚ä¸‹ï¼š
import getConfig from 'next/config'
const { publicRuntimeConfig } = getConfig() const Page = () => { return ( <div> <img src={\`\${publicRuntimeConfig.assetPrefix}/local-img.png\`} /> </div> )
} export default Page`},{header:"4ã€ç›‘å¬å¸è½½",slug:"_4ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ
})
Note
nextjsé»˜è®¤æ”¯æŒcss moduleåŠŸèƒ½ï¼Œå¦‚æœä½ ä½¿ç”¨äº†æ­¤åŠŸèƒ½ï¼Œå»ºè®®å…³é—­æ ·å¼éš”ç¦»ä»¥æå‡æ€§èƒ½ï¼š<micro-app name='xx' url='xx' disableScopecss></micro-app>`},{header:"5ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",slug:"_5ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",content:`MicroAppæœ‰ä¸¤ç§æ²™ç®±æ–¹æ¡ˆï¼šwithæ²™ç®±å’Œiframeæ²™ç®±ã€‚
é»˜è®¤å¼€å¯withæ²™ç®±ï¼Œå¦‚æœwithæ²™ç®±æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å°è¯•åˆ‡æ¢åˆ°iframeæ²™ç®±ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€ä½¿ç”¨next/imageç»„ä»¶åŠ è½½å›¾ç‰‡å¤±è´¥",slug:"_1ã€ä½¿ç”¨next-imageç»„ä»¶åŠ è½½å›¾ç‰‡å¤±è´¥",content:`è§£å†³æ–¹å¼ï¼š
åœ¨éƒ¨åˆ†nextjsç‰ˆæœ¬ä¸­(å¦‚ï¼šnextjs 11)ï¼Œä½¿ç”¨next/imageç»„ä»¶æ— æ³•æ­£ç¡®å¼•å…¥å›¾ç‰‡ï¼Œæ­¤æ—¶æ¨èä½¿ç”¨imgå…ƒç´ ä»£æ›¿ã€‚`},{header:"2ã€æ— æ³•é¢„åŠ è½½ssrå­åº”ç”¨",slug:"_2ã€æ— æ³•é¢„åŠ è½½ssrå­åº”ç”¨",content:"åŸå› ï¼š å› ä¸ºssråº”ç”¨æ¯ä¸ªè·¯ç”±åœ°å€åŠ è½½çš„htmlã€jsã€cssç­‰é™æ€èµ„æºéƒ½ä¸åŒï¼Œæ‰€ä»¥æ— æ³•å¯¹ssrå­åº”ç”¨ä½¿ç”¨é¢„åŠ è½½ã€‚"},{header:"3ã€æ§åˆ¶å°æŠ¥é”™Cannot read properties of null (reading 'tagName')",slug:"_3ã€æ§åˆ¶å°æŠ¥é”™cannot-read-properties-of-null-reading-tagname",content:`åŸå› ï¼š å½“ä¸»åº”ç”¨å’Œå­åº”ç”¨éƒ½æ˜¯nextjsåº”ç”¨æ—¶ï¼Œnext/headç»„ä»¶å†²çªã€‚
è§£å†³æ–¹å¼ï¼š å»æ‰å­åº”ç”¨ä¸­next/headç»„ä»¶ã€‚`},{header:"4ã€webpack.jsonpFunctionå†²çªï¼Œå¯¼è‡´åŠ è½½å­åº”ç”¨å¤±è´¥",slug:"_4ã€webpack-jsonpfunctionå†²çª-å¯¼è‡´åŠ è½½å­åº”ç”¨å¤±è´¥",content:`åŸå› ï¼š å½“ä¸»åº”ç”¨å’Œå­åº”ç”¨éƒ½æ˜¯å®˜æ–¹è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œå®¹æ˜“é€ æˆwebpack.jsonpFunctionå†²çªã€‚
è§£å†³æ–¹å¼ï¼š ä¿®æ”¹å­åº”ç”¨çš„webpacké…ç½®ã€‚
jsonpFunctionæ˜¯webpack4ä¸­çš„åç§°ï¼Œåœ¨webpack5ä¸­åç§°ä¸ºchunkLoadingGlobalï¼Œè¯·æ ¹æ®è‡ªå·±é¡¹ç›®çš„webpackç‰ˆæœ¬è®¾ç½®ã€‚
åœ¨next.config.jsä¸­é…ç½®webpackï¼š
// next.config.js
module.exports = { webpack: (config) => { Object.assign(config.output, { chunkLoadingGlobal: 'webpackJsonp_è‡ªå®šä¹‰åç§°', // webpack5 // jsonpFunction: 'webpackJsonp_è‡ªå®šä¹‰åç§°', // webpack4 globalObject: 'window', }) return config },
}
æç¤º
nextjsç›¸å…³é—®é¢˜å¯ä»¥åœ¨nextjsä¸“å±è®¨è®ºè´´ä¸‹åé¦ˆã€‚`}]},{path:"/zh/framework/nuxtjs.html",title:"Nuxtjs",pathLocale:"/",contents:[{header:"Nuxtjs",slug:"nuxtjs",content:"æœ¬ç¯‡ä»¥nuxtjs 2ä½œä¸ºæ¡ˆä¾‹ä»‹ç»nuxtjsçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬nuxtjsæ¥å…¥æ–¹å¼ä¼šåœ¨åç»­è¡¥å……ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºä¸»åº”ç”¨",slug:"ä½œä¸ºä¸»åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åˆå§‹åŒ–micro-app",slug:"_2ã€åˆå§‹åŒ–micro-app",content:`å› ä¸ºwebComponentåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨æµè§ˆå™¨ç¯å¢ƒæ‰§è¡Œmicro-appçš„åˆå§‹åŒ–ã€‚
å¦‚æœæ²¡æœ‰layoutsæ–‡ä»¶ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶layouts/default.vueï¼Œå¦‚æœå·²ç»æœ‰layoutsæ–‡ä»¶ï¼Œç›´æ¥å¤ç”¨å³å¯ï¼Œlayoutsç›¸å…³ä¿¡æ¯å‚è€ƒï¼šlayouts
// layouts/default.vue
<template> <Nuxt />
</template> <script>
import microApp from '@micro-zoe/micro-app' export default { name: 'default', mounted () { microApp.start() }
}
<\/script>`},{header:"3ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_3ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:`å› ä¸ºmicro-appåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥åœ¨mountedé’©å­ä¸­é€šè¿‡å˜é‡æ§åˆ¶å­åº”ç”¨æ˜¾ç¤ºã€‚
<template> <div> <h1>å­åº”ç”¨</h1> <!-- nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ --> <micro-app v-if='show' name='my-app' url='http://localhost:3000/'></micro-app> </div>
</template> <script>
export default { name: 'my-page', data () { return { show: false, } }, mounted () { this.show = true },
}
<\/script>`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€åœ¨ä¸»åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",slug:"_1ã€åœ¨ä¸»åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",content:`å½“å­åº”ç”¨æ˜¯ssråº”ç”¨æ—¶ï¼Œä¸»åº”ç”¨éœ€è¦åœ¨micro-appå…ƒç´ ä¸Šæ·»åŠ ssrå±æ€§ï¼Œæ­¤æ—¶micro-appä¼šæ ¹æ®ssræ¨¡å¼åŠ è½½å­åº”ç”¨ã€‚
<micro-app name='xx' url='xx' ssr></micro-app>`},{header:"2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`é€šè¿‡è‡ªå®šä¹‰æœåŠ¡è®¾ç½®è·¨åŸŸè®¿é—®ã€‚
æ­¥éª¤1ã€åœ¨æ ¹ç›®å½•åˆ›å»ºserver.js
server.jsçš„å†…å®¹å¦‚ä¸‹ï¼š
// server.js
const express = require('express')
const { Nuxt, Builder } = require('nuxt') const app = express() const host = process.env.HOST || '127.0.0.1'
const port = process.env.PORT || 3000 // Import and set Nuxt options
const config = require('./nuxt.config.js')
config.dev = process.env.NODE_ENV !== 'production' const nuxt = new Nuxt(config) // Start build process in dev mode
if (config.dev) { const builder = new Builder(nuxt) builder.build()
} // è®¾ç½®è·¨åŸŸæ”¯æŒ
app.all('*', (req, res, next) => { res.header("Access-Control-Allow-Origin", '*') next()
}) // Give nuxt middleware to express
app.use(nuxt.render) // Start express server
app.listen(port, host, () => { console.log(\`Ready on http://localhost:\${port}/\`)
})
æ­¥éª¤2ã€ä¿®æ”¹package.jsonä¸­çš„scriptsï¼Œå¦‚ä¸‹ï¼š
"scripts": { "dev": "node server.js", "build": "nuxt build", "start": "cross-env NODE_ENV=production node server.js",
}`},{header:"3ã€é€šè¿‡envæ³¨å…¥è¿è¡Œæ—¶å˜é‡assetPrefix",slug:"_3ã€é€šè¿‡envæ³¨å…¥è¿è¡Œæ—¶å˜é‡assetprefix",content:`assetPrefixä¸ºé™æ€èµ„æºè·¯å¾„å‰ç¼€ï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨é€šè¿‡assetPrefixè¡¥å…¨å›¾ç‰‡åœ°å€ï¼Œé¿å…å­åº”ç”¨çš„å›¾ç‰‡åœ¨ä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µã€‚
// nuxt.config.js
const basePath = 'åŸºç¡€è·¯ç”±' // é»˜è®¤ä¸º '/'
// é™æ€èµ„æºè·¯å¾„å‰ç¼€
const assetPrefix = process.env.NODE_ENV === 'production' ? \`çº¿ä¸ŠåŸŸå\${basePath}\` : \`http://localhost:\${process.env.PORT || 3000}\${basePath}\` module.exports = { // å°† assetPrefix å†™å…¥ç¯å¢ƒå˜é‡ï¼Œé€šè¿‡ process.env.assetPrefix è®¿é—® env: { assetPrefix, }, // è®¾ç½®åŸºç¡€è·¯ç”± router: { base: basePath, },
}
ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
<template> <div> <img :src="localImg" /> </div>
</template> <script>
import Vue from 'vue' export default Vue.extend({ data () { return { // è¡¥å…¨å›¾ç‰‡åœ°å€ localImg: process.env.assetPrefix + '/local-img.png', } }
})
<\/script>`},{header:"4ã€ç›‘å¬å¸è½½",slug:"_4ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ
})`},{header:"5ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",slug:"_5ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",content:`MicroAppæœ‰ä¸¤ç§æ²™ç®±æ–¹æ¡ˆï¼šwithæ²™ç®±å’Œiframeæ²™ç®±ã€‚
é»˜è®¤å¼€å¯withæ²™ç®±ï¼Œå¦‚æœwithæ²™ç®±æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å°è¯•åˆ‡æ¢åˆ°iframeæ²™ç®±ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€æ§åˆ¶å°æŠ›å‡ºè­¦å‘Š[Vue warn]: Unknown custom element: <micro-app>",slug:"_1ã€æ§åˆ¶å°æŠ›å‡ºè­¦å‘Š-vue-warn-unknown-custom-element-micro-app",content:`è§£å†³æ–¹å¼ï¼š åœ¨nuxt.config.jsä¸­æ·»åŠ é…ç½®ï¼Œè®¾ç½®ignoredElementså¿½ç•¥micro-appå…ƒç´ ã€‚
// nuxt.config.js
module.exports = { vue: { config: { ignoredElements: [ 'micro-app', ], } },
}
æç¤º
nuxtjsç›¸å…³é—®é¢˜å¯ä»¥åœ¨nuxtjsä¸“å±è®¨è®ºè´´ä¸‹åé¦ˆã€‚`},{header:"2ã€æ— æ³•é¢„åŠ è½½ssrå­åº”ç”¨",slug:"_2ã€æ— æ³•é¢„åŠ è½½ssrå­åº”ç”¨",content:"åŸå› ï¼š å› ä¸ºssråº”ç”¨æ¯ä¸ªè·¯ç”±åœ°å€åŠ è½½çš„htmlã€jsã€cssç­‰é™æ€èµ„æºéƒ½ä¸åŒï¼Œæ‰€ä»¥æ— æ³•å¯¹ssrå­åº”ç”¨ä½¿ç”¨é¢„åŠ è½½ã€‚"}]},{path:"/zh/framework/react.html",title:"React",pathLocale:"/",contents:[{header:"React",slug:"react",content:"æœ¬ç¯‡ä»¥React 16ã€17ä½œä¸ºæ¡ˆä¾‹ä»‹ç»reactçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬reactçš„æ¥å…¥æ–¹å¼ä»¥æ­¤ç±»æ¨ã€‚æˆ‘ä»¬é»˜è®¤å¼€å‘è€…æŒæ¡äº†å„ç‰ˆæœ¬reactçš„å¼€å‘æŠ€å·§ï¼Œå¦‚ç¤ºä¾‹ä¸­useEffectï¼Œåœ¨ä¸æ”¯æŒhooksçš„ç‰ˆæœ¬ä¸­è½¬æ¢ä¸ºcomponentDidMountã€‚"},{header:"ä½œä¸ºä¸»åº”ç”¨",slug:"ä½œä¸ºä¸»åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åˆå§‹åŒ–micro-app",slug:"_2ã€åˆå§‹åŒ–micro-app",content:`// index.js
import microApp from '@micro-zoe/micro-app' microApp.start()`},{header:"3ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_3ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:`export function MyPage () { return ( <div> <h1>å­åº”ç”¨ğŸ‘‡</h1> // nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ <micro-app name='my-app' url='http://localhost:3000/'></micro-app> </div> )
}
Note nameï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦ç‰¹æ®Šç¬¦å·(ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿é™¤å¤–)
urlï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»æŒ‡å‘å­åº”ç”¨çš„index.htmlï¼Œå¦‚ï¼šhttp://localhost:3000/ æˆ– http://localhost:3000/index.html`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`ä½¿ç”¨create-react-appè„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œåœ¨ config/webpackDevServer.config.js æ–‡ä»¶ä¸­æ·»åŠ headersã€‚
å…¶å®ƒé¡¹ç›®åœ¨webpack-dev-serverä¸­æ·»åŠ headersã€‚
headers: { 'Access-Control-Allow-Origin': '*',
}`},{header:"2ã€æ³¨å†Œå¸è½½å‡½æ•°",slug:"_2ã€æ³¨å†Œå¸è½½å‡½æ•°",content:`å­åº”ç”¨å¸è½½æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œwindow.unmountï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// index.js
window.unmount = () => { ReactDOM.unmountComponentAtNode(document.getElementById('root'))
}
å®Œæˆä»¥ä¸Šæ­¥éª¤å¾®å‰ç«¯å³å¯æ­£å¸¸æ¸²æŸ“ã€‚`},{header:"å¯é€‰è®¾ç½®",slug:"å¯é€‰è®¾ç½®",content:"ä»¥ä¸‹é…ç½®æ˜¯é’ˆå¯¹å­åº”ç”¨çš„ï¼Œå®ƒä»¬æ˜¯å¯é€‰çš„ï¼Œå»ºè®®æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©è®¾ç½®ã€‚"},{header:"1ã€å¼€å¯umdæ¨¡å¼ï¼Œä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½",slug:"_1ã€å¼€å¯umdæ¨¡å¼-ä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½",content:`MicroAppæ”¯æŒä¸¤ç§æ¸²æŸ“å¾®å‰ç«¯çš„æ¨¡å¼ï¼Œé»˜è®¤æ¨¡å¼å’Œumdæ¨¡å¼ã€‚ é»˜è®¤æ¨¡å¼ï¼š å­åº”ç”¨åœ¨åˆæ¬¡æ¸²æŸ“å’Œåç»­æ¸²æŸ“æ—¶ä¼šé¡ºåºæ‰§è¡Œæ‰€æœ‰jsï¼Œä»¥ä¿è¯å¤šæ¬¡æ¸²æŸ“çš„ä¸€è‡´æ€§ã€‚
umdæ¨¡å¼ï¼š å­åº”ç”¨æš´éœ²å‡ºmountã€unmountæ–¹æ³•ï¼Œæ­¤æ—¶åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œæ‰€æœ‰jsï¼Œåç»­æ¸²æŸ“åªä¼šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨å¤šæ¬¡æ¸²æŸ“æ—¶å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œå†…å­˜è¡¨ç°ã€‚ å¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½ä¸é¢‘ç¹ï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤æ¨¡å¼å³å¯ï¼Œå¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½éå¸¸é¢‘ç¹å»ºè®®ä½¿ç”¨umdæ¨¡å¼ã€‚
// index.js
import React from "react"
import ReactDOM from "react-dom"
import App from './App' // ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•°ï¼Œå­åº”ç”¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ
window.mount = () => { ReactDOM.render(<App />, document.getElementById("root"))
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•°ï¼Œå°±æ˜¯ä¸Šé¢æ­¥éª¤2ä¸­çš„å¸è½½å‡½æ•°
window.unmount = () => { ReactDOM.unmountComponentAtNode(document.getElementById("root"))
} // å¦‚æœä¸åœ¨å¾®å‰ç«¯ç¯å¢ƒï¼Œåˆ™ç›´æ¥æ‰§è¡Œmountæ¸²æŸ“
if (!window.__MICRO_APP_ENVIRONMENT__) { window.mount()
}`},{header:"2ã€è®¾ç½® webpack.jsonpFunction",slug:"_2ã€è®¾ç½®-webpack-jsonpfunction",content:`å¦‚æœå¾®å‰ç«¯æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å¿½ç•¥è¿™ä¸€æ­¥ã€‚
å¦‚æœå­åº”ç”¨èµ„æºåŠ è½½æ··ä¹±å¯¼è‡´æ¸²æŸ“å¤±è´¥ï¼Œå¯ä»¥å°è¯•è®¾ç½®jsonpFunctionæ¥è§£å†³ï¼Œå› ä¸ºç›¸åŒçš„jsonpFunctionåç§°ä¼šå¯¼è‡´èµ„æºæ±¡æŸ“ã€‚
è¿™ç§æƒ…å†µå¸¸è§äºä¸»åº”ç”¨å’Œå­åº”ç”¨éƒ½æ˜¯é€šè¿‡create-react-appç­‰è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ã€‚
è§£å†³æ–¹å¼ï¼šä¿®æ”¹å­åº”ç”¨çš„webpacké…ç½® // webpack.config.js
module.exports = { output: { ... jsonpFunction: \`webpackJsonp_è‡ªå®šä¹‰åç§°\`, globalObject: 'window', },
} // webpack.config.js
module.exports = { output: { ... chunkLoadingGlobal: 'webpackJsonp_è‡ªå®šä¹‰åç§°', globalObject: 'window', },
}`},{header:"3ã€è®¾ç½® publicPath",slug:"_3ã€è®¾ç½®-publicpath",content:`å¦‚æœå­åº”ç”¨å‡ºç°é™æ€èµ„æºåœ°å€404(jsã€cssã€å›¾ç‰‡)ï¼Œå»ºè®®è®¾ç½®publicPathæ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
publicPathæ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è¡¥å…¨é™æ€èµ„æºçš„åœ°å€ï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ publicPath
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"4ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",slug:"_4ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",content:`MicroAppæœ‰ä¸¤ç§æ²™ç®±æ–¹æ¡ˆï¼šwithæ²™ç®±å’Œiframeæ²™ç®±ã€‚
é»˜è®¤å¼€å¯withæ²™ç®±ï¼Œå¦‚æœwithæ²™ç®±æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å°è¯•åˆ‡æ¢åˆ°iframeæ²™ç®±ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:"æ— "}]},{path:"/zh/framework/vite.html",title:"Vite",pathLocale:"/",contents:[{header:"Vite",slug:"vite",content:"æœ¬ç¯‡ä»‹ç»äº†viteçš„æ¥å…¥æ–¹å¼ï¼Œå¦‚æœåœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šè”ç³»æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºä¸»åº”ç”¨",slug:"ä½œä¸ºä¸»åº”ç”¨",content:"viteä½œä¸ºä¸»åº”ç”¨æ—¶æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„ï¼Œå…·ä½“æ–¹å¼å‚è€ƒå„æ¡†æ¶æ¥å…¥æ–‡æ¡£ã€‚"},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:"viteä½œä¸ºå­åº”ç”¨åªéœ€åˆ‡æ¢åˆ°iframeæ²™ç®±ï¼Œå…¶å®ƒæ“ä½œå‚è€ƒå„æ¡†æ¶æ¥å…¥æ–‡æ¡£ã€‚"},{header:"åˆ‡æ¢åˆ°iframeæ²™ç®±",slug:"åˆ‡æ¢åˆ°iframeæ²™ç®±",content:"<micro-app name='xxx' url='xxx' iframe></micro-app>"},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€å­åº”ç”¨ä¸­æ“ä½œlocationå¼‚å¸¸",slug:"_1ã€å­åº”ç”¨ä¸­æ“ä½œlocationå¼‚å¸¸",content:`åŸå› ï¼š viteæ„å»ºscriptçš„typeä¸ºmoduleï¼Œå¯¼è‡´æ— æ³•æ‹¦æˆªlocationæ“ä½œã€‚
è§£å†³æ–¹å¼ï¼š ä½¿ç”¨MicroAppæä¾›çš„locationè¿›è¡Œæ“ä½œ
å¦‚ï¼š
window.microApp.location.host
window.microApp.location.origin
window.microApp.location.href = 'xxx'
window.microApp.location.pathname = 'xxx'`}]},{path:"/zh/framework/vue.html",title:"Vue",pathLocale:"/",contents:[{header:"Vue",slug:"vue",content:"æœ¬ç¯‡ä»¥Vue 2ã€3ä½œä¸ºæ¡ˆä¾‹ä»‹ç»vueçš„æ¥å…¥æ–¹å¼ã€‚"},{header:"ä½œä¸ºä¸»åº”ç”¨",slug:"ä½œä¸ºä¸»åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åˆå§‹åŒ–micro-app",slug:"_2ã€åˆå§‹åŒ–micro-app",content:`// main.js
import microApp from '@micro-zoe/micro-app' microApp.start()`},{header:"3ã€åµŒå…¥å­åº”ç”¨",slug:"_3ã€åµŒå…¥å­åº”ç”¨",content:`<template> <div> <h1>å­åº”ç”¨ğŸ‘‡</h1> <!-- nameï¼šåº”ç”¨åç§°, urlï¼šåº”ç”¨åœ°å€ --> <micro-app name='my-app' url='http://localhost:3000/'></micro-app> </div>
</template>
Note nameï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œä¸”ä¸å¯ä»¥å¸¦ç‰¹æ®Šç¬¦å·(ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿é™¤å¤–)
urlï¼šå¿…ä¼ å‚æ•°ï¼Œå¿…é¡»æŒ‡å‘å­åº”ç”¨çš„index.htmlï¼Œå¦‚ï¼šhttp://localhost:3000/ æˆ– http://localhost:3000/index.html`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`module.exports = { devServer: { headers: { 'Access-Control-Allow-Origin': '*', } }
} viteé»˜è®¤å¼€å¯è·¨åŸŸæ”¯æŒï¼Œä¸éœ€è¦é¢å¤–é…ç½®ã€‚`},{header:"2ã€æ³¨å†Œå¸è½½å‡½æ•°",slug:"_2ã€æ³¨å†Œå¸è½½å‡½æ•°",content:`å­åº”ç”¨å¸è½½æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œwindow.unmountï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚ // main.js
const app = new Vue(...) // å¸è½½åº”ç”¨
window.unmount = () => { app.$destroy()
} // main.js
const app = createApp(App)
app.mount('#app') // å¸è½½åº”ç”¨
window.unmount = () => { app.unmount()
} å®Œæˆä»¥ä¸Šæ­¥éª¤å¾®å‰ç«¯å³å¯æ­£å¸¸æ¸²æŸ“ã€‚`},{header:"å¯é€‰è®¾ç½®",slug:"å¯é€‰è®¾ç½®",content:"ä»¥ä¸‹é…ç½®æ˜¯é’ˆå¯¹å­åº”ç”¨çš„ï¼Œå®ƒä»¬æ˜¯å¯é€‰çš„ï¼Œå»ºè®®æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©è®¾ç½®ã€‚"},{header:"1ã€å¼€å¯umdæ¨¡å¼ï¼Œä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½",slug:"_1ã€å¼€å¯umdæ¨¡å¼-ä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½",content:`MicroAppæ”¯æŒä¸¤ç§æ¸²æŸ“å¾®å‰ç«¯çš„æ¨¡å¼ï¼Œé»˜è®¤æ¨¡å¼å’Œumdæ¨¡å¼ã€‚ é»˜è®¤æ¨¡å¼ï¼š å­åº”ç”¨åœ¨åˆæ¬¡æ¸²æŸ“å’Œåç»­æ¸²æŸ“æ—¶ä¼šé¡ºåºæ‰§è¡Œæ‰€æœ‰jsï¼Œä»¥ä¿è¯å¤šæ¬¡æ¸²æŸ“çš„ä¸€è‡´æ€§ã€‚
umdæ¨¡å¼ï¼š å­åº”ç”¨æš´éœ²å‡ºmountã€unmountæ–¹æ³•ï¼Œæ­¤æ—¶åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œæ‰€æœ‰jsï¼Œåç»­æ¸²æŸ“åªä¼šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨å¤šæ¬¡æ¸²æŸ“æ—¶å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œå†…å­˜è¡¨ç°ã€‚ å¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½ä¸é¢‘ç¹ï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤æ¨¡å¼å³å¯ï¼Œå¦‚æœå­åº”ç”¨æ¸²æŸ“å’Œå¸è½½éå¸¸é¢‘ç¹å»ºè®®ä½¿ç”¨umdæ¨¡å¼ã€‚ // main.js
import Vue from 'vue'
import router from './router'
import App from './App.vue' let app = null
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•°ï¼Œå­åº”ç”¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ
window.mount = () => { app = new Vue({ router, render: h => h(App), }).$mount('#app')
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•°ï¼Œå°±æ˜¯ä¸Šé¢æ­¥éª¤2ä¸­çš„å¸è½½å‡½æ•°
window.unmount = () => { app.$destroy() app.$el.innerHTML = '' app = null
} // å¦‚æœä¸åœ¨å¾®å‰ç«¯ç¯å¢ƒï¼Œåˆ™ç›´æ¥æ‰§è¡Œmountæ¸²æŸ“
if (!window.__MICRO_APP_ENVIRONMENT__) { window.mount()
} // main.js
import { createApp } from 'vue'
import * as VueRouter from 'vue-router'
import routes from './router'
import App from './App.vue' let app = null
let router = null
let history = null
// ğŸ‘‡ å°†æ¸²æŸ“æ“ä½œæ”¾å…¥ mount å‡½æ•°ï¼Œå­åº”ç”¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ
window.mount = () => { history = VueRouter.createWebHistory() router = VueRouter.createRouter({ history, routes, }) app = createApp(App) app.use(router) app.mount('#app')
} // ğŸ‘‡ å°†å¸è½½æ“ä½œæ”¾å…¥ unmount å‡½æ•°ï¼Œå°±æ˜¯ä¸Šé¢æ­¥éª¤2ä¸­çš„å¸è½½å‡½æ•°
window.unmount = () => { app.unmount() history.destroy() app = null router = null history = null
} // å¦‚æœä¸åœ¨å¾®å‰ç«¯ç¯å¢ƒï¼Œåˆ™ç›´æ¥æ‰§è¡Œmountæ¸²æŸ“
if (!window.__MICRO_APP_ENVIRONMENT__) { window.mount()
}`},{header:"2ã€è®¾ç½® webpack.jsonpFunction",slug:"_2ã€è®¾ç½®-webpack-jsonpfunction",content:`å¦‚æœå¾®å‰ç«¯æ­£å¸¸è¿è¡Œï¼Œåˆ™å¯ä»¥å¿½ç•¥è¿™ä¸€æ­¥ã€‚
å¦‚æœå­åº”ç”¨èµ„æºåŠ è½½æ··ä¹±å¯¼è‡´æ¸²æŸ“å¤±è´¥ï¼Œå¯ä»¥å°è¯•è®¾ç½®jsonpFunctionæ¥è§£å†³ï¼Œå› ä¸ºç›¸åŒçš„jsonpFunctionåç§°ä¼šå¯¼è‡´èµ„æºæ±¡æŸ“ã€‚
è¿™ç§æƒ…å†µå¸¸è§äºä¸»åº”ç”¨å’Œå­åº”ç”¨éƒ½æ˜¯é€šè¿‡create-react-appè„šæ‰‹æ¶åˆ›å»ºçš„reacté¡¹ç›®ï¼Œvueé¡¹ç›®ä¸­å¹¶ä¸å¸¸è§ã€‚
è§£å†³æ–¹å¼ï¼šä¿®æ”¹å­åº”ç”¨çš„webpacké…ç½® // vue.config.js
module.exports = { configureWebpack: { output: { jsonpFunction: \`webpackJsonp_è‡ªå®šä¹‰åç§°\`, globalObject: 'window', } },
} // webpack.config.js
module.exports = { output: { ... jsonpFunction: \`webpackJsonp_è‡ªå®šä¹‰åç§°\`, globalObject: 'window', },
} // webpack.config.js
module.exports = { output: { ... chunkLoadingGlobal: 'webpackJsonp_è‡ªå®šä¹‰åç§°', globalObject: 'window', },
}`},{header:"3ã€è®¾ç½® publicPath",slug:"_3ã€è®¾ç½®-publicpath",content:`å¦‚æœå­åº”ç”¨å‡ºç°é™æ€èµ„æºåœ°å€404(jsã€cssã€å›¾ç‰‡)ï¼Œå»ºè®®è®¾ç½®publicPathæ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
publicPathæ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è¡¥å…¨é™æ€èµ„æºçš„åœ°å€ï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ publicPath
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"4ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",slug:"_4ã€åˆ‡æ¢åˆ°iframeæ²™ç®±",content:`MicroAppæœ‰ä¸¤ç§æ²™ç®±æ–¹æ¡ˆï¼šwithæ²™ç®±å’Œiframeæ²™ç®±ã€‚
é»˜è®¤å¼€å¯withæ²™ç®±ï¼Œå¦‚æœwithæ²™ç®±æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥å°è¯•åˆ‡æ¢åˆ°iframeæ²™ç®±ã€‚`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€ä¸»åº”ç”¨ä¸­æŠ›å‡ºè­¦å‘Šï¼Œmicro-appæœªå®šä¹‰",slug:"_1ã€ä¸»åº”ç”¨ä¸­æŠ›å‡ºè­¦å‘Š-micro-appæœªå®šä¹‰",content:`æŠ¥é”™ä¿¡æ¯ï¼š vue2: [Vue warn]: Unknown custom element: <micro-app>
vue3: [Vue warn]: Failed to resolve component: micro-app å‚è€ƒissueï¼š vue-next@1414
è§£å†³æ–¹å¼ï¼š åœ¨ä¸»åº”ç”¨ä¸­æ·»åŠ å¦‚ä¸‹é…ç½® åœ¨å…¥å£æ–‡ä»¶main.jsä¸­è®¾ç½®ignoredElementsï¼Œè¯¦æƒ…æŸ¥çœ‹ï¼šhttps://cn.vuejs.org/v2/api/#ignoredElements
// main.js
import Vue from 'vue' Vue.config.ignoredElements = [ 'micro-app',
] åœ¨vue.config.jsä¸­æ·»åŠ chainWebpacké…ç½®ï¼Œå¦‚ä¸‹ï¼š
// vue.config.js
module.exports = { chainWebpack: config => { config.module .rule('vue') .use('vue-loader') .tap(options => { options.compilerOptions = { ...(options.compilerOptions || {}), isCustomElement: (tag) => /^micro-app/.test(tag), }; return options }) }
} åœ¨vite.config.jsä¸­é€šè¿‡vueæ’ä»¶è®¾ç½®isCustomElementï¼Œå¦‚ä¸‹ï¼š
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue' export default defineConfig({ plugins: [ vue({ template: { compilerOptions: { isCustomElement: tag => /^micro-app/.test(tag) } } }) ],
})`}]},{path:"/v0/zh/framework/angular.html",title:"Angular",pathLocale:"/",contents:[{header:"Angular",slug:"angular",content:"æœ¬ç¯‡ä»¥angular 11ä½œä¸ºæ¡ˆä¾‹ä»‹ç»angularçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬angularæ¥å…¥æ–¹å¼ä¼šåœ¨åç»­è¡¥å……ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºåŸºåº§åº”ç”¨",slug:"ä½œä¸ºåŸºåº§åº”ç”¨",content:`æˆ‘ä»¬å¼ºçƒˆå»ºè®®åŸºåº§åº”ç”¨é‡‡ç”¨historyæ¨¡å¼ï¼Œhashè·¯ç”±çš„åŸºåº§åº”ç”¨åªèƒ½åŠ è½½hashè·¯ç”±çš„å­åº”ç”¨ï¼Œhistoryæ¨¡å¼çš„åŸºåº§åº”ç”¨å¯¹è¿™ä¸¤ç§å­åº”ç”¨éƒ½æ”¯æŒã€‚
åœ¨ä»¥ä¸‹æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬é»˜è®¤åŸºåº§çš„è·¯ç”±ä¸ºhistoryæ¨¡å¼ã€‚`},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åœ¨å…¥å£å¤„å¼•å…¥",slug:"_2ã€åœ¨å…¥å£å¤„å¼•å…¥",content:`// entry
import microApp from '@micro-zoe/micro-app' microApp.start()`},{header:"3ã€å¢åŠ å¯¹WebComponentçš„æ”¯æŒ",slug:"_3ã€å¢åŠ å¯¹webcomponentçš„æ”¯æŒ",content:`åœ¨app/app.module.tsä¸­æ·»åŠ  CUSTOM_ELEMENTS_SCHEMA åˆ° @NgModule.schemas
// app/app.module.ts
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core'; @NgModule({ schemas: [CUSTOM_ELEMENTS_SCHEMA],
})`},{header:"4ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨",slug:"_4ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨",content:`// app/app-routing.module.ts
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { MyPage } from './my-page/my-page.component'; const routes: Routes = [ { // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢ path: 'my-page', children: [{ path: '**', component: MyPage }] },
]; @NgModule({ imports: [RouterModule.forRoot(routes)], exports: [RouterModule],
}) export class AppRoutingModule { }`},{header:"4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:"<!-- app/my-page/my-page.component.html -->\n<div> <h1>å­åº”ç”¨</h1> <!-- name(å¿…ä¼ )ï¼šåº”ç”¨åç§° url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ `/my-page` --> <micro-app name='app1' url='http://localhost:3000/' baseroute='/my-page'></micro-app>\n</div>"},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€åœ¨åŸºåº§åº”ç”¨ä¸­å¼•å…¥zone.js",slug:"_1ã€åœ¨åŸºåº§åº”ç”¨ä¸­å¼•å…¥zone-js",content:`å¦‚æœåŸºåº§åº”ç”¨éangularï¼Œé‚£ä¹ˆåŸºåº§åº”ç”¨éœ€è¦å¼•å…¥zone.jsæ‰èƒ½æ­£ç¡®åŠ è½½angularå­åº”ç”¨ã€‚
æ­¥éª¤1ã€å®‰è£…ä¾èµ–
npm i zone.js --save
æ­¥éª¤2ã€åœ¨åŸºåº§åº”ç”¨ä¸­å¼•å…¥zone.js
import 'zone.js'`},{header:"2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`angularå®˜æ–¹è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®åœ¨å¼€å‘ç¯å¢ƒä¸‹é»˜è®¤æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œä¸éœ€è¦ç‰¹æ®Šå¤„ç†ã€‚
å…¶å®ƒé¡¹ç›®åœ¨webpack-dev-serverä¸­æ·»åŠ headersã€‚
headers: { 'Access-Control-Allow-Origin': '*',
}`},{header:"3ã€å…³é—­çƒ­æ›´æ–°",slug:"_3ã€å…³é—­çƒ­æ›´æ–°",content:`"scripts": { "start": "ng serve --live-reload false",
},`},{header:"4ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)",slug:"_4ã€è®¾ç½®åŸºç¡€è·¯ç”±-å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±-å­åº”ç”¨æ˜¯hashè·¯ç”±-è¿™ä¸€æ­¥å¯ä»¥çœç•¥",content:`// app/app-routing.module.ts
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { APP_BASE_HREF } from '@angular/common'; const routes: Routes = [...]; @NgModule({ imports: [RouterModule.forRoot(routes)], exports: [RouterModule], // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”± providers: [{ provide: APP_BASE_HREF, // @ts-ignore __MICRO_APP_BASE_ROUTE__ ä¸ºmicro-appä¼ å…¥çš„åŸºç¡€è·¯ç”± useValue: window.__MICRO_APP_BASE_ROUTE__ || '/', }]
}) export class AppRoutingModule { }`},{header:"5ã€è®¾ç½® publicPath",slug:"_5ã€è®¾ç½®-publicpath",content:`è¿™ä¸€æ­¥å€ŸåŠ©äº†webpackçš„åŠŸèƒ½ï¼Œé¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ publicPath
å¦‚æœå­åº”ç”¨ä¸æ˜¯webpackæ„å»ºçš„ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥ã€‚
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"6ã€ç›‘å¬å¸è½½",slug:"_6ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// main.ts let app = null;
platformBrowserDynamic() .bootstrapModule(AppModule) .then((res: NgModuleRef<AppModule>) => { app = res }) // ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { app.destroy(); app = null;
})`},{header:"å®æˆ˜æ¡ˆä¾‹",slug:"å®æˆ˜æ¡ˆä¾‹",content:`ä»¥ä¸Šä»‹ç»äº†angularå¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºangularä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚
æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€åŸºåº§æ˜¯reactã€nextjsåº”ç”¨ï¼Œå¼•å…¥zone.jsåå¯¼è‡´micro-appå…ƒç´ ç”Ÿå‘½å‘¨æœŸå¼‚å¸¸",slug:"_1ã€åŸºåº§æ˜¯reactã€nextjsåº”ç”¨-å¼•å…¥zone-jsåå¯¼è‡´micro-appå…ƒç´ ç”Ÿå‘½å‘¨æœŸå¼‚å¸¸",content:"è§£å†³æ–¹å¼ï¼š åœ¨micro-appå…ƒç´ ä¸Šè®¾ç½®destroy"},{header:"2ã€@angular/materialç»„ä»¶åº“æ ·å¼å¤±æ•ˆ",slug:"_2ã€-angular-materialç»„ä»¶åº“æ ·å¼å¤±æ•ˆ",content:`è§£å†³æ–¹å¼ï¼š å…³é—­æ ·å¼éš”ç¦»
<micro-app name='xx' url='xx' disableScopecss></micro-app>`},{header:"3ã€é€šè¿‡micro-appæ•°æ®é€šä¿¡ä¿®æ”¹angularç»„ä»¶æ•°æ®åè§†å›¾ä¸æ›´æ–°",slug:"_3ã€é€šè¿‡micro-appæ•°æ®é€šä¿¡ä¿®æ”¹angularç»„ä»¶æ•°æ®åè§†å›¾ä¸æ›´æ–°",content:`åŸå› ï¼š å› ä¸ºåœ¨angularåŒºåŸŸå¤–è°ƒç”¨äº†å†…éƒ¨çš„ä»£ç (åŸºåº§å’Œå­åº”ç”¨å±äºä¸åŒçš„angularåŒºåŸŸ)ï¼Œangularæ— æ³•çŸ¥é“çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ã€‚
è§£å†³æ–¹å¼ï¼š é€šè¿‡ngZone.run()è§¦å‘æ›´æ”¹æ£€æµ‹ï¼Œå…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š`}]},{path:"/v0/zh/framework/introduce.html",title:"",pathLocale:"/",contents:[{header:"",slug:"",content:`ä¸Šé¢çš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬ä»åŠŸèƒ½çš„è§’åº¦ä»‹ç»å¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œè¿™å¯¼è‡´æ•´ä½“çš„é€»è¾‘ä¸è¿è´¯ã€‚
åœ¨æ‰‹æŠŠæ‰‹ç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬ä¼šä¾§é‡äºå‰ç«¯æ¡†æ¶æœ¬èº«ï¼Œè¯¦ç»†ä»‹ç»å®ƒä»¬ä½œä¸ºåŸºåº§åº”ç”¨å’Œå­åº”ç”¨å¦‚ä½•æ¥å…¥å¾®å‰ç«¯ã€‚
æˆ‘ä»¬åˆ—ä¸¾æ¯”è¾ƒæµè¡Œçš„å‰ç«¯æ¡†æ¶ï¼ŒæŒ‡å‡ºå„æ¡†æ¶çš„æ³¨æ„äº‹é¡¹ï¼Œè§„é¿å„ç§å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚
ç›®å‰æœ‰ï¼š react (version 16, 17)
vue (version 2, 3)
vite (version 2)
angular (version 11)
nextjs (version 11)
nuxtjs (version 2) æç¤º
ä»¥ä¸Šæ¡†æ¶å¯ä»¥ä»»æ„ç»„åˆï¼Œæ¢å¥è¯è¯´ä»»ä½•ä¸€ä¸ªæ¡†æ¶éƒ½å¯ä»¥ä½œä¸ºåŸºåº§åµŒå…¥å…¶å®ƒç±»å‹çš„å­åº”ç”¨ï¼Œä»»ä½•ä¸€ä¸ªæ¡†æ¶ä¹Ÿå¯ä»¥ä½œä¸ºå­åº”ç”¨è¢«å…¶å®ƒæ¡†æ¶åµŒå…¥ï¼ŒåŒ…æ‹¬ä¸Šé¢æ²¡æœ‰åˆ—ä¸¾å‡ºçš„å…¶å®ƒåº“ï¼Œå¦‚ svelteã€umi ...
æˆ‘ä»¬åªåˆ—ä¸¾äº†éƒ¨åˆ†æ¡†æ¶ï¼Œå¦‚æœæœ‰å…¶å®ƒæ¡†æ¶éœ€æ±‚ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚`}]},{path:"/v0/zh/framework/nextjs.html",title:"Nextjs",pathLocale:"/",contents:[{header:"Nextjs",slug:"nextjs",content:"æœ¬ç¯‡ä»¥nextjs 11ä½œä¸ºæ¡ˆä¾‹ä»‹ç»nextjsçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬nextjsæ¥å…¥æ–¹å¼ä¼šåœ¨åç»­è¡¥å……ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºåŸºåº§åº”ç”¨",slug:"ä½œä¸ºåŸºåº§åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€å¼•å…¥micro-app",slug:"_2ã€å¼•å…¥micro-app",content:`å› ä¸ºwebComponentåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨pages/_app.jsxçš„useEffectä¸­è¿›è¡Œåˆå§‹åŒ–ã€‚
// pages/_app.jsx
import { useEffect } from 'react'
import microApp from '@micro-zoe/micro-app' function MyApp({ Component, pageProps }) { useEffect(() => { // åˆå§‹åŒ–micro-app microApp.start() /** * BUG FIX * åœ¨nextjs 11ä¸‹ï¼Œå­åº”ç”¨å†…éƒ¨è·³è½¬ï¼ŒåŸºåº§æ— æ³•ç›‘å¬ï¼Œå¯¼è‡´ç‚¹å‡»æµè§ˆå™¨å‰è¿›ã€åé€€æŒ‰é’®ï¼Œæ— æ³•å›é€€åˆ°æ­£ç¡®çš„å­åº”ç”¨é¡µé¢ * é€šè¿‡ç›‘å¬popstateäº‹ä»¶ï¼Œåœ¨åœ°å€å˜åŒ–æ—¶é‡æ–°æ›¿æ¢ä¸ºnextè·¯ç”±æ¥è§£å†³è¿™ä¸ªé—®é¢˜ */ window.addEventListener('popstate', () => { const { href, origin } = window.location router.replace(href.replace(origin, '')) }) }, []) return <Component {...pageProps} />
} export default MyApp`},{header:"3ã€è®¾ç½®åŠ¨æ€è·¯ç”±",slug:"_3ã€è®¾ç½®åŠ¨æ€è·¯ç”±",content:`é€šè¿‡pages/my-page/[[...]].jsè®¾ç½®åŠ¨æ€è·¯ç”±ï¼Œä»¥ç¡®ä¿/my-page/* éƒ½æŒ‡å‘å½“å‰é¡µé¢ã€‚
è¯¦æƒ…å‚è€ƒï¼šoptional-catch-all-routes`},{header:"4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:`å¦‚ä¸Šæ‰€è¿°ï¼Œmicro-appåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥åœ¨useEffectä¸­é€šè¿‡å˜é‡æ§åˆ¶å­åº”ç”¨æ˜¾ç¤ºã€‚
// pages/my-page/[[...]].js
import { useState, useEffect } from 'react' const MyPage = () => { const [show, changeShow] = useState(false) useEffect(() => { changeShow(true) }, []) return ( <div> <h1>å­åº”ç”¨</h1> { show && ( <micro-app name='app1' // name(å¿…ä¼ )ï¼šåº”ç”¨åç§° url='http://localhost:3000/' // url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html baseroute='/my-page' // baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ \`/my-page\` ></micro-app> ) } </div> )
} export default MyPage`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€åœ¨åŸºåº§åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",slug:"_1ã€åœ¨åŸºåº§åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",content:`å½“å­åº”ç”¨æ˜¯ssråº”ç”¨æ—¶ï¼ŒåŸºåº§éœ€è¦åœ¨micro-appå…ƒç´ ä¸Šæ·»åŠ ssrå±æ€§ï¼Œæ­¤æ—¶micro-appä¼šæ ¹æ®ssræ¨¡å¼åŠ è½½å­åº”ç”¨ã€‚
<micro-app name='xx' url='xx' ssr></micro-app>
åŸºåº§åº”ç”¨ä¸éœ€è¦è®¾ç½®baserouteå±æ€§ï¼Œå› ä¸ºssrå­åº”ç”¨æ— æ³•ä½¿ç”¨ã€‚`},{header:"2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`é€šè¿‡è‡ªå®šä¹‰æœåŠ¡è®¾ç½®è·¨åŸŸè®¿é—®ï¼Œè¯¦æƒ…å‚è€ƒ custom-server
æ­¥éª¤1ã€åœ¨æ ¹ç›®å½•åˆ›å»ºserver.js
server.jsçš„å†…å®¹å¦‚ä¸‹ï¼š
// server.js
const express = require('express')
const next = require('next')
const config = require('./next.config') const port = parseInt(process.env.PORT, 10) || 3000
const dev = process.env.NODE_ENV !== 'production'
const app = next({ dev })
const handle = app.getRequestHandler() app.prepare().then(() => { const server = express() // è®¾ç½®è·¨åŸŸæ”¯æŒ server.all('*', (req, res) => { res.setHeader('access-control-allow-origin', '*') return handle(req, res) }) server.listen(port, (err) => { if (err) throw err console.log(\`> Ready on http://localhost:\${port}\${config.basePath}/\`) })
})
æ­¥éª¤2ã€ä¿®æ”¹package.jsonä¸­çš„scriptsï¼Œå¦‚ä¸‹ï¼š
"scripts": { "dev": "node server.js", "build": "next build", "start": "cross-env NODE_ENV=production node server.js"
}`},{header:"3ã€è®¾ç½®åŸºç¡€è·¯ç”±",slug:"_3ã€è®¾ç½®åŸºç¡€è·¯ç”±",content:`nextjsçš„åŸºç¡€è·¯ç”±åªèƒ½åœ¨next.config.jsä¸­é€šè¿‡basePathå†™æ­»ï¼Œæ— æ³•åƒSPAåº”ç”¨ä¸€æ ·çµæ´»é…ç½®ã€‚
// next.config.js
const basePath = 'åŸºç¡€è·¯ç”±ï¼Œä¸åŸºåº§åˆ†é…çš„è·¯ç”±åœ°å€ä¸€è‡´',
module.exports = { basePath,
}`},{header:"4ã€è®¾ç½®assetPrefix å’Œ publicRuntimeConfig",slug:"_4ã€è®¾ç½®assetprefix-å’Œ-publicruntimeconfig",content:`åœ¨next.config.jsä¸­è®¾ç½®assetPrefixï¼Œä¸ºé™æ€èµ„æºæ·»åŠ è·¯å¾„å‰ç¼€ï¼Œé¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µã€‚
// next.config.js
// åŸºç¡€è·¯ç”±
const basePath = 'åŸºç¡€è·¯ç”±ï¼Œä¸åŸºåº§åˆ†é…çš„è·¯ç”±åœ°å€ä¸€è‡´',
// é™æ€èµ„æºè·¯å¾„å‰ç¼€
const assetPrefix = process.env.NODE_ENV === 'production' ? \`çº¿ä¸ŠåŸŸå\${basePath}\` : \`http://localhost:\${process.env.PORT || 3000}\${basePath}\` module.exports = { basePath, assetPrefix, // æ·»åŠ  assetPrefix åœ°å€åˆ° publicRuntimeConfig publicRuntimeConfig: { assetPrefix, },
}
assetPrefixåªå¯¹jsã€cssç­‰é™æ€èµ„æºç”Ÿæ•ˆï¼Œå¯¹æœ¬åœ°å›¾ç‰‡æ— æ•ˆã€‚
ä¸ºæ­¤æˆ‘ä»¬å°†assetPrefixä½œä¸ºå‚æ•°ä¼ å…¥publicRuntimeConfigï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨é€šè¿‡publicRuntimeConfigè¡¥å…¨å›¾ç‰‡åœ°å€ã€‚
æ–¹å¼å¦‚ä¸‹ï¼š
import getConfig from 'next/config'
const { publicRuntimeConfig } = getConfig() const Page = () => { return ( <div> <img src={\`\${publicRuntimeConfig.assetPrefix}/local-img.png\`} /> </div> )
} export default Page`},{header:"5ã€ç›‘å¬å¸è½½",slug:"_5ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ
})
Note
nextjsé»˜è®¤æ”¯æŒcss moduleåŠŸèƒ½ï¼Œå¦‚æœä½ ä½¿ç”¨äº†æ­¤åŠŸèƒ½ï¼Œå»ºè®®å…³é—­æ ·å¼éš”ç¦»ä»¥æå‡æ€§èƒ½ï¼š<micro-app name='xx' url='xx' disableScopecss></micro-app>`},{header:"å®æˆ˜æ¡ˆä¾‹",slug:"å®æˆ˜æ¡ˆä¾‹",content:`ä»¥ä¸Šä»‹ç»äº†nextjså¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºnextjsä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚
æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€ä½¿ç”¨next/imageç»„ä»¶åŠ è½½å›¾ç‰‡å¤±è´¥",slug:"_1ã€ä½¿ç”¨next-imageç»„ä»¶åŠ è½½å›¾ç‰‡å¤±è´¥",content:`è§£å†³æ–¹å¼ï¼š
åœ¨éƒ¨åˆ†nextjsç‰ˆæœ¬ä¸­(å¦‚ï¼šnextjs 11)ï¼Œä½¿ç”¨next/imageç»„ä»¶æ— æ³•æ­£ç¡®å¼•å…¥å›¾ç‰‡ï¼Œæ­¤æ—¶æ¨èä½¿ç”¨imgå…ƒç´ ä»£æ›¿ã€‚`},{header:"2ã€æ— æ³•é¢„åŠ è½½ssrå­åº”ç”¨",slug:"_2ã€æ— æ³•é¢„åŠ è½½ssrå­åº”ç”¨",content:"åŸå› ï¼š å› ä¸ºssråº”ç”¨æ¯ä¸ªè·¯ç”±åœ°å€åŠ è½½çš„htmlã€jsã€cssç­‰é™æ€èµ„æºéƒ½ä¸åŒï¼Œæ‰€ä»¥æ— æ³•å¯¹ssrå­åº”ç”¨ä½¿ç”¨é¢„åŠ è½½ã€‚"},{header:"3ã€æ§åˆ¶å°æŠ¥é”™Cannot read properties of null (reading 'tagName')",slug:"_3ã€æ§åˆ¶å°æŠ¥é”™cannot-read-properties-of-null-reading-tagname",content:`åŸå› ï¼š å½“åŸºåº§å’Œå­åº”ç”¨éƒ½æ˜¯nextjsåº”ç”¨æ—¶ï¼Œnext/headç»„ä»¶å†²çªã€‚
è§£å†³æ–¹å¼ï¼š å»æ‰å­åº”ç”¨ä¸­next/headç»„ä»¶ã€‚`},{header:"4ã€webpack.jsonpFunctionå†²çªï¼Œå¯¼è‡´åŠ è½½å­åº”ç”¨å¤±è´¥",slug:"_4ã€webpack-jsonpfunctionå†²çª-å¯¼è‡´åŠ è½½å­åº”ç”¨å¤±è´¥",content:`åŸå› ï¼š å½“åŸºåº§å’Œå­åº”ç”¨éƒ½æ˜¯å®˜æ–¹è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œå®¹æ˜“é€ æˆwebpack.jsonpFunctionå†²çªã€‚
è§£å†³æ–¹å¼ï¼š ä¿®æ”¹å­åº”ç”¨çš„webpacké…ç½®ã€‚
jsonpFunctionæ˜¯webpack4ä¸­çš„åç§°ï¼Œåœ¨webpack5ä¸­åç§°ä¸ºchunkLoadingGlobalï¼Œè¯·æ ¹æ®è‡ªå·±é¡¹ç›®çš„webpackç‰ˆæœ¬è®¾ç½®ã€‚
åœ¨next.config.jsä¸­é…ç½®webpackï¼š
// next.config.js
module.exports = { webpack: (config) => { Object.assign(config.output, { chunkLoadingGlobal: 'webpackJsonp_child_app', // webpack5 // jsonpFunction: 'webpackJsonp_child_app', // webpack4 globalObject: 'window', }) return config },
}
æç¤º
nextjsç›¸å…³é—®é¢˜å¯ä»¥åœ¨nextjsä¸“å±è®¨è®ºè´´ä¸‹åé¦ˆã€‚`}]},{path:"/v0/zh/framework/nuxtjs.html",title:"Nuxtjs",pathLocale:"/",contents:[{header:"Nuxtjs",slug:"nuxtjs",content:"æœ¬ç¯‡ä»¥nuxtjs 2ä½œä¸ºæ¡ˆä¾‹ä»‹ç»nuxtjsçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬nuxtjsæ¥å…¥æ–¹å¼ä¼šåœ¨åç»­è¡¥å……ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ï¼Œè¯·åœ¨githubä¸Šæissueå‘ŠçŸ¥æˆ‘ä»¬ã€‚"},{header:"ä½œä¸ºåŸºåº§åº”ç”¨",slug:"ä½œä¸ºåŸºåº§åº”ç”¨",content:""},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€å¼•å…¥micro-app",slug:"_2ã€å¼•å…¥micro-app",content:`å› ä¸ºwebComponentåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨æµè§ˆå™¨ç¯å¢ƒæ‰§è¡Œmicro-appçš„åˆå§‹åŒ–ã€‚
å¦‚æœæ²¡æœ‰layoutsæ–‡ä»¶ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶layouts/default.vueï¼Œå¦‚æœå·²ç»æœ‰layoutsæ–‡ä»¶ï¼Œç›´æ¥å¤ç”¨å³å¯ï¼Œlayoutsç›¸å…³ä¿¡æ¯å‚è€ƒï¼šlayouts
// layouts/default.vue
<template> <Nuxt />
</template> <script>
import microApp from '@micro-zoe/micro-app' export default { name: 'default', mounted () { microApp.start() }
}
<\/script>`},{header:"3ã€è®¾ç½®åŠ¨æ€è·¯ç”±",slug:"_3ã€è®¾ç½®åŠ¨æ€è·¯ç”±",content:`é€šè¿‡pages/my-page/_.vueè®¾ç½®åŠ¨æ€è·¯ç”±ï¼Œä»¥ç¡®ä¿/my-page/* éƒ½æŒ‡å‘å½“å‰é¡µé¢ã€‚
è¯¦æƒ…å‚è€ƒï¼šdynamic-routes`},{header:"4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:`å¦‚ä¸Šæ‰€è¿°ï¼Œmicro-appåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥åœ¨mountedé’©å­ä¸­é€šè¿‡å˜é‡æ§åˆ¶å­åº”ç”¨æ˜¾ç¤ºã€‚
<template> <div> <h1>å­åº”ç”¨</h1> <!-- name(å¿…ä¼ )ï¼šåº”ç”¨åç§° url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ \`/my-page\` --> <micro-app v-if='show' name='app1' url='http://localhost:3000/' baseroute='/my-page'></micro-app> </div>
</template> <script>
export default { name: 'my-page', data () { return { show: false, } }, mounted () { this.show = true },
}
<\/script>`},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€åœ¨åŸºåº§åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",slug:"_1ã€åœ¨åŸºåº§åº”ç”¨ä¸­æ·»åŠ ssré…ç½®",content:`å½“å­åº”ç”¨æ˜¯ssråº”ç”¨æ—¶ï¼ŒåŸºåº§éœ€è¦åœ¨micro-appå…ƒç´ ä¸Šæ·»åŠ ssrå±æ€§ï¼Œæ­¤æ—¶micro-appä¼šæ ¹æ®ssræ¨¡å¼åŠ è½½å­åº”ç”¨ã€‚
<micro-app name='xx' url='xx' ssr></micro-app>
åŸºåº§åº”ç”¨ä¸éœ€è¦è®¾ç½®baserouteå±æ€§ï¼Œå› ä¸ºssrå­åº”ç”¨æ— æ³•ä½¿ç”¨ã€‚`},{header:"2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_2ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`é€šè¿‡è‡ªå®šä¹‰æœåŠ¡è®¾ç½®è·¨åŸŸè®¿é—®ã€‚
æ­¥éª¤1ã€åœ¨æ ¹ç›®å½•åˆ›å»ºserver.js
server.jsçš„å†…å®¹å¦‚ä¸‹ï¼š
// server.js
const express = require('express')
const { Nuxt, Builder } = require('nuxt') const app = express() const host = process.env.HOST || '127.0.0.1'
const port = process.env.PORT || 3000 // Import and set Nuxt options
const config = require('./nuxt.config.js')
config.dev = process.env.NODE_ENV !== 'production' const nuxt = new Nuxt(config) // Start build process in dev mode
if (config.dev) { const builder = new Builder(nuxt) builder.build()
} // è®¾ç½®è·¨åŸŸæ”¯æŒ
app.all('*', (req, res, next) => { res.header("Access-Control-Allow-Origin", '*') next()
}) // Give nuxt middleware to express
app.use(nuxt.render) // Start express server
app.listen(port, host, () => { console.log(\`Ready on http://localhost:\${port}\${config.router.base}\`)
})
æ­¥éª¤2ã€ä¿®æ”¹package.jsonä¸­çš„scriptsï¼Œå¦‚ä¸‹ï¼š
"scripts": { "dev": "node server.js", "build": "nuxt build", "start": "cross-env NODE_ENV=production node server.js",
}`},{header:"3ã€è®¾ç½®åŸºç¡€è·¯ç”±",slug:"_3ã€è®¾ç½®åŸºç¡€è·¯ç”±",content:`nuxtjsçš„åŸºç¡€è·¯ç”±åªèƒ½åœ¨nuxt.config.jsä¸­é€šè¿‡router.baseå†™æ­»ï¼Œæ— æ³•åƒSPAåº”ç”¨ä¸€æ ·çµæ´»é…ç½®ã€‚
// nuxt.config.js
const basePath = 'åŸºç¡€è·¯ç”±ï¼Œä¸åŸºåº§åˆ†é…çš„è·¯ç”±åœ°å€ä¸€è‡´', module.exports = { // è®¾ç½®åŸºç¡€è·¯ç”± router: { base: basePath, },
}`},{header:"4ã€é€šè¿‡envæ³¨å…¥è¿è¡Œæ—¶å˜é‡assetPrefix",slug:"_4ã€é€šè¿‡envæ³¨å…¥è¿è¡Œæ—¶å˜é‡assetprefix",content:`assetPrefixä¸ºé™æ€èµ„æºè·¯å¾„å‰ç¼€ï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨é€šè¿‡assetPrefixè¡¥å…¨å›¾ç‰‡åœ°å€ï¼Œé¿å…å­åº”ç”¨çš„å›¾ç‰‡åœ¨ä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µã€‚
// nuxt.config.js
// åŸºç¡€è·¯ç”±
const basePath = 'åŸºç¡€è·¯ç”±ï¼Œä¸åŸºåº§åˆ†é…çš„è·¯ç”±åœ°å€ä¸€è‡´',
// é™æ€èµ„æºè·¯å¾„å‰ç¼€
const assetPrefix = process.env.NODE_ENV === 'production' ? \`çº¿ä¸ŠåŸŸå\${basePath}\` : \`http://localhost:\${process.env.PORT || 3000}\${basePath}\` module.exports = { // å°† assetPrefix å†™å…¥ç¯å¢ƒå˜é‡ï¼Œé€šè¿‡ process.env.assetPrefix è®¿é—® env: { assetPrefix, }, // è®¾ç½®åŸºç¡€è·¯ç”± router: { base: basePath, },
}
ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
<template> <div> <img :src="localImg" /> </div>
</template> <script>
import Vue from 'vue' export default Vue.extend({ data () { return { // è¡¥å…¨å›¾ç‰‡åœ°å€ localImg: process.env.assetPrefix + '/local-img.png', } }
})
<\/script>`},{header:"5ã€ç›‘å¬å¸è½½",slug:"_5ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
// ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { // æ‰§è¡Œå¸è½½ç›¸å…³æ“ä½œ
})`},{header:"å®æˆ˜æ¡ˆä¾‹",slug:"å®æˆ˜æ¡ˆä¾‹",content:`ä»¥ä¸Šä»‹ç»äº†nuxtjså¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºnuxtjsä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚
æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€æ§åˆ¶å°æŠ›å‡ºè­¦å‘Š[Vue warn]: Unknown custom element: <micro-app>",slug:"_1ã€æ§åˆ¶å°æŠ›å‡ºè­¦å‘Š-vue-warn-unknown-custom-element-micro-app",content:`è§£å†³æ–¹å¼ï¼š åœ¨nuxt.config.jsä¸­æ·»åŠ é…ç½®ï¼Œè®¾ç½®ignoredElementså¿½ç•¥micro-appå…ƒç´ ã€‚
// nuxt.config.js
module.exports = { vue: { config: { ignoredElements: [ 'micro-app', ], } },
}
æç¤º
nuxtjsç›¸å…³é—®é¢˜å¯ä»¥åœ¨nuxtjsä¸“å±è®¨è®ºè´´ä¸‹åé¦ˆã€‚`}]},{path:"/v0/zh/framework/react.html",title:"React",pathLocale:"/",contents:[{header:"React",slug:"react",content:"æœ¬ç¯‡ä»¥React 16ã€17ä½œä¸ºæ¡ˆä¾‹ä»‹ç»reactçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬reactçš„æ¥å…¥æ–¹å¼ä»¥æ­¤ç±»æ¨ã€‚æˆ‘ä»¬é»˜è®¤å¼€å‘è€…æŒæ¡äº†å„ç‰ˆæœ¬reactçš„å¼€å‘æŠ€å·§ï¼Œå¦‚ç¤ºä¾‹ä¸­useEffectï¼Œåœ¨ä¸æ”¯æŒhooksçš„ç‰ˆæœ¬ä¸­è½¬æ¢ä¸ºcomponentDidMountã€‚"},{header:"ä½œä¸ºåŸºåº§åº”ç”¨",slug:"ä½œä¸ºåŸºåº§åº”ç”¨",content:`æˆ‘ä»¬å¼ºçƒˆå»ºè®®åŸºåº§åº”ç”¨é‡‡ç”¨historyæ¨¡å¼ï¼Œhashè·¯ç”±çš„åŸºåº§åº”ç”¨åªèƒ½åŠ è½½hashè·¯ç”±çš„å­åº”ç”¨ï¼Œhistoryæ¨¡å¼çš„åŸºåº§åº”ç”¨å¯¹è¿™ä¸¤ç§å­åº”ç”¨éƒ½æ”¯æŒã€‚
åœ¨ä»¥ä¸‹æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬é»˜è®¤åŸºåº§çš„è·¯ç”±ä¸ºhistoryæ¨¡å¼ã€‚`},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åœ¨å…¥å£å¤„å¼•å…¥",slug:"_2ã€åœ¨å…¥å£å¤„å¼•å…¥",content:`// entry
import microApp from '@micro-zoe/micro-app' microApp.start()`},{header:"3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨",slug:"_3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨",content:`// router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom'
import MyPage from './my-page' export default function AppRoute () { return ( <BrowserRouter> <Switch> // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢ <Route path='/my-page'> <MyPage /> </Route> </Switch> </BrowserRouter> )
}`},{header:"4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:"export function MyPage () { return ( <div> <h1>å­åº”ç”¨</h1> <micro-app name='app1' // name(å¿…ä¼ )ï¼šåº”ç”¨åç§° url='http://localhost:3000/' // url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html baseroute='/my-page' // baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ `/my-page` ></micro-app> </div> )\n}"},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`ä½¿ç”¨create-react-appè„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œåœ¨ config/webpackDevServer.config.js æ–‡ä»¶ä¸­æ·»åŠ headersã€‚
å…¶å®ƒé¡¹ç›®åœ¨webpack-dev-serverä¸­æ·»åŠ headersã€‚
headers: { 'Access-Control-Allow-Origin': '*',
}`},{header:"2ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)",slug:"_2ã€è®¾ç½®åŸºç¡€è·¯ç”±-å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±-å­åº”ç”¨æ˜¯hashè·¯ç”±-è¿™ä¸€æ­¥å¯ä»¥çœç•¥",content:`// router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom' export default function AppRoute () { return ( // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™window.__MICRO_APP_BASE_ROUTE__ä¸ºç©ºå­—ç¬¦ä¸² <BrowserRouter basename={window.__MICRO_APP_BASE_ROUTE__ || '/'}> ... </BrowserRouter> )
}`},{header:"3ã€è®¾ç½® publicPath",slug:"_3ã€è®¾ç½®-publicpath",content:`è¿™ä¸€æ­¥å€ŸåŠ©äº†webpackçš„åŠŸèƒ½ï¼Œé¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ publicPath
å¦‚æœå­åº”ç”¨ä¸æ˜¯webpackæ„å»ºçš„ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥ã€‚
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"4ã€ç›‘å¬å¸è½½",slug:"_4ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚
window.addEventListener('unmount', function () { ReactDOM.unmountComponentAtNode(document.getElementById('root'))
})`},{header:"å®æˆ˜æ¡ˆä¾‹",slug:"å®æˆ˜æ¡ˆä¾‹",content:`ä»¥ä¸Šä»‹ç»äº†reactå¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºreactä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚
æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€create-react-appåˆ›å»ºçš„å­åº”ç”¨ï¼Œè¢«åµŒå…¥å¾®å‰ç«¯åsockjs-nodeæŠ¥é”™",slug:"_1ã€create-react-appåˆ›å»ºçš„å­åº”ç”¨-è¢«åµŒå…¥å¾®å‰ç«¯åsockjs-nodeæŠ¥é”™",content:`æŠ¥é”™ä¿¡æ¯ï¼š WebSocket connection to 'ws://localhost:3000/sockjs-node' failed
åŸå› ï¼š å­åº”ç”¨çš„sockjs-nodeä¼šæ ¹æ®å½“å‰é¡µé¢çš„ç«¯å£å·è¿›è¡Œé€šä¿¡ï¼ŒåµŒå…¥å¾®å‰ç«¯åï¼Œç«¯å£å·ä¸ºåŸºåº§çš„ï¼Œè€Œéå­åº”ç”¨çš„ï¼Œå¯¼è‡´æŠ¥é”™ã€‚
è™½ç„¶è¿™ä¸ªé—®é¢˜ä¸å½±å“åº”ç”¨çš„æ­£å¸¸è¿è¡Œï¼Œä½†è¿˜æ˜¯è¦è¿›è¡Œå¤„ç†ã€‚
è§£å†³æ–¹å¼ï¼š ä½¿ç”¨æ’ä»¶ç³»ç»Ÿè¡¥å…¨å­åº”ç”¨sockjs-nodeçš„ç«¯å£å·ã€‚
microApp.start({ plugins: { modules: { å­åº”ç”¨åç§°: [{ loader(code) { if (process.env.NODE_ENV === 'development' && code.indexOf('sockjs-node') > -1) { code = code.replace('window.location.port', å­åº”ç”¨ç«¯å£) } return code } }], } }
})`}]},{path:"/v0/zh/framework/vite.html",title:"Vite",pathLocale:"/",contents:[{header:"Vite",slug:"vite",content:`è­¦å‘Š
åœ¨æ­£å¼ç‰ˆä¸­æ¥å…¥viteå­åº”ç”¨éœ€è¦å…³é—­æ²™ç®±ï¼Œè¿™ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ï¼Œæš‚æ—¶ä¸å»ºè®®æ¥å…¥ã€‚
åœ¨1.0å…¬æµ‹ç‰ˆä¸­æˆ‘ä»¬æ¨å‡ºäº†ä¸ºviteæ‰“é€ çš„æ²™ç®±æ–¹æ¡ˆï¼Œå¯¹äºæ–°æ¥å…¥çš„é¡¹ç›®ï¼Œæ¨èä½¿ç”¨æ–°çš„æ–¹æ¡ˆï¼Œå…·ä½“è¯¦æƒ…è¯·è·³è½¬1.0å…¬æµ‹ç‰ˆæ–‡æ¡£ã€‚`},{header:"ä½œä¸ºåŸºåº§åº”ç”¨",slug:"ä½œä¸ºåŸºåº§åº”ç”¨",content:"viteä½œä¸ºåŸºåº§åº”ç”¨æ—¶æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„ï¼Œå…·ä½“æ–¹å¼å‚è€ƒå„æ¡†æ¶æ¥å…¥æ–‡æ¡£ã€‚"},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:`å½“å­åº”ç”¨æ˜¯viteåº”ç”¨æ—¶éœ€è¦åšç‰¹åˆ«çš„é€‚é…ï¼Œé€‚é…viteçš„ä»£ä»·æ˜¯å·¨å¤§çš„ï¼Œæˆ‘ä»¬å¿…é¡»å…³é—­æ²™ç®±åŠŸèƒ½ï¼Œå› ä¸ºæ²™ç®±åœ¨module scriptä¸‹ä¸æ”¯æŒï¼Œè¿™å¯¼è‡´å¤§éƒ¨åˆ†åŠŸèƒ½å¤±æ•ˆï¼ŒåŒ…æ‹¬ï¼šç¯å¢ƒå˜é‡ã€æ ·å¼éš”ç¦»ã€å…ƒç´ éš”ç¦»ã€èµ„æºè·¯å¾„è¡¥å…¨ã€baseroute ç­‰ã€‚
åœ¨åµŒå…¥viteå­åº”ç”¨æ—¶ï¼Œmicro-appçš„åŠŸèƒ½åªè´Ÿè´£æ¸²æŸ“ï¼Œå…¶å®ƒçš„è¡Œä¸ºç”±åº”ç”¨è‡ªè¡Œå†³å®šï¼Œè¿™åŒ…æ‹¬å¦‚ä½•é˜²æ­¢æ ·å¼ã€JSå˜é‡ã€å…ƒç´ çš„å†²çªã€‚
åœ¨moduleæ¨¡å¼ä¸‹ï¼Œå¼•å…¥çš„èµ„æºå¤§å¤šä¸ºç›¸å¯¹åœ°å€ï¼Œå…¼å®¹ä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯å°†åœ°å€è¡¥å…¨ã€‚`},{header:"ğŸ‘‡ å­åº”ç”¨çš„ä¿®æ”¹",slug:"ğŸ‘‡-å­åº”ç”¨çš„ä¿®æ”¹",content:`1ã€ä¿®æ”¹vite.config.js
import { join } from 'path'
import { writeFileSync } from 'fs' // vite.config.js
export default defineConfig({ base: \`\${process.env.NODE_ENV === 'production' ? 'http://my-site.com' : ''}/basename/\`, plugins: [ // è‡ªå®šä¹‰æ’ä»¶ (function () { let basePath = '' return { name: "vite:micro-app", apply: 'build', configResolved(config) { basePath = \`\${config.base}\${config.build.assetsDir}/\` }, writeBundle (options, bundle) { for (const chunkName in bundle) { if (Object.prototype.hasOwnProperty.call(bundle, chunkName)) { const chunk = bundle[chunkName] if (chunk.fileName && chunk.fileName.endsWith('.js')) { chunk.code = chunk.code.replace(/(from|import\\()(\\s*['"])(\\.\\.?\\/)/g, (all, $1, $2, $3) => { return all.replace($3, new URL($3, basePath)) }) const fullPath = join(options.dir, chunk.fileName) writeFileSync(fullPath, chunk.code) } } } }, } })(), ],
})
2ã€ä¿®æ”¹å®¹å™¨å…ƒç´ id
å› ä¸ºviteå­åº”ç”¨æ²¡æœ‰å…ƒç´ éš”ç¦»çš„ä¿æŠ¤ï¼Œå»ºè®®ä¿®æ”¹å®¹å™¨å…ƒç´ çš„idå€¼ï¼Œä»¥ç¡®ä¿ä¸å…¶å®ƒå…ƒç´ ä¸å†²çªã€‚
1ã€ä¿®æ”¹index.htmlä¸­å®¹å™¨å…ƒç´ çš„idå€¼
<!-- index.html -->
<body> <div id="my-vite-app"></div>
</body>
2ã€ä½¿ç”¨æ–°çš„idæ¸²æŸ“
// main.js
createApp(App).mount('#my-vite-app')
å½“å¤šä¸ªviteå­åº”ç”¨åŒæ—¶æ¸²æŸ“æ—¶ï¼Œå¿…é¡»ä¿®æ”¹å®¹å™¨å…ƒç´ çš„idå€¼ï¼Œç¡®ä¿æ¯ä¸ªå­åº”ç”¨å®¹å™¨å…ƒç´ idçš„å”¯ä¸€æ€§ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ¸²æŸ“ã€‚
3ã€è·¯ç”±
æ¨èåŸºåº§ä½¿ç”¨historyè·¯ç”±ï¼Œviteå­åº”ç”¨ä½¿ç”¨hashè·¯ç”±ï¼Œé¿å…ä¸€äº›å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚
å­åº”ç”¨å¦‚æœæ˜¯vue3ï¼Œåœ¨åˆå§‹åŒ–æ—¶è·¯ç”±æ—¶ï¼ŒcreateWebHashHistoryä¸è¦ä¼ å…¥å‚æ•°ï¼Œå¦‚ä¸‹ï¼š
import { createRouter, createWebHashHistory } from 'vue-router' const router = createRouter({ history: createWebHashHistory(), routes,
})
4ã€é™æ€èµ„æº
å›¾ç‰‡ç­‰é™æ€èµ„æºéœ€è¦ä½¿ç”¨ç»å¯¹åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ new URL('../assets/logo.png', import.meta.url).href ç­‰æ–¹å¼è·å–èµ„æºçš„å…¨é“¾æ¥åœ°å€ã€‚`},{header:"ğŸ‘‡ åŸºåº§åº”ç”¨çš„ä¿®æ”¹",slug:"ğŸ‘‡-åŸºåº§åº”ç”¨çš„ä¿®æ”¹",content:`æ³¨æ„è¿™é‡Œçš„åŸºåº§åº”ç”¨æ˜¯æŒ‡åµŒå…¥äº†viteå­åº”ç”¨çš„åŸºåº§ï¼Œå®ƒå¯ä»¥æ˜¯ä»»ä½•æ¡†æ¶ï¼Œå’Œä¸Šé¢ä½œä¸ºåŸºåº§åº”ç”¨ä¸€èŠ‚æ— å…³ã€‚
1ã€å…³é—­æ²™ç®±å¹¶ä½¿ç”¨å†…è”scriptæ¨¡å¼
<micro-app name='child-name' url='http://localhost:3001/basename/' inline // ä½¿ç”¨å†…è”scriptæ¨¡å¼ disableSandbox // å…³é—­æ²™ç®±
>
2ã€å¤„ç†å­åº”ç”¨é™æ€èµ„æº
å†™ä¸€ä¸ªç®€æ˜“çš„æ’ä»¶ï¼Œå¯¹å¼€å‘ç¯å¢ƒçš„å­åº”ç”¨è¿›è¡Œå¤„ç†ï¼Œè¡¥å…¨é™æ€èµ„æºè·¯å¾„ã€‚
import microApp from '@micro-zoe/micro-app' microApp.start({ plugins: { modules: { // appNameå³åº”ç”¨çš„nameå€¼ appName: [{ loader(code) { if (process.env.NODE_ENV === 'development') { // è¿™é‡Œ basename éœ€è¦å’Œå­åº”ç”¨vite.config.jsä¸­baseçš„é…ç½®ä¿æŒä¸€è‡´ code = code.replace(/(from|import)(\\s*['"])(\\/basename\\/)/g, all => { return all.replace('/basename/', 'å­åº”ç”¨åŸŸå/basename/') }) } return code } }] } }
})`},{header:"ğŸ‘‡ æ•°æ®é€šä¿¡",slug:"ğŸ‘‡-æ•°æ®é€šä¿¡",content:`æ²™ç®±å…³é—­åï¼Œå­åº”ç”¨é»˜è®¤çš„é€šä¿¡åŠŸèƒ½å¤±æ•ˆï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡æ‰‹åŠ¨æ³¨å†Œé€šä¿¡å¯¹è±¡å®ç°ä¸€è‡´çš„åŠŸèƒ½ã€‚
æ³¨å†Œæ–¹å¼ï¼šåœ¨åŸºåº§åº”ç”¨ä¸­ä¸ºå­åº”ç”¨åˆå§‹åŒ–é€šä¿¡å¯¹è±¡
import { EventCenterForMicroApp } from '@micro-zoe/micro-app' // æ³¨æ„ï¼šæ¯ä¸ªviteå­åº”ç”¨æ ¹æ®appNameå•ç‹¬åˆ†é…ä¸€ä¸ªé€šä¿¡å¯¹è±¡
window.eventCenterForViteApp1 = new EventCenterForMicroApp(appName)
viteå­åº”ç”¨å°±å¯ä»¥é€šè¿‡æ³¨å†Œçš„eventCenterForViteApp1å¯¹è±¡è¿›è¡Œé€šä¿¡ï¼Œå…¶apiå’Œwindow.microAppä¸€è‡´ï¼ŒåŸºåº§é€šä¿¡æ–¹å¼æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚
å­åº”ç”¨é€šä¿¡æ–¹å¼ï¼š
/** * ç»‘å®šç›‘å¬å‡½æ•° * dataListener: ç»‘å®šå‡½æ•° * autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶æœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse */
window.eventCenterForViteApp1.addDataListener(dataListener: (data: Object) => void, autoTrigger?: boolean) // è§£ç»‘æŒ‡å®šå‡½æ•°
window.eventCenterForViteApp1.removeDataListener(dataListener) // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
window.eventCenterForViteApp1.clearDataListener() // ä¸»åŠ¨è·å–æ•°æ®
window.eventCenterForViteApp1.getData() // å­åº”ç”¨å‘åŸºåº§åº”ç”¨å‘é€æ•°æ®
window.eventCenterForViteApp1.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})
æ³¨æ„ è¯·ç¡®ä¿viteç‰ˆæœ¬>=2.5.0
é€‚é…viteæœ¬è´¨ä¸Šæ˜¯é€‚é…moduleè„šæœ¬ï¼Œå…¶å®ƒéviteæ„å»ºçš„moduleè„šæœ¬ä¹Ÿå¯ä»¥é‡‡ç”¨ç›¸åŒçš„æ€è·¯å¤„ç†ã€‚`},{header:"å®æˆ˜æ¡ˆä¾‹",slug:"å®æˆ˜æ¡ˆä¾‹",content:`ä»¥ä¸Šä»‹ç»äº†viteå¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºviteä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚
æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x`}]},{path:"/v0/zh/framework/vue.html",title:"Vue",pathLocale:"/",contents:[{header:"Vue",slug:"vue",content:"æœ¬ç¯‡ä»¥Vue 2ã€3ä½œä¸ºæ¡ˆä¾‹ä»‹ç»vueçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬vueçš„æ¥å…¥æ–¹å¼ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬é»˜è®¤å¼€å‘è€…æŒæ¡äº†å„ç‰ˆæœ¬vueçš„å¼€å‘æŠ€å·§ï¼Œæ¯”å¦‚ç¤ºä¾‹ä¸­vue2çš„ä»£ç å¦‚ä½•è½¬æ¢ä¸ºvue1ã€‚"},{header:"ä½œä¸ºåŸºåº§åº”ç”¨",slug:"ä½œä¸ºåŸºåº§åº”ç”¨",content:`æˆ‘ä»¬å¼ºçƒˆå»ºè®®åŸºåº§åº”ç”¨é‡‡ç”¨historyæ¨¡å¼ï¼Œhashè·¯ç”±çš„åŸºåº§åº”ç”¨åªèƒ½åŠ è½½hashè·¯ç”±çš„å­åº”ç”¨ï¼Œhistoryæ¨¡å¼çš„åŸºåº§åº”ç”¨å¯¹è¿™ä¸¤ç§å­åº”ç”¨éƒ½æ”¯æŒã€‚
åœ¨ä»¥ä¸‹æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬é»˜è®¤åŸºåº§çš„è·¯ç”±ä¸ºhistoryæ¨¡å¼ã€‚`},{header:"1ã€å®‰è£…ä¾èµ–",slug:"_1ã€å®‰è£…ä¾èµ–",content:"npm i @micro-zoe/micro-app --save"},{header:"2ã€åœ¨å…¥å£å¤„å¼•å…¥",slug:"_2ã€åœ¨å…¥å£å¤„å¼•å…¥",content:`// entry
import microApp from '@micro-zoe/micro-app' microApp.start()`},{header:"3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨",slug:"_3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨",content:`// router.js
import Vue from 'vue'
import VueRouter from 'vue-router'
import MyPage from './my-page.vue' Vue.use(VueRouter) const routes = [ { // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢ path: '/my-page/*', name: 'my-page', component: MyPage, },
] export default routes // router.js
import { createRouter, createWebHistory } from 'vue-router'
import MyPage from './my-page.vue' const routes = [ { // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢ path: '/my-page/:page*', name: 'my-page', component: MyPage, },
] const router = createRouter({ history: createWebHistory(process.env.BASE_URL), routes
}) export default router`},{header:"4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",slug:"_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨",content:"<!-- my-page.vue -->\n<template> <div> <h1>å­åº”ç”¨</h1> <!-- name(å¿…ä¼ )ï¼šåº”ç”¨åç§° url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ `/my-page` --> <micro-app name='app1' url='http://localhost:3000/' baseroute='/my-page'></micro-app> </div>\n</template>"},{header:"ä½œä¸ºå­åº”ç”¨",slug:"ä½œä¸ºå­åº”ç”¨",content:""},{header:"1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",slug:"_1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ",content:`åœ¨vue.config.jsä¸­æ·»åŠ é…ç½®
devServer: { headers: { 'Access-Control-Allow-Origin': '*', }
}`},{header:"2ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)",slug:"_2ã€è®¾ç½®åŸºç¡€è·¯ç”±-å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±-å­åº”ç”¨æ˜¯hashè·¯ç”±-è¿™ä¸€æ­¥å¯ä»¥çœç•¥",content:`// main.js
import VueRouter from 'vue-router'
import routes from './router' const router = new VueRouter({ mode: 'history', // ğŸ‘‡ __MICRO_APP_BASE_ROUTE__ ä¸ºmicro-appä¼ å…¥çš„åŸºç¡€è·¯ç”± base: window.__MICRO_APP_BASE_ROUTE__ || process.env.BASE_URL, routes,
}) // main.js
import { createRouter, createWebHistory } from 'vue-router'
import routes from './router' const router = createRouter({ // ğŸ‘‡ __MICRO_APP_BASE_ROUTE__ ä¸ºmicro-appä¼ å…¥çš„åŸºç¡€è·¯ç”± history: createWebHistory(window.__MICRO_APP_BASE_ROUTE__ || process.env.BASE_URL), routes,
})`},{header:"3ã€è®¾ç½® publicPath",slug:"_3ã€è®¾ç½®-publicpath",content:`è¿™ä¸€æ­¥å€ŸåŠ©äº†webpackçš„åŠŸèƒ½ï¼Œé¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ publicPath
å¦‚æœå­åº”ç”¨ä¸æ˜¯webpackæ„å»ºçš„ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥ã€‚
æ­¥éª¤1: åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) { // eslint-disable-next-line __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
æ­¥éª¤2: åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js
// entry
import './public-path'`},{header:"4ã€ç›‘å¬å¸è½½",slug:"_4ã€ç›‘å¬å¸è½½",content:`å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚ // main.js
const app = new Vue(...) // ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { app.$destroy()
}) // main.js
const app = createApp(App)
app.mount('#app') // ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () { app.unmount()
})`},{header:"å®æˆ˜æ¡ˆä¾‹",slug:"å®æˆ˜æ¡ˆä¾‹",content:`ä»¥ä¸Šä»‹ç»äº†vueå¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºvueä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚
æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x`},{header:"å¸¸è§é—®é¢˜",slug:"å¸¸è§é—®é¢˜",content:""},{header:"1ã€åŸºåº§åº”ç”¨ä¸­æŠ›å‡ºè­¦å‘Šï¼Œmicro-appæœªå®šä¹‰",slug:"_1ã€åŸºåº§åº”ç”¨ä¸­æŠ›å‡ºè­¦å‘Š-micro-appæœªå®šä¹‰",content:`æŠ¥é”™ä¿¡æ¯ï¼š vue2: [Vue warn]: Unknown custom element: <micro-app>
vue3: [Vue warn]: Failed to resolve component: micro-app å‚è€ƒissueï¼š vue-next@1414
è§£å†³æ–¹å¼ï¼š åœ¨åŸºåº§åº”ç”¨ä¸­æ·»åŠ å¦‚ä¸‹é…ç½® åœ¨å…¥å£æ–‡ä»¶main.jsä¸­è®¾ç½®ignoredElementsï¼Œè¯¦æƒ…æŸ¥çœ‹ï¼šhttps://cn.vuejs.org/v2/api/#ignoredElements
// main.js
import Vue from 'vue' Vue.config.ignoredElements = [ 'micro-app',
] åœ¨vue.config.jsä¸­æ·»åŠ chainWebpacké…ç½®ï¼Œå¦‚ä¸‹ï¼š
// vue.config.js
module.exports = { chainWebpack: config => { config.module .rule('vue') .use('vue-loader') .tap(options => { options.compilerOptions = { ...(options.compilerOptions || {}), isCustomElement: (tag) => /^micro-app/.test(tag), }; return options }) }
} åœ¨vite.config.jsä¸­é€šè¿‡vueæ’ä»¶è®¾ç½®isCustomElementï¼Œå¦‚ä¸‹ï¼š
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue' export default defineConfig({ plugins: [ vue({ template: { compilerOptions: { isCustomElement: tag => /^micro-app/.test(tag) } } }) ],
})`},{header:"2ã€å½“åŸºåº§å’Œå­åº”ç”¨éƒ½æ˜¯vue-router4ï¼Œç‚¹å‡»æµè§ˆå™¨è¿”å›æŒ‰é’®é¡µé¢ä¸¢å¤±",slug:"_2ã€å½“åŸºåº§å’Œå­åº”ç”¨éƒ½æ˜¯vue-router4-ç‚¹å‡»æµè§ˆå™¨è¿”å›æŒ‰é’®é¡µé¢ä¸¢å¤±",content:`åŸå› ï¼š vue-router4æ²¡æœ‰å¯¹è·¯ç”±å †æ ˆstateåšå”¯ä¸€æ€§æ ‡è®°ï¼Œå¯¼è‡´åŸºåº§å’Œå­åº”ç”¨ç›¸äº’å½±å“ï¼Œvue-router3åŠå…¶å®ƒæ¡†æ¶è·¯ç”±æ²¡æœ‰ç±»ä¼¼é—®é¢˜ã€‚
æµ‹è¯•ç‰ˆæœ¬ï¼š vue-router@4.0.12
ç›¸å…³issueï¼š 155
è§£å†³æ–¹å¼ï¼š åœ¨å­åº”ç”¨ä¸­æ·»åŠ å¦‚ä¸‹è®¾ç½®
if (window.__MICRO_APP_ENVIRONMENT__) { // å¦‚æœ__MICRO_APP_BASE_ROUTE__ä¸º \`/åŸºåº§åº”ç”¨åŸºç¡€è·¯ç”±/å­åº”ç”¨åŸºç¡€è·¯ç”±/\`ï¼Œåˆ™åº”å»æ‰\`/åŸºåº§åº”ç”¨åŸºç¡€è·¯ç”±\` // å¦‚æœå¯¹è¿™å¥è¯ä¸ç†è§£ï¼Œå¯ä»¥å‚è€ƒæ¡ˆä¾‹ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x const realBaseRoute = window.__MICRO_APP_BASE_ROUTE__ router.beforeEach(() => { if (typeof window.history.state?.current === 'string') { window.history.state.current = window.history.state.current.replace(new RegExp(realBaseRoute, 'g'), '') } }) router.afterEach(() => { if (typeof window.history.state === 'object') { window.history.state.current = realBaseRoute + (window.history.state.current || '') } })
}`},{header:"3ã€vue-routeråœ¨hashæ¨¡å¼æ— æ³•é€šè¿‡baseè®¾ç½®åŸºç¡€è·¯ç”±",slug:"_3ã€vue-routeråœ¨hashæ¨¡å¼æ— æ³•é€šè¿‡baseè®¾ç½®åŸºç¡€è·¯ç”±",content:`è§£å†³æ–¹å¼ï¼š åˆ›å»ºä¸€ä¸ªç©ºçš„è·¯ç”±é¡µé¢ï¼Œå°†å…¶å®ƒè·¯ç”±ä½œä¸ºå®ƒçš„childrenï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹ï¼š
import RootApp from './root-app.vue' const routes = [ { path: window.__MICRO_APP_BASE_ROUTE__ || '/', component: RootApp, children: [ // å…¶ä»–çš„è·¯ç”±éƒ½å†™åˆ°è¿™é‡Œ ], },
]
root-app.vueå†…å®¹å¦‚ä¸‹ï¼š
<template> <router-view />
</template>`}]},{path:"/404.html",title:"",pathLocale:"/",contents:[]}],U="update-vuepress-plugin-full-text-search2-search-index";var j=w(B),$=y(()=>{const e=new Map;for(const t of j.value)e.set(t.path,t);return e});import.meta.webpackHot&&(__VUE_HMR_RUNTIME__[U]=e=>{j.value=e});function V(e){const t=w([]);let p=null;return O(e,()=>{p&&clearTimeout(p),p=setTimeout(a,100)}),t;function a(){const c=e.value.toLowerCase().trim();if(!c){t.value=[];return}const r=new Map,n=new Set;for(const o of j.value)for(const s of G(o,c)){n.add(s.parentPageTitle);let i=r.get(s.parentPageTitle);i||(i=[],r.set(s.parentPageTitle,i)),i.push(s)}const l=[...n].sort((o,s)=>{const i=r.get(o);return r.get(s).length-i.length});t.value=[...r].flatMap(([,o])=>o).sort((o,s)=>o.parentPagePriority-s.parentPagePriority||l.indexOf(o.parentPageTitle)-l.indexOf(s.parentPageTitle)||o.priority-s.priority)}}function*G(e,t){const p=A(e.title,t);if(p){yield{path:e.path,parentPageTitle:b(e),title:e.title,display:p,page:e,content:null,parentPagePriority:1,priority:1};return}for(const a of e.contents){const c=A(a.header,t);if(c){yield{path:e.path+(a.slug?`#${a.slug}`:""),parentPageTitle:b(e),title:e.title,display:c,page:e,content:null,parentPagePriority:10,priority:2};continue}const r=A(a.content,t);r&&(yield{path:e.path+(a.slug?`#${a.slug}`:""),parentPageTitle:b(e),title:e.title,display:[{type:"header",str:`${a.header}
`},...r],page:e,content:null,parentPagePriority:10,priority:10})}}function b(e){const t=e.path.split("/");let p="/";return t[1]&&(p=`/${t[1]}/`),($.value.get(p)||e).title}function A(e,t){const p=[];let a=0;const c=e.toLowerCase().replace(/\s/gu," ");let r=0,n=c.indexOf(t,r);if(n<0)return null;for(;n>=0;){const o=n+t.length;if(l(e.slice(r,n),"normal"),l(e.slice(n,o),"highlight"),r=o,n=c.indexOf(t,r),a>100)break}return l(e.slice(r),"normal"),p.filter(o=>o.str);function l(o,s){let i=o;s==="normal"&&i.length>100&&a===0&&(i=`â€¦ ${i.slice(-10)}`);let h=!1;if(a+i.length>100){if(p.some(g=>g.type==="ellipsis"))return;i=i.slice(0,Math.max(100-a,1)),h=!0}p.push({type:s,str:i}),a+=i.length,h&&(p.push({type:"ellipsis",str:" â€¦"}),a+=2)}}var H={"/":{placeholder:"æœç´¢"}};const q=H,W=N({name:"SearchBox",props:{locales:{type:Object,required:!1,default:()=>q}},setup(e){const{locales:t}=M(e),p=w(""),a=w(!1),c=w(-1),r=V(p),n=y(()=>p.value&&a.value&&r.value.length),l=L(),o=S(),s=y(()=>t.value[o.value]??{});function i(){if(!n.value)return;let m=c.value-1;m<0&&(m=r.value.length-1),g(m)}function h(){if(!n.value)return;let m=c.value+1;m>=r.value.length&&(m=0),g(m)}function g(m){c.value=m}function D(){c.value=-1}function E(m){if(!n.value)return;const P=r.value[m];P&&l.push(P.path)}return{query:p,focused:a,focusIndex:c,suggestions:r,activeSuggestion:n,onUp:i,onDown:h,focus:g,unfocus:D,go:E,locale:s}}}),J={class:"search-box",role:"search"},X=["placeholder"],K=["onMousedown","onMouseenter"],Z=["href"],Y={key:0,class:"parent-page-title"},Q={class:"suggestion-row"},ee={class:"page-title"},te={class:"suggestion-content"};function ne(e,t,p,a,c,r){return u(),d("div",J,[z(f("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=n=>e.query=n),"aria-label":"Search",class:_({focused:e.focused}),placeholder:e.locale.placeholder??"Search",autocomplete:"off",spellcheck:"false",onFocus:t[1]||(t[1]=()=>e.focused=!0),onBlur:t[2]||(t[2]=()=>e.focused=!1),onKeyup:[t[3]||(t[3]=x(n=>e.go(e.focusIndex),["enter"])),t[4]||(t[4]=x((...n)=>e.onUp&&e.onUp(...n),["up"])),t[5]||(t[5]=x((...n)=>e.onDown&&e.onDown(...n),["down"]))]},null,42,X),[[T,e.query]]),e.activeSuggestion?(u(),d("ul",{key:0,class:"suggestions",onMouseleave:t[7]||(t[7]=(...n)=>e.unfocus&&e.unfocus(...n))},[(u(!0),d(C,null,k(e.suggestions,(n,l)=>(u(),d("li",{key:l,class:_(["suggestion",{focused:l===e.focusIndex}]),onMousedown:o=>e.go(l),onMouseenter:o=>e.focus(l)},[f("a",{href:n.path,onClick:t[6]||(t[6]=F(()=>{},["prevent"]))},[n.parentPageTitle&&(!e.suggestions[l-1]||e.suggestions[l-1].parentPageTitle!==n.parentPageTitle)?(u(),d("div",Y,v(n.parentPageTitle),1)):R("",!0),f("div",Q,[f("div",ee,v(n.title||n.path),1),f("div",te,[(u(!0),d(C,null,k(n.display,(o,s)=>(u(),d("span",{key:s,class:_(o.type)},v(o.str),3))),128))])])],8,Z)],42,K))),128))],32)):R("",!0)])}const ae=I(W,[["render",ne],["__scopeId","data-v-fd6cd4d5"],["__file","SearchBox.vue"]]);export{ae as default};
