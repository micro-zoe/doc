import{_ as t,r as p,o,c,d as n,e as s,b as i,a}from"./app-CYuVcYeJ.js";const l={},r=a(`<h1 id="react" tabindex="-1"><a class="header-anchor" href="#react"><span>React</span></a></h1><p>æœ¬ç¯‡ä»¥<code>React 16ã€17</code>ä½œä¸ºæ¡ˆä¾‹ä»‹ç»reactçš„æ¥å…¥æ–¹å¼ï¼Œå…¶å®ƒç‰ˆæœ¬reactçš„æ¥å…¥æ–¹å¼ä»¥æ­¤ç±»æ¨ã€‚æˆ‘ä»¬é»˜è®¤å¼€å‘è€…æŒæ¡äº†å„ç‰ˆæœ¬reactçš„å¼€å‘æŠ€å·§ï¼Œå¦‚ç¤ºä¾‹ä¸­useEffectï¼Œåœ¨ä¸æ”¯æŒhooksçš„ç‰ˆæœ¬ä¸­è½¬æ¢ä¸ºcomponentDidMountã€‚</p><h2 id="ä½œä¸ºåŸºåº§åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ä½œä¸ºåŸºåº§åº”ç”¨"><span>ä½œä¸ºåŸºåº§åº”ç”¨</span></a></h2><p>æˆ‘ä»¬å¼ºçƒˆå»ºè®®åŸºåº§åº”ç”¨é‡‡ç”¨historyæ¨¡å¼ï¼Œhashè·¯ç”±çš„åŸºåº§åº”ç”¨åªèƒ½åŠ è½½hashè·¯ç”±çš„å­åº”ç”¨ï¼Œhistoryæ¨¡å¼çš„åŸºåº§åº”ç”¨å¯¹è¿™ä¸¤ç§å­åº”ç”¨éƒ½æ”¯æŒã€‚</p><p>åœ¨ä»¥ä¸‹æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬é»˜è®¤åŸºåº§çš„è·¯ç”±ä¸ºhistoryæ¨¡å¼ã€‚</p><h4 id="_1ã€å®‰è£…ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1ã€å®‰è£…ä¾èµ–"><span>1ã€å®‰è£…ä¾èµ–</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i @micro-zoe/micro-app <span class="token parameter variable">--save</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2ã€åœ¨å…¥å£å¤„å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#_2ã€åœ¨å…¥å£å¤„å¼•å…¥"><span>2ã€åœ¨å…¥å£å¤„å¼•å…¥</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// entry</span>
<span class="token keyword">import</span> microApp <span class="token keyword">from</span> <span class="token string">&#39;@micro-zoe/micro-app&#39;</span>

microApp<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨"><span>3ã€åˆ†é…ä¸€ä¸ªè·¯ç”±ç»™å­åº”ç”¨</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// router.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter<span class="token punctuation">,</span> Switch<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span>
<span class="token keyword">import</span> MyPage <span class="token keyword">from</span> <span class="token string">&#39;./my-page&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">AppRoute</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>BrowserRouter<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
        <span class="token comment">// ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/my-page/* éƒ½æŒ‡å‘ MyPage é¡µé¢</span>
        <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&#39;/my-page&#39;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>MyPage <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>BrowserRouter<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#_4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨"><span>4ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">MyPage</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>å­åº”ç”¨<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>micro<span class="token operator">-</span>app
        name<span class="token operator">=</span><span class="token string">&#39;app1&#39;</span> <span class="token comment">// name(å¿…ä¼ )ï¼šåº”ç”¨åç§°</span>
        url<span class="token operator">=</span><span class="token string">&#39;http://localhost:3000/&#39;</span> <span class="token comment">// url(å¿…ä¼ )ï¼šåº”ç”¨åœ°å€ï¼Œä¼šè¢«è‡ªåŠ¨è¡¥å…¨ä¸ºhttp://localhost:3000/index.html</span>
        baseroute<span class="token operator">=</span><span class="token string">&#39;/my-page&#39;</span> <span class="token comment">// baseroute(å¯é€‰)ï¼šåŸºåº§åº”ç”¨åˆ†é…ç»™å­åº”ç”¨çš„åŸºç¡€è·¯ç”±ï¼Œå°±æ˜¯ä¸Šé¢çš„ \`/my-page\`</span>
      <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>micro<span class="token operator">-</span>app<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä½œä¸ºå­åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ä½œä¸ºå­åº”ç”¨"><span>ä½œä¸ºå­åº”ç”¨</span></a></h2><h4 id="_1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#_1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ"><span>1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ</span></a></h4><p>ä½¿ç”¨<code>create-react-app</code>è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œåœ¨ <code>config/webpackDevServer.config.js</code> æ–‡ä»¶ä¸­æ·»åŠ headersã€‚</p><p>å…¶å®ƒé¡¹ç›®åœ¨<code>webpack-dev-server</code>ä¸­æ·»åŠ headersã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&#39;Access-Control-Allow-Origin&#39;</span><span class="token operator">:</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2ã€è®¾ç½®åŸºç¡€è·¯ç”±-å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±-å­åº”ç”¨æ˜¯hashè·¯ç”±-è¿™ä¸€æ­¥å¯ä»¥çœç•¥" tabindex="-1"><a class="header-anchor" href="#_2ã€è®¾ç½®åŸºç¡€è·¯ç”±-å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±-å­åº”ç”¨æ˜¯hashè·¯ç”±-è¿™ä¸€æ­¥å¯ä»¥çœç•¥"><span>2ã€è®¾ç½®åŸºç¡€è·¯ç”±<code>(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)</code></span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// router.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter<span class="token punctuation">,</span> Switch<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">AppRoute</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token comment">// ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™window.__MICRO_APP_BASE_ROUTE__ä¸ºç©ºå­—ç¬¦ä¸²</span>
    <span class="token operator">&lt;</span>BrowserRouter basename<span class="token operator">=</span><span class="token punctuation">{</span>window<span class="token punctuation">.</span>__MICRO_APP_BASE_ROUTE__ <span class="token operator">||</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">...</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>BrowserRouter<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€è®¾ç½®-publicpath" tabindex="-1"><a class="header-anchor" href="#_3ã€è®¾ç½®-publicpath"><span>3ã€è®¾ç½® publicPath</span></a></h4>`,21),d={href:"https://webpack.docschina.org/guides/public-path/#on-the-fly",target:"_blank",rel:"noopener noreferrer"},u=a(`<p><em>å¦‚æœå­åº”ç”¨ä¸æ˜¯webpackæ„å»ºçš„ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥ã€‚</em></p><p><strong>æ­¥éª¤1:</strong> åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸º<code>public-path.js</code>çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__MICRO_APP_ENVIRONMENT__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// eslint-disable-next-line</span>
  __webpack_public_path__ <span class="token operator">=</span> window<span class="token punctuation">.</span>__MICRO_APP_PUBLIC_PATH__
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ­¥éª¤2:</strong> åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„<strong>æœ€é¡¶éƒ¨</strong>å¼•å…¥<code>public-path.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// entry</span>
<span class="token keyword">import</span> <span class="token string">&#39;./public-path&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€ç›‘å¬å¸è½½" tabindex="-1"><a class="header-anchor" href="#_4ã€ç›‘å¬å¸è½½"><span>4ã€ç›‘å¬å¸è½½</span></a></h4><p>å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸º<code>unmount</code>çš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;unmount&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®æˆ˜æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜æ¡ˆä¾‹"><span>å®æˆ˜æ¡ˆä¾‹</span></a></h2><p>ä»¥ä¸Šä»‹ç»äº†reactå¦‚ä½•æ¥å…¥å¾®å‰ç«¯ï¼Œä½†åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šæ¶‰åŠæ›´å¤šåŠŸèƒ½ï¼Œå¦‚æ•°æ®é€šä¿¡ã€è·¯ç”±è·³è½¬ã€æ‰“åŒ…éƒ¨ç½²ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†ä¸€å¥—æ¡ˆä¾‹ï¼Œç”¨äºå±•ç¤ºreactä½œä¸ºåŸºåº§åµŒå…¥(æˆ–ä½œä¸ºå­åº”ç”¨è¢«åµŒå…¥) reactã€vueã€angularã€viteã€nextjsã€nuxtjsç­‰æ¡†æ¶ï¼Œåœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç å®ç°å°½å¯èƒ½å¤šçš„åŠŸèƒ½ã€‚</p><p>æ¡ˆä¾‹åœ°å€ï¼šhttps://github.com/micro-zoe/micro-app-demo-0.x</p><h2 id="å¸¸è§é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å¸¸è§é—®é¢˜"><span>å¸¸è§é—®é¢˜</span></a></h2><h4 id="_1ã€create-react-appåˆ›å»ºçš„å­åº”ç”¨-è¢«åµŒå…¥å¾®å‰ç«¯åsockjs-nodeæŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_1ã€create-react-appåˆ›å»ºçš„å­åº”ç”¨-è¢«åµŒå…¥å¾®å‰ç«¯åsockjs-nodeæŠ¥é”™"><span>1ã€create-react-appåˆ›å»ºçš„å­åº”ç”¨ï¼Œè¢«åµŒå…¥å¾®å‰ç«¯åsockjs-nodeæŠ¥é”™</span></a></h4><p><strong>æŠ¥é”™ä¿¡æ¯ï¼š</strong> <code>WebSocket connection to &#39;ws://localhost:3000/sockjs-node&#39; failed</code></p><p><strong>åŸå› ï¼š</strong> å­åº”ç”¨çš„sockjs-nodeä¼šæ ¹æ®å½“å‰é¡µé¢çš„ç«¯å£å·è¿›è¡Œé€šä¿¡ï¼ŒåµŒå…¥å¾®å‰ç«¯åï¼Œç«¯å£å·ä¸ºåŸºåº§çš„ï¼Œè€Œéå­åº”ç”¨çš„ï¼Œå¯¼è‡´æŠ¥é”™ã€‚ è™½ç„¶è¿™ä¸ªé—®é¢˜ä¸å½±å“åº”ç”¨çš„æ­£å¸¸è¿è¡Œï¼Œä½†è¿˜æ˜¯è¦è¿›è¡Œå¤„ç†ã€‚</p><p><strong>è§£å†³æ–¹å¼ï¼š</strong> ä½¿ç”¨æ’ä»¶ç³»ç»Ÿè¡¥å…¨å­åº”ç”¨sockjs-nodeçš„ç«¯å£å·ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>microApp<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">å­åº”ç”¨åç§°</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#39;development&#39;</span> <span class="token operator">&amp;&amp;</span> code<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;sockjs-node&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            code <span class="token operator">=</span> code<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;window.location.port&#39;</span><span class="token punctuation">,</span> å­åº”ç”¨ç«¯å£<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> code
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,17);function k(v,m){const e=p("ExternalLinkIcon");return o(),c("div",null,[r,n("p",null,[s("è¿™ä¸€æ­¥å€ŸåŠ©äº†webpackçš„åŠŸèƒ½ï¼Œé¿å…å­åº”ç”¨çš„é™æ€èµ„æºä½¿ç”¨ç›¸å¯¹åœ°å€æ—¶åŠ è½½å¤±è´¥çš„æƒ…å†µï¼Œè¯¦æƒ…å‚è€ƒwebpackæ–‡æ¡£ "),n("a",d,[s("publicPath"),i(e)])]),u])}const b=t(l,[["render",k],["__file","react.html.vue"]]);export{b as default};
